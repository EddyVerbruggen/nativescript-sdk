/**
 * kinvey-nativescript-sdk - Kinvey NativeScript SDK for developing NativeScript applications.
 * @version v3.9.9
 * @author Kinvey, Inc.
 * @link http://www.kinvey.com
 * @license Apache-2.0
 */
module.exports=function(e){var t={};function r(n){if(t[n]){return t[n].exports}var i=t[n]={i:n,l:false,exports:{}};e[n].call(i.exports,i,i.exports,r);i.l=true;return i.exports}r.m=e;r.c=t;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=143)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseError=n;function n(e,t,r,n){this.name="BaseError";this.message=e||"An error occurred.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}n.prototype=Object.create(Error.prototype);n.prototype.constructor=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(214);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(215);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(216);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(217);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(218);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(0);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})});var c=r(219);Object.keys(c).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return c[e]}})});var f=r(220);Object.keys(f).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return f[e]}})});var l=r(221);Object.keys(l).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return l[e]}})});var h=r(222);Object.keys(h).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return h[e]}})});var d=r(223);Object.keys(d).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return d[e]}})});var p=r(224);Object.keys(p).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return p[e]}})});var v=r(225);Object.keys(v).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return v[e]}})});var y=r(226);Object.keys(y).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return y[e]}})});var b=r(227);Object.keys(b).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return b[e]}})});var g=r(228);Object.keys(g).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return g[e]}})});var m=r(229);Object.keys(m).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return m[e]}})});var _=r(230);Object.keys(_).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return _[e]}})});var w=r(231);Object.keys(w).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return w[e]}})});var O=r(232);Object.keys(O).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return O[e]}})});var E=r(233);Object.keys(E).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return E[e]}})});var k=r(234);Object.keys(k).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return k[e]}})});var P=r(235);Object.keys(P).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return P[e]}})});var j=r(236);Object.keys(j).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return j[e]}})});var S=r(237);Object.keys(S).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return S[e]}})});var A=r(238);Object.keys(A).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return A[e]}})});var T=r(239);Object.keys(T).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return T[e]}})});var x=r(240);Object.keys(x).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return x[e]}})});var C=r(241);Object.keys(C).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return C[e]}})});var M=r(242);Object.keys(M).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return M[e]}})});var R=r(243);Object.keys(R).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return R[e]}})});var I=r(244);Object.keys(I).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return I[e]}})});var q=r(245);Object.keys(q).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return q[e]}})});var U=r(246);Object.keys(U).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return U[e]}})});var D=r(247);Object.keys(D).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return D[e]}})});var K=r(248);Object.keys(K).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return K[e]}})});var N=r(249);Object.keys(N).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return N[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(110);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(253);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(254);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})})},function(e,t,r){"use strict";e.exports={}},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNDeleteMessagesOperation:"PNDeleteMessagesOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerAudit:"PNAccessManagerAudit"};e.exports=t["default"]},function(e,t,r){(function(t,n){var i;(function(t,r){true?e.exports=r():typeof define==="function"&&define.amd?define(r):t.ES6Promise=r()})(this,function(){"use strict";function e(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}function o(e){return typeof e==="function"}var u=undefined;if(Array.isArray){u=Array.isArray}else{u=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}var a=u;var s=0;var c=undefined;var f=undefined;var l=function e(t,r){k[s]=t;k[s+1]=r;s+=2;if(s===2){if(f){f(P)}else{S()}}};function h(e){f=e}function d(e){l=e}var p=typeof window!=="undefined"?window:undefined;var v=p||{};var y=v.MutationObserver||v.WebKitMutationObserver;var b=typeof self==="undefined"&&typeof t!=="undefined"&&{}.toString.call(t)==="[object process]";var g=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function m(){return function(){return t.nextTick(P)}}function _(){if(typeof c!=="undefined"){return function(){c(P)}}return E()}function w(){var e=0;var t=new y(P);var r=document.createTextNode("");t.observe(r,{characterData:true});return function(){r.data=e=++e%2}}function O(){var e=new MessageChannel;e.port1.onmessage=P;return function(){return e.port2.postMessage(0)}}function E(){var e=setTimeout;return function(){return e(P,1)}}var k=new Array(1e3);function P(){for(var e=0;e<s;e+=2){var t=k[e];var r=k[e+1];t(r);k[e]=undefined;k[e+1]=undefined}s=0}function j(){try{var e=i;var t=r(146);c=t.runOnLoop||t.runOnContext;return _()}catch(e){return E()}}var S=undefined;if(b){S=m()}else if(y){S=w()}else if(g){S=O()}else if(p===undefined&&"function"==="function"){S=j()}else{S=E()}function A(e,t){var r=arguments;var n=this;var i=new this.constructor(C);if(i[x]===undefined){re(i)}var o=n._state;if(o){(function(){var e=r[o-1];l(function(){return X(o,i,e,n._result)})})()}else{Q(n,i,e,t)}return i}function T(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var r=new t(C);H(r,e);return r}var x=Math.random().toString(36).substring(16);function C(){}var M=void 0;var R=1;var I=2;var q=new W;function U(){return new TypeError("You cannot resolve a promise with itself")}function D(){return new TypeError("A promises callback cannot return that same promise.")}function K(e){try{return e.then}catch(e){q.error=e;return q}}function N(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function L(e,t,r){l(function(e){var n=false;var i=N(r,t,function(r){if(n){return}n=true;if(t!==r){H(e,r)}else{z(e,r)}},function(t){if(n){return}n=true;V(e,t)},"Settle: "+(e._label||" unknown promise"));if(!n&&i){n=true;V(e,i)}},e)}function B(e,t){if(t._state===R){z(e,t._result)}else if(t._state===I){V(e,t._result)}else{Q(t,undefined,function(t){return H(e,t)},function(t){return V(e,t)})}}function F(e,t,r){if(t.constructor===e.constructor&&r===A&&t.constructor.resolve===T){B(e,t)}else{if(r===q){V(e,q.error);q.error=null}else if(r===undefined){z(e,t)}else if(o(r)){L(e,t,r)}else{z(e,t)}}}function H(t,r){if(t===r){V(t,U())}else if(e(r)){F(t,r,K(r))}else{z(t,r)}}function G(e){if(e._onerror){e._onerror(e._result)}$(e)}function z(e,t){if(e._state!==M){return}e._result=t;e._state=R;if(e._subscribers.length!==0){l($,e)}}function V(e,t){if(e._state!==M){return}e._state=I;e._result=t;l(G,e)}function Q(e,t,r,n){var i=e._subscribers;var o=i.length;e._onerror=null;i[o]=t;i[o+R]=r;i[o+I]=n;if(o===0&&e._state){l($,e)}}function $(e){var t=e._subscribers;var r=e._state;if(t.length===0){return}var n=undefined,i=undefined,o=e._result;for(var u=0;u<t.length;u+=3){n=t[u];i=t[u+r];if(n){X(r,n,i,o)}else{i(o)}}e._subscribers.length=0}function W(){this.error=null}var Y=new W;function J(e,t){try{return e(t)}catch(e){Y.error=e;return Y}}function X(e,t,r,n){var i=o(r),u=undefined,a=undefined,s=undefined,c=undefined;if(i){u=J(r,n);if(u===Y){c=true;a=u.error;u.error=null}else{s=true}if(t===u){V(t,D());return}}else{u=n;s=true}if(t._state!==M){}else if(i&&s){H(t,u)}else if(c){V(t,a)}else if(e===R){z(t,u)}else if(e===I){V(t,u)}}function Z(e,t){try{t(function t(r){H(e,r)},function t(r){V(e,r)})}catch(t){V(e,t)}}var ee=0;function te(){return ee++}function re(e){e[x]=ee++;e._state=undefined;e._result=undefined;e._subscribers=[]}function ne(e,t){this._instanceConstructor=e;this.promise=new e(C);if(!this.promise[x]){re(this.promise)}if(a(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){z(this.promise,this._result)}else{this.length=this.length||0;this._enumerate(t);if(this._remaining===0){z(this.promise,this._result)}}}else{V(this.promise,ie())}}function ie(){return new Error("Array Methods must be provided an Array")}ne.prototype._enumerate=function(e){for(var t=0;this._state===M&&t<e.length;t++){this._eachEntry(e[t],t)}};ne.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;var n=r.resolve;if(n===T){var i=K(e);if(i===A&&e._state!==M){this._settledAt(e._state,t,e._result)}else if(typeof i!=="function"){this._remaining--;this._result[t]=e}else if(r===fe){var o=new r(C);F(o,e,i);this._willSettleAt(o,t)}else{this._willSettleAt(new r(function(t){return t(e)}),t)}}else{this._willSettleAt(n(e),t)}};ne.prototype._settledAt=function(e,t,r){var n=this.promise;if(n._state===M){this._remaining--;if(e===I){V(n,r)}else{this._result[t]=r}}if(this._remaining===0){z(n,this._result)}};ne.prototype._willSettleAt=function(e,t){var r=this;Q(e,undefined,function(e){return r._settledAt(R,t,e)},function(e){return r._settledAt(I,t,e)})};function oe(e){return new ne(this,e).promise}function ue(e){var t=this;if(!a(e)){return new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}else{return new t(function(r,n){var i=e.length;for(var o=0;o<i;o++){t.resolve(e[o]).then(r,n)}})}}function ae(e){var t=this;var r=new t(C);V(r,e);return r}function se(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ce(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function fe(e){this[x]=te();this._result=this._state=undefined;this._subscribers=[];if(C!==e){typeof e!=="function"&&se();this instanceof fe?Z(this,e):ce()}}fe.all=oe;fe.race=ue;fe.resolve=T;fe.reject=ae;fe._setScheduler=h;fe._setAsap=d;fe._asap=l;fe.prototype={constructor:fe,then:A,catch:function e(t){return this.then(null,t)}};function le(){var e=undefined;if(typeof n!=="undefined"){e=n}else if(typeof self!=="undefined"){e=self}else{try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if(r==="[object Promise]"&&!t.cast){return}}e.Promise=fe}fe.polyfill=le;fe.Promise=fe;return fe})}).call(t,r(145),r(18))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(94);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(308);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(50);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(126);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(49);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(34);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})});var c=r(76);Object.keys(c).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return c[e]}})});var f=r(122);Object.keys(f).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return f[e]}})})},function(e,t,r){var n=r(19),i=r(4),o=r(15);var u="[object String]";function a(e){return typeof e=="string"||!i(e)&&o(e)&&n(e)==u}e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Client=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(115);var o=v(i);var u=r(11);var a=v(u);var s=r(8);var c=v(s);var f=r(75);var l=v(f);var h=r(1);var d=r(22);var p=r(2);function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=6e4;var g="active_user";var m=null;var _=function(){function e(){y(this,e);this.memory=new o.default}n(e,[{key:"get",value:function e(t){if(!(0,c.default)(t)){throw new h.KinveyError("ActiveUserStorage key must be a string.")}try{return JSON.parse(this.memory.get(t))}catch(e){return null}}},{key:"set",value:function e(t,r){if(!(0,c.default)(t)){throw new h.KinveyError("ActiveUserStorage key must be a string.")}if((0,p.isDefined)(r)){this.memory.set(t,JSON.stringify(r))}else{this.memory.delete(t)}return r}}]);return e}();var w=t.Client=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};y(this,e);var r=(0,c.default)(t.apiHostname)?t.apiHostname:"https://baas.kinvey.com";if(/^https?:\/\//i.test(r)===false){r="https://"+r}var n=a.default.parse(r);this.deviceId=(0,p.uuidv4)();this.apiProtocol=n.protocol;this.apiHost=n.host;var i=(0,c.default)(t.micHostname)?t.micHostname:"https://auth.kinvey.com";if(/^https?:\/\//i.test(i)===false){i="https://"+i}var o=a.default.parse(i);this.micProtocol=o.protocol;this.micHost=o.host;this.appKey=t.appKey;this.appSecret=t.appSecret;this.masterSecret=t.masterSecret;this.encryptionKey=t.encryptionKey;this.appVersion=t.appVersion;this.defaultTimeout=(0,l.default)(t.defaultTimeout)&&t.defaultTimeout>=0?t.defaultTimeout:b;this.storageProviders=t.storage;this.activeUserStorage=new _}n(e,[{key:"getActiveUser",value:function e(){return this.activeUserStorage.get(this.appKey+"."+g)}},{key:"setActiveUser",value:function e(t){return this.activeUserStorage.set(this.appKey+"."+g,t)}},{key:"toPlainObject",value:function e(){return{deviceId:this.deviceId,apiHostname:this.apiHostname,apiProtocol:this.apiProtocol,apiHost:this.apiHost,micHostname:this.micHostname,micProtocol:this.micProtocol,micHost:this.micHost,appKey:this.appKey,appSecret:this.appSecret,masterSecret:this.masterSecret,encryptionKey:this.encryptionKey,appVersion:this.appVersion,storageProviders:this.storageProviders}}},{key:"apiHostname",get:function e(){return a.default.format({protocol:this.apiProtocol,host:this.apiHost})}},{key:"micHostname",get:function e(){return a.default.format({protocol:this.micProtocol,host:this.micHost})}},{key:"appVersion",get:function e(){return this._appVersion},set:function e(t){if(t&&!(0,c.default)(t)){t=String(t)}this._appVersion=t}},{key:"defaultTimeout",get:function e(){return this._defaultTimeout},set:function e(t){t=parseInt(t,10);if((0,l.default)(t)===false||isNaN(t)){throw new h.KinveyError("Invalid timeout. Timeout must be a number.")}if(t<0){d.Log.info("Default timeout is less than 0. Setting default timeout to "+defaultTimeout+"ms.");t=defaultTimeout}this._defaultTimeout=t}}],[{key:"initialize",value:function e(){throw new h.KinveyError("Please use Client.init().")}},{key:"init",value:function t(r){m=new e(r);return m}},{key:"sharedInstance",value:function e(){if((0,p.isDefined)(m)===false){throw new h.KinveyError("You have not initialized the library. "+"Please call Kinvey.init() to initialize the library.")}return m}}]);return e}()},function(e,t,r){"use strict";function n(e){var t=[];Object.keys(e).forEach(function(e){return t.push(e)});return t}function i(e){return encodeURIComponent(e).replace(/[!~*'()]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function o(e){return n(e).sort()}function u(e){var t=o(e);return t.map(function(t){return t+"="+i(e[t])}).join("&")}function a(e,t){return e.indexOf(t,this.length-t.length)!==-1}function s(){var e=void 0;var t=void 0;var r=new Promise(function(r,n){e=r;t=n});return{promise:r,reject:t,fulfill:e}}e.exports={signPamFromParams:u,endsWith:a,createPromise:s,encodeString:i}},function(e,t,r){"use strict";var n=r(149);var i=r(150);t.parse=w;t.resolve=E;t.resolveObject=k;t.format=O;t.Url=o;function o(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var u=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["<",">",'"',"`"," ","\r","\n","\t"],f=["{","}","|","\\","^","`"].concat(c),l=["'"].concat(f),h=["%","/","?",";","#"].concat(l),d=["/","?","#"],p=255,v=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:true,"javascript:":true},g={javascript:true,"javascript:":true},m={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},_=r(151);function w(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;n.parse(e,t,r);return n}o.prototype.parse=function(e,t,r){if(!i.isString(e)){throw new TypeError("Parameter 'url' must be a string, not "+typeof e)}var o=e.indexOf("?"),a=o!==-1&&o<e.indexOf("#")?"?":"#",c=e.split(a),f=/\\/g;c[0]=c[0].replace(f,"/");e=c.join(a);var w=e;w=w.trim();if(!r&&e.split("#").length===1){var O=s.exec(w);if(O){this.path=w;this.href=w;this.pathname=O[1];if(O[2]){this.search=O[2];if(t){this.query=_.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(t){this.search="";this.query={}}return this}}var E=u.exec(w);if(E){E=E[0];var k=E.toLowerCase();this.protocol=k;w=w.substr(E.length)}if(r||E||w.match(/^\/\/[^@\/]+@[^@\/]+/)){var P=w.substr(0,2)==="//";if(P&&!(E&&g[E])){w=w.substr(2);this.slashes=true}}if(!g[E]&&(P||E&&!m[E])){var j=-1;for(var S=0;S<d.length;S++){var A=w.indexOf(d[S]);if(A!==-1&&(j===-1||A<j))j=A}var T,x;if(j===-1){x=w.lastIndexOf("@")}else{x=w.lastIndexOf("@",j)}if(x!==-1){T=w.slice(0,x);w=w.slice(x+1);this.auth=decodeURIComponent(T)}j=-1;for(var S=0;S<h.length;S++){var A=w.indexOf(h[S]);if(A!==-1&&(j===-1||A<j))j=A}if(j===-1)j=w.length;this.host=w.slice(0,j);w=w.slice(j);this.parseHost();this.hostname=this.hostname||"";var C=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!C){var M=this.hostname.split(/\./);for(var S=0,R=M.length;S<R;S++){var I=M[S];if(!I)continue;if(!I.match(v)){var q="";for(var U=0,D=I.length;U<D;U++){if(I.charCodeAt(U)>127){q+="x"}else{q+=I[U]}}if(!q.match(v)){var K=M.slice(0,S);var N=M.slice(S+1);var L=I.match(y);if(L){K.push(L[1]);N.unshift(L[2])}if(N.length){w="/"+N.join(".")+w}this.hostname=K.join(".");break}}}}if(this.hostname.length>p){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!C){this.hostname=n.toASCII(this.hostname)}var B=this.port?":"+this.port:"";var F=this.hostname||"";this.host=F+B;this.href+=this.host;if(C){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(w[0]!=="/"){w="/"+w}}}if(!b[k]){for(var S=0,R=l.length;S<R;S++){var H=l[S];if(w.indexOf(H)===-1)continue;var G=encodeURIComponent(H);if(G===H){G=escape(H)}w=w.split(H).join(G)}}var z=w.indexOf("#");if(z!==-1){this.hash=w.substr(z);w=w.slice(0,z)}var V=w.indexOf("?");if(V!==-1){this.search=w.substr(V);this.query=w.substr(V+1);if(t){this.query=_.parse(this.query)}w=w.slice(0,V)}else if(t){this.search="";this.query={}}if(w)this.pathname=w;if(m[k]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var B=this.pathname||"";var Q=this.search||"";this.path=B+Q}this.href=this.format();return this};function O(e){if(i.isString(e))e=w(e);if(!(e instanceof o))return o.prototype.format.call(e);return e.format()}o.prototype.format=function(){var e=this.auth||"";if(e){e=encodeURIComponent(e);e=e.replace(/%3A/i,":");e+="@"}var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=false,u="";if(this.host){o=e+this.host}else if(this.hostname){o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){o+=":"+this.port}}if(this.query&&i.isObject(this.query)&&Object.keys(this.query).length){u=_.stringify(this.query)}var a=this.search||u&&"?"+u||"";if(t&&t.substr(-1)!==":")t+=":";if(this.slashes||(!t||m[t])&&o!==false){o="//"+(o||"");if(r&&r.charAt(0)!=="/")r="/"+r}else if(!o){o=""}if(n&&n.charAt(0)!=="#")n="#"+n;if(a&&a.charAt(0)!=="?")a="?"+a;r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)});a=a.replace("#","%23");return t+o+r+a+n};function E(e,t){return w(e,false,true).resolve(t)}o.prototype.resolve=function(e){return this.resolveObject(w(e,false,true)).format()};function k(e,t){if(!e)return t;return w(e,false,true).resolveObject(t)}o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,false,true);e=t}var r=new o;var n=Object.keys(this);for(var u=0;u<n.length;u++){var a=n[u];r[a]=this[a]}r.hash=e.hash;if(e.href===""){r.href=r.format();return r}if(e.slashes&&!e.protocol){var s=Object.keys(e);for(var c=0;c<s.length;c++){var f=s[c];if(f!=="protocol")r[f]=e[f]}if(m[r.protocol]&&r.hostname&&!r.pathname){r.path=r.pathname="/"}r.href=r.format();return r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){var l=Object.keys(e);for(var h=0;h<l.length;h++){var d=l[h];r[d]=e[d]}r.href=r.format();return r}r.protocol=e.protocol;if(!e.host&&!g[e.protocol]){var p=(e.pathname||"").split("/");while(p.length&&!(e.host=p.shift()));if(!e.host)e.host="";if(!e.hostname)e.hostname="";if(p[0]!=="")p.unshift("");if(p.length<2)p.unshift("");r.pathname=p.join("/")}else{r.pathname=e.pathname}r.search=e.search;r.query=e.query;r.host=e.host||"";r.auth=e.auth;r.hostname=e.hostname||e.host;r.port=e.port;if(r.pathname||r.search){var v=r.pathname||"";var y=r.search||"";r.path=v+y}r.slashes=r.slashes||e.slashes;r.href=r.format();return r}var b=r.pathname&&r.pathname.charAt(0)==="/",_=e.host||e.pathname&&e.pathname.charAt(0)==="/",w=_||b||r.host&&e.pathname,O=w,E=r.pathname&&r.pathname.split("/")||[],p=e.pathname&&e.pathname.split("/")||[],k=r.protocol&&!m[r.protocol];if(k){r.hostname="";r.port=null;if(r.host){if(E[0]==="")E[0]=r.host;else E.unshift(r.host)}r.host="";if(e.protocol){e.hostname=null;e.port=null;if(e.host){if(p[0]==="")p[0]=e.host;else p.unshift(e.host)}e.host=null}w=w&&(p[0]===""||E[0]==="")}if(_){r.host=e.host||e.host===""?e.host:r.host;r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname;r.search=e.search;r.query=e.query;E=p}else if(p.length){if(!E)E=[];E.pop();E=E.concat(p);r.search=e.search;r.query=e.query}else if(!i.isNullOrUndefined(e.search)){if(k){r.hostname=r.host=E.shift();var P=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(P){r.auth=P.shift();r.host=r.hostname=P.shift()}}r.search=e.search;r.query=e.query;if(!i.isNull(r.pathname)||!i.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.href=r.format();return r}if(!E.length){r.pathname=null;if(r.search){r.path="/"+r.search}else{r.path=null}r.href=r.format();return r}var j=E.slice(-1)[0];var S=(r.host||e.host||E.length>1)&&(j==="."||j==="..")||j==="";var A=0;for(var T=E.length;T>=0;T--){j=E[T];if(j==="."){E.splice(T,1)}else if(j===".."){E.splice(T,1);A++}else if(A){E.splice(T,1);A--}}if(!w&&!O){for(;A--;A){E.unshift("..")}}if(w&&E[0]!==""&&(!E[0]||E[0].charAt(0)!=="/")){E.unshift("")}if(S&&E.join("/").substr(-1)!=="/"){E.push("")}var x=E[0]===""||E[0]&&E[0].charAt(0)==="/";if(k){r.hostname=r.host=x?"":E.length?E.shift():"";var P=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(P){r.auth=P.shift();r.host=r.hostname=P.shift()}}w=w||r.host&&E.length;if(w&&!x){E.unshift("")}if(!E.length){r.pathname=null;r.path=null}else{r.pathname=E.join("/")}if(!i.isNull(r.pathname)||!i.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.auth=e.auth||r.auth;r.slashes=r.slashes||e.slashes;r.href=r.format();return r};o.prototype.parseHost=function(){var e=this.host;var t=a.exec(e);if(t){t=t[0];if(t!==":"){this.port=t.substr(1)}e=e.substr(0,e.length-t.length)}if(e)this.hostname=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Query=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(250);var o=l(i);var u=r(32);var a=l(u);var s=r(1);var c=r(2);var f=r(22);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var d=["$nearSphere"];var p=function(){function e(t){h(this,e);t=Object.assign({fields:[],filter:{},sort:null,limit:null,skip:0},t);this.fields=t.fields;this.filter=t.filter;this.sort=t.sort;this.limit=t.limit;this.skip=t.skip;this._parent=null}n(e,[{key:"isSupportedOffline",value:function e(){var t=this;return Object.keys(this.filter).reduce(function(e,r){if(e){var n=t.filter[r];return d.some(function(e){if(!n){return true}return!Object.keys(n).some(function(t){return t===e})})}return e},true)}},{key:"equalTo",value:function e(t,r){return this.addFilter(t,r)}},{key:"contains",value:function e(t,r){if((0,c.isDefined)(r)===false){throw new s.QueryError("You must supply a value.")}if(Array.isArray(r)===false){r=[r]}return this.addFilter(t,"$in",r)}},{key:"containsAll",value:function e(t,r){if((0,c.isDefined)(r)===false){throw new s.QueryError("You must supply a value.")}if(Array.isArray(r)===false){r=[r]}return this.addFilter(t,"$all",r)}},{key:"greaterThan",value:function e(t,r){if((0,c.isNumber)(r)===false&&typeof r!=="string"){throw new s.QueryError("You must supply a number or string.")}return this.addFilter(t,"$gt",r)}},{key:"greaterThanOrEqualTo",value:function e(t,r){if((0,c.isNumber)(r)===false&&typeof r!=="string"){throw new s.QueryError("You must supply a number or string.")}return this.addFilter(t,"$gte",r)}},{key:"lessThan",value:function e(t,r){if((0,c.isNumber)(r)===false&&typeof r!=="string"){throw new s.QueryError("You must supply a number or string.")}return this.addFilter(t,"$lt",r)}},{key:"lessThanOrEqualTo",value:function e(t,r){if((0,c.isNumber)(r)===false&&typeof r!=="string"){throw new s.QueryError("You must supply a number or string.")}return this.addFilter(t,"$lte",r)}},{key:"notEqualTo",value:function e(t,r){return this.addFilter(t,"$ne",r)}},{key:"notContainedIn",value:function e(t,r){if(Array.isArray(r)===false){r=[r]}return this.addFilter(t,"$nin",r)}},{key:"and",value:function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}return this.join("$and",r)}},{key:"nor",value:function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}if((0,c.isDefined)(this._parent)&&Object.hasOwnProperty.call(this._parent.filter,"$and")){var i;return(i=this._parent).nor.apply(i,r)}return this.join("$nor",r)}},{key:"or",value:function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}if((0,c.isDefined)(this._parent)){var i;return(i=this._parent).or.apply(i,r)}return this.join("$or",r)}},{key:"exists",value:function e(t,r){r=typeof r==="undefined"?true:r||false;return this.addFilter(t,"$exists",r)}},{key:"mod",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(typeof r==="string"){r=parseFloat(r)}if(typeof n==="string"){n=parseFloat(n)}if(!(0,c.isNumber)(r)){throw new s.QueryError("divisor must be a number")}if(!(0,c.isNumber)(n)){throw new s.QueryError("remainder must be a number")}return this.addFilter(t,"$mod",[r,n])}},{key:"matches",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=[];if(!(r instanceof RegExp)){r=new RegExp(r)}if(r.source.indexOf("^")!==0){throw new s.QueryError("regExp must have '^' at the beginning of the expression"+" to make it an anchored expression.")}if((r.ignoreCase||n.ignoreCase)&&n.ignoreCase!==false){throw new s.QueryError("ignoreCase flag is not supported")}if((r.multiline||n.multiline)&&n.multiline!==false){i.push("m")}if(n.extended===true){i.push("x")}if(n.dotMatchesAll===true){i.push("s")}if(i.length>0){this.addFilter(t,"$options",i.join(""))}return this.addFilter(t,"$regex",r.source)}},{key:"near",value:function e(t,r,n){if(!Array.isArray(r)||!(0,c.isNumber)(r[0])||!(0,c.isNumber)(r[1])){throw new s.QueryError("coord must be a [number, number]")}var i=this.addFilter(t,"$nearSphere",[r[0],r[1]]);if((0,c.isNumber)(n)){this.addFilter(t,"$maxDistance",n)}return i}},{key:"withinBox",value:function e(t,r,n){if(!Array.isArray(r)||!(0,c.isNumber)(r[0])||!(0,c.isNumber)(r[1])){throw new s.QueryError("bottomLeftCoord must be a [number, number]")}if(!Array.isArray(n)||!(0,c.isNumber)(n[0])||!(0,c.isNumber)(n[1])){throw new s.QueryError("upperRightCoord must be a [number, number]")}r[0]=parseFloat(r[0]);r[1]=parseFloat(r[1]);n[0]=parseFloat(n[0]);n[1]=parseFloat(n[1]);var i=[[r[0],r[1]],[n[0],n[1]]];return this.addFilter(t,"$within",{$box:i})}},{key:"withinPolygon",value:function e(t,r){if(Array.isArray(r)===false||r.length===0||r.length>3){throw new s.QueryError("coords must be a [[number, number]]")}r=r.map(function(e){if((0,c.isNumber)(e[0])===false||(0,c.isNumber)(e[1])===false){throw new s.QueryError("coords argument must be a [number, number]")}return[parseFloat(e[0]),parseFloat(e[1])]});return this.addFilter(t,"$within",{$polygon:r})}},{key:"size",value:function e(t,r){if(typeof r==="string"){r=parseFloat(r)}if(!(0,c.isNumber)(r)){throw new s.QueryError("size must be a number")}return this.addFilter(t,"$size",r)}},{key:"ascending",value:function e(t){if((0,c.isDefined)(this._parent)){this._parent.ascending(t)}else{this.sort[t]=1}return this}},{key:"descending",value:function e(t){if((0,c.isDefined)(this._parent)){this._parent.descending(t)}else{this.sort[t]=-1}return this}},{key:"addFilter",value:function e(t,r,n){if((0,c.isDefined)(r)&&((0,c.isDefined)(n)||arguments.length===3)){if(!(0,a.default)(this.filter[t])){this.filter[t]={}}this.filter[t][r]=n}else{this.filter[t]=r}return this}},{key:"join",value:function t(r,n){var i=this;var o=this;var u={};n=n.map(function(t){if(!(t instanceof e)){if((0,a.default)(t)){t=new e(t)}else{throw new s.QueryError("query argument must be of type: Kinvey.Query[] or Object[].")}}return t.toPlainObject().filter});if(n.length===0){o=new e;n=[o.toPlainObject().filter];o._parent=this}var c=Object.keys(this.filter);c.forEach(function(e){u[e]=i.filter[e];delete i.filter[e]});this.filter[r]=[u].concat(n);return o}},{key:"process",value:function e(t){if(!this.isSupportedOffline()){var r="This query is not able to run locally. The following filters are not supported"+" locally:";d.forEach(function(e){r=r+" "+e});f.Log.error(r);throw new s.QueryError(r)}if(!Array.isArray(t)){throw new s.QueryError("data argument must be of type: Array.")}f.Log.debug("Data length before processiong query",t.length);var n=this.toPlainObject();t=(0,o.default)(n.filter,t);f.Log.debug("Data length after applying query filter",n.filter,t.length);if((0,c.isDefined)(n.sort)){f.Log.debug("Sorting data",n.sort);t.sort(function(e,t){for(var r in n.sort){if(n.sort.hasOwnProperty(r)){var i=(0,c.nested)(e,r);var o=(0,c.nested)(t,r);var u=n.sort[r];if((0,c.isDefined)(i)&&(0,c.isDefined)(o)===false){return 1*u}else if((0,c.isDefined)(i)===false&&(0,c.isDefined)(o)){return-1*u}else if(typeof i==="undefined"&&o===null){return 0}else if(i===null&&typeof o==="undefined"){return 0}else if(i!==o){return(i<o?-1:1)*u}}}return 0})}if(Array.isArray(n.fields)&&n.fields.length>0){f.Log.debug("Removing fields from data",n.fields);t=t.map(function(e){var t=Object.keys(e);t.forEach(function(t){if(n.fields.indexOf(t)===-1){delete e[t]}});return e})}if((0,c.isNumber)(n.skip)){if((0,c.isNumber)(n.limit)&&n.limit>0){f.Log.debug("Skipping and limiting data",n.skip,n.limit);return t.slice(n.skip,n.skip+n.limit)}f.Log.debug("Skipping data",n.skip);return t.slice(n.skip)}return t}},{key:"toPlainObject",value:function e(){if((0,c.isDefined)(this._parent)){return this._parent.toPlainObject()}var t={fields:this.fields,filter:this.filter,sort:this.sort,skip:this.skip,limit:this.limit};return t}},{key:"toQueryString",value:function e(){var t={};if(Object.keys(this.filter).length>0){t.query=this.filter}if(this.fields.length>0){t.fields=this.fields.join(",")}if((0,c.isNumber)(this.limit)){t.limit=this.limit}if((0,c.isNumber)(this.skip)&&this.skip>0){t.skip=this.skip}if(Object.keys(this.sort).length>0){t.sort=this.sort}var r=Object.keys(t);r.forEach(function(e){t[e]=typeof t[e]==="string"?t[e]:JSON.stringify(t[e])});return t}},{key:"toString",value:function e(){return JSON.stringify(this.toQueryString())}},{key:"fields",get:function e(){return this._fields},set:function e(t){t=t||[];if(!Array.isArray(t)){throw new s.QueryError("fields must be an Array")}if((0,c.isDefined)(this._parent)){this._parent.fields=t}else{this._fields=t}}},{key:"filter",get:function e(){return this._filter},set:function e(t){this._filter=t}},{key:"sort",get:function e(){return this._sort},set:function e(t){if(t&&!(0,a.default)(t)){throw new s.QueryError("sort must an Object")}if((0,c.isDefined)(this._parent)){this._parent.sort=t}else{this._sort=t||{}}}},{key:"limit",get:function e(){return this._limit},set:function e(t){if(typeof t==="string"){t=parseFloat(t)}if((0,c.isDefined)(t)&&(0,c.isNumber)(t)===false){throw new s.QueryError("limit must be a number")}if(this._parent){this._parent.limit=t}else{this._limit=t}}},{key:"skip",get:function e(){return this._skip},set:function e(t){if(typeof t==="string"){t=parseFloat(t)}if((0,c.isNumber)(t)===false){throw new s.QueryError("skip must be a number")}if((0,c.isDefined)(this._parent)){this._parent.skip=t}else{this._skip=t}}}]);return e}();t.Query=p},function(e,t,r){var n=r(93);var i=typeof self=="object"&&self&&self.Object===Object&&self;var o=n||i||Function("return this")();e.exports=o},function(e,t){function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}e.exports=r},function(e,t){function r(e){return e!=null&&typeof e=="object"}e.exports=r},function(e,t,r){var n=r(20),i=r(65);function o(e){return e!=null&&i(e.length)&&!n(e)}e.exports=o},function(e,t,r){var n=r(62),i=r(25),o=r(73),u=r(16),a=r(31),s=r(21);var c=Object.prototype;var f=c.hasOwnProperty;var l=o(function(e,t){if(a(t)||u(t)){i(t,s(t),e);return}for(var r in t){if(f.call(t,r)){n(e,r,t[r])}}});e.exports=l},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")r=window}e.exports=r},function(e,t,r){var n=r(26),i=r(147),o=r(148);var u="[object Null]",a="[object Undefined]";var s=n?n.toStringTag:undefined;function c(e){if(e==null){return e===undefined?a:u}return s&&s in Object(e)?i(e):o(e)}e.exports=c},function(e,t,r){var n=r(19),i=r(14);var o="[object AsyncFunction]",u="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function c(e){if(!i(e)){return false}var t=n(e);return t==u||t==a||t==o||t==s}e.exports=c},function(e,t,r){var n=r(99),i=r(101),o=r(16);function u(e){return o(e)?n(e):i(e)}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Log=undefined;var n=r(262);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}i.default.setDefaultLevel(i.default.levels.SILENT);var u=i.default.methodFactory;i.default.methodFactory=function e(t,r,n){var i=u(t,r,n);return function e(t){t="Kinvey: "+t;for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++){n[o-1]=arguments[o]}if(n.length>0){i(t,n)}else{i(t)}}};t.Log=i.default},function(e,t,r){var n=r(268),i=r(277),o=r(46),u=r(4),a=r(287);function s(e){if(typeof e=="function"){return e}if(e==null){return o}if(typeof e=="object"){return u(e)?i(e[0],e[1]):n(e)}return a(e)}e.exports=s},function(e,t,r){var n=r(166),i=r(169);function o(e,t){var r=i(e,t);return n(r)?r:undefined}e.exports=o},function(e,t,r){var n=r(62),i=r(63);function o(e,t,r,o){var u=!r;r||(r={});var a=-1,s=t.length;while(++a<s){var c=t[a];var f=o?o(r[c],e[c],c,r,e):undefined;if(f===undefined){f=e[c]}if(u){i(r,c,f)}else{n(r,c,f)}}return r}e.exports=o},function(e,t,r){var n=r(13);var i=n.Symbol;e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Aggregation=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(17);var o=m(i);var u=r(48);var a=m(u);var s=r(8);var c=m(s);var f=r(14);var l=m(f);var h=r(20);var d=m(h);var p=r(95);var v=m(p);var y=r(1);var b=r(2);var g=r(12);function m(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=t.Aggregation=function(){function e(t){_(this,e);t=(0,o.default)({query:null,initial:{},key:{},reduceFn:function(){}.toString()},t);this.query=t.query;this.initial=t.initial;this.key=t.key;this.reduceFn=t.reduceFn}n(e,[{key:"by",value:function e(t){this.key[t]=true;return this}},{key:"process",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var r=this.toPlainObject();var n=Object.keys(r.key);var i=r.reduceFn.replace(/function[\s\S]*?\([\s\S]*?\)/,"");r.reduce=new Function(["doc","out"],i);if(this.query){t=this.query.process(t)}if(n.length>0){var u=[];n.forEach(function(e){var n={};t.forEach(function(t){var i=t[e];var o=(0,b.isDefined)(n[i])?n[i]:(0,v.default)(r.initial);var u=r.reduce(t,o);if((0,b.isDefined)(u)){o=u}n[i]=o});Object.keys(n).forEach(function(t){var r={};r[e]=t;r=(0,o.default)({},r,n[t]);u.push(r)})});return u}var s=(0,v.default)(r.initial);(0,a.default)(t,function(e){var t=r.reduce(e,s);if((0,b.isDefined)(t)){s=t}});return s}},{key:"toPlainObject",value:function e(){return{key:this.key,initial:this.initial,reduce:this.reduceFn,reduceFn:this.reduceFn,condition:this.query?this.query.toPlainObject().filter:{},query:this.query?this.query.toPlainObject():null}}},{key:"initial",get:function e(){return(0,v.default)(this._initial)},set:function e(t){if(!(0,l.default)(t)){throw new y.KinveyError("initial must be an Object.")}this._initial=t}},{key:"query",get:function e(){return this._query},set:function e(t){if((0,b.isDefined)(t)&&!(t instanceof g.Query)){throw new y.KinveyError("Invalid query. It must be an instance of the Query class.")}this._query=t}},{key:"reduceFn",get:function e(){return this._reduceFn},set:function e(t){if((0,d.default)(t)){t=t.toString()}if(!(0,c.default)(t)){throw new y.KinveyError("fn argument must be of type function or string.")}this._reduceFn=t}}],[{key:"count",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.by(r);n.initial={count:0};n.reduceFn=""+"function(doc, out) {"+"  out.count += 1;"+"  return out;"+"}";return n}},{key:"sum",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={sum:0};n.reduceFn=""+"function(doc, out) {"+('  out.sum += doc["'+r+'"];')+"  return out;"+"}";return n}},{key:"min",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={min:Infinity};n.reduceFn=""+"function(doc, out) {"+('  out.min = Math.min(out.min, doc["'+r+'"]);')+"  return out;"+"}";return n}},{key:"max",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={max:-Infinity};n.reduceFn=""+"function(doc, out) {"+('  out.max = Math.max(out.max, doc["'+r+'"]);')+"  return out;"+"}";return n}},{key:"average",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={count:0,average:0};n.reduceFn=""+"function(doc, out) {"+('  out.average = (out.average * out.count + doc["'+r+'"]) / (out.count + 1);')+"  out.count += 1;"+"  return out;"+"}";return n}}]);return e}()},function(e,t,r){var n=r(52);var i=1/0;function o(e){if(typeof e=="string"||n(e)){return e}var t=e+"";return t=="0"&&1/e==-i?"-0":t}e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(90);var o=a(i);var u=r(3);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){var r=t.setup,n=t.db;s(this,e);this._db=n;this.instanceId="pn-"+o.default.createUUID();this.secretKey=r.secretKey||r.secret_key;this.subscribeKey=r.subscribeKey||r.subscribe_key;this.publishKey=r.publishKey||r.publish_key;this.sdkName=r.sdkName;this.sdkFamily=r.sdkFamily;this.partnerId=r.partnerId;this.setAuthKey(r.authKey);this.setCipherKey(r.cipherKey);this.setFilterExpression(r.filterExpression);this.origin=r.origin||"pubsub.pndsn.com";this.secure=r.ssl||false;this.restore=r.restore||false;this.proxy=r.proxy;this.keepAlive=r.keepAlive;this.keepAliveSettings=r.keepAliveSettings;this.autoNetworkDetection=r.autoNetworkDetection||false;this.dedupeOnSubscribe=r.dedupeOnSubscribe||false;this.maximumCacheSize=r.maximumCacheSize||100;this.customEncrypt=r.customEncrypt;this.customDecrypt=r.customDecrypt;if(typeof location!=="undefined"&&location.protocol==="https:"){this.secure=true}this.logVerbosity=r.logVerbosity||false;this.suppressLeaveEvents=r.suppressLeaveEvents||false;this.announceFailedHeartbeats=r.announceFailedHeartbeats||true;this.announceSuccessfulHeartbeats=r.announceSuccessfulHeartbeats||false;this.useInstanceId=r.useInstanceId||false;this.useRequestId=r.useRequestId||false;this.requestMessageCountThreshold=r.requestMessageCountThreshold;this.setTransactionTimeout(r.transactionalRequestTimeout||15*1e3);this.setSubscribeTimeout(r.subscribeRequestTimeout||310*1e3);this.setSendBeaconConfig(r.useSendBeacon||true);this.setPresenceTimeout(r.presenceTimeout||300);if(r.heartbeatInterval!=null){this.setHeartbeatInterval(r.heartbeatInterval)}this.setUUID(this._decideUUID(r.uuid))}n(e,[{key:"getAuthKey",value:function e(){return this.authKey}},{key:"setAuthKey",value:function e(t){this.authKey=t;return this}},{key:"setCipherKey",value:function e(t){this.cipherKey=t;return this}},{key:"getUUID",value:function e(){return this.UUID}},{key:"setUUID",value:function e(t){if(this._db&&this._db.set)this._db.set(this.subscribeKey+"uuid",t);this.UUID=t;return this}},{key:"getFilterExpression",value:function e(){return this.filterExpression}},{key:"setFilterExpression",value:function e(t){this.filterExpression=t;return this}},{key:"getPresenceTimeout",value:function e(){return this._presenceTimeout}},{key:"setPresenceTimeout",value:function e(t){this._presenceTimeout=t;this.setHeartbeatInterval(this._presenceTimeout/2-1);return this}},{key:"getHeartbeatInterval",value:function e(){return this._heartbeatInterval}},{key:"setHeartbeatInterval",value:function e(t){this._heartbeatInterval=t;return this}},{key:"getSubscribeTimeout",value:function e(){return this._subscribeRequestTimeout}},{key:"setSubscribeTimeout",value:function e(t){this._subscribeRequestTimeout=t;return this}},{key:"getTransactionTimeout",value:function e(){return this._transactionalRequestTimeout}},{key:"setTransactionTimeout",value:function e(t){this._transactionalRequestTimeout=t;return this}},{key:"isSendBeaconEnabled",value:function e(){return this._useSendBeacon}},{key:"setSendBeaconConfig",value:function e(t){this._useSendBeacon=t;return this}},{key:"getVersion",value:function e(){return"4.19.0"}},{key:"_decideUUID",value:function e(t){if(t){return t}if(this._db&&this._db.get&&this._db.get(this.subscribeKey+"uuid")){return this._db.get(this.subscribeKey+"uuid")}return"pn-"+o.default.createUUID()}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t){function r(e,t){return e===t||e!==e&&t!==t}e.exports=r},function(e,t){var r=Object.prototype;function n(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||r;return e===n}e.exports=n},function(e,t,r){var n=r(19),i=r(68),o=r(15);var u="[object Object]";var a=Function.prototype,s=Object.prototype;var c=a.toString;var f=s.hasOwnProperty;var l=c.call(Object);function h(e){if(!o(e)||n(e)!=u){return false}var t=i(e);if(t===null){return true}var r=f.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&c.call(r)==l}e.exports=h},function(e,t,r){var n=r(263),i=r(266);var o=i(n);e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyResponse=t.Response=t.StatusCode=undefined;var n=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(17);var u=c(o);var a=r(50);var s=r(1);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var d=t.StatusCode={Ok:200,Created:201,Empty:204,MovedPermanently:301,Found:302,NotModified:304,TemporaryRedirect:307,PermanentRedirect:308,Unauthorized:401,Forbidden:403,NotFound:404,ServerError:500};Object.freeze(d);var p=t.Response=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};h(this,e);t=(0,u.default)({statusCode:d.Empty,headers:new a.Headers,data:null},t);this.statusCode=t.statusCode;this.headers=t.headers;this.data=t.data}i(e,[{key:"isSuccess",value:function e(){return this.statusCode>=200&&this.statusCode<300||this.statusCode===d.MovedPermanently||this.statusCode===d.Found||this.statusCode===d.NotModified||this.statusCode===d.TemporaryRedirect||this.statusCode===d.PermanentRedirect}},{key:"isServerError",value:function e(){return this.statusCode>=500&&this.statusCode<600}},{key:"isClientError",value:function e(){return this.statusCode>=400&&this.statusCode<500}},{key:"toPlainObject",value:function e(){return{statusCode:this.statusCode,headers:this.headers.toPlainObject(),data:this.data}}},{key:"headers",get:function e(){return this._headers},set:function e(t){if(!(t instanceof a.Headers)){t=new a.Headers(t)}this._headers=t}},{key:"error",get:function e(){if(this.isSuccess()){return null}var t=this.data||{};var r=t.message||t.description;var n=t.debug;var i=this.statusCode;var o=this.headers.get("X-Kinvey-Request-ID");var u=void 0;if(i===d.Unauthorized){u=new s.InsufficientCredentialsError(r,n,i,o)}else if(i===d.NotFound){u=new s.NotFoundError(r,n,i,o)}else if(i===d.ServerError){u=new s.ServerError(r,n,i,o)}else{u=new s.KinveyError(r,n,i,o)}return u}}]);return e}();var v=t.KinveyResponse=function(e){l(t,e);function t(){h(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}i(t,[{key:"error",get:function e(){if(this.isSuccess()){return null}var r=this.data||{};var i=r.name||r.error;var o=r.message||r.description;var u=r.debug;var a=this.statusCode;var c=this.headers.get("X-Kinvey-Request-ID");var f=void 0;if(i==="APIVersionNotAvailable"){f=new s.APIVersionNotAvailableError(o,u,a,c)}else if(i==="APIVersionNotImplemented"){f=new s.APIVersionNotImplementedError(o,u,a,c)}else if(i==="AppProblem"){f=new s.AppProblemError(o,u,a,c)}else if(i==="AppProblem"){f=new s.AppProblemError(o,u,a,c)}else if(i==="BadRequest"){f=new s.BadRequestError(o,u,a,c)}else if(i==="BLInternalError"||i==="BLRuntimeError"||i==="BLSyntaxError"||i==="BLTimeoutError"||i==="BLViolationError"){f=new s.BLError(o,u,a,c)}else if(i==="CORSDisabled"){f=new s.CORSDisabledError(o,u,a,c)}else if(i==="DuplicateEndUsers"){f=new s.DuplicateEndUsersError(o,u,a,c)}else if(i==="FeatureUnavailable"){f=new s.FeatureUnavailableError(o,u,a,c)}else if(i==="IncompleteRequestBody"){f=new s.IncompleteRequestBodyError(o,u,a,c)}else if(i==="IndirectCollectionAccessDisallowed"){f=new s.IndirectCollectionAccessDisallowedError(o,u,a,c)}else if(i==="InsufficientCredentials"){f=new s.InsufficientCredentialsError(o,u,a,c)}else if(i==="InvalidCredentials"){f=new s.InvalidCredentialsError(o,u,a,c)}else if(i==="InvalidIdentifier"){f=new s.InvalidIdentifierError(o,u,a,c)}else if(i==="InvalidQuerySyntax"){f=new s.InvalidQuerySyntaxError(o,u,a,c)}else if(i==="JSONParseError"){f=new s.JSONParseError(o,u,a,c)}else if(i==="KinveyInternalErrorRetry"){f=new s.KinveyInternalErrorRetry(o,u,a,c)}else if(i==="KinveyInternalErrorStop"){f=new s.KinveyInternalErrorStop(o,u,a,c)}else if(i==="MissingQuery"){f=new s.MissingQueryError(o,u,a,c)}else if(i==="MissingRequestHeader"){f=new s.MissingRequestHeaderError(o,u,a,c)}else if(i==="MissingRequestParameter"){f=new s.MissingRequestParameterError(o,u,a,c)}else if(i==="EntityNotFound"||i==="CollectionNotFound"||i==="AppNotFound"||i==="UserNotFound"||i==="BlobNotFound"||i==="DocumentNotFound"){f=new s.NotFoundError(o,u,a,c)}else if(i==="ParameterValueOutOfRange"){f=new s.ParameterValueOutOfRangeError(o,u,a,c)}else if(i==="ServerError"){f=new s.ServerError(o,u,a,c)}else if(i==="StaleRequest"){f=new s.StaleRequestError(o,u,a,c)}else if(i==="UserAlreadyExists"){f=new s.UserAlreadyExistsError(o,u,a,c)}else if(i==="WritesToCollectionDisallowed"){f=new s.WritesToCollectionDisallowedError(o,u,a,c)}else{return n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"error",this)}return f}}]);return t}(p)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Middleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=a(i);var u=r(293);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=t.Middleware=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Middleware";s(this,e);this.name=t}n(e,[{key:"handle",value:function e(){return o.default.reject(new Error("A subclass middleware must override the handle function."))}},{key:"cancel",value:function e(){return o.default.resolve()}},{key:"generateTree",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var r={value:this.name,level:t,nodes:[]};return r}},{key:"toString",value:function e(){var t=this.generateTree();return u.AsciiTree.generate(t)}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyObservable=undefined;var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(6);var u=d(o);var a=r(347);var s=r(131);var c=r(87);var f=r(20);var l=d(f);var h=r(2);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function y(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var b={closed:true,next:function e(){},error:function e(t){throw t},complete:function e(){},status:function e(){},presence:function e(){}};var g=function(e){y(t,e);function t(e,r,n,i,o,u){p(this,t);var a=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));var s=void 0;var c=a;a._parentSubscriber=e;if((0,l.default)(r)){s=r}else if(r){s=r.next;n=r.error;i=r.complete;if(r!==b){c=Object.create(r);if((0,l.default)(c.unsubscribe)){a.add(c.unsubscribe.bind(c))}c.unsubscribe=a.unsubscribe.bind(a)}}a._context=c;a._next=s;a._error=n;a._complete=i;a._status=o;a._presence=u;return a}i(t,[{key:"next",value:function e(t){if(!this.isStopped&&this._next){var r=this._parentSubscriber;if(!r.syncErrorThrowable){this.__tryOrUnsub(this._next,t)}else if(this.__tryOrSetError(r,this._next,t)){this.unsubscribe()}}}},{key:"error",value:function e(t){if(!this.isStopped){var r=this._parentSubscriber;if(this._error){if(!r.syncErrorThrowable){this.__tryOrUnsub(this._error,t);this.unsubscribe()}else{this.__tryOrSetError(r,this._error,t);this.unsubscribe()}}else if(!r.syncErrorThrowable){this.unsubscribe();throw t}else{r.syncErrorValue=t;r.syncErrorThrown=true;this.unsubscribe()}}}},{key:"complete",value:function e(){var t=this;if(!this.isStopped){var r=this._parentSubscriber;if(this._complete){var n=function e(){return t._complete.call(t._context)};if(!r.syncErrorThrowable){this.__tryOrUnsub(n);this.unsubscribe()}else{this.__tryOrSetError(r,n);this.unsubscribe()}}else{this.unsubscribe()}}}},{key:"status",value:function e(t){if(!this.isStopped&&this._status){var r=this._parentSubscriber;if(!r.syncErrorThrowable){this.__tryOrUnsub(this._status,t)}else if(this.__tryOrSetError(r,this._status,t)){this.unsubscribe()}}}},{key:"presence",value:function e(t){if(!this.isStopped&&this._presence){var r=this._parentSubscriber;if(!r.syncErrorThrowable){this.__tryOrUnsub(this._presence,t)}else if(this.__tryOrSetError(r,this._presence,t)){this.unsubscribe()}}}},{key:"__tryOrUnsub",value:function e(t,r){try{t.call(this._context,r)}catch(e){this.unsubscribe();throw e}}},{key:"__tryOrSetError",value:function e(t,r,n){try{r.call(this._context,n)}catch(e){t.syncErrorValue=e;t.syncErrorThrown=true;return true}return false}},{key:"_unsubscribe",value:function e(){var t=this._parentSubscriber;this._context=null;this._parentSubscriber=null;t.unsubscribe()}}]);return t}(s.Subscriber);var m=function(e){y(t,e);function t(e,r,i,o,u){p(this,t);var a=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i));switch(arguments.length){case 0:a.destination=b;break;case 1:if((0,h.isDefined)(e)===false){a.destination=b;break}if((typeof e==="undefined"?"undefined":n(e))==="object"){if(e instanceof s.Subscriber){a.destination=e;a.destination.add(a)}else{a.syncErrorThrowable=true;a.destination=new g(a,e)}break}default:a.syncErrorThrowable=true;a.destination=new g(a,e,r,i,o,u);break}return a}i(t,[{key:"status",value:function e(t){if(!this.isStopped){this._status(t)}}},{key:"presence",value:function e(t){if(!this.isStopped){this._presence(t)}}},{key:"_status",value:function e(t){this.destination.status(t)}},{key:"_presence",value:function e(t){this.destination.presence(t)}}]);return t}(s.Subscriber);function _(e,t,r,n,i){if(e){if(e instanceof m){return e}if(e[c.rxSubscriber]){return e[c.rxSubscriber]()}}if(!e&&!t&&!r&&!n&&!i){return new m(b)}return new m(e,t,r,n,i)}var w=t.KinveyObservable=function(e){y(t,e);function t(){p(this,t);return v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}i(t,[{key:"subscribe",value:function e(t,r,n,i,o){var u=this.operator;var a=_(t,r,n,i,o);if(u){u.call(a,this.source)}else{a.add(this._trySubscribe(a))}if(a.syncErrorThrowable){a.syncErrorThrowable=false;if(a.syncErrorThrown){throw a.syncErrorValue}}return a}},{key:"toPromise",value:function e(){var t=this;return new u.default(function(e,r){var n=void 0;t.subscribe(function(e){n=e},r,function(){e(n)})})}}],[{key:"create",value:function e(r){return new t(r)}}]);return t}(a.Observable)},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];if(!e.children)e.children=[];Object.defineProperty(e,"loaded",{enumerable:true,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:true,get:function(){return e.i}});e.webpackPolyfill=1}return e}},function(e,t,r){var n=r(156),i=r(157),o=r(158),u=r(159),a=r(160);function s(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n;s.prototype["delete"]=i;s.prototype.get=o;s.prototype.has=u;s.prototype.set=a;e.exports=s},function(e,t,r){var n=r(30);function i(e,t){var r=e.length;while(r--){if(n(e[r][0],t)){return r}}return-1}e.exports=i},function(e,t,r){var n=r(24);var i=n(Object,"create");e.exports=i},function(e,t,r){var n=r(178);function i(e,t){var r=e.__data__;return n(t)?r[typeof t=="string"?"string":"hash"]:r.map}e.exports=i},function(e,t,r){var n=r(184),i=r(15);var o=Object.prototype;var u=o.hasOwnProperty;var a=o.propertyIsEnumerable;var s=n(function(){return arguments}())?n:function(e){return i(e)&&u.call(e,"callee")&&!a.call(e,"callee")};e.exports=s},function(e,t,r){(function(e){var n=r(13),i=r(185);var o=typeof t=="object"&&t&&!t.nodeType&&t;var u=o&&typeof e=="object"&&e&&!e.nodeType&&e;var a=u&&u.exports===o;var s=a?n.Buffer:undefined;var c=s?s.isBuffer:undefined;var f=c||i;e.exports=f}).call(t,r(37)(e))},function(e,t){var r=9007199254740991;var n=/^(?:0|[1-9]\d*)$/;function i(e,t){t=t==null?r:t;return!!t&&(typeof e=="number"||n.test(e))&&(e>-1&&e%1==0&&e<t)}e.exports=i},function(e,t,r){var n=r(99),i=r(190),o=r(16);function u(e){return o(e)?n(e,true):i(e)}e.exports=u},function(e,t){function r(e){return e}e.exports=r},function(e,t,r){var n=r(101),i=r(69),o=r(42),u=r(4),a=r(16),s=r(43),c=r(31),f=r(64);var l="[object Map]",h="[object Set]";var d=Object.prototype;var p=d.hasOwnProperty;function v(e){if(e==null){return true}if(a(e)&&(u(e)||typeof e=="string"||typeof e.splice=="function"||s(e)||f(e)||o(e))){return!e.length}var t=i(e);if(t==l||t==h){return!e.size}if(c(e)){return!n(e).length}for(var r in e){if(p.call(e,r)){return false}}return true}e.exports=v},function(e,t,r){var n=r(97),i=r(33),o=r(267),u=r(4);function a(e,t){var r=u(e)?n:i;return r(e,o(t))}e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Request=t.RequestMethod=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=m(i);var u=r(72);var a=m(u);var s=r(17);var c=m(s);var f=r(8);var l=m(f);var h=r(75);var d=m(h);var p=r(9);var v=r(1);var y=r(2);var b=r(34);var g=r(50);function m(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=t.RequestMethod={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};Object.freeze(w);var O=t.Request=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_(this,e);t=(0,c.default)({followRedirect:true},t);this.id=(0,y.randomString)();this.client=t.client;this.method=t.method||w.GET;this.headers=t.headers||new g.Headers;this.url=t.url||"";this.body=t.body||t.data;this.timeout=(0,y.isDefined)(t.timeout)?t.timeout:this.client.defaultTimeout;this.followRedirect=t.followRedirect===true;this.cache=t.cache===true}n(e,[{key:"execute",value:function e(){if((0,y.isDefined)(this.rack)===false){Log.error("Unable to execute the request. Please provide a rack to execute the request.");return o.default.reject(new v.KinveyError("Unable to execute the request. Please provide a rack to execute the request."))}return this.rack.execute(this.toPlainObject()).then(function(e){if((0,y.isDefined)(e)===false){throw new v.NoResponseError}if(e instanceof b.Response===false){e=new b.Response({statusCode:e.statusCode,headers:e.headers,data:e.data})}return e})}},{key:"cancel",value:function e(){return this.rack.cancel()}},{key:"toPlainObject",value:function e(){return{id:this.id,method:this.method,headers:this.headers.toPlainObject(),url:this.url,body:this.body,timeout:this.timeout,followRedirect:this.followRedirect,encryptionKey:this.client.encryptionKey}}},{key:"client",get:function e(){return this._client||p.Client.sharedInstance()},set:function e(t){if(t){if(t instanceof p.Client===false){throw new v.KinveyError("client must be an instance of the Client class.")}}this._client=t}},{key:"method",get:function e(){return this._method},set:function e(t){if(!(0,l.default)(t)){t=String(t)}t=t.toUpperCase();switch(t){case w.GET:case w.POST:case w.PATCH:case w.PUT:case w.DELETE:this._method=t;break;default:throw new v.KinveyError("Invalid request method. Only GET, POST, PATCH, PUT, and DELETE are allowed.")}}},{key:"headers",get:function e(){return this._headers},set:function e(t){if(!(t instanceof g.Headers)){t=new g.Headers(t)}this._headers=t}},{key:"url",get:function e(){if(this.cache===true){return(0,y.appendQuery)(this._url,a.default.stringify({_:Math.random().toString(36).substr(2)}))}return this._url},set:function e(t){this._url=t}},{key:"data",get:function e(){return this.body},set:function e(t){this.body=t}},{key:"timeout",get:function e(){return this._timeout},set:function e(t){t=parseInt(t,10);if((0,d.default)(t)===false||isNaN(t)){throw new v.KinveyError("Invalid timeout. Timeout must be a number.")}this._timeout=t}},{key:"followRedirect",get:function e(){return this._followRedirect},set:function e(t){this._followRedirect=!!t}},{key:"cache",get:function e(){return this._cache},set:function e(t){this._cache=!!t}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Headers=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(48);var o=l(i);var u=r(8);var a=l(u);var s=r(32);var c=l(s);var f=r(2);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var d=t.Headers=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};h(this,e);this.headers={};this.addAll(t)}n(e,[{key:"get",value:function e(t){if(t){if((0,a.default)(t)===false){t=String(t)}var r=this.headers;return r[t.toLowerCase()]}return undefined}},{key:"set",value:function e(t,r){if((0,f.isDefined)(t)===false||(0,f.isDefined)(r)===false){throw new Error("A name and value must be provided to set a header.")}if((0,a.default)(t)===false){t=String(t)}var n=this.headers;t=t.toLowerCase();if((0,a.default)(r)===false){n[t]=JSON.stringify(r)}else{n[t]=r}this.headers=n;return this}},{key:"has",value:function e(t){return!!this.get(t)}},{key:"add",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return this.set(t.name,t.value)}},{key:"addAll",value:function t(){var r=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(n instanceof e){n=n.toPlainObject()}if((0,c.default)(n)===false){throw new Error("Headers argument must be an object.")}var i=Object.keys(n);(0,o.default)(i,function(e){try{r.set(e,n[e])}catch(e){}});return this}},{key:"remove",value:function e(t){if(t){if((0,a.default)(t)===false){t=String(t)}var r=this.headers;delete r[t.toLowerCase()];this.headers=r}return this}},{key:"clear",value:function e(){this.headers={};return this}},{key:"toPlainObject",value:function e(){return this.headers}},{key:"toString",value:function e(){return JSON.stringify(this.toPlainObject())}}]);return e}()},function(e,t,r){var n=r(4),i=r(79),o=r(279),u=r(282);function a(e,t){if(n(e)){return e}return i(e,t)?[e]:o(u(e))}e.exports=a},function(e,t,r){var n=r(19),i=r(15);var o="[object Symbol]";function u(e){return typeof e=="symbol"||i(e)&&n(e)==o}e.exports=u},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length,i=Array(n);while(++r<n){i[r]=t(e[r],r,e)}return i}e.exports=r},function(e,t){function r(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}e.exports=r;r.EventEmitter=r;r.prototype._events=undefined;r.prototype._maxListeners=undefined;r.defaultMaxListeners=10;r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};r.prototype.emit=function(e){var t,r,i,a,s,c;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||o(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{var f=new Error('Uncaught, unspecified "error" event. ('+t+")");f.context=t;throw f}}}r=this._events[e];if(u(r))return false;if(n(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1);r.apply(this,a)}}else if(o(r)){a=Array.prototype.slice.call(arguments,1);c=r.slice();i=c.length;for(s=0;s<i;s++)c[s].apply(this,a)}return true};r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,n(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(o(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(o(this._events[e])&&!this._events[e].warned){if(!u(this._maxListeners)){i=this._maxListeners}else{i=r.defaultMaxListeners}if(i&&i>0&&this._events[e].length>i){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};r.prototype.on=r.prototype.addListener;r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=false;function i(){this.removeListener(e,i);if(!r){r=true;t.apply(this,arguments)}}i.listener=t;this.on(e,i);return this};r.prototype.removeListener=function(e,t){var r,i,u,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];u=r.length;i=-1;if(r===t||n(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(o(r)){for(a=u;a-- >0;){if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}}if(i<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(i,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(n(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};r.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(n(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;else if(t)return t.length}return 0};r.listenerCount=function(e,t){return e.listenerCount(t)};function n(e){return typeof e==="function"}function i(e){return typeof e==="number"}function o(e){return typeof e==="object"&&e!==null}function u(e){return e===void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(83);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(88);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(141);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(401);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(140);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LiveService=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();t.isValidReceiver=b;t.isValidChannelName=g;t.getLiveService=w;var i=r(359);var o=v(i);var u=r(20);var a=v(u);var s=r(393);var c=v(s);var f=r(9);var l=r(7);var h=r(1);var d=r(2);var p=r(138);function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function b(e){if(!e){return false}var t=e.onMessage,r=e.onError,n=e.onStatus;return(0,a.default)(t)||(0,a.default)(r)||(0,a.default)(n)}function g(e){return(0,d.isNonemptyString)(e)}var m=t.LiveService=function(){function e(t){y(this,e);this._client=t||f.Client.sharedInstance();this._pubnubClient=undefined;this._pubnubListener=undefined;this._userChannelGroup=undefined;this._pubnubConfig=undefined;this._registeredUser=undefined}n(e,[{key:"fullInitialization",value:function e(t){var r=this;return this.registerUser(t).then(function(e){var t=new o.default(e);var n=new p.PubNubListener;r.initialize(t,n)})}},{key:"fullUninitialization",value:function e(){var t=this;return this.unregisterUser().then(function(e){t.uninitialize();return e})}},{key:"isInitialized",value:function e(){return!!this.__pubnubClient&&!!this.__pubnubListener&&!!this._registeredUser}},{key:"registerUser",value:function e(t){var r=this;if(!t||!t.isActive()){return Promise.reject(new h.ActiveUserError("Missing or invalid active user"))}if(this.isInitialized()){return Promise.reject(new h.KinveyError("Live service already initialized"))}return this._makeRegisterRequest(t._id).then(function(e){r._registeredUser=t;r._userChannelGroup=e.userChannelGroup;var n=(0,c.default)({ssl:true,authKey:r._registeredUser._kmd.authtoken},e);return n})}},{key:"initialize",value:function e(t,r){if(this.isInitialized()){throw new h.KinveyError("Live service already initialized")}this._pubnubListener=r;this._pubnubClient=t;this._pubnubClient.addListener(this._pubnubListener);this._subscribeToUserChannelGroup()}},{key:"uninitialize",value:function e(){this._unsubscribeFromAll();this._pubnubClient=null;this._pubnubListener=null}},{key:"onConnectionStatusUpdates",value:function e(t){this._pubnubListener.on(p.PubNubListener.unclassifiedEvents,t);this._pubnubListener.on(this._userChannelGroup,t)}},{key:"offConnectionStatusUpdates",value:function e(t){if(t){this._pubnubListener.removeListener(p.PubNubListener.unclassifiedEvents,t);this._pubnubListener.removeListener(this._userChannelGroup,t)}else{this._pubnubListener.removeAllListeners(p.PubNubListener.unclassifiedEvents);this._pubnubListener.removeAllListeners(this._userChannelGroup)}}},{key:"publishToChannel",value:function e(t,r){if(!this.isInitialized()){return Promise.reject(new h.KinveyError("Live service is not initialized"))}var n=this._validatePublishData(t,r);if(n){return Promise.reject(n)}return this._pubnubClient.publish({message:r,channel:t}).catch(function(e){e=e.status&&e.status.errorData;var t=new l.Response({data:e,statusCode:e.status,headers:e.response&&e.response.headers});return Promise.reject(t)})}},{key:"subscribeToChannel",value:function e(t,r){var n=this._validateSubscribeData(t,r);if(n){throw n}this._subscribeToListener(t,r)}},{key:"unsubscribeFromChannel",value:function e(t){this._unsubscribeFromListener(t)}},{key:"unregisterUser",value:function e(){var t=this;if(!this._registeredUser){var r="Cannot unregister when no user has been registered for live service";return Promise.reject(new h.KinveyError(r))}var n=this._registeredUser._id;return this._makeUnregisterRequst(n).then(function(e){t._registeredUser=null;return e})}},{key:"_unsubscribeFromAll",value:function e(){this._pubnubClient.unsubscribeAll();this._pubnubListener.removeAllListeners()}},{key:"_validatePublishData",value:function e(t,r){var n=null;if(!g(t)){n=new h.KinveyError("Invalid channel name")}if(r===undefined){n=new h.KinveyError("Missing or invalid message")}return n}},{key:"_validateSubscribeData",value:function e(t,r){var n=null;if(!g(t)){n=new h.KinveyError("Invalid channel name")}if(!r||!b(r)){n=new h.KinveyError("Missing or invalid receiver")}return n}},{key:"_subscribeToUserChannelGroup",value:function e(){this._pubnubClient.subscribe({channelGroups:[this._userChannelGroup]})}},{key:"_subscribeToListener",value:function e(t,r){if((0,a.default)(r.onMessage)){this._pubnubListener.on(t,r.onMessage)}if((0,a.default)(r.onError)||(0,a.default)(r.onStatus)){this._pubnubListener.on(""+p.PubNubListener.statusPrefix+t,function(e){var t=e.error?r.onError:r.onStatus;if((0,a.default)(t)){t.call(r,e)}})}}},{key:"_unsubscribeFromListener",value:function e(t){this._pubnubListener.removeAllListeners(t);this._pubnubListener.removeAllListeners(""+p.PubNubListener.statusPrefix+t)}},{key:"_makeRegisterRequest",value:function e(t){return this._makeUserManagementRequest(t,"register-realtime")}},{key:"_makeUnregisterRequst",value:function e(t){return this._makeUserManagementRequest(t,"unregister-realtime")}},{key:"_makeUserManagementRequest",value:function e(t,r){return l.KinveyRequest.executeShort({method:l.RequestMethod.POST,pathname:"/user/"+this._client.appKey+"/"+t+"/"+r,body:{deviceId:this._client.deviceId}},this._client)}},{key:"_throwNotInitializedError",value:function e(){throw new h.KinveyError("Live service has not been initialized")}},{key:"_pubnubClient",get:function e(){if(!this.__pubnubClient){this._throwNotInitializedError()}return this.__pubnubClient},set:function e(t){this.__pubnubClient=t}},{key:"_pubnubListener",set:function e(t){this.__pubnubListener=t},get:function e(){if(!this.__pubnubListener){this._throwNotInitializedError()}return this.__pubnubListener}}]);return e}();var _=void 0;function w(e){if(!_){_=new m(e)}return _}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory"};e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(92);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(144);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){var n=r(38),i=r(161),o=r(162),u=r(163),a=r(164),s=r(165);function c(e){var t=this.__data__=new n(e);this.size=t.size}c.prototype.clear=i;c.prototype["delete"]=o;c.prototype.get=u;c.prototype.has=a;c.prototype.set=s;e.exports=c},function(e,t,r){var n=r(24),i=r(13);var o=n(i,"Map");e.exports=o},function(e,t,r){var n=r(170),i=r(177),o=r(179),u=r(180),a=r(181);function s(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n;s.prototype["delete"]=i;s.prototype.get=o;s.prototype.has=u;s.prototype.set=a;e.exports=s},function(e,t,r){var n=r(63),i=r(30);var o=Object.prototype;var u=o.hasOwnProperty;function a(e,t,r){var o=e[t];if(!(u.call(e,t)&&i(o,r))||r===undefined&&!(t in e)){n(e,t,r)}}e.exports=a},function(e,t,r){var n=r(98);function i(e,t,r){if(t=="__proto__"&&n){n(e,t,{configurable:true,enumerable:true,value:r,writable:true})}else{e[t]=r}}e.exports=i},function(e,t,r){var n=r(186),i=r(100),o=r(187);var u=o&&o.isTypedArray;var a=u?i(u):n;e.exports=a},function(e,t){var r=9007199254740991;function n(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=r}e.exports=n},function(e,t,r){var n=r(195),i=r(103);var o=Object.prototype;var u=o.propertyIsEnumerable;var a=Object.getOwnPropertySymbols;var s=!a?i:function(e){if(e==null){return[]}e=Object(e);return n(a(e),function(t){return u.call(e,t)})};e.exports=s},function(e,t){function r(e,t){var r=-1,n=t.length,i=e.length;while(++r<n){e[i+r]=t[r]}return e}e.exports=r},function(e,t,r){var n=r(102);var i=n(Object.getPrototypeOf,Object);e.exports=i},function(e,t,r){var n=r(198),i=r(60),o=r(199),u=r(200),a=r(201),s=r(19),c=r(96);var f="[object Map]",l="[object Object]",h="[object Promise]",d="[object Set]",p="[object WeakMap]";var v="[object DataView]";var y=c(n),b=c(i),g=c(o),m=c(u),_=c(a);var w=s;if(n&&w(new n(new ArrayBuffer(1)))!=v||i&&w(new i)!=f||o&&w(o.resolve())!=h||u&&w(new u)!=d||a&&w(new a)!=p){w=function(e){var t=s(e),r=t==l?e.constructor:undefined,n=r?c(r):"";if(n){switch(n){case y:return v;case b:return f;case g:return h;case m:return d;case _:return p}}return t}}e.exports=w},function(e,t,r){var n=r(107);function i(e){var t=new e.constructor(e.byteLength);new n(t).set(new n(e));return t}e.exports=i},function(e,t){function r(e,t,r,n){var i=-1,o=e==null?0:e.length;if(n&&o){r=e[++i]}while(++i<o){r=t(r,e[i],i,e)}return r}e.exports=r},function(e,t,r){"use strict";var n=r(255);var i=r(256);var o=r(112);e.exports={formats:o,parse:i,stringify:n}},function(e,t,r){var n=r(74),i=r(114);function o(e){return n(function(t,r){var n=-1,o=r.length,u=o>1?r[o-1]:undefined,a=o>2?r[2]:undefined;u=e.length>3&&typeof u=="function"?(o--,u):undefined;if(a&&i(r[0],r[1],a)){u=o<3?undefined:u;o=1}t=Object(t);while(++n<o){var s=r[n];if(s){e(t,s,n,u)}}return t})}e.exports=o},function(e,t,r){var n=r(46),i=r(257),o=r(258);function u(e,t){return o(i(e,t,n),e+"")}e.exports=u},function(e,t,r){var n=r(19),i=r(15);var o="[object Number]";function u(e){return typeof e=="number"||i(e)&&n(e)==o}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkRack=t.CacheRack=t.Rack=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var o=r(6);var u=y(o);var a=r(77);var s=y(a);var c=r(20);var f=y(c);var l=r(80);var h=y(l);var d=r(2);var p=r(22);var v=r(122);function y(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function g(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function m(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var _=t.Rack=function(e){m(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Rack";b(this,t);var r=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.middlewares=[];r.canceled=false;r.activeMiddleware=undefined;return r}n(t,[{key:"use",value:function e(t){if((0,d.isDefined)(t)){if(t instanceof v.Middleware){this.middlewares.push(t);return}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"reset",value:function e(){this.middlewares=[]}},{key:"execute",value:function e(t){var r=this;if((0,d.isDefined)(t)===false){return u.default.reject(new Error("Request is undefined. Please provide a valid request."))}return(0,s.default)((0,h.default)(this.middlewares),function(e,n){return e.then(function(e){var i=e.request,o=e.response;if(r.canceled){return u.default.reject(new Error("Cancelled"))}r.activeMiddleware=n;return n.handle(i||t,o)})},u.default.resolve({request:t})).then(function(e){var t=e.response;if(r.canceled===true){return u.default.reject(new Error("Cancelled"))}r.canceled=false;r.activeMiddleware=undefined;return t}).catch(function(e){r.canceled=false;r.activeMiddleware=undefined;throw e})}},{key:"cancel",value:function e(){this.canceled=true;if((0,d.isDefined)(this.activeMiddleware)&&(0,f.default)(this.activeMiddleware.cancel)){return this.activeMiddleware.cancel()}return u.default.resolve()}},{key:"handle",value:function e(t){return this.execute(t)}},{key:"generateTree",value:function e(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"generateTree",this).call(this,r);(0,h.default)(this.middlewares).forEach(function(e){n.nodes.push(e.generateTree(r+1))});return n}}]);return t}(v.Middleware);var w=function(e){m(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Cache Rack";b(this,t);var r=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.use(new v.CacheMiddleware);return r}n(t,[{key:"useCacheMiddleware",value:function e(t){this.reset();this.use(t)}},{key:"execute",value:function e(r){p.Log.debug("Executing cache request",r);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,r).then(function(e){p.Log.debug("Received response for cache request id: "+r.id,e);return e}).catch(function(e){p.Log.error("Received error for cache request id: "+r.id,e);throw e})}}]);return t}(_);var O=new w;var E=function(e){m(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Network Rack";b(this,t);var r=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.use(new v.SerializeMiddleware);r.use(new v.HttpMiddleware);r.use(new v.ParseMiddleware);return r}n(t,[{key:"useHttpMiddleware",value:function e(t){this.reset();this.use(new v.SerializeMiddleware);this.use(t);this.use(new v.ParseMiddleware)}},{key:"execute",value:function e(r){p.Log.debug("Executing network request",r);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,r).then(function(e){p.Log.debug("Received response for network request: "+r.id,e);return e}).catch(function(e){p.Log.error("Received error for network request id: "+r.id,e);throw e})}}]);return t}(_);var k=new E;t.CacheRack=O;t.NetworkRack=k},function(e,t,r){var n=r(71),i=r(33),o=r(23),u=r(290),a=r(4);function s(e,t,r){var s=a(e)?n:u,c=arguments.length<3;return s(e,o(t,4),r,c,i)}e.exports=s},function(e,t,r){var n=r(51),i=r(28);function o(e,t){t=n(t,e);var r=0,o=t.length;while(e!=null&&r<o){e=e[i(t[r++])]}return r&&r==o?e:undefined}e.exports=o},function(e,t,r){var n=r(4),i=r(52);var o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;function a(e,t){if(n(e)){return false}var r=typeof e;if(r=="number"||r=="symbol"||r=="boolean"||e==null||i(e)){return true}return u.test(e)||!o.test(e)||t!=null&&e in Object(t)}e.exports=a},function(e,t,r){var n=r(291),i=r(21);function o(e){return e==null?[]:n(e,i(e))}e.exports=o},function(e,t,r){var n=r(63),i=r(296);var o=i(function(e,t,r){n(e,r,t)});e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(330);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CacheStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var o=r(6);var u=M(o);var a=r(331);var s=M(a);var c=r(17);var f=M(c);var l=r(81);var h=M(l);var d=r(341);var p=M(d);var v=r(4);var y=M(v);var b=r(77);var g=M(b);var m=r(84);var _=M(m);var w=r(11);var O=M(w);var E=r(7);var k=r(1);var P=r(12);var j=r(27);var S=r(85);var A=r(2);var T=r(36);var x=r(88);var C=r(140);function M(e){return e&&e.__esModule?e:{default:e}}function R(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function I(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function q(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var U=t.CacheStore=function(e){q(t,e);function t(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};R(this,t);var n=I(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));n.ttl=r.ttl||undefined;n.syncManager=new C.SyncManager(n.collection,r);return n}n(t,[{key:"find",value:function e(r){var n=this;var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};o=(0,f.default)({syncAutomatically:this.syncAutomatically},o);var u=o.syncAutomatically===true;var a=T.KinveyObservable.create(function(e){if(r&&!(r instanceof P.Query)){return e.error(new k.KinveyError("Invalid query. It must be an instance of the Query class."))}var a=new E.CacheRequest({method:E.RequestMethod.GET,url:O.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:o.properties,query:r,timeout:o.timeout,tag:n.tag});return a.execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];e.next(a);if(u===true){return n.pendingSyncCount(r,o).then(function(e){if(e>0){return n.push(r,o).then(function(){return n.pendingSyncCount(r,o)})}return e}).then(function(e){if(e>0){throw new k.KinveyError("Unable to fetch the entities on the backend."+(" There are "+e+" entities that need")+" to be synced.")}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"find",n).call(n,r,o).toPromise()}).then(function(e){var t=(0,s.default)(a,e,"_id");var r=Object.keys((0,h.default)(t,"_id"));var i=(new P.Query).contains("_id",r);return n.clear(i,o).then(function(){return e})}).then(function(e){var t=new E.CacheRequest({method:E.RequestMethod.PUT,url:O.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:o.properties,body:e,timeout:o.timeout,tag:n.tag});return t.execute().then(function(e){return e.data})})}return a}).then(function(t){e.next(t)}).then(function(){e.complete()}).catch(function(t){return e.error(t)})});return a}},{key:"findById",value:function e(r){var n=this;var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};o=(0,f.default)({syncAutomatically:this.syncAutomatically},o);var u=o.syncAutomatically===true;var a=T.KinveyObservable.create(function(e){if((0,A.isDefined)(r)===false){e.next(undefined);return e.complete()}var a=new E.CacheRequest({method:E.RequestMethod.GET,url:O.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname+"/"+r}),properties:o.properties,timeout:o.timeout,tag:n.tag});return a.execute().then(function(e){return e.data}).catch(function(){return undefined}).then(function(a){e.next(a);if(u===true){var s=new P.Query;s.equalTo("_id",r);return n.pendingSyncCount(s,o).then(function(e){if(e>0){return n.push(s,o).then(function(){return n.pendingSyncCount(s,o)})}return e}).then(function(e){if(e>0){throw new k.KinveyError("Unable to find the entity on the backend."+(" There are "+e+" entities that need")+" to be synced.")}}).then(function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"findById",n).call(n,r,o).toPromise()}).then(function(e){var t=new E.CacheRequest({method:E.RequestMethod.PUT,url:O.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:o.properties,body:e,timeout:o.timeout,tag:n.tag});return t.execute().then(function(e){return e.data})})}return a}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return a}},{key:"group",value:function e(r){var n=this;var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};o=(0,f.default)({syncAutomatically:this.syncAutomatically},o);var u=o.syncAutomatically===true;var a=T.KinveyObservable.create(function(e){if(!(r instanceof j.Aggregation)){return e.error(new k.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))}var a=new E.CacheRequest({method:E.RequestMethod.POST,url:O.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname+"/_group"}),properties:o.properties,aggregation:r,timeout:o.timeout,tag:n.tag});return a.execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];e.next(a);if(u===true){return n.pendingSyncCount(null,o).then(function(e){if(e>0){return n.push(null,o).then(function(){return n.pendingSyncCount(null,o)})}return e}).then(function(e){if(e>0){throw new k.KinveyError("Unable to group entities on the backend."+(" There are "+e+" entities that need")+" to be synced.")}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"group",n).call(n,r,o).toPromise()})}return a}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return a}},{key:"count",value:function e(r){var n=this;var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};o=(0,f.default)({syncAutomatically:this.syncAutomatically},o);var u=o.syncAutomatically===true;var a=T.KinveyObservable.create(function(e){if(r&&!(r instanceof P.Query)){return e.error(new k.KinveyError("Invalid query. It must be an instance of the Query class."))}var a=new E.CacheRequest({method:E.RequestMethod.GET,url:O.default.format({protocol:n.client.apiProtocol,host:n.client.apiHost,pathname:n.pathname}),properties:o.properties,query:r,timeout:o.timeout,tag:n.tag});return a.execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return e.length}).then(function(a){e.next(a);if(u===true){return n.pendingSyncCount(r,o).then(function(e){if(e>0){return n.push(r,o).then(function(){return n.pendingSyncCount(r,o)})}return e}).then(function(e){if(e>0){throw new k.KinveyError("Unable to count entities on the backend."+(" There are "+e+" entities that need")+" to be synced.")}}).then(function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"count",n).call(n,r,o).toPromise()})}return a}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return a}},{key:"create",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=T.KinveyObservable.create(function(e){if((0,A.isDefined)(t)===false){e.next(null);return e.complete()}if((0,y.default)(t)){return e.error(new k.KinveyError("Unable to create an array of entities.","Please create entities one by one."))}var i=new E.CacheRequest({method:E.RequestMethod.POST,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,body:t,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(e){return r.syncManager.addCreateOperation(e,n).then(function(){return e})}).then(function(e){if(r.syncAutomatically===true){var t=(new P.Query).equalTo("_id",e._id);return r.push(t,n).then(function(e){var t=e[0];if((0,A.isDefined)(t.error)){throw t.error}return t.entity})}return e}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"update",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=T.KinveyObservable.create(function(e){if((0,A.isDefined)(t)===false){e.next(null);return e.complete()}if((0,y.default)(t)){return e.error(new k.KinveyError("Unable to update an array of entities.","Please update entities one by one."))}if((0,A.isDefined)(t._id)===false){return e.error(new k.KinveyError("The entity provided does not contain an _id. An _id is required to"+" update the entity.",t))}var i=new E.CacheRequest({method:E.RequestMethod.PUT,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t._id}),properties:n.properties,body:t,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(e){return r.syncManager.addUpdateOperation(e,n).then(function(){return e})}).then(function(e){if(r.syncAutomatically===true){var t=(new P.Query).equalTo("_id",e._id);return r.push(t,n).then(function(e){var t=e[0];if((0,A.isDefined)(t.error)){throw t.error}return t.entity})}return e}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"remove",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=T.KinveyObservable.create(function(e){if(t&&!(t instanceof P.Query)){return e.error(new k.KinveyError("Invalid query. It must be an instance of the Query class."))}var i=new E.CacheRequest({method:E.RequestMethod.GET,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:t,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(e.length>0){return u.default.all((0,_.default)(e,function(e){var t=new S.Metadata(e);if(t.isLocal()){var i=new P.Query;i.equalTo("_id",e._id);return r.clearSync(i,n).then(function(){return e})}return r.syncManager.addDeleteOperation(e,n).then(function(){return e})})).then(function(){return e})}return e}).then(function(e){if(e.length>0&&r.syncAutomatically===true){var t=(0,p.default)(e,function(e){var t=new S.Metadata(e);return t.isLocal()});var i=Object.keys((0,h.default)(e,"_id"));var o=(new P.Query).contains("_id",i);return r.push(o,n).then(function(e){return e.concat(t)})}return e}).then(function(e){return u.default.all((0,_.default)(e,function(e){if((0,A.isDefined)(e.error)===false){var t=new E.CacheRequest({method:E.RequestMethod.DELETE,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+e._id}),properties:n.properties,authType:E.AuthType.Default,timeout:n.timeout,tag:r.tag});return t.execute().then(function(e){return e.data})}return{count:0}}))}).then(function(e){return(0,g.default)(e,function(e,t){e.count+=t.count;return e},{count:0})}).then().then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"removeById",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=T.KinveyObservable.create(function(e){if((0,A.isDefined)(t)===false){e.next({count:0});return e.complete()}var i=new E.CacheRequest({method:E.RequestMethod.GET,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t}),properties:n.properties,authType:E.AuthType.Default,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).catch(function(e){if(e instanceof k.NotFoundError){return null}throw e}).then(function(e){if((0,A.isDefined)(e)){var t=new S.Metadata(e);if(t.isLocal()){var i=new P.Query;i.equalTo("_id",e._id);return r.clearSync(i,n).then(function(){return e})}return r.syncManager.addDeleteOperation(e,n).then(function(){return e})}return e}).then(function(e){if(r.syncAutomatically===true){var t=(new P.Query).equalTo("_id",e._id);return r.push(t,n).then(function(){return e})}return e}).then(function(e){var t=new E.CacheRequest({method:E.RequestMethod.DELETE,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+e._id}),properties:n.properties,authType:E.AuthType.Default,timeout:n.timeout,tag:r.tag});return t.execute().then(function(e){return e.data})}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"clear",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=T.KinveyObservable.create(function(e){if(t&&!(t instanceof P.Query)){return e.error(new k.KinveyError("Invalid query. It must be an instance of the Query class."))}var i=new E.CacheRequest({method:E.RequestMethod.GET,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:t,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return u.default.all((0,_.default)(e,function(e){return u.default.resolve(e).then(function(e){var t=new S.Metadata(e);if(t.isLocal()){var i=new P.Query;i.equalTo("_id",e._id);return r.clearSync(i,n).then(function(){return e})}return e}).then(function(e){var t=new E.CacheRequest({method:E.RequestMethod.DELETE,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+e._id}),properties:n.properties,authType:E.AuthType.Default,timeout:n.timeout,tag:r.tag});return t.execute().then(function(e){return e.data})})}))}).then(function(e){return(0,g.default)(e,function(e,t){e.count+=t.count;return e},{count:0})}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"pendingSyncCount",value:function e(t,r){return this.syncManager.count(t,r)}},{key:"pendingSyncEntities",value:function e(t,r){return this.syncManager.find(t,r)}},{key:"push",value:function e(t,r){return this.syncManager.push(t,r)}},{key:"pull",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};n=(0,f.default)({useDeltaFetch:this.useDeltaFetch},n);return this.syncManager.pull(t,n).then(function(e){return r.clear(t,n).then(function(){var t=new E.CacheRequest({method:E.RequestMethod.PUT,url:O.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,body:e,timeout:n.timeout,tag:r.tag});return t.execute()}).then(function(){return e})})}},{key:"sync",value:function e(t,r){var n=this;r=(0,f.default)({useDeltaFetch:this.useDeltaFetch},r);return this.push(t,r).then(function(e){var i=n.pull(t,r).then(function(t){var r={push:e,pull:t};return r});return i})}},{key:"clearSync",value:function e(t,r){return this.syncManager.clear(t,r)}},{key:"syncAutomatically",get:function e(){return true}}]);return t}(x.NetworkStore)},function(e,t,r){var n=r(53),i=r(23),o=r(346),u=r(4);function a(e,t){var r=u(e)?n:o;return r(e,i(t,3))}e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Metadata=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(32);var o=s(i);var u=r(1);var a=r(2);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=t.Metadata=function(){function e(t){c(this,e);if((0,o.default)(t)===false){throw new u.KinveyError("entity argument must be an object")}t._kmd=t._kmd||{};this.entity=t}n(e,[{key:"isLocal",value:function e(){return this.entity._kmd.local===true}},{key:"toPlainObject",value:function e(){return this.entity._kmd}},{key:"createdAt",get:function e(){if((0,a.isDefined)(this.entity._kmd.ect)){return new Date(this.entity._kmd.ect)}return undefined}},{key:"ect",get:function e(){return this.createdAt}},{key:"emailVerification",get:function e(){if((0,a.isDefined)(this.entity._kmd.emailVerification)){return this.entity._kmd.emailVerification.status}return undefined}},{key:"lastModified",get:function e(){if((0,a.isDefined)(this.entity._kmd.lmt)){return new Date(this.entity._kmd.lmt)}return undefined}},{key:"lmt",get:function e(){return this.lastModified}},{key:"authtoken",get:function e(){return this.entity._kmd.authtoken}}]);return e}()},function(e,t,r){"use strict";(function(e){var r=typeof window!=="undefined"&&window;var n=typeof self!=="undefined"&&typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope&&self;var i=typeof e!=="undefined"&&e;var o=r||i||n;t.root=o;(function(){if(!o){throw new Error("RxJS could not find any global context (window, self, global)")}})()}).call(t,r(18))},function(e,t,r){"use strict";var n=r(86);var i=n.root.Symbol;t.rxSubscriber=typeof i==="function"&&typeof i.for==="function"?i.for("rxSubscriber"):"@@rxSubscriber";t.$$rxSubscriber=t.rxSubscriber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(8);var o=g(i);var u=r(4);var a=g(u);var s=r(11);var c=g(s);var f=r(7);var l=r(1);var h=r(12);var d=r(9);var p=r(2);var v=r(36);var y=r(27);var b=r(89);function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var _=t.NetworkStore=function(){function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};m(this,e);if(t&&!(0,o.default)(t)){throw new l.KinveyError("Collection must be a string.")}this.collection=t;if(r.tag){var n=r.tag;if(!(0,o.default)(n)){throw new l.KinveyError("A tag must be a string.")}if(!/^[a-zA-Z0-9-]+$/.test(n)){throw new l.KinveyError('A tag can only contain letters, numbers, and "-".')}this.tag=n}this.client=r.client;this.useDeltaFetch=r.useDeltaFetch===true}n(e,[{key:"find",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=n.useDeltaFetch===true||this.useDeltaFetch;var o=v.KinveyObservable.create(function(e){if((0,p.isDefined)(t)&&!(t instanceof h.Query)){return e.error(new l.KinveyError("Invalid query. It must be an instance of the Query class."))}var o={method:f.RequestMethod.GET,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:t,timeout:n.timeout,client:r.client,tag:r.tag};var u=new f.KinveyRequest(o);if(i===true){u=new f.DeltaFetchRequest(o)}return u.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return o}},{key:"findById",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=n.useDeltaFetch||this.useDeltaFetch;var o=v.KinveyObservable.create(function(e){if(!t){e.next(undefined);return e.complete()}var o={method:f.RequestMethod.GET,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t}),properties:n.properties,timeout:n.timeout,client:r.client,tag:r.tag};var u=new f.KinveyRequest(o);if(i===true){u=new f.DeltaFetchRequest(o)}return u.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return o}},{key:"group",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){if(!(t instanceof y.Aggregation)){return e.error(new l.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))}var i=new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/_group"}),properties:n.properties,aggregation:t,timeout:n.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i}},{key:"count",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){try{if(t&&!(t instanceof h.Query)){throw new l.KinveyError("Invalid query. It must be an instance of the Query class.")}var i=new f.KinveyRequest({method:f.RequestMethod.GET,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/_count"}),properties:n.properties,query:t,timeout:n.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t?t.count:0)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})}catch(t){return e.error(t)}});return i}},{key:"create",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){if((0,p.isDefined)(t)===false){e.next(null);return e.complete()}if((0,a.default)(t)){return e.error(new l.KinveyError("Unable to create an array of entities.","Please create entities one by one."))}var i=new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,data:t,timeout:n.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"update",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){if((0,p.isDefined)(t)===false){e.next(null);return e.complete()}if((0,a.default)(t)){return e.error(new l.KinveyError("Unable to update an array of entities.","Please update entities one by one."))}if((0,p.isDefined)(t._id)===false){return e.error(new l.KinveyError("Unable to update entity.","Entity must contain an _id to be updated."))}var i=new f.KinveyRequest({method:f.RequestMethod.PUT,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t._id}),properties:n.properties,data:t,timeout:n.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"save",value:function e(t,r){if(t._id){return this.update(t,r)}return this.create(t,r)}},{key:"remove",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){try{if(t&&!(t instanceof h.Query)){throw new l.KinveyError("Invalid query. It must be an instance of the Query class.")}var i=new f.KinveyRequest({method:f.RequestMethod.DELETE,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:t,timeout:n.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})}catch(t){return e.error(t)}});return i.toPromise()}},{key:"removeById",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){try{if((0,p.isDefined)(t)===false){e.next(undefined);return e.complete()}var i=new f.KinveyRequest({method:f.RequestMethod.DELETE,authType:f.AuthType.Default,url:c.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t}),properties:n.properties,timeout:n.timeout});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})}catch(t){return e.error(t)}});return i.toPromise()}},{key:"subscribe",value:function e(t){var r=(0,b.getLiveCollectionManager)();return r.subscribeCollection(this.collection,t)}},{key:"unsubscribe",value:function e(){var t=(0,b.getLiveCollectionManager)();return t.unsubscribeCollection(this.collection)}},{key:"client",get:function e(){if((0,p.isDefined)(this._client)){return this._client}return d.Client.sharedInstance()},set:function e(t){if(t instanceof d.Client){this._client=t}else{this._client=null}}},{key:"pathname",get:function e(){var t="/appdata/"+this.client.appKey;if(this.collection){t=t+"/"+this.collection}return t}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(357);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(395);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(56);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(138);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(400);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(361);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}t.default={createUUID:function e(){if(i.default.uuid){return i.default.uuid()}else{return(0,i.default)()}}};e.exports=t["default"]},function(e,t,r){"use strict";function n(e){for(var r in e)if(!t.hasOwnProperty(r))t[r]=e[r]}Object.defineProperty(t,"__esModule",{value:true});var i=r(58);var o=r(7);var u=r(127);var a=r(320);var s=r(321);var c=r(327);o.CacheRack.useCacheMiddleware(new u.CacheMiddleware);o.NetworkRack.useHttpMiddleware(new a.HttpMiddleware(c.default));i.MobileIdentityConnect.usePopupClass(s.Popup);var f=r(328);t.client=f.client;t.getAppVersion=f.getAppVersion;t.setAppVersion=f.setAppVersion;t.ping=f.ping;t.Acl=f.Acl;t.Aggregation=f.Aggregation;t.AuthorizationGrant=f.AuthorizationGrant;t.CustomEndpoint=f.CustomEndpoint;t.DataStore=f.DataStore;t.DataStoreType=f.DataStoreType;t.SyncOperation=f.SyncOperation;t.LiveService=f.LiveService;t.Files=f.Files;t.Log=f.Log;t.Metadata=f.Metadata;t.Query=f.Query;t.User=f.User;t.ActiveUserError=f.ActiveUserError;t.APIVersionNotAvailableError=f.APIVersionNotAvailableError;t.APIVersionNotImplementedError=f.APIVersionNotImplementedError;t.AppProblemError=f.AppProblemError;t.BadRequestError=f.BadRequestError;t.BLError=f.BLError;t.CORSDisabledError=f.CORSDisabledError;t.DuplicateEndUsersError=f.DuplicateEndUsersError;t.FeatureUnavailableError=f.FeatureUnavailableError;t.IncompleteRequestBodyError=f.IncompleteRequestBodyError;t.IndirectCollectionAccessDisallowedError=f.IndirectCollectionAccessDisallowedError;t.InsufficientCredentialsError=f.InsufficientCredentialsError;t.InvalidCredentialsError=f.InvalidCredentialsError;t.InvalidIdentifierError=f.InvalidIdentifierError;t.InvalidQuerySyntaxError=f.InvalidQuerySyntaxError;t.JSONParseError=f.JSONParseError;t.KinveyError=f.KinveyError;t.KinveyInternalErrorRetry=f.KinveyInternalErrorRetry;t.KinveyInternalErrorStop=f.KinveyInternalErrorStop;t.MissingQueryError=f.MissingQueryError;t.MissingRequestHeaderError=f.MissingRequestHeaderError;t.MissingRequestParameterError=f.MissingRequestParameterError;t.MobileIdentityConnectError=f.MobileIdentityConnectError;t.NoActiveUserError=f.NoActiveUserError;t.NetworkConnectionError=f.NetworkConnectionError;t.NoResponseError=f.NoResponseError;t.NotFoundError=f.NotFoundError;t.ParameterValueOutOfRangeError=f.ParameterValueOutOfRangeError;t.PopupError=f.PopupError;t.QueryError=f.QueryError;t.ServerError=f.ServerError;t.StaleRequestError=f.StaleRequestError;t.SyncError=f.SyncError;t.TimeoutError=f.TimeoutError;t.UserAlreadyExistsError=f.UserAlreadyExistsError;t.WritesToCollectionDisallowedError=f.WritesToCollectionDisallowedError;n(r(407))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.SocialIdentity={Kinvey:"kinvey",MobileIdentityConnect:"kinveyAuth"};Object.freeze(n)},function(e,t,r){(function(t){var r=typeof t=="object"&&t&&t.Object===Object&&t;e.exports=r}).call(t,r(18))},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.CacheRequest=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n,i){var o=Object.getOwnPropertyDescriptor(t,r);if(o===undefined){var u=Object.getPrototypeOf(t);if(u!==null){e(u,r,n,i)}}else if("value"in o&&o.writable){o.value=n}else{var a=o.set;if(a!==undefined){a.call(i,n)}}return n};var o=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var u=r(11);var a=b(u);var s=r(95);var c=b(s);var f=r(1);var l=r(12);var h=r(27);var d=r(2);var p=r(49);var v=r(34);var y=r(76);function b(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function m(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var w=t.CacheRequest=function(t){_(r,t);function r(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};g(this,r);var t=m(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));t.aggregation=e.aggregation;t.query=e.query;t.rack=y.CacheRack;t.tag=e.tag;return t}n(r,[{key:"execute",value:function e(){var t=this;return o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"execute",this).call(this).then(function(e){if(!(e instanceof v.KinveyResponse)){e=new v.KinveyResponse({statusCode:e.statusCode,headers:e.headers,data:e.data})}if(!e.isSuccess()){throw e.error}if((0,d.isDefined)(t.query)&&(0,d.isDefined)(e.data)){e.data=t.query.process(e.data)}if((0,d.isDefined)(t.aggregation)&&(0,d.isDefined)(e.data)){e.data=t.aggregation.process(e.data)}return e})}},{key:"toPlainObject",value:function e(){var t=o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toPlainObject",this).call(this);t.appKey=this.appKey;t.collection=this.collection;t.entityId=this.entityId;t.encryptionKey=this.client?this.client.encryptionKey:undefined;t.storageProviders=this.client?this.client.storage:undefined;return t}},{key:"body",get:function e(){return this._body},set:function e(t){this._body=(0,c.default)(t)}},{key:"query",get:function e(){return this._query},set:function e(t){if((0,d.isDefined)(t)&&!(t instanceof l.Query)){throw new f.KinveyError("Invalid query. It must be an instance of the Query class.")}this._query=t}},{key:"aggregation",get:function e(){return this._aggregation},set:function e(t){if((0,d.isDefined)(t)&&!(t instanceof h.Aggregation)){throw new f.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.")}this._aggregation=t}},{key:"collection",get:function e(){if((0,d.isDefined)(this.tag)){return this._collection+"."+this.tag}return this._collection},set:function e(t){this._collection=t}},{key:"url",get:function e(){return o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"url",this)},set:function t(n){i(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"url",n,this);var o=e.decodeURIComponent(a.default.parse(n).pathname);var u=o.replace(/^\//,"").split("/");this.appKey=u[1];this.collection=u[2];this.entityId=u[3]}}]);return r}(p.Request)}).call(t,r(18))},function(e,t,r){var n=r(155);var i=1,o=4;function u(e){return n(e,i|o)}e.exports=u},function(e,t){var r=Function.prototype;var n=r.toString;function i(e){if(e!=null){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}e.exports=i},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length;while(++r<n){if(t(e[r],r,e)===false){break}}return e}e.exports=r},function(e,t,r){var n=r(24);var i=function(){try{var e=n(Object,"defineProperty");e({},"",{});return e}catch(e){}}();e.exports=i},function(e,t,r){var n=r(183),i=r(42),o=r(4),u=r(43),a=r(44),s=r(64);var c=Object.prototype;var f=c.hasOwnProperty;function l(e,t){var r=o(e),c=!r&&i(e),l=!r&&!c&&u(e),h=!r&&!c&&!l&&s(e),d=r||c||l||h,p=d?n(e.length,String):[],v=p.length;for(var y in e){if((t||f.call(e,y))&&!(d&&(y=="length"||l&&(y=="offset"||y=="parent")||h&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||a(y,v)))){p.push(y)}}return p}e.exports=l},function(e,t){function r(e){return function(t){return e(t)}}e.exports=r},function(e,t,r){var n=r(31),i=r(188);var o=Object.prototype;var u=o.hasOwnProperty;function a(e){if(!n(e)){return i(e)}var t=[];for(var r in Object(e)){if(u.call(e,r)&&r!="constructor"){t.push(r)}}return t}e.exports=a},function(e,t){function r(e,t){return function(r){return e(t(r))}}e.exports=r},function(e,t){function r(){return[]}e.exports=r},function(e,t,r){var n=r(67),i=r(68),o=r(66),u=r(103);var a=Object.getOwnPropertySymbols;var s=!a?u:function(e){var t=[];while(e){n(t,o(e));e=i(e)}return t};e.exports=s},function(e,t,r){var n=r(106),i=r(66),o=r(21);function u(e){return n(e,o,i)}e.exports=u},function(e,t,r){var n=r(67),i=r(4);function o(e,t,r){var o=t(e);return i(e)?o:n(o,r(e))}e.exports=o},function(e,t,r){var n=r(13);var i=n.Uint8Array;e.exports=i},function(e,t){function r(e){var t=-1,r=Array(e.size);e.forEach(function(e,n){r[++t]=[n,e]});return r}e.exports=r},function(e,t){function r(e){var t=-1,r=Array(e.size);e.forEach(function(e){r[++t]=e});return r}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isDefined=c;t.isNumber=f;t.nested=l;t.keyBy=h;t.isEmpty=d;var i=r(251);var o=s(i);var u=r(252);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e){return(0,a.default)(e)===false&&(0,o.default)(e)===false}function f(e){return!Number.isNaN(parseFloat(e))&&Number.isFinite(e)}function l(e,t,r){if(c(t)===false){e=r||e;return e}var n=t.split(".");var i=n.shift();while(i&&e){e=e[i];i=n.shift()}return r||e}function h(e,t){if(!e){return{}}return e.reduce(function(e,r){e[t]=r[t];return e},{})}function d(e){if(!c(e))return true;if(e.length>0)return false;if(e.length===0)return true;if((typeof e==="undefined"?"undefined":n(e))!=="object")return true;return Object.keys(e).reduce(function(t,r){if(!t)return false;if(Object.hasOwnProperty.call(e,r))return false;return true},true)}},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty;var i=function(){var e=[];for(var t=0;t<256;++t){e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase())}return e}();var o=function e(t){var r;while(t.length){var n=t.pop();r=n.obj[n.prop];if(Array.isArray(r)){var i=[];for(var o=0;o<r.length;++o){if(typeof r[o]!=="undefined"){i.push(r[o])}}n.obj[n.prop]=i}}return r};t.arrayToObject=function e(t,r){var n=r&&r.plainObjects?Object.create(null):{};for(var i=0;i<t.length;++i){if(typeof t[i]!=="undefined"){n[i]=t[i]}}return n};t.merge=function e(r,i,o){if(!i){return r}if(typeof i!=="object"){if(Array.isArray(r)){r.push(i)}else if(typeof r==="object"){if(o.plainObjects||o.allowPrototypes||!n.call(Object.prototype,i)){r[i]=true}}else{return[r,i]}return r}if(typeof r!=="object"){return[r].concat(i)}var u=r;if(Array.isArray(r)&&!Array.isArray(i)){u=t.arrayToObject(r,o)}if(Array.isArray(r)&&Array.isArray(i)){i.forEach(function(e,i){if(n.call(r,i)){if(r[i]&&typeof r[i]==="object"){r[i]=t.merge(r[i],e,o)}else{r.push(e)}}else{r[i]=e}});return r}return Object.keys(i).reduce(function(e,r){var u=i[r];if(n.call(e,r)){e[r]=t.merge(e[r],u,o)}else{e[r]=u}return e},u)};t.assign=function e(t,r){return Object.keys(r).reduce(function(e,t){e[t]=r[t];return e},t)};t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}};t.encode=function e(t){if(t.length===0){return t}var r=typeof t==="string"?t:String(t);var n="";for(var o=0;o<r.length;++o){var u=r.charCodeAt(o);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122){n+=r.charAt(o);continue}if(u<128){n=n+i[u];continue}if(u<2048){n=n+(i[192|u>>6]+i[128|u&63]);continue}if(u<55296||u>=57344){n=n+(i[224|u>>12]+i[128|u>>6&63]+i[128|u&63]);continue}o+=1;u=65536+((u&1023)<<10|r.charCodeAt(o)&1023);n+=i[240|u>>18]+i[128|u>>12&63]+i[128|u>>6&63]+i[128|u&63]}return n};t.compact=function e(t){var r=[{obj:{o:t},prop:"o"}];var n=[];for(var i=0;i<r.length;++i){var u=r[i];var a=u.obj[u.prop];var s=Object.keys(a);for(var c=0;c<s.length;++c){var f=s[c];var l=a[f];if(typeof l==="object"&&l!==null&&n.indexOf(l)===-1){r.push({obj:a,prop:f});n.push(l)}}}return o(r)};t.isRegExp=function e(t){return Object.prototype.toString.call(t)==="[object RegExp]"};t.isBuffer=function e(t){if(t===null||typeof t==="undefined"){return false}return!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}},function(e,t,r){"use strict";var n=String.prototype.replace;var i=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return n.call(e,i,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t){function r(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}e.exports=r},function(e,t,r){var n=r(30),i=r(16),o=r(44),u=r(14);function a(e,t,r){if(!u(r)){return false}var a=typeof t;if(a=="number"?i(r)&&o(t,r.length):a=="string"&&t in r){return n(r[t],e)}return false}e.exports=a},function(e,t,r){"use strict";function n(){this._cache=i();this._timeouts=i()}n.prototype.get=function(e){return this._cache[e]};n.prototype.set=function(e,t,r){this.delete(e);this._cache[e]=t;if(r){this._timeouts[e]=setTimeout(this.delete.bind(this,e),r*1e3)}};n.prototype.delete=function(e){delete this._cache[e];if(e in this._timeouts){clearTimeout(this._timeouts[e]);delete this._timeouts[e]}};n.prototype.clear=function(){this._cache=i();for(var e in this._timeouts){clearTimeout(this._timeouts[e])}this._timeouts=i()};function i(){return Object.create(null)}e.exports=n},function(e,t,r){var n=r(270),i=r(15);function o(e,t,r,u,a){if(e===t){return true}if(e==null||t==null||!i(e)&&!i(t)){return e!==e&&t!==t}return n(e,t,r,u,o,a)}e.exports=o},function(e,t,r){var n=r(118),i=r(273),o=r(119);var u=1,a=2;function s(e,t,r,s,c,f){var l=r&u,h=e.length,d=t.length;if(h!=d&&!(l&&d>h)){return false}var p=f.get(e);if(p&&f.get(t)){return p==t}var v=-1,y=true,b=r&a?new n:undefined;f.set(e,t);f.set(t,e);while(++v<h){var g=e[v],m=t[v];if(s){var _=l?s(m,g,v,t,e,f):s(g,m,v,e,t,f)}if(_!==undefined){if(_){continue}y=false;break}if(b){if(!i(t,function(e,t){if(!o(b,t)&&(g===e||c(g,e,r,s,f))){return b.push(t)}})){y=false;break}}else if(!(g===m||c(g,m,r,s,f))){y=false;break}}f["delete"](e);f["delete"](t);return y}e.exports=s},function(e,t,r){var n=r(61),i=r(271),o=r(272);function u(e){var t=-1,r=e==null?0:e.length;this.__data__=new n;while(++t<r){this.add(e[t])}}u.prototype.add=u.prototype.push=i;u.prototype.has=o;e.exports=u},function(e,t){function r(e,t){return e.has(t)}e.exports=r},function(e,t,r){var n=r(14);function i(e){return e===e&&!n(e)}e.exports=i},function(e,t){function r(e,t){return function(r){if(r==null){return false}return r[e]===t&&(t!==undefined||e in Object(r))}}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(292);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(305);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(35);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(306);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(307);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(123);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MemoryAdapter=t.Storage=t.StorageProvider=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=v(i);var u=r(8);var a=v(u);var s=r(4);var c=v(s);var f=r(2);var l=r(294);var h=r(22);var d=r(1);var p=r(295);function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=new l.Queue(1,Infinity);var g=t.StorageProvider={Memory:"Memory"};Object.freeze(g);var m=t.Storage=function(){function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[g.Memory];y(this,e);if(!t){throw new d.KinveyError("Unable to create a Storage instance without a name.")}if(!(0,a.default)(t)){throw new d.KinveyError("The name is not a string. A name must be a string to create a Storage instance.")}this.name=t;if(!Array.isArray(r)){r=[r]}this.storageProviders=r}n(e,[{key:"loadAdapter",value:function e(){var t=this;return this.storageProviders.reduce(function(e,r){return e.then(function(e){if(e){return e}switch(r){case g.Memory:return p.MemoryAdapter.load(t.name);default:return null}})},o.default.resolve()).then(function(e){if(!e){return o.default.reject(new d.KinveyError("Unable to load a storage adapter."))}return e})}},{key:"generateObjectId",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:24;var r="abcdef0123456789";var n="";for(var i=0,o=r.length;i<t;i+=1){var u=Math.floor(Math.random()*o);n+=r.substring(u,u+1)}return n}},{key:"find",value:function e(t){return this.loadAdapter().then(function(e){h.Log.debug("Find all the entities stored in the "+t+" collection.",e);return e.find(t)}).catch(function(e){h.Log.error("Unable to find all the entities stored in the "+t+" collection.",e);if(e instanceof d.NotFoundError||e.code===404){return[]}return o.default.reject(e)}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return e})}},{key:"findById",value:function e(t,r){if(!(0,a.default)(r)){var n=new d.KinveyError("id must be a string",r);h.Log.error("Unable to find an entity with id "+r+" stored in the "+t+" collection.",n.message);return o.default.reject(n)}return this.loadAdapter().then(function(e){h.Log.debug("Find an entity with id "+r+" stored in the "+t+" collection.",e);return e.findById(t,r)})}},{key:"save",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return b.add(function(){var e=false;if(!(0,f.isDefined)(n)){return o.default.resolve(null)}if(!(0,c.default)(n)){e=true;n=[n]}n=n.map(function(e){if(!(0,f.isDefined)(e._id)){var t=e._kmd||{};t.local=true;e._kmd=t;e._id=r.generateObjectId()}return e});return r.loadAdapter().then(function(e){return e.save(t,n)}).then(function(t){if(e&&t.length>0){return t[0]}return t})})}},{key:"remove",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return o.default.all(n.map(function(e){if(!(0,f.isDefined)(e._id)){return o.default.reject(new d.KinveyError("Unable to remove this entity because it does not have _id."))}return r.removeById(t,e._id)})).then(function(e){return e.reduce(function(e,t){e.count+=t.count;return e},{count:0})})}},{key:"removeById",value:function e(t,r){var n=this;return b.add(function(){if(!(0,a.default)(r)){return o.default.reject(new d.KinveyError("id must be a string",r))}return n.loadAdapter().then(function(e){return e.removeById(t,r)})})}},{key:"clear",value:function e(){var t=this;return b.add(function(){return t.loadAdapter().then(function(e){return e.clear()})})}}]);return e}();t.MemoryAdapter=p.MemoryAdapter},function(e,t){function r(e,t,r,n){var i=e.length,o=r+(n?1:-1);while(n?o--:++o<i){if(t(e[o],o,e)){return o}}return-1}e.exports=r},function(e,t,r){var n=r(51),i=r(20),o=r(28);function u(e,t,r){t=n(t,e);var u=-1,a=t.length;if(!a){a=1;e=undefined}while(++u<a){var s=e==null?undefined:e[o(t[u])];if(s===undefined){u=a;s=r}e=i(s)?s.call(e):s}return e}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyRequest=t.Properties=t.AuthType=t.NetworkRequest=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n,i){var o=Object.getOwnPropertyDescriptor(t,r);if(o===undefined){var u=Object.getPrototypeOf(t);if(u!==null){e(u,r,n,i)}}else if("value"in o&&o.writable){o.value=n}else{var a=o.set;if(a!==undefined){a.call(i,n)}}return n};var o=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var u=r(6);var a=x(u);var s=r(309);var c=r(72);var f=x(c);var l=r(17);var h=x(l);var d=r(313);var p=x(d);var v=r(47);var y=x(v);var b=r(11);var g=x(b);var m=r(8);var _=x(m);var w=r(9);var O=r(12);var E=r(27);var k=r(2);var P=r(1);var j=r(49);var S=r(50);var A=r(76);var T=r(34);function x(e){return e&&e.__esModule?e:{default:e}}function C(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function M(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function R(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var I=t.NetworkRequest=function(e){R(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};C(this,t);var r=M(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.rack=A.NetworkRack;return r}return t}(j.Request);var q=t.AuthType={All:"All",App:"App",Basic:"Basic",Default:"Default",Master:"Master",None:"None",Session:"Session"};Object.freeze(q);var U={all:function e(t){return U.session(t).catch(function(){return U.basic(t)})},app:function e(t){if(!t.appKey||!t.appSecret){return a.default.reject(new Error("Missing client appKey and/or appSecret."+" Use Kinvey.initialize() to set the appKey and appSecret for the client."))}return a.default.resolve({scheme:"Basic",username:t.appKey,password:t.appSecret})},basic:function e(t){return U.master(t).catch(function(){return U.app(t)})},master:function e(t){if(!t.appKey||!t.masterSecret){return a.default.reject(new Error("Missing client appKey and/or masterSecret."+" Use Kinvey.initialize() to set the appKey and masterSecret for the client."))}return a.default.resolve({scheme:"Basic",username:t.appKey,password:t.masterSecret})},none:function e(){return a.default.resolve(null)},session:function e(t){var r=t.getActiveUser();if(!(0,k.isDefined)(r)){return a.default.reject(new P.NoActiveUserError("There is not an active user. Please login a user and retry the request."))}return a.default.resolve({scheme:"Kinvey",credentials:r._kmd.authtoken})}};function D(e){if(e){var t=0;var r=e.length;e=String(e||"");for(var n=0;n<r;n+=1){var i=encodeURI(e[n]).split("%").length;t+=i===1?1:i-1}return t}return 0}var K=t.Properties=function(e){R(t,e);function t(){C(this,t);return M(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(S.Headers);var N=t.KinveyRequest=function(e){R(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};C(this,t);var r=M(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));e=(0,h.default)({skipBL:false,trace:false},e);r.authType=e.authType||q.None;r.query=e.query;r.aggregation=e.aggregation;r.properties=e.properties||new K;r.skipBL=e.skipBL===true;r.trace=e.trace===true;return r}n(t,[{key:"getAuthorizationHeader",value:function e(){var t=this;var r=a.default.resolve(undefined);if(this.authType){switch(this.authType){case q.All:r=U.all(this.client);break;case q.App:r=U.app(this.client);break;case q.Basic:r=U.basic(this.client);break;case q.Master:r=U.master(this.client);break;case q.None:r=U.none(this.client);break;case q.Session:r=U.session(this.client);break;default:r=U.session(this.client).catch(function(e){return U.master(t.client).catch(function(){throw e})})}}return r.then(function(e){if((0,k.isDefined)(e)){var t=e.credentials;if(e.username){t=new s.Buffer(e.username+":"+e.password).toString("base64")}return e.scheme+" "+t}return undefined})}},{key:"execute",value:function e(){var r=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;return this.getAuthorizationHeader().then(function(e){if((0,k.isDefined)(e)){r.headers.set("Authorization",e)}else{r.headers.remove("Authorization")}}).then(function(){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",r).call(r)}).then(function(e){if(e instanceof T.KinveyResponse===false){e=new T.KinveyResponse({statusCode:e.statusCode,headers:e.headers,data:e.data})}if(n===false&&e.isSuccess()===false){throw e.error}return e}).catch(function(e){if(i&&e instanceof P.InvalidCredentialsError){var o=r.client.getActiveUser();if((0,k.isDefined)(o)){var u=(0,k.isDefined)(o._socialIdentity)?o._socialIdentity:{};var s=Object.keys(u).find(function(e){return u[e].identity==="kinveyAuth"});var c=u[s];if((0,k.isDefined)(c)){var f=new t({method:j.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:q.App,url:g.default.format({protocol:r.client.micProtocol,host:r.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:c.client_id,redirect_uri:c.redirect_uri,refresh_token:c.refresh_token},properties:r.properties,timeout:r.timeout});return f.execute().then(function(e){return e.data}).then(function(e){e.identity=c.identity;e.client_id=c.client_id;e.redirect_uri=c.redirect_uri;e.protocol=r.client.micProtocol;e.host=r.client.micHost;return e}).then(function(e){var n={};u[e.identity]=e;n._socialIdentity=u;var i=new t({method:j.RequestMethod.POST,authType:q.App,url:g.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:"/user/"+r.client.appKey+"/login"}),properties:r.properties,body:n,timeout:r.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){t._socialIdentity[e.identity]=(0,p.default)(t._socialIdentity[e.identity],e);return r.client.setActiveUser(t)})}).then(function(){return r.execute(n,false)}).catch(function(){return a.default.reject(e)})}}}return a.default.reject(e)})}},{key:"appVersion",get:function e(){return this.client.appVersion}},{key:"query",get:function e(){return this._query},set:function e(t){if((0,k.isDefined)(t)&&!(t instanceof O.Query)){throw new P.KinveyError("Invalid query. It must be an instance of the Query class.")}this._query=t}},{key:"aggregation",get:function e(){return this._aggregation},set:function e(t){if((0,k.isDefined)(t)&&!(t instanceof E.Aggregation)){throw new P.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.")}if((0,k.isDefined)(t)){this.body=t.toPlainObject()}this._aggregation=t}},{key:"headers",get:function e(){var r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",this);if(!r.has("Accept")){r.set("Accept","application/json; charset=utf-8")}if(!r.has("Content-Type")){r.set("Content-Type","application/json; charset=utf-8")}if(!r.has("X-Kinvey-Api-Version")){r.set("X-Kinvey-Api-Version",4)}if(this.skipBL===true){r.set("X-Kinvey-Skip-Business-Logic",true)}else{r.remove("X-Kinvey-Skip-Business-Logic")}if(this.trace===true){r.set("X-Kinvey-Include-Headers-In-Response","X-Kinvey-Request-Id");r.set("X-Kinvey-ResponseWrapper",true)}else{r.remove("X-Kinvey-Include-Headers-In-Response");r.remove("X-Kinvey-ResponseWrapper")}if(this.appVersion){r.set("X-Kinvey-Client-App-Version",this.appVersion)}else{r.remove("X-Kinvey-Client-App-Version")}if(this.properties){var n=this.properties.toString();if(!(0,y.default)(n)){var i=D(n);if(i>=2e3){throw new Error("The custom properties are "+i+" bytes."+"It must be less then 2000 bytes.","Please remove some custom properties.")}r.set("X-Kinvey-Custom-Request-Properties",n)}else{r.remove("X-Kinvey-Custom-Request-Properties")}}else{r.remove("X-Kinvey-Custom-Request-Properties")}return r},set:function e(r){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",r,this)}},{key:"url",get:function e(){var r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",this);var n=this.query?this.query.toQueryString():{};if((0,y.default)(n)){return r}return(0,k.appendQuery)(r,f.default.stringify(n))},set:function e(r){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",r,this)}},{key:"properties",get:function e(){return this._properties},set:function e(t){if(t&&t instanceof K===false){t=new K(t)}this._properties=t}}],[{key:"executeShort",value:function e(r,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var o=(0,h.default)({method:j.RequestMethod.GET,authType:q.Session},r);n=n||w.Client.sharedInstance();if(!o.url&&(0,_.default)(o.pathname)&&n){o.url=g.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:o.pathname})}var u=t.execute(o);if(i){u=u.then(function(e){return e.data})}return u}},{key:"execute",value:function e(r){return new t(r).execute()}}]);return t}(I)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(7);var i=r(318);t.StorageProvider=Object.assign({},n.StorageProvider,{SQLite:"SQLite"});Object.freeze(t.StorageProvider);var o=function(e){__extends(r,e);function r(r,n){if(n===void 0){n=[t.StorageProvider.SQLite,t.StorageProvider.Memory]}return e.call(this,r,n)||this}r.prototype.loadAdapter=function(){var r=this;return this.storageProviders.reduce(function(n,o){return n.then(function(n){if(n){return n}switch(o){case t.StorageProvider.SQLite:return i.sqLite.load(r.name);default:return e.prototype.loadAdapter.call(r)}})},Promise.resolve())};return r}(n.Storage);var u=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.loadStorage=function(e,t){return new o(e,t)};return t}(n.CacheMiddleware);t.CacheMiddleware=u},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("platform")},function(e,t){function r(e){var t=e==null?0:e.length;return t?e[t-1]:undefined}e.exports=r},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};var i=r(132);var o=r(349);var u=r(134);var a=r(87);var s=function(e){n(t,e);function t(r,n,i){e.call(this);this.syncErrorValue=null;this.syncErrorThrown=false;this.syncErrorThrowable=false;this.isStopped=false;switch(arguments.length){case 0:this.destination=u.empty;break;case 1:if(!r){this.destination=u.empty;break}if(typeof r==="object"){if(r instanceof t){this.destination=r;this.destination.add(this)}else{this.syncErrorThrowable=true;this.destination=new c(this,r)}break}default:this.syncErrorThrowable=true;this.destination=new c(this,r,n,i);break}}t.prototype[a.rxSubscriber]=function(){return this};t.create=function(e,r,n){var i=new t(e,r,n);i.syncErrorThrowable=false;return i};t.prototype.next=function(e){if(!this.isStopped){this._next(e)}};t.prototype.error=function(e){if(!this.isStopped){this.isStopped=true;this._error(e)}};t.prototype.complete=function(){if(!this.isStopped){this.isStopped=true;this._complete()}};t.prototype.unsubscribe=function(){if(this.closed){return}this.isStopped=true;e.prototype.unsubscribe.call(this)};t.prototype._next=function(e){this.destination.next(e)};t.prototype._error=function(e){this.destination.error(e);this.unsubscribe()};t.prototype._complete=function(){this.destination.complete();this.unsubscribe()};t.prototype._unsubscribeAndRecycle=function(){var e=this,t=e._parent,r=e._parents;this._parent=null;this._parents=null;this.unsubscribe();this.closed=false;this.isStopped=false;this._parent=t;this._parents=r;return this};return t}(o.Subscription);t.Subscriber=s;var c=function(e){n(t,e);function t(t,r,n,o){e.call(this);this._parentSubscriber=t;var a;var s=this;if(i.isFunction(r)){a=r}else if(r){a=r.next;n=r.error;o=r.complete;if(r!==u.empty){s=Object.create(r);if(i.isFunction(s.unsubscribe)){this.add(s.unsubscribe.bind(s))}s.unsubscribe=this.unsubscribe.bind(this)}}this._context=s;this._next=a;this._error=n;this._complete=o}t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;if(!t.syncErrorThrowable){this.__tryOrUnsub(this._next,e)}else if(this.__tryOrSetError(t,this._next,e)){this.unsubscribe()}}};t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error){if(!t.syncErrorThrowable){this.__tryOrUnsub(this._error,e);this.unsubscribe()}else{this.__tryOrSetError(t,this._error,e);this.unsubscribe()}}else if(!t.syncErrorThrowable){this.unsubscribe();throw e}else{t.syncErrorValue=e;t.syncErrorThrown=true;this.unsubscribe()}}};t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};if(!t.syncErrorThrowable){this.__tryOrUnsub(r);this.unsubscribe()}else{this.__tryOrSetError(t,r);this.unsubscribe()}}else{this.unsubscribe()}}};t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){this.unsubscribe();throw e}};t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(t){e.syncErrorValue=t;e.syncErrorThrown=true;return true}return false};t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null;this._parentSubscriber=null;e.unsubscribe()};return t}(s)},function(e,t,r){"use strict";function n(e){return typeof e==="function"}t.isFunction=n},function(e,t,r){"use strict";t.errorObject={e:{}}},function(e,t,r){"use strict";t.empty={closed:true,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(29);var o=s(i);var u=r(362);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(t){var r=t.config;c(this,e);this._config=r;this._iv="0123456789012345";this._allowedKeyEncodings=["hex","utf8","base64","binary"];this._allowedKeyLengths=[128,256];this._allowedModes=["ecb","cbc"];this._defaultOptions={encryptKey:true,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}n(e,[{key:"HMACSHA256",value:function e(t){var r=a.default.HmacSHA256(t,this._config.secretKey);return r.toString(a.default.enc.Base64)}},{key:"SHA256",value:function e(t){return a.default.SHA256(t).toString(a.default.enc.Hex)}},{key:"_parseOptions",value:function e(t){var r=t||{};if(!r.hasOwnProperty("encryptKey"))r.encryptKey=this._defaultOptions.encryptKey;if(!r.hasOwnProperty("keyEncoding"))r.keyEncoding=this._defaultOptions.keyEncoding;if(!r.hasOwnProperty("keyLength"))r.keyLength=this._defaultOptions.keyLength;if(!r.hasOwnProperty("mode"))r.mode=this._defaultOptions.mode;if(this._allowedKeyEncodings.indexOf(r.keyEncoding.toLowerCase())===-1){r.keyEncoding=this._defaultOptions.keyEncoding}if(this._allowedKeyLengths.indexOf(parseInt(r.keyLength,10))===-1){r.keyLength=this._defaultOptions.keyLength}if(this._allowedModes.indexOf(r.mode.toLowerCase())===-1){r.mode=this._defaultOptions.mode}return r}},{key:"_decodeKey",value:function e(t,r){if(r.keyEncoding==="base64"){return a.default.enc.Base64.parse(t)}else if(r.keyEncoding==="hex"){return a.default.enc.Hex.parse(t)}else{return t}}},{key:"_getPaddedKey",value:function e(t,r){t=this._decodeKey(t,r);if(r.encryptKey){return a.default.enc.Utf8.parse(this.SHA256(t).slice(0,32))}else{return t}}},{key:"_getMode",value:function e(t){if(t.mode==="ecb"){return a.default.mode.ECB}else{return a.default.mode.CBC}}},{key:"_getIV",value:function e(t){return t.mode==="cbc"?a.default.enc.Utf8.parse(this._iv):null}},{key:"encrypt",value:function e(t,r,n){if(this._config.customEncrypt){return this._config.customEncrypt(t)}else{return this.pnEncrypt(t,r,n)}}},{key:"decrypt",value:function e(t,r,n){if(this._config.customDecrypt){return this._config.customDecrypt(t)}else{return this.pnDecrypt(t,r,n)}}},{key:"pnEncrypt",value:function e(t,r,n){if(!r&&!this._config.cipherKey)return t;n=this._parseOptions(n);var i=this._getIV(n);var o=this._getMode(n);var u=this._getPaddedKey(r||this._config.cipherKey,n);var s=a.default.AES.encrypt(t,u,{iv:i,mode:o}).ciphertext;var c=s.toString(a.default.enc.Base64);return c||t}},{key:"pnDecrypt",value:function e(t,r,n){if(!r&&!this._config.cipherKey)return t;n=this._parseOptions(n);var i=this._getIV(n);var o=this._getMode(n);var u=this._getPaddedKey(r||this._config.cipherKey,n);try{var s=a.default.enc.Base64.parse(t);var c=a.default.AES.decrypt({ciphertext:s},u,{iv:i,mode:o}).toString(a.default.enc.Utf8);var f=JSON.parse(c);return f}catch(e){return null}}}]);return e}();t.default=f;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(3);var o=r(57);var u=a(o);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(){s(this,e);this._listeners=[]}n(e,[{key:"addListener",value:function e(t){this._listeners.push(t)}},{key:"removeListener",value:function e(t){var r=[];this._listeners.forEach(function(e){if(e!==t)r.push(e)});this._listeners=r}},{key:"removeAllListeners",value:function e(){this._listeners=[]}},{key:"announcePresence",value:function e(t){this._listeners.forEach(function(e){if(e.presence)e.presence(t)})}},{key:"announceStatus",value:function e(t){this._listeners.forEach(function(e){if(e.status)e.status(t)})}},{key:"announceMessage",value:function e(t){this._listeners.forEach(function(e){if(e.message)e.message(t)})}},{key:"announceNetworkUp",value:function e(){var t={};t.category=u.default.PNNetworkUpCategory;this.announceStatus(t)}},{key:"announceNetworkDown",value:function e(){var t={};t.category=u.default.PNNetworkDownCategory;this.announceStatus(t)}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.getURL=s;t.getRequestTimeout=c;t.prepareParams=f;t.isAuthSupported=l;t.handleResponse=h;t.validateParams=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNTimeOperation}function s(){return"/time/0"}function c(e){var t=e.config;return t.getTransactionTimeout()}function f(){return{}}function l(){return false}function h(e,t){return{timetoken:t[0]}}function d(){}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PubNubListener=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(54);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function a(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var s="status:";var c="pubNubEventsNotRouted";var f=t.PubNubListener=function(e){a(t,e);function t(){o(this,t);return u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"message",value:function e(t){this.emit(t.channel,t.message)}},{key:"status",value:function e(r){var n=this;var i=this._getEventNamesFromStatus(r.affectedChannels,r.affectedChannelGroups);if(i.length){i.forEach(function(e){n.emit(""+t.statusPrefix+e,r)})}else{this.emit(t.unclassifiedEvents,r)}}},{key:"_getEventNamesFromStatus",value:function e(t,r){var n=t||[];var i=r||[];return n.concat(i)}}],[{key:"statusPrefix",get:function e(){return s}},{key:"unclassifiedEvents",get:function e(){return c}}]);return t}(i.EventEmitter)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StreamACL=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var o=f(i);var u=r(397);var a=f(u);var s=r(1);var c=r(2);function f(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h="Invalid ACL object value";var d=t.StreamACL=function(){function e(t){l(this,e);this.publishers=[];this.subscribers=[];this.publisherGroups=[];this.subscriberGroups=[];if(t){if(t instanceof e){t=t.toPlainObject()}this._parsePlainObject(t)}}n(e,[{key:"addPublishers",value:function e(t){this._addToAcl(this.publishers,t);return this}},{key:"addSubscribers",value:function e(t){this._addToAcl(this.subscribers,t);return this}},{key:"addPublisherGroups",value:function e(t){this._addToAcl(this.publisherGroups,t);return this}},{key:"addSubscriberGroups",value:function e(t){this._addToAcl(this.subscriberGroups,t);return this}},{key:"removePublishers",value:function e(t){this._removeFromAcl(this.publishers,t);return this}},{key:"removeSubscribers",value:function e(t){this._removeFromAcl(this.subscribers,t);return this}},{key:"removePublisherGroups",value:function e(t){this._removeFromAcl(this.publisherGroups,t);return this}},{key:"removeSubscriberGroups",value:function e(t){this._removeFromAcl(this.subscriberGroups,t);return this}},{key:"isNotEmpty",value:function e(){return this.publishers.length||this.subscribers.length||this.publisherGroups.length||this.subscriberGroups.length}},{key:"toPlainObject",value:function e(){var t={};if(this.subscribers.length){t.subscribe=this.subscribers.slice(0)}if(this.publishers.length){t.publish=this.publishers.slice(0)}if(this.subscriberGroups.length){t.groups=t.groups||{};t.groups.subscribe=this.addSubscriberGroups.slice(0)}if(this.publisherGroups.length){t.groups=t.groups||{};t.groups.publish=this.publisherGroups.slice(0)}return t}},{key:"_parsePlainObject",value:function e(t){if(t.subscribe){this.subscribers=this._ensureValidIdArray(t.subscribe)}if(t.publish){this.publishers=this._ensureValidIdArray(t.publish)}if(t.groups){if(t.groups.publish){this.publisherGroups=this._ensureValidIdArray(t.groups.publish)}if(t.groups.subscribe){this.subscriberGroups=this._ensureValidIdArray(t.groups.subscribe)}}}},{key:"_ensureValidIdArray",value:function e(t){var r=this._isValidIdArray(t);if(!r){throw new s.KinveyError(h)}return t}},{key:"_isValidIdArray",value:function e(t){var r=this;return(0,o.default)(t)&&(0,a.default)(t,function(e){var t=r._getAsId(e);return(0,c.isNonemptyString)(t)})}},{key:"_addToAcl",value:function e(t,r){var n=this;var i=(0,o.default)(r)?r:[r];var u=this._isValidIdArray(i);if(!u){throw new s.KinveyError(h)}i.forEach(function(e){var r=n._getAsId(e);t.push(r)})}},{key:"_removeFromAcl",value:function e(t,r){var n=this;var i=(0,o.default)(r)?r:[r];i.forEach(function(e){var r=n._getAsId(e);var i=t.indexOf(r);if(i>=0){t.splice(i,1)}})}},{key:"_getAsId",value:function e(t){return t&&t._id?t._id:t}}],[{key:"isValidACLObject",value:function t(r){try{var n=new e(r);return n.isNotEmpty()}catch(e){return false}}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SyncManager=t.SyncOperation=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=w(i);var u=r(84);var a=w(u);var s=r(125);var c=w(s);var f=r(4);var l=w(f);var h=r(8);var d=w(h);var p=r(11);var v=w(p);var y=r(7);var b=r(1);var g=r(2);var m=r(9);var _=r(12);function w(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var E=new Map;var k=t.SyncOperation={Create:y.RequestMethod.POST,Update:y.RequestMethod.PUT,Delete:y.RequestMethod.DELETE};Object.freeze(k);var P=t.SyncManager=function(){function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};O(this,e);if(!t){throw new b.SyncError("A collection is required.")}if(!(0,d.default)(t)){throw new b.SyncError("Collection must be a string.")}this.collection=t;this.tag=r.tag||undefined;this.client=r.client||m.Client.sharedInstance()}n(e,[{key:"find",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if((0,g.isDefined)(t)&&t instanceof _.Query===false){t=new _.Query((0,c.default)(t,"toJSON",t))}var i=new y.CacheRequest({method:y.RequestMethod.GET,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.backendPathname}),query:t,properties:n.properties,timeout:n.timeout,client:this.client,tag:this.tag});return i.execute().then(function(e){return e.data}).then(function(e){var i=new _.Query;i.equalTo("collection",r.collection);if((0,g.isDefined)(t)){i.contains("entityId",(0,a.default)(e,function(e){return e._id}))}var o=new y.CacheRequest({method:y.RequestMethod.GET,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:i,timeout:n.timeout,client:r.client,tag:r.tag});return o.execute().then(function(e){return e.data})})}},{key:"count",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this.find(t,r).then(function(e){return e.length})}},{key:"addCreateOperation",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this.addOperation(k.Create,t,r)}},{key:"addUpdateOperation",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this.addOperation(k.Update,t,r)}},{key:"addDeleteOperation",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this.addOperation(k.Delete,t,r)}},{key:"addOperation",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:k.Create;var r=this;var n=arguments[1];var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var u=false;if(!(0,l.default)(n)){u=true;n=[n]}return o.default.all((0,a.default)(n,function(e){if(!e){return o.default.resolve(null)}var n=e._id;if(!n){return o.default.reject(new b.SyncError("An entity is missing an _id. All entities must have an _id in order to be "+"added to the sync table.",e))}var u=(new _.Query).equalTo("entityId",n);var a=new y.CacheRequest({method:y.RequestMethod.GET,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:i.properties,query:u,timeout:i.timeout,tag:r.tag});return a.execute().then(function(e){return e.data}).then(function(e){var o=e.length===1?e[0]:{collection:r.collection,state:{},entityId:n};o.state=o.state||{};o.state.operation=t;var u=new y.CacheRequest({method:y.RequestMethod.PUT,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:i.properties,body:o,timeout:i.timeout,tag:r.tag});return u.execute()})})).then(function(){if(u===true){return n[0]}return n})}},{key:"pull",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(t&&!(t instanceof _.Query)){return o.default.reject(new b.SyncError("Invalid query. It must be an instance of the Query class."))}return this.count(t).then(function(e){if(e>0){return r.push(t).then(function(){return r.count(t)})}return e}).then(function(e){if(e>0){throw new b.SyncError("Unable to pull data from the network."+(" There are "+e+" entities that need")+" to be synced before data is loaded from the network.")}var i={method:y.RequestMethod.GET,authType:y.AuthType.Default,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.backendPathname}),properties:n.properties,query:t,timeout:n.timeout,client:r.client,tag:r.tag};var o=new y.KinveyRequest(i);if(n.useDeltaFetch===true){o=new y.DeltaFetchRequest(i)}return o.execute()}).then(function(e){return e.data})}},{key:"push",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=100;var u=0;if(E.get(this.collection)===true){return o.default.reject(new b.SyncError("Data is already being pushed to the backend."+" Please wait for it to complete before pushing new data to the backend."))}E.set(this.collection,true);return this.find(t).then(function(e){if(e.length>0){var t=function t(s){var c=new o.default(function(c){var f=e.slice(u,u+i);u+=i;return o.default.all((0,a.default)(f,function(e){var t=e.entityId,i=e.state,o=i===undefined?{}:i;var u=o.operation||o.method;if(u===k.Delete){var a=new y.KinveyRequest({method:y.RequestMethod.DELETE,authType:y.AuthType.Default,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.backendPathname+"/"+t}),properties:n.properties,timeout:n.timeout,client:r.client,tag:r.tag});return a.execute().then(function(){var t=new y.CacheRequest({method:y.RequestMethod.DELETE,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout,tag:r.tag});return t.execute()}).then(function(){var e={_id:t,operation:u};return e}).catch(function(e){var r={_id:t,operation:u,error:e};return r})}else if(u===k.Create||u===k.Update){var s=false;var c=new y.CacheRequest({method:y.RequestMethod.GET,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.backendPathname+"/"+t}),properties:n.properties,timeout:n.timeout,tag:r.tag});return c.execute().then(function(e){return e.data}).then(function(i){var o=new y.KinveyRequest({method:y.RequestMethod.PUT,authType:y.AuthType.Default,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.backendPathname+"/"+t}),properties:n.properties,timeout:n.timeout,body:i,client:r.client});if(u===k.Create){if((0,g.isDefined)(i._kmd)&&i._kmd.local===true){s=true;delete i._id}o.method=y.RequestMethod.POST;o.url=v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.backendPathname})}return o.execute().then(function(e){return e.data}).then(function(i){var o=new y.CacheRequest({method:y.RequestMethod.DELETE,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout,tag:r.tag});return o.execute().then(function(){var e=new y.CacheRequest({method:y.RequestMethod.PUT,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.backendPathname+"/"+i._id}),properties:n.properties,timeout:n.timeout,body:i,tag:r.tag});return e.execute().then(function(e){return e.data})}).then(function(e){if(s){var i=new y.CacheRequest({method:y.RequestMethod.DELETE,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.backendPathname+"/"+t}),properties:n.properties,timeout:n.timeout,tag:r.tag});return i.execute().then(function(){return e})}return e}).then(function(e){var r={_id:t,operation:u,entity:e};return r})}).catch(function(e){i._id=t;var r={_id:t,operation:u,entity:i,error:e};return r})}).catch(function(e){var r={_id:t,operation:u,entity:undefined,error:e};return r})}return{_id:t,operation:u,entity:undefined,error:new b.SyncError("Unable to sync the entity since the operation was not recognized.",e)}})).then(function(r){s=s.concat(r);if(u<e.length){return c(t(s))}return c(s)})});return c};return t([])}return[]}).then(function(e){E.set(r.collection,false);return e}).catch(function(e){E.set(r.collection,false);throw e})}},{key:"clear",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this.find(t,n).then(function(e){return o.default.all((0,a.default)(e,function(e){var t=new y.CacheRequest({method:y.RequestMethod.DELETE,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+e._id}),properties:n.properties,timeout:n.timeout,tag:r.tag});return t.execute().then(function(e){return e.data})}))})}},{key:"pathname",get:function e(){return"/appdata/"+this.client.appKey+"/kinvey_sync"}},{key:"backendPathname",get:function e(){return"/appdata/"+this.client.appKey+"/"+this.collection}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SyncStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(11);var o=d(i);var u=r(7);var a=r(1);var s=r(12);var c=r(27);var f=r(2);var l=r(36);var h=r(83);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function y(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var b=t.SyncStore=function(e){y(t,e);function t(){p(this,t);return v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"find",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=l.KinveyObservable.create(function(e){if(t&&!(t instanceof s.Query)){return e.error(new a.KinveyError("Invalid query. It must be an instance of the Query class."))}var i=new u.CacheRequest({method:u.RequestMethod.GET,url:o.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:t,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i}},{key:"findById",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=l.KinveyObservable.create(function(e){try{if((0,f.isDefined)(t)===false){e.next(undefined);return e.complete()}var i=new u.CacheRequest({method:u.RequestMethod.GET,url:o.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t}),properties:n.properties,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})}catch(t){return e.error(t)}});return i}},{key:"group",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=l.KinveyObservable.create(function(e){if(!(t instanceof c.Aggregation)){return e.error(new a.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))}var i=new u.CacheRequest({method:u.RequestMethod.POST,url:o.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/_group"}),properties:n.properties,aggregation:t,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i}},{key:"count",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=l.KinveyObservable.create(function(e){try{if(t&&!(t instanceof s.Query)){throw new a.KinveyError("Invalid query. It must be an instance of the Query class.")}var i=new u.CacheRequest({method:u.RequestMethod.GET,url:o.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:t,timeout:n.timeout,tag:r.tag});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t?t.length:0)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})}catch(t){return e.error(t)}});return i}},{key:"syncAutomatically",get:function e(){return false}}]);return t}(h.CacheStore)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Acl=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(32);var o=h(i);var u=r(4);var a=h(u);var s=r(17);var c=h(s);var f=r(1);var l=r(2);function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var p=t.Acl=function(){function e(t){d(this,e);if((0,o.default)(t)===false){throw new f.KinveyError("entity argument must be an object")}t._acl=t._acl||{};this.entity=t}n(e,[{key:"addReader",value:function e(t){var r=this.readers;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.r=r;return this}},{key:"addReaderGroup",value:function e(t){var r=this.readerGroups;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{r:r});return this}},{key:"addWriter",value:function e(t){var r=this.writers;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.w=r;return this}},{key:"addWriterGroup",value:function e(t){var r=this.writerGroups;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{w:r});return this}},{key:"isGloballyReadable",value:function e(){if(this.entity._acl.gr===true){return this.entity._acl.gr}return false}},{key:"isGloballyWritable",value:function e(){if(this.entity._acl.gw===true){return this.entity._acl.gw}return false}},{key:"removeReader",value:function e(t){var r=this.readers;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.r=r;return this}},{key:"removeReaderGroup",value:function e(t){var r=this.readerGroups;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{r:r});return this}},{key:"removeWriter",value:function e(t){var r=this.writers;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.w=r;return this}},{key:"removeWriterGroup",value:function e(t){var r=this.writerGroups;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{w:r});return this}},{key:"toPlainObject",value:function e(){return this.entity._acl}},{key:"creator",get:function e(){return this.entity._acl.creator}},{key:"readers",get:function e(){return(0,a.default)(this.entity._acl.r)?this.entity._acl.r:[]}},{key:"writers",get:function e(){return(0,a.default)(this.entity._acl.w)?this.entity._acl.w:[]}},{key:"readerGroups",get:function e(){return(0,l.isDefined)(this.entity._acl.groups)&&(0,a.default)(this.entity._acl.groups.r)?this.entity._acl.groups.r:[]}},{key:"writerGroups",get:function e(){return(0,l.isDefined)(this.entity._acl.groups)&&(0,a.default)(this.entity._acl.groups.w)?this.entity._acl.groups.w:[]}},{key:"globallyReadable",set:function e(t){if(t===true){this.entity._acl.gr=t}else{this.entity._acl.gr=false}}},{key:"globallyWritable",set:function e(t){if(t===true){this.entity._acl.gw=t}else{this.entity._acl.gw=false}}}]);return e}()},function(e,t,r){"use strict";function n(e){for(var r in e)if(!t.hasOwnProperty(r))t[r]=e[r]}Object.defineProperty(t,"__esModule",{value:true});n(r(91));var i=r(91);t.Kinvey=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MobileIdentityConnect=t.AuthorizationGrant=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=g(i);var u=r(8);var a=g(u);var s=r(11);var c=g(s);var f=r(154);var l=g(f);var h=r(7);var d=r(1);var p=r(2);var v=r(316);var y=r(317);var b=r(92);function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function w(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var O=v.Popup;var E=t.AuthorizationGrant={AuthorizationCodeLoginPage:"AuthorizationCodeLoginPage",AuthorizationCodeAPI:"AuthorizationCodeAPI"};Object.freeze(E);var k=t.MobileIdentityConnect=function(e){w(t,e);function t(){m(this,t);return _(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"isSupported",value:function e(){return true}},{key:"login",value:function e(r){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:E.AuthorizationCodeLoginPage;var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=this.client.appKey;if((0,a.default)(u.micId)){s=s+"."+u.micId}var c=o.default.resolve().then(function(){if(i===E.AuthorizationCodeLoginPage){return n.requestCodeWithPopup(s,r,u)}else if(i===E.AuthorizationCodeAPI){return n.requestTempLoginUrl(s,r,u).then(function(e){return n.requestCodeWithUrl(e,s,r,u)})}throw new d.KinveyError("The authorization grant "+i+" is unsupported. "+"Please use a supported authorization grant.")}).then(function(e){return n.requestToken(e,s,r,u)}).then(function(e){e.identity=t.identity;e.client_id=s;e.redirect_uri=r;e.protocol=n.client.micProtocol;e.host=n.client.micHost;return e});return c}},{key:"refresh",value:function e(r,n,i){var u=this;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};return o.default.resolve().then(function(){return u.refreshToken(r,n,i,a)}).then(function(e){e.identity=t.identity;e.client_id=n;e.redirect_uri=i;e.protocol=u.client.micProtocol;e.host=u.client.micHost;return e})}},{key:"requestTempLoginUrl",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i="/oauth/auth";if(n.version){var o=n.version;if((0,a.default)(o)===false){o=String(o)}i=(0,l.default)(o.indexOf("v")===0?o:"v"+o,i)}var u=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:c.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:i}),properties:n.properties,body:{client_id:t,redirect_uri:r,response_type:"code"}});return u.execute().then(function(e){return e.data.temp_login_uri})}},{key:"requestCodeWithPopup",value:function e(t,r){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var u=o.default.resolve().then(function(){var e="/oauth/auth";var o=new O;if(i.version){var u=i.version;if(!(0,a.default)(u)){u=String(u)}e=(0,l.default)(u.indexOf("v")===0?u:"v"+u,e)}return o.open(c.default.format({protocol:n.client.micProtocol,host:n.client.micHost,pathname:e,query:{client_id:t,redirect_uri:r,response_type:"code"}}))}).then(function(e){var t=new o.default(function(t,n){var i=false;function o(n){try{if(n.url&&n.url.indexOf(r)===0&&i===false){i=true;e.removeAllListeners();e.close();t(c.default.parse(n.url,true).query.code)}}catch(e){}}function u(o){try{if(o.url&&o.url.indexOf(r)===0&&i===false){i=true;e.removeAllListeners();e.close();t(c.default.parse(o.url,true).query.code)}else if(i===false){e.removeAllListeners();e.close();n(new d.KinveyError(o.message,"",o.code))}}catch(e){}}function a(){if(i===false){e.removeAllListeners();n(new d.KinveyError("Login has been cancelled."))}}e.on("loadstart",o);e.on("loadstop",o);e.on("error",u);e.on("exit",a)});return t});return u}},{key:"requestCodeWithUrl",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var u=o.default.resolve().then(function(){var e=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:t,properties:i.properties,body:{client_id:r,redirect_uri:n,response_type:"code",username:i.username,password:i.password},followRedirect:false});return e.execute()}).then(function(e){var t=e.headers.get("location");if(t){return c.default.parse(t,true).query.code}throw new d.MobileIdentityConnectError("Unable to authorize user with username "+i.username+".","A location header was not provided with a code to exchange for an auth token.")});return u}},{key:"requestToken",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var o=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:h.AuthType.App,url:c.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),properties:i.properties,body:{grant_type:"authorization_code",client_id:r,redirect_uri:n,code:t}});return o.execute().then(function(e){return e.data})}},{key:"refreshToken",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var o=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:h.AuthType.App,url:c.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:r,redirect_uri:n,refresh_token:t},properties:i.properties,timeout:i.timeout});return o.execute().then(function(e){return e.data})}},{key:"logout",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new h.KinveyRequest({method:h.RequestMethod.GET,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:h.AuthType.App,url:c.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/invalidate",query:{user:t._id}}),properties:r.properties});return n.execute().then(function(e){return e.data})}},{key:"identity",get:function e(){return b.SocialIdentity.MobileIdentityConnect}}],[{key:"isSupported",value:function e(){return true}},{key:"usePopupClass",value:function e(t){if((0,p.isDefined)(t)){O=t}}},{key:"identity",get:function e(){return b.SocialIdentity.MobileIdentityConnect}}]);return t}(y.Identity)},function(e,t){var r=e.exports={};var n;var i;function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=o}}catch(e){n=o}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=u}}catch(e){i=u}})();function a(e){if(n===setTimeout){return setTimeout(e,0)}if((n===o||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function s(e){if(i===clearTimeout){return clearTimeout(e)}if((i===u||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var c=[];var f=false;var l;var h=-1;function d(){if(!f||!l){return}f=false;if(l.length){c=l.concat(c)}else{h=-1}if(c.length){p()}}function p(){if(f){return}var e=a(d);f=true;var t=c.length;while(t){l=c;c=[];while(++h<t){if(l){l[h].run()}}h=-1;t=c.length}l=null;f=false;s(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}c.push(new v(e,t));if(c.length===1&&!f){a(p)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function y(){}r.on=y;r.addListener=y;r.once=y;r.off=y;r.removeListener=y;r.removeAllListeners=y;r.emit=y;r.prependListener=y;r.prependOnceListener=y;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t){},function(e,t,r){var n=r(26);var i=Object.prototype;var o=i.hasOwnProperty;var u=i.toString;var a=n?n.toStringTag:undefined;function s(e){var t=o.call(e,a),r=e[a];try{e[a]=undefined;var n=true}catch(e){}var i=u.call(e);if(n){if(t){e[a]=r}else{delete e[a]}}return i}e.exports=s},function(e,t){var r=Object.prototype;var n=r.toString;function i(e){return n.call(e)}e.exports=i},function(e,t,r){(function(e,n){var i;(function(o){var u=typeof t=="object"&&t&&!t.nodeType&&t;var a=typeof e=="object"&&e&&!e.nodeType&&e;var s=typeof n=="object"&&n;if(s.global===s||s.window===s||s.self===s){o=s}var c,f=2147483647,l=36,h=1,d=26,p=38,v=700,y=72,b=128,g="-",m=/^xn--/,_=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=l-h,k=Math.floor,P=String.fromCharCode,j;function S(e){throw new RangeError(O[e])}function A(e,t){var r=e.length;var n=[];while(r--){n[r]=t(e[r])}return n}function T(e,t){var r=e.split("@");var n="";if(r.length>1){n=r[0]+"@";e=r[1]}e=e.replace(w,".");var i=e.split(".");var o=A(i,t).join(".");return n+o}function x(e){var t=[],r=0,n=e.length,i,o;while(r<n){i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){o=e.charCodeAt(r++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);r--}}else{t.push(i)}}return t}function C(e){return A(e,function(e){var t="";if(e>65535){e-=65536;t+=P(e>>>10&1023|55296);e=56320|e&1023}t+=P(e);return t}).join("")}function M(e){if(e-48<10){return e-22}if(e-65<26){return e-65}if(e-97<26){return e-97}return l}function R(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function I(e,t,r){var n=0;e=r?k(e/v):e>>1;e+=k(e/t);for(;e>E*d>>1;n+=l){e=k(e/E)}return k(n+(E+1)*e/(e+p))}function q(e){var t=[],r=e.length,n,i=0,o=b,u=y,a,s,c,p,v,m,_,w,O;a=e.lastIndexOf(g);if(a<0){a=0}for(s=0;s<a;++s){if(e.charCodeAt(s)>=128){S("not-basic")}t.push(e.charCodeAt(s))}for(c=a>0?a+1:0;c<r;){for(p=i,v=1,m=l;;m+=l){if(c>=r){S("invalid-input")}_=M(e.charCodeAt(c++));if(_>=l||_>k((f-i)/v)){S("overflow")}i+=_*v;w=m<=u?h:m>=u+d?d:m-u;if(_<w){break}O=l-w;if(v>k(f/O)){S("overflow")}v*=O}n=t.length+1;u=I(i-p,n,p==0);if(k(i/n)>f-o){S("overflow")}o+=k(i/n);i%=n;t.splice(i++,0,o)}return C(t)}function U(e){var t,r,n,i,o,u,a,s,c,p,v,m=[],_,w,O,E;e=x(e);_=e.length;t=b;r=0;o=y;for(u=0;u<_;++u){v=e[u];if(v<128){m.push(P(v))}}n=i=m.length;if(i){m.push(g)}while(n<_){for(a=f,u=0;u<_;++u){v=e[u];if(v>=t&&v<a){a=v}}w=n+1;if(a-t>k((f-r)/w)){S("overflow")}r+=(a-t)*w;t=a;for(u=0;u<_;++u){v=e[u];if(v<t&&++r>f){S("overflow")}if(v==t){for(s=r,c=l;;c+=l){p=c<=o?h:c>=o+d?d:c-o;if(s<p){break}E=s-p;O=l-p;m.push(P(R(p+E%O,0)));s=k(E/O)}m.push(P(R(s,0)));o=I(r,w,n==i);r=0;++n}}++r;++t}return m.join("")}function D(e){return T(e,function(e){return m.test(e)?q(e.slice(4).toLowerCase()):e})}function K(e){return T(e,function(e){return _.test(e)?"xn--"+U(e):e})}c={version:"1.4.1",ucs2:{decode:x,encode:C},decode:q,encode:U,toASCII:K,toUnicode:D};if(true){!(i=function(){return c}.call(t,r,t,e),i!==undefined&&(e.exports=i))}else if(u&&a){if(e.exports==u){a.exports=c}else{for(j in c){c.hasOwnProperty(j)&&(u[j]=c[j])}}}else{o.punycode=c}})(this)}).call(t,r(37)(e),r(18))},function(e,t,r){"use strict";e.exports={isString:function(e){return typeof e==="string"},isObject:function(e){return typeof e==="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}},function(e,t,r){"use strict";t.decode=t.parse=r(152);t.encode=t.stringify=r(153)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&";r=r||"=";var u={};if(typeof e!=="string"||e.length===0){return u}var a=/\+/g;e=e.split(t);var s=1e3;if(o&&typeof o.maxKeys==="number"){s=o.maxKeys}var c=e.length;if(s>0&&c>s){c=s}for(var f=0;f<c;++f){var l=e[f].replace(a,"%20"),h=l.indexOf(r),d,p,v,y;if(h>=0){d=l.substr(0,h);p=l.substr(h+1)}else{d=l;p=""}v=decodeURIComponent(d);y=decodeURIComponent(p);if(!n(u,v)){u[v]=y}else if(i(u[v])){u[v].push(y)}else{u[v]=[u[v],y]}}return u};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){t=t||"&";r=r||"=";if(e===null){e=undefined}if(typeof e==="object"){return o(u(e),function(u){var a=encodeURIComponent(n(u))+r;if(i(e[u])){return o(e[u],function(e){return a+encodeURIComponent(n(e))}).join(t)}else{return a+encodeURIComponent(n(e[u]))}}).join(t)}if(!a)return"";return encodeURIComponent(n(a))+r+encodeURIComponent(n(e))};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function o(e,t){if(e.map)return e.map(t);var r=[];for(var n=0;n<e.length;n++){r.push(t(e[n],n))}return r}var u=Object.keys||function(e){var t=[];for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t.push(r)}return t}},function(e,t,r){var n,i;(function(o,u,a){if(typeof e!=="undefined"&&e.exports)e.exports=a();else if(true)!(n=a,i=typeof n==="function"?n.call(t,r,t,e):n,i!==undefined&&(e.exports=i));else u[o]=a()})("urljoin",this,function(){function e(e,t){return e.substr(0,t.length)===t}function t(t,r){if(e(t,"file://")){t=t.replace(/(\/{0,3})\/*/g,"$1")}else{t=t.replace(/:\//g,"://");t=t.replace(/([^:\s\%\3\A])\/+/g,"$1/")}t=t.replace(/\/(\?|&|#[^!])/g,"$1");t=t.replace(/(\?.+)\?/g,"$1&");return t}return function(){var e=arguments;var r={};if(typeof arguments[0]==="object"){e=arguments[0];r=arguments[1]||{}}var n=[].slice.call(e,0).join("/");return t(n,r)}})},function(e,t,r){var n=r(59),i=r(97),o=r(62),u=r(182),a=r(189),s=r(192),c=r(193),f=r(194),l=r(196),h=r(105),d=r(197),p=r(69),v=r(202),y=r(203),b=r(212),g=r(4),m=r(43),_=r(14),w=r(21);var O=1,E=2,k=4;var P="[object Arguments]",j="[object Array]",S="[object Boolean]",A="[object Date]",T="[object Error]",x="[object Function]",C="[object GeneratorFunction]",M="[object Map]",R="[object Number]",I="[object Object]",q="[object RegExp]",U="[object Set]",D="[object String]",K="[object Symbol]",N="[object WeakMap]";var L="[object ArrayBuffer]",B="[object DataView]",F="[object Float32Array]",H="[object Float64Array]",G="[object Int8Array]",z="[object Int16Array]",V="[object Int32Array]",Q="[object Uint8Array]",$="[object Uint8ClampedArray]",W="[object Uint16Array]",Y="[object Uint32Array]";var J={};J[P]=J[j]=J[L]=J[B]=J[S]=J[A]=J[F]=J[H]=J[G]=J[z]=J[V]=J[M]=J[R]=J[I]=J[q]=J[U]=J[D]=J[K]=J[Q]=J[$]=J[W]=J[Y]=true;J[T]=J[x]=J[N]=false;function X(e,t,r,j,S,A){var T,M=t&O,R=t&E,q=t&k;if(r){T=S?r(e,j,S,A):r(e)}if(T!==undefined){return T}if(!_(e)){return e}var U=g(e);if(U){T=v(e);if(!M){return c(e,T)}}else{var D=p(e),K=D==x||D==C;if(m(e)){return s(e,M)}if(D==I||D==P||K&&!S){T=R||K?{}:b(e);if(!M){return R?l(e,a(T,e)):f(e,u(T,e))}}else{if(!J[D]){return S?e:{}}T=y(e,D,X,M)}}A||(A=new n);var N=A.get(e);if(N){return N}A.set(e,T);var L=q?R?d:h:R?keysIn:w;var B=U?undefined:L(e);i(B||e,function(n,i){if(B){i=n;n=e[i]}o(T,i,X(n,t,r,i,e,A))});return T}e.exports=X},function(e,t){function r(){this.__data__=[];this.size=0}e.exports=r},function(e,t,r){var n=r(39);var i=Array.prototype;var o=i.splice;function u(e){var t=this.__data__,r=n(t,e);if(r<0){return false}var i=t.length-1;if(r==i){t.pop()}else{o.call(t,r,1)}--this.size;return true}e.exports=u},function(e,t,r){var n=r(39);function i(e){var t=this.__data__,r=n(t,e);return r<0?undefined:t[r][1]}e.exports=i},function(e,t,r){var n=r(39);function i(e){return n(this.__data__,e)>-1}e.exports=i},function(e,t,r){var n=r(39);function i(e,t){var r=this.__data__,i=n(r,e);if(i<0){++this.size;r.push([e,t])}else{r[i][1]=t}return this}e.exports=i},function(e,t,r){var n=r(38);function i(){this.__data__=new n;this.size=0}e.exports=i},function(e,t){function r(e){var t=this.__data__,r=t["delete"](e);this.size=t.size;return r}e.exports=r},function(e,t){function r(e){return this.__data__.get(e)}e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t,r){var n=r(38),i=r(60),o=r(61);var u=200;function a(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!i||a.length<u-1){a.push([e,t]);this.size=++r.size;return this}r=this.__data__=new o(a)}r.set(e,t);this.size=r.size;return this}e.exports=a},function(e,t,r){var n=r(20),i=r(167),o=r(14),u=r(96);var a=/[\\^$.*+?()[\]{}|]/g;var s=/^\[object .+?Constructor\]$/;var c=Function.prototype,f=Object.prototype;var l=c.toString;var h=f.hasOwnProperty;var d=RegExp("^"+l.call(h).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p(e){if(!o(e)||i(e)){return false}var t=n(e)?d:s;return t.test(u(e))}e.exports=p},function(e,t,r){var n=r(168);var i=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function o(e){return!!i&&i in e}e.exports=o},function(e,t,r){var n=r(13);var i=n["__core-js_shared__"];e.exports=i},function(e,t){function r(e,t){return e==null?undefined:e[t]}e.exports=r},function(e,t,r){var n=r(171),i=r(38),o=r(60);function u(){this.size=0;this.__data__={hash:new n,map:new(o||i),string:new n}}e.exports=u},function(e,t,r){var n=r(172),i=r(173),o=r(174),u=r(175),a=r(176);function s(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n;s.prototype["delete"]=i;s.prototype.get=o;s.prototype.has=u;s.prototype.set=a;e.exports=s},function(e,t,r){var n=r(40);function i(){this.__data__=n?n(null):{};this.size=0}e.exports=i},function(e,t){function r(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}e.exports=r},function(e,t,r){var n=r(40);var i="__lodash_hash_undefined__";var o=Object.prototype;var u=o.hasOwnProperty;function a(e){var t=this.__data__;if(n){var r=t[e];return r===i?undefined:r}return u.call(t,e)?t[e]:undefined}e.exports=a},function(e,t,r){var n=r(40);var i=Object.prototype;var o=i.hasOwnProperty;function u(e){var t=this.__data__;return n?t[e]!==undefined:o.call(t,e)}e.exports=u},function(e,t,r){var n=r(40);var i="__lodash_hash_undefined__";function o(e,t){var r=this.__data__;this.size+=this.has(e)?0:1;r[e]=n&&t===undefined?i:t;return this}e.exports=o},function(e,t,r){var n=r(41);function i(e){var t=n(this,e)["delete"](e);this.size-=t?1:0;return t}e.exports=i},function(e,t){function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}e.exports=r},function(e,t,r){var n=r(41);function i(e){return n(this,e).get(e)}e.exports=i},function(e,t,r){var n=r(41);function i(e){return n(this,e).has(e)}e.exports=i},function(e,t,r){var n=r(41);function i(e,t){var r=n(this,e),i=r.size;r.set(e,t);this.size+=r.size==i?0:1;return this}e.exports=i},function(e,t,r){var n=r(25),i=r(21);function o(e,t){return e&&n(t,i(t),e)}e.exports=o},function(e,t){function r(e,t){var r=-1,n=Array(e);while(++r<e){n[r]=t(r)}return n}e.exports=r},function(e,t,r){var n=r(19),i=r(15);var o="[object Arguments]";function u(e){return i(e)&&n(e)==o}e.exports=u},function(e,t){function r(){return false}e.exports=r},function(e,t,r){var n=r(19),i=r(65),o=r(15);var u="[object Arguments]",a="[object Array]",s="[object Boolean]",c="[object Date]",f="[object Error]",l="[object Function]",h="[object Map]",d="[object Number]",p="[object Object]",v="[object RegExp]",y="[object Set]",b="[object String]",g="[object WeakMap]";var m="[object ArrayBuffer]",_="[object DataView]",w="[object Float32Array]",O="[object Float64Array]",E="[object Int8Array]",k="[object Int16Array]",P="[object Int32Array]",j="[object Uint8Array]",S="[object Uint8ClampedArray]",A="[object Uint16Array]",T="[object Uint32Array]";var x={};x[w]=x[O]=x[E]=x[k]=x[P]=x[j]=x[S]=x[A]=x[T]=true;x[u]=x[a]=x[m]=x[s]=x[_]=x[c]=x[f]=x[l]=x[h]=x[d]=x[p]=x[v]=x[y]=x[b]=x[g]=false;function C(e){return o(e)&&i(e.length)&&!!x[n(e)]}e.exports=C},function(e,t,r){(function(e){var n=r(93);var i=typeof t=="object"&&t&&!t.nodeType&&t;var o=i&&typeof e=="object"&&e&&!e.nodeType&&e;var u=o&&o.exports===i;var a=u&&n.process;var s=function(){try{return a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}).call(t,r(37)(e))},function(e,t,r){var n=r(102);var i=n(Object.keys,Object);e.exports=i},function(e,t,r){var n=r(25),i=r(45);function o(e,t){return e&&n(t,i(t),e)}e.exports=o},function(e,t,r){var n=r(14),i=r(31),o=r(191);var u=Object.prototype;var a=u.hasOwnProperty;function s(e){if(!n(e)){return o(e)}var t=i(e),r=[];for(var u in e){if(!(u=="constructor"&&(t||!a.call(e,u)))){r.push(u)}}return r}e.exports=s},function(e,t){function r(e){var t=[];if(e!=null){for(var r in Object(e)){t.push(r)}}return t}e.exports=r},function(e,t,r){(function(e){var n=r(13);var i=typeof t=="object"&&t&&!t.nodeType&&t;var o=i&&typeof e=="object"&&e&&!e.nodeType&&e;var u=o&&o.exports===i;var a=u?n.Buffer:undefined,s=a?a.allocUnsafe:undefined;function c(e,t){if(t){return e.slice()}var r=e.length,n=s?s(r):new e.constructor(r);e.copy(n);return n}e.exports=c}).call(t,r(37)(e))},function(e,t){function r(e,t){var r=-1,n=e.length;t||(t=Array(n));while(++r<n){t[r]=e[r]}return t}e.exports=r},function(e,t,r){var n=r(25),i=r(66);function o(e,t){return n(e,i(e),t)}e.exports=o},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length,i=0,o=[];while(++r<n){var u=e[r];if(t(u,r,e)){o[i++]=u}}return o}e.exports=r},function(e,t,r){var n=r(25),i=r(104);function o(e,t){return n(e,i(e),t)}e.exports=o},function(e,t,r){var n=r(106),i=r(104),o=r(45);function u(e){return n(e,o,i)}e.exports=u},function(e,t,r){var n=r(24),i=r(13);var o=n(i,"DataView");e.exports=o},function(e,t,r){var n=r(24),i=r(13);var o=n(i,"Promise");e.exports=o},function(e,t,r){var n=r(24),i=r(13);var o=n(i,"Set");e.exports=o},function(e,t,r){var n=r(24),i=r(13);var o=n(i,"WeakMap");e.exports=o},function(e,t){var r=Object.prototype;var n=r.hasOwnProperty;function i(e){var t=e.length,r=e.constructor(t);if(t&&typeof e[0]=="string"&&n.call(e,"index")){r.index=e.index;r.input=e.input}return r}e.exports=i},function(e,t,r){var n=r(70),i=r(204),o=r(205),u=r(207),a=r(208),s=r(210),c=r(211);var f="[object Boolean]",l="[object Date]",h="[object Map]",d="[object Number]",p="[object RegExp]",v="[object Set]",y="[object String]",b="[object Symbol]";var g="[object ArrayBuffer]",m="[object DataView]",_="[object Float32Array]",w="[object Float64Array]",O="[object Int8Array]",E="[object Int16Array]",k="[object Int32Array]",P="[object Uint8Array]",j="[object Uint8ClampedArray]",S="[object Uint16Array]",A="[object Uint32Array]";function T(e,t,r,T){var x=e.constructor;switch(t){case g:return n(e);case f:case l:return new x(+e);case m:return i(e,T);case _:case w:case O:case E:case k:case P:case j:case S:case A:return c(e,T);case h:return o(e,T,r);case d:case y:return new x(e);case p:return u(e);case v:return a(e,T,r);case b:return s(e)}}e.exports=T},function(e,t,r){var n=r(70);function i(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}e.exports=i},function(e,t,r){var n=r(206),i=r(71),o=r(108);var u=1;function a(e,t,r){var a=t?r(o(e),u):o(e);return i(a,n,new e.constructor)}e.exports=a},function(e,t){function r(e,t){e.set(t[0],t[1]);return e}e.exports=r},function(e,t){var r=/\w*$/;function n(e){var t=new e.constructor(e.source,r.exec(e));t.lastIndex=e.lastIndex;return t}e.exports=n},function(e,t,r){var n=r(209),i=r(71),o=r(109);var u=1;function a(e,t,r){var a=t?r(o(e),u):o(e);return i(a,n,new e.constructor)}e.exports=a},function(e,t){function r(e,t){e.add(t);return e}e.exports=r},function(e,t,r){var n=r(26);var i=n?n.prototype:undefined,o=i?i.valueOf:undefined;function u(e){return o?Object(o.call(e)):{}}e.exports=u},function(e,t,r){var n=r(70);function i(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}e.exports=i},function(e,t,r){var n=r(213),i=r(68),o=r(31);function u(e){return typeof e.constructor=="function"&&!o(e)?n(i(e)):{}}e.exports=u},function(e,t,r){var n=r(14);var i=Object.create;var o=function(){function e(){}return function(t){if(!n(t)){return{}}if(i){return i(t)}e.prototype=t;var r=new e;e.prototype=undefined;return r}}();e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ActiveUserError=i;var n=r(0);function i(e,t,r,n){this.name="ActiveUserError";this.message=e||"An active user already exists.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.APIVersionNotAvailableError=i;var n=r(0);function i(e,t,r,n){this.name="APIVersionNotAvailableError";this.message=e||"This API version is not available for your app.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.APIVersionNotImplementedError=i;var n=r(0);function i(e,t,r,n){this.name="APIVersionNotImplementedError";this.message=e||"This API version is not implemented.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AppProblemError=i;var n=r(0);function i(e,t,r,n){this.name="AppProblemError";this.message=e||"There is a problem with this app backend that prevents execution of this operation. Please contact support@kinvey.com for assistance.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BadRequestError=i;var n=r(0);function i(e,t,r,n){this.name="BadRequestError";this.message=e||"Unable to understand request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BLError=i;var n=r(0);function i(e,t,r,n){this.name="BLError";this.message=e||"The Business Logic script did not complete.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CORSDisabledError=i;var n=r(0);function i(e,t,r,n){this.name="CORSDisabledError";this.message=e||"Cross Origin Support is disabled for this application.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DuplicateEndUsersError=i;var n=r(0);function i(e,t,r,n){this.name="DuplicateEndUsersError";this.message=e||"More than one user registered with this username for this application.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureUnavailableError=i;var n=r(0);function i(e,t,r,n){this.name="FeatureUnavailableError";this.message=e||"Requested functionality is unavailable in this API version.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IncompleteRequestBodyError=i;var n=r(0);function i(e,t,r,n){this.name="IncompleteRequestBodyError";this.message=e||"The request body is either missing or incomplete.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IndirectCollectionAccessDisallowedError=i;var n=r(0);function i(e,t,r,n){this.name="IndirectCollectionAccessDisallowedError";this.message=e||"Please use the appropriate API to access this collection for this app backend.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InsufficientCredentialsError=i;var n=r(0);function i(e,t,r,n){this.name="InsufficientCredentialsError";this.message=e||"The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InvalidCredentialsError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidCredentialsError";this.message=e||"Invalid credentials. Please retry your request with correct credentials.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InvalidIdentifierError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidIdentifierError";this.message=e||"One of more identifier names in the request has an invalid format.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InvalidQuerySyntaxError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidQuerySyntaxError";this.message=e||"The query string in the request has an invalid syntax.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JSONParseError=i;var n=r(0);function i(e,t,r,n){this.name="JSONParseError";this.message=e||"Unable to parse the JSON in the request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyInternalErrorRetry=i;var n=r(0);function i(e,t,r,n){this.name="KinveyInternalErrorRetry";this.message=e||"The Kinvey server encountered an unexpected error. Please retry your request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyInternalErrorStop=i;var n=r(0);function i(e,t,r,n){this.name="KinveyInternalErrorStop";this.message=e||"The Kinvey server encountered an unexpected error. Please contact support@kinvey.com for assistance.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyError=i;var n=r(0);function i(e,t,r,n){this.name="KinveyError";this.message=e||"An error occurred.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MissingQueryError=i;var n=r(0);function i(e,t,r,n){this.name="MissingQueryError";this.message=e||"The request is missing a query string.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MissingRequestHeaderError=i;var n=r(0);function i(e,t,r,n){this.name="MissingRequestHeaderError";this.message=e||"The request is missing a required header.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MissingRequestParameterError=i;var n=r(0);function i(e,t,r,n){this.name="MissingRequestParameterError";this.message=e||"A required parameter is missing from the request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MobileIdentityConnectError=i;var n=r(0);function i(e,t,r,n){this.name="MobileIdentityConnectError";this.message=e||"An error has occurred with Mobile Identity Connect.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkConnectionError=i;var n=r(0);function i(e,t,r,n){this.name="NetworkConnectionError";this.message=e||"There was an error connecting to the network.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NoActiveUserError=i;var n=r(0);function i(e,t,r,n){this.name="NoActiveUserError";this.message=e||"There is not an active user.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NoResponseError=i;var n=r(0);function i(e,t,r,n){this.name="NoResponseError";this.message=e||"No response was provided.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NotFoundError=i;var n=r(0);function i(e,t,r,n){this.name="NotFoundError";this.message=e||"The entity was not found.";this.debug=t||undefined;this.code=r||404;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ParameterValueOutOfRangeError=i;var n=r(0);function i(e,t,r,n){this.name="ParameterValueOutOfRangeError";this.message=e||"The value specified for one of the request parameters is out of range.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PopupError=i;var n=r(0);function i(e,t,r,n){this.name="PopupError";this.message=e||"Unable to open a popup on this platform.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryError=i;var n=r(0);function i(e,t,r,n){this.name="QueryError";this.message=e||"An error occurred with the query.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ServerError=i;var n=r(0);function i(e,t,r,n){this.name="ServerError";this.message=e||"An error occurred on the server.";this.debug=t||undefined;this.code=r||500;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StaleRequestError=i;var n=r(0);function i(e,t,r,n){this.name="StaleRequestError";this.message=e||"The time window for this request has expired.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SyncError=i;var n=r(0);function i(e,t,r,n){this.name="SyncError";this.message=e||"An error occurred during sync.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TimeoutError=i;var n=r(0);function i(e,t,r,n){this.name="TimeoutError";this.message=e||"The request timed out.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UserAlreadyExistsError=i;var n=r(0);function i(e,t,r,n){this.name="UserAlreadyExistsError";this.message=e||"This username is already taken. Please retry your request with a different username.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.WritesToCollectionDisallowedError=i;var n=r(0);function i(e,t,r,n){this.name="WritesToCollectionDisallowedError";this.message=e||"This collection is configured to disallow any modifications to an existing entity or creation of new entities.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t){(function(){"use strict";function r(e){return typeof e==="function"}function n(e){return Object.prototype.toString.call(e)==="[object Array]"}function i(e){if(e instanceof Date){return e.getTime()}else if(n(e)){return e.map(i)}else if(e&&typeof e.toJSON==="function"){return e.toJSON()}else{return e}}function o(e,t){return r(e.get)?e.get(t):e[t]}function u(e){return function(t,r){if(!n(r)||!r.length){return e(t,r)}for(var i=0,u=r.length;i<u;i++){if(e(t,o(r,i)))return true}return false}}function a(e){return function(t,r){if(!n(r)||!r.length){return e(t,r)}for(var i=0,u=r.length;i<u;i++){if(!e(t,o(r,i)))return false}return true}}function s(e,t,r,n){return e.v(e.a,t,r,n)}var c={$eq:u(function(e,t){return e(t)}),$ne:a(function(e,t){return!e(t)}),$gt:u(function(e,t){return m.compare(i(t),e)>0}),$gte:u(function(e,t){return m.compare(i(t),e)>=0}),$lt:u(function(e,t){return m.compare(i(t),e)<0}),$lte:u(function(e,t){return m.compare(i(t),e)<=0}),$mod:u(function(e,t){return t%e[0]==e[1]}),$in:function(e,t){if(t instanceof Array){for(var r=t.length;r--;){if(~e.indexOf(i(o(t,r)))){return true}}}else{var n=i(t);if(n===t&&typeof t==="object"){for(var r=e.length;r--;){if(String(e[r])===String(t)&&String(t)!=="[object Object]"){return true}}}if(typeof n=="undefined"){for(var r=e.length;r--;){if(e[r]==null){return true}}}for(var r=e.length;r--;){var u=g(o(e,r),undefined);var a=s(u,t,r,e);if(a&&String(a)!=="[object Object]"&&String(t)!=="[object Object]"){return true}}return!!~e.indexOf(n)}return false},$nin:function(e,t,r,n){return!c.$in(e,t,r,n)},$not:function(e,t,r,n){return!s(e,t,r,n)},$type:function(e,t){return t!=void 0?t instanceof e||t.constructor==e:false},$all:function(e,t,r,n){return c.$and(e,t,r,n)},$size:function(e,t){return t?e===t.length:false},$or:function(e,t,r,n){for(var i=0,u=e.length;i<u;i++)if(s(o(e,i),t,r,n))return true;return false},$nor:function(e,t,r,n){return!c.$or(e,t,r,n)},$and:function(e,t,r,n){for(var i=0,u=e.length;i<u;i++){if(!s(o(e,i),t,r,n)){return false}}return true},$regex:u(function(e,t){return typeof t==="string"&&e.test(t)}),$where:function(e,t,r,n){return e.call(t,t,r,n)},$elemMatch:function(e,t,r,i){if(n(t)){return!!~l(t,e)}return s(e,t,r,i)},$exists:function(e,t,r,n){return n.hasOwnProperty(r)===e}};var f={$eq:function(e){if(e instanceof RegExp){return function(t){return typeof t==="string"&&e.test(t)}}else if(e instanceof Function){return e}else if(n(e)&&!e.length){return function(e){return n(e)&&!e.length}}else if(e===null){return function(e){return e==null}}return function(t){return m.compare(i(t),e)===0}},$ne:function(e){return f.$eq(e)},$and:function(e){return e.map(b)},$all:function(e){return f.$and(e)},$or:function(e){return e.map(b)},$nor:function(e){return e.map(b)},$not:function(e){return b(e)},$regex:function(e,t){return new RegExp(e,t.$options)},$where:function(e){return typeof e==="string"?new Function("obj","return "+e):e},$elemMatch:function(e){return b(e)},$exists:function(e){return!!e}};function l(e,t){for(var r=0;r<e.length;r++){var n=o(e,r);if(s(t,o(e,r))){return r}}return-1}function h(e,t){return{a:e,v:t}}function d(e,t){var r=[];p(t,e.k,0,t,r);if(r.length===1){var n=r[0];return s(e.nv,n[0],n[1],n[2])}for(var i=0;i<r.length;i++){var o=r[i];if(s(e.nv,o[0],o[1],o[2])){return true}}return false}function p(e,t,r,i,u){if(r===t.length||e==void 0){u.push([e,t[r-1],i]);return}var a=o(t,r);if(n(e)&&isNaN(Number(a))){for(var s=0,c=e.length;s<c;s++){p(o(e,s),t,r,e,u)}}else{p(o(e,a),t,r+1,e,u)}}function v(e,t){return{a:{k:e,nv:t},v:d}}function y(e){return e&&e.constructor===Object}function b(e){e=i(e);if(!e||!y(e)){e={$eq:e}}var t=[];for(var r in e){var n=e[r];if(r==="$options"){continue}if(c[r]){if(f[r])n=f[r](n,e);t.push(h(i(n),c[r]))}else{if(r.charCodeAt(0)===36){throw new Error("Unknown operation "+r)}t.push(v(r.split("."),b(n)))}}return t.length===1?t[0]:h(t,c.$and)}function g(e,t){var r=b(e);if(t){r={a:r,v:function(e,r,n,i){return s(e,t(r),n,i)}}}return r}function m(e,t,n){if(r(t)){n=t;t=void 0}var i=g(e,n);function o(e,t,r){return s(i,e,t,r)}if(t){return t.filter(o)}return o}m.use=function(e){if(r(e))return e(m);for(var t in e){if(t.charCodeAt(0)===36){c[t]=e[t]}}};m.indexOf=function(e,t,r){return l(t,g(e,r))};m.compare=function(e,t){if(e===t)return 0;if(typeof e===typeof t){if(e>t){return 1}if(e<t){return-1}}};if(typeof e!=="undefined"&&typeof e.exports!=="undefined"){Object.defineProperty(t,"__esModule",{value:true});e.exports=m;t["default"]=e.exports.default=m}if(typeof window!=="undefined"){window.sift=m}})()},function(e,t){function r(e){return e===null}e.exports=r},function(e,t){function r(e){return e===undefined}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.randomString=i;t.isNonemptyString=o;t.uuidv4=u;function n(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10;var t="";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<e;n+=1){t+=r.charAt(Math.floor(Math.random()*r.length))}return t}function i(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:18;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";return""+t+n(e)}function o(e){return typeof e==="string"&&e!==""}function u(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return""+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.appendQuery=_;var n=r(11);var i=g(n);var o=r(72);var u=g(o);var a=r(17);var s=g(a);var c=r(4);var f=g(c);var l=r(32);var h=g(l);var d=r(8);var p=g(d);var v=r(47);var y=g(v);var b=r(110);function g(e){return e&&e.__esModule?e:{default:e}}function m(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=arguments[2];var n=[];var i=false;if((0,f.default)(e)&&(0,b.isDefined)(r)){i=true}Object.keys(e).forEach(function(o){var u=void 0;var a=e[o];var s=r?r+"["+(i?"":o)+"]":o;if((0,b.isDefined)(a)===false){if(t.removeNull===true){return}u=t.encodeComponents===true?encodeURIComponent(s):s}else if((0,h.default)(a)){u=m(a,t,s)}else{u=t.encodeComponents?encodeURIComponent(s)+"="+encodeURIComponent(a):s+"="+a}n.push(u)});return n.join("&")}function _(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=i.default.parse(e,true);var o=(0,p.default)(t)?u.default.parse(t):t;var a=(0,s.default)({},n.query,o);r=(0,s.default)({encodeComponents:true,removeNull:false},r);n.query=null;var c=m(a,r);n.search=(0,b.isDefined)(c)&&(0,y.default)(c)===false?"?"+c:null;return i.default.format(n)}},function(e,t,r){"use strict";var n=r(111);var i=r(112);var o={brackets:function e(t){return t+"[]"},indices:function e(t,r){return t+"["+r+"]"},repeat:function e(t){return t}};var u=Date.prototype.toISOString;var a={delimiter:"&",encode:true,encoder:n.encode,encodeValuesOnly:false,serializeDate:function e(t){return u.call(t)},skipNulls:false,strictNullHandling:false};var s=function e(t,r,i,o,u,s,c,f,l,h,d,p){var v=t;if(typeof c==="function"){v=c(r,v)}else if(v instanceof Date){v=h(v)}else if(v===null){if(o){return s&&!p?s(r,a.encoder):r}v=""}if(typeof v==="string"||typeof v==="number"||typeof v==="boolean"||n.isBuffer(v)){if(s){var y=p?r:s(r,a.encoder);return[d(y)+"="+d(s(v,a.encoder))]}return[d(r)+"="+d(String(v))]}var b=[];if(typeof v==="undefined"){return b}var g;if(Array.isArray(c)){g=c}else{var m=Object.keys(v);g=f?m.sort(f):m}for(var _=0;_<g.length;++_){var w=g[_];if(u&&v[w]===null){continue}if(Array.isArray(v)){b=b.concat(e(v[w],i(r,w),i,o,u,s,c,f,l,h,d,p))}else{b=b.concat(e(v[w],r+(l?"."+w:"["+w+"]"),i,o,u,s,c,f,l,h,d,p))}}return b};e.exports=function(e,t){var r=e;var u=t?n.assign({},t):{};if(u.encoder!==null&&u.encoder!==undefined&&typeof u.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var c=typeof u.delimiter==="undefined"?a.delimiter:u.delimiter;var f=typeof u.strictNullHandling==="boolean"?u.strictNullHandling:a.strictNullHandling;var l=typeof u.skipNulls==="boolean"?u.skipNulls:a.skipNulls;var h=typeof u.encode==="boolean"?u.encode:a.encode;var d=typeof u.encoder==="function"?u.encoder:a.encoder;var p=typeof u.sort==="function"?u.sort:null;var v=typeof u.allowDots==="undefined"?false:u.allowDots;var y=typeof u.serializeDate==="function"?u.serializeDate:a.serializeDate;var b=typeof u.encodeValuesOnly==="boolean"?u.encodeValuesOnly:a.encodeValuesOnly;if(typeof u.format==="undefined"){u.format=i["default"]}else if(!Object.prototype.hasOwnProperty.call(i.formatters,u.format)){throw new TypeError("Unknown format option provided.")}var g=i.formatters[u.format];var m;var _;if(typeof u.filter==="function"){_=u.filter;r=_("",r)}else if(Array.isArray(u.filter)){_=u.filter;m=_}var w=[];if(typeof r!=="object"||r===null){return""}var O;if(u.arrayFormat in o){O=u.arrayFormat}else if("indices"in u){O=u.indices?"indices":"repeat"}else{O="indices"}var E=o[O];if(!m){m=Object.keys(r)}if(p){m.sort(p)}for(var k=0;k<m.length;++k){var P=m[k];if(l&&r[P]===null){continue}w=w.concat(s(r[P],P,E,f,l,h?d:null,_,p,v,y,g,b))}var j=w.join(c);var S=u.addQueryPrefix===true?"?":"";return j.length>0?S+j:""}},function(e,t,r){"use strict";var n=r(111);var i=Object.prototype.hasOwnProperty;var o={allowDots:false,allowPrototypes:false,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:false,strictNullHandling:false};var u=function e(t,r){var n={};var u=r.ignoreQueryPrefix?t.replace(/^\?/,""):t;var a=r.parameterLimit===Infinity?undefined:r.parameterLimit;var s=u.split(r.delimiter,a);for(var c=0;c<s.length;++c){var f=s[c];var l=f.indexOf("]=");var h=l===-1?f.indexOf("="):l+1;var d,p;if(h===-1){d=r.decoder(f,o.decoder);p=r.strictNullHandling?null:""}else{d=r.decoder(f.slice(0,h),o.decoder);p=r.decoder(f.slice(h+1),o.decoder)}if(i.call(n,d)){n[d]=[].concat(n[d]).concat(p)}else{n[d]=p}}return n};var a=function(e,t,r){var n=t;for(var i=e.length-1;i>=0;--i){var o;var u=e[i];if(u==="[]"){o=[];o=o.concat(n)}else{o=r.plainObjects?Object.create(null):{};var a=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u;var s=parseInt(a,10);if(!isNaN(s)&&u!==a&&String(s)===a&&s>=0&&(r.parseArrays&&s<=r.arrayLimit)){o=[];o[s]=n}else{o[a]=n}}n=o}return n};var s=function e(t,r,n){if(!t){return}var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t;var u=/(\[[^[\]]*])/;var s=/(\[[^[\]]*])/g;var c=u.exec(o);var f=c?o.slice(0,c.index):o;var l=[];if(f){if(!n.plainObjects&&i.call(Object.prototype,f)){if(!n.allowPrototypes){return}}l.push(f)}var h=0;while((c=s.exec(o))!==null&&h<n.depth){h+=1;if(!n.plainObjects&&i.call(Object.prototype,c[1].slice(1,-1))){if(!n.allowPrototypes){return}}l.push(c[1])}if(c){l.push("["+o.slice(c.index)+"]")}return a(l,r,n)};e.exports=function(e,t){var r=t?n.assign({},t):{};if(r.decoder!==null&&r.decoder!==undefined&&typeof r.decoder!=="function"){throw new TypeError("Decoder has to be a function.")}r.ignoreQueryPrefix=r.ignoreQueryPrefix===true;r.delimiter=typeof r.delimiter==="string"||n.isRegExp(r.delimiter)?r.delimiter:o.delimiter;r.depth=typeof r.depth==="number"?r.depth:o.depth;r.arrayLimit=typeof r.arrayLimit==="number"?r.arrayLimit:o.arrayLimit;r.parseArrays=r.parseArrays!==false;r.decoder=typeof r.decoder==="function"?r.decoder:o.decoder;r.allowDots=typeof r.allowDots==="boolean"?r.allowDots:o.allowDots;r.plainObjects=typeof r.plainObjects==="boolean"?r.plainObjects:o.plainObjects;r.allowPrototypes=typeof r.allowPrototypes==="boolean"?r.allowPrototypes:o.allowPrototypes;r.parameterLimit=typeof r.parameterLimit==="number"?r.parameterLimit:o.parameterLimit;r.strictNullHandling=typeof r.strictNullHandling==="boolean"?r.strictNullHandling:o.strictNullHandling;if(e===""||e===null||typeof e==="undefined"){return r.plainObjects?Object.create(null):{}}var i=typeof e==="string"?u(e,r):e;var a=r.plainObjects?Object.create(null):{};var c=Object.keys(i);for(var f=0;f<c.length;++f){var l=c[f];var h=s(l,i[l],r);a=n.merge(a,h,r)}return n.compact(a)}},function(e,t,r){var n=r(113);var i=Math.max;function o(e,t,r){t=i(t===undefined?e.length-1:t,0);return function(){var o=arguments,u=-1,a=i(o.length-t,0),s=Array(a);while(++u<a){s[u]=o[t+u]}u=-1;var c=Array(t+1);while(++u<t){c[u]=o[u]}c[t]=r(s);return n(e,this,c)}}e.exports=o},function(e,t,r){var n=r(259),i=r(261);var o=i(n);e.exports=o},function(e,t,r){var n=r(260),i=r(98),o=r(46);var u=!i?o:function(e,t){return i(e,"toString",{configurable:true,enumerable:false,value:n(t),writable:true})};e.exports=u},function(e,t){function r(e){return function(){return e}}e.exports=r},function(e,t){var r=800,n=16;var i=Date.now;function o(e){var t=0,o=0;return function(){var u=i(),a=n-(u-o);o=u;if(a>0){if(++t>=r){return arguments[0]}}else{t=0}return e.apply(undefined,arguments)}}e.exports=o},function(e,t,r){var n,i;(function(o,u){"use strict";if(true){!(n=u,i=typeof n==="function"?n.call(t,r,t,e):n,i!==undefined&&(e.exports=i))}else if(typeof e==="object"&&e.exports){e.exports=u()}else{o.log=u()}})(this,function(){"use strict";var e=function(){};var t="undefined";var r=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if(typeof r.bind==="function"){return r.bind(e)}else{try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}}function i(r){if(r==="debug"){r="log"}if(typeof console===t){return false}else if(console[r]!==undefined){return n(console,r)}else if(console.log!==undefined){return n(console,"log")}else{return e}}function o(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function u(e,r,n){return function(){if(typeof console!==t){o.call(this,r,n);this[e].apply(this,arguments)}}}function a(e,t,r){return i(e)||u.apply(this,arguments)}function s(e,n,i){var u=this;var s;var c="loglevel";if(e){c+=":"+e}function f(e){var n=(r[e]||"silent").toUpperCase();if(typeof window===t)return;try{window.localStorage[c]=n;return}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}function l(){var e;if(typeof window===t)return;try{e=window.localStorage[c]}catch(e){}if(typeof e===t){try{var r=window.document.cookie;var n=r.indexOf(encodeURIComponent(c)+"=");if(n!==-1){e=/^([^;]+)/.exec(r.slice(n))[1]}}catch(e){}}if(u.levels[e]===undefined){e=undefined}return e}u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5};u.methodFactory=i||a;u.getLevel=function(){return s};u.setLevel=function(r,n){if(typeof r==="string"&&u.levels[r.toUpperCase()]!==undefined){r=u.levels[r.toUpperCase()]}if(typeof r==="number"&&r>=0&&r<=u.levels.SILENT){s=r;if(n!==false){f(r)}o.call(u,r,e);if(typeof console===t&&r<u.levels.SILENT){return"No console available for logging"}}else{throw"log.setLevel() called with invalid level: "+r}};u.setDefaultLevel=function(e){if(!l()){u.setLevel(e,false)}};u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)};u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)};var h=l();if(h==null){h=n==null?"WARN":n}u.setLevel(h,false)}var c=new s;var f={};c.getLogger=function e(t){if(typeof t!=="string"||t===""){throw new TypeError("You must supply a name when creating a logger.")}var r=f[t];if(!r){r=f[t]=new s(t,c.getLevel(),c.methodFactory)}return r};var l=typeof window!==t?window.log:undefined;c.noConflict=function(){if(typeof window!==t&&window.log===c){window.log=l}return c};return c})},function(e,t,r){var n=r(264),i=r(21);function o(e,t){return e&&n(e,t,i)}e.exports=o},function(e,t,r){var n=r(265);var i=n();e.exports=i},function(e,t){function r(e){return function(t,r,n){var i=-1,o=Object(t),u=n(t),a=u.length;while(a--){var s=u[e?a:++i];if(r(o[s],s,o)===false){break}}return t}}e.exports=r},function(e,t,r){var n=r(16);function i(e,t){return function(r,i){if(r==null){return r}if(!n(r)){return e(r,i)}var o=r.length,u=t?o:-1,a=Object(r);while(t?u--:++u<o){if(i(a[u],u,a)===false){break}}return r}}e.exports=i},function(e,t,r){var n=r(46);function i(e){return typeof e=="function"?e:n}e.exports=i},function(e,t,r){var n=r(269),i=r(276),o=r(121);function u(e){var t=i(e);if(t.length==1&&t[0][2]){return o(t[0][0],t[0][1])}return function(r){return r===e||n(r,e,t)}}e.exports=u},function(e,t,r){var n=r(59),i=r(116);var o=1,u=2;function a(e,t,r,a){var s=r.length,c=s,f=!a;if(e==null){return!c}e=Object(e);while(s--){var l=r[s];if(f&&l[2]?l[1]!==e[l[0]]:!(l[0]in e)){return false}}while(++s<c){l=r[s];var h=l[0],d=e[h],p=l[1];if(f&&l[2]){if(d===undefined&&!(h in e)){return false}}else{var v=new n;if(a){var y=a(d,p,h,e,t,v)}if(!(y===undefined?i(p,d,o|u,a,v):y)){return false}}}return true}e.exports=a},function(e,t,r){var n=r(59),i=r(117),o=r(274),u=r(275),a=r(69),s=r(4),c=r(43),f=r(64);var l=1;var h="[object Arguments]",d="[object Array]",p="[object Object]";var v=Object.prototype;var y=v.hasOwnProperty;function b(e,t,r,v,b,g){var m=s(e),_=s(t),w=m?d:a(e),O=_?d:a(t);w=w==h?p:w;O=O==h?p:O;var E=w==p,k=O==p,P=w==O;if(P&&c(e)){if(!c(t)){return false}m=true;E=false}if(P&&!E){g||(g=new n);return m||f(e)?i(e,t,r,v,b,g):o(e,t,w,r,v,b,g)}if(!(r&l)){var j=E&&y.call(e,"__wrapped__"),S=k&&y.call(t,"__wrapped__");if(j||S){var A=j?e.value():e,T=S?t.value():t;g||(g=new n);return b(A,T,r,v,g)}}if(!P){return false}g||(g=new n);return u(e,t,r,v,b,g)}e.exports=b},function(e,t){var r="__lodash_hash_undefined__";function n(e){this.__data__.set(e,r);return this}e.exports=n},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length;while(++r<n){if(t(e[r],r,e)){return true}}return false}e.exports=r},function(e,t,r){var n=r(26),i=r(107),o=r(30),u=r(117),a=r(108),s=r(109);var c=1,f=2;var l="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Map]",v="[object Number]",y="[object RegExp]",b="[object Set]",g="[object String]",m="[object Symbol]";var _="[object ArrayBuffer]",w="[object DataView]";var O=n?n.prototype:undefined,E=O?O.valueOf:undefined;function k(e,t,r,n,O,k,P){switch(r){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case _:if(e.byteLength!=t.byteLength||!k(new i(e),new i(t))){return false}return true;case l:case h:case v:return o(+e,+t);case d:return e.name==t.name&&e.message==t.message;case y:case g:return e==t+"";case p:var j=a;case b:var S=n&c;j||(j=s);if(e.size!=t.size&&!S){return false}var A=P.get(e);if(A){return A==t}n|=f;P.set(e,t);var T=u(j(e),j(t),n,O,k,P);P["delete"](e);return T;case m:if(E){return E.call(e)==E.call(t)}}return false}e.exports=k},function(e,t,r){var n=r(105);var i=1;var o=Object.prototype;var u=o.hasOwnProperty;function a(e,t,r,o,a,s){var c=r&i,f=n(e),l=f.length,h=n(t),d=h.length;if(l!=d&&!c){return false}var p=l;while(p--){var v=f[p];if(!(c?v in t:u.call(t,v))){return false}}var y=s.get(e);if(y&&s.get(t)){return y==t}var b=true;s.set(e,t);s.set(t,e);var g=c;while(++p<l){v=f[p];var m=e[v],_=t[v];if(o){var w=c?o(_,m,v,t,e,s):o(m,_,v,e,t,s)}if(!(w===undefined?m===_||a(m,_,r,o,s):w)){b=false;break}g||(g=v=="constructor")}if(b&&!g){var O=e.constructor,E=t.constructor;if(O!=E&&("constructor"in e&&"constructor"in t)&&!(typeof O=="function"&&O instanceof O&&typeof E=="function"&&E instanceof E)){b=false}}s["delete"](e);s["delete"](t);return b}e.exports=a},function(e,t,r){var n=r(120),i=r(21);function o(e){var t=i(e),r=t.length;while(r--){var o=t[r],u=e[o];t[r]=[o,u,n(u)]}return t}e.exports=o},function(e,t,r){var n=r(116),i=r(278),o=r(284),u=r(79),a=r(120),s=r(121),c=r(28);var f=1,l=2;function h(e,t){if(u(e)&&a(t)){return s(c(e),t)}return function(r){var u=i(r,e);return u===undefined&&u===t?o(r,e):n(t,u,f|l)}}e.exports=h},function(e,t,r){var n=r(78);function i(e,t,r){var i=e==null?undefined:n(e,t);return i===undefined?r:i}e.exports=i},function(e,t,r){var n=r(280);var i=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var u=/\\(\\)?/g;var a=n(function(e){var t=[];if(i.test(e)){t.push("")}e.replace(o,function(e,r,n,i){t.push(n?i.replace(u,"$1"):r||e)});return t});e.exports=a},function(e,t,r){var n=r(281);var i=500;function o(e){var t=n(e,function(e){if(r.size===i){r.clear()}return e});var r=t.cache;return t}e.exports=o},function(e,t,r){var n=r(61);var i="Expected a function";function o(e,t){if(typeof e!="function"||t!=null&&typeof t!="function"){throw new TypeError(i)}var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i)){return o.get(i)}var u=e.apply(this,n);r.cache=o.set(i,u)||o;return u};r.cache=new(o.Cache||n);return r}o.Cache=n;e.exports=o},function(e,t,r){var n=r(283);function i(e){return e==null?"":n(e)}e.exports=i},function(e,t,r){var n=r(26),i=r(53),o=r(4),u=r(52);var a=1/0;var s=n?n.prototype:undefined,c=s?s.toString:undefined;function f(e){if(typeof e=="string"){return e}if(o(e)){return i(e,f)+""}if(u(e)){return c?c.call(e):""}var t=e+"";return t=="0"&&1/e==-a?"-0":t}e.exports=f},function(e,t,r){var n=r(285),i=r(286);function o(e,t){return e!=null&&i(e,t,n)}e.exports=o},function(e,t){function r(e,t){return e!=null&&t in Object(e)}e.exports=r},function(e,t,r){var n=r(51),i=r(42),o=r(4),u=r(44),a=r(65),s=r(28);function c(e,t,r){t=n(t,e);var c=-1,f=t.length,l=false;while(++c<f){var h=s(t[c]);if(!(l=e!=null&&r(e,h))){break}e=e[h]}if(l||++c!=f){return l}f=e==null?0:e.length;return!!f&&a(f)&&u(h,f)&&(o(e)||i(e))}e.exports=c},function(e,t,r){var n=r(288),i=r(289),o=r(79),u=r(28);function a(e){return o(e)?n(u(e)):i(e)}e.exports=a},function(e,t){function r(e){return function(t){return t==null?undefined:t[e]}}e.exports=r},function(e,t,r){var n=r(78);function i(e){return function(t){return n(t,e)}}e.exports=i},function(e,t){function r(e,t,r,n,i){i(e,function(e,i,o){r=n?(n=false,e):t(r,e,i,o)});return r}e.exports=r},function(e,t,r){var n=r(53);function i(e,t){return n(t,function(t){return e[t]})}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CacheMiddleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(47);var o=c(i);var u=r(2);var a=r(35);var s=r(123);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function l(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=t.CacheMiddleware=function(e){h(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Cache Middleware";f(this,t);return l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}n(t,[{key:"loadStorage",value:function e(t,r){return new s.Storage(t,r)}},{key:"handle",value:function e(t){var r=t.method,n=t.body,i=t.appKey,a=t.collection,s=t.entityId,c=t.encryptionKey,f=t.storageProviders;var l=this.loadStorage(i,f,c);var h=void 0;if(r==="GET"){if((0,u.isDefined)(s)){h=l.findById(a,s)}else{h=l.find(a)}}else if(r==="POST"||r==="PUT"){if(s==="_group"){h=l.find(a)}else{h=l.save(a,n)}}else if(r==="DELETE"){if((0,u.isDefined)(a)===false){h=l.clear()}else{h=l.removeById(a,s)}}return h.then(function(e){var t={statusCode:r==="POST"?201:200,data:e};if(r==="POST"&&s==="_group"){t.statusCode=200}if((0,u.isDefined)(e)===false||(0,o.default)(e)){t.statusCode=204}return t}).catch(function(e){return{statusCode:e.code}}).then(function(e){return{response:e}})}}]);return t}(a.Middleware)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=[];var u=String.fromCharCode(9500);var a=String.fromCharCode(9472);var s=String.fromCharCode(9492);var c=String.fromCharCode(9474);function f(e,t){if(e.level===0){return e.value}var r="\r\n";var n=t?s:u;for(var i=1;i<e.level;i+=1){r=""+r+(o[i]?" ":c);r=r+"  "}return""+r+n+a+" "+e.value}var l=t.AsciiTree=function(){function e(){i(this,e)}n(e,null,[{key:"generate",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=arguments[1];var i=f(r,n);if(r.nodes.length>0){var u=r.nodes.length-1;r.nodes.forEach(function(e,r){o[e.level]=r===u;i+=t.generate(e,r===u)})}return i}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Queue=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=function e(){};function c(e){if(e&&typeof e.then==="function"){return e}return o.default.resolve(e)}var f=t.Queue=function(){function e(t,r){a(this,e);this.pendingPromises=0;this.maxPendingPromises=typeof t!=="undefined"?t:Infinity;this.maxQueuedPromises=typeof r!=="undefined"?r:Infinity;this.queue=[]}n(e,[{key:"add",value:function e(t){var r=this;return new o.default(function(e,n,i){if(r.queue.length>=r.maxQueuedPromises){n(new Error("Queue limit reached"));return}r.queue.push({promiseGenerator:t,resolve:e,reject:n,notify:i||s});r._dequeue()})}},{key:"getPendingLength",value:function e(){return this.pendingPromises}},{key:"getQueueLength",value:function e(){return this.queue.length}},{key:"_dequeue",value:function e(){var t=this;if(this.pendingPromises>=this.maxPendingPromises){return false}var r=this.queue.shift();if(!r){return false}try{this.pendingPromises+=1;c(r.promiseGenerator()).then(function(e){t.pendingPromises-=1;r.resolve(e);t._dequeue()},function(e){t.pendingPromises-=1;r.reject(e);t._dequeue()},function(e){r.notify(e)})}catch(e){this.pendingPromises-=1;r.reject(e);this._dequeue()}return true}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MemoryAdapter=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=O(i);var u=r(115);var a=O(u);var s=r(81);var c=O(s);var f=r(48);var l=O(f);var h=r(80);var d=O(h);var p=r(299);var v=O(p);var y=r(8);var b=O(y);var g=r(4);var m=O(g);var _=r(2);var w=r(1);function O(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var k={};var P=function(){function e(t){E(this,e);if(!(0,_.isDefined)(t)){throw new Error("A name for the collection is required to use the memory persistence adapter.",t)}if(!(0,b.default)(t)){throw new Error("The name of the collection must be a string to use the memory persistence adapter",t)}this.name=t;this.cache=k[t];if(!(0,_.isDefined)(this.cache)){this.cache=new a.default;k[t]=this.cache}}n(e,[{key:"find",value:function e(t){try{var r=this.cache.get(t);if(r){return o.default.resolve(JSON.parse(r))}return o.default.resolve([])}catch(e){return o.default.reject(e)}}},{key:"findById",value:function e(t,r){var n=this;return this.find(t).then(function(e){var i=(0,v.default)(e,function(e){return e._id===r});if(!i){return o.default.reject(new w.NotFoundError("An entity with _id = "+r+" was not found in the "+t+(" collection on the "+n.name+" memory database.")))}return i})}},{key:"save",value:function e(t,r){var n=this;var i=false;if(!(0,m.default)(r)){r=[r];i=true}if(r.length===0){return o.default.resolve(r)}return this.find(t).then(function(e){e=(0,c.default)(e,"_id");r=(0,c.default)(r,"_id");var o=Object.keys(r);(0,l.default)(o,function(t){e[t]=r[t]});n.cache.set(t,JSON.stringify((0,d.default)(e)));r=(0,d.default)(r);return i?r[0]:r})}},{key:"removeById",value:function e(t,r){var n=this;return this.find(t).then(function(e){e=(0,c.default)(e,"_id");var i=e[r];if(!(0,_.isDefined)(i)){return o.default.reject(new w.NotFoundError("An entity with _id = "+r+" was not found in the "+t+(" collection on the "+n.name+" memory database.")))}delete e[r];n.cache.set(t,JSON.stringify((0,d.default)(e)));return{count:1}})}},{key:"clear",value:function e(){this.cache.clear();return o.default.resolve(null)}}]);return e}();var j=t.MemoryAdapter={load:function e(t){return o.default.resolve(new P(t))}}},function(e,t,r){var n=r(297),i=r(298),o=r(23),u=r(4);function a(e,t){return function(r,a){var s=u(r)?n:i,c=t?t():{};return s(r,e,o(a,2),c)}}e.exports=a},function(e,t){function r(e,t,r,n){var i=-1,o=e==null?0:e.length;while(++i<o){var u=e[i];t(n,u,r(u),e)}return n}e.exports=r},function(e,t,r){var n=r(33);function i(e,t,r,i){n(e,function(e,n,o){t(i,e,r(e),o)});return i}e.exports=i},function(e,t,r){var n=r(300),i=r(301);var o=n(i);e.exports=o},function(e,t,r){var n=r(23),i=r(16),o=r(21);function u(e){return function(t,r,u){var a=Object(t);if(!i(t)){var s=n(r,3);t=o(t);r=function(e){return s(a[e],e,a)}}var c=e(t,r,u);return c>-1?a[s?t[c]:c]:undefined}}e.exports=u},function(e,t,r){var n=r(124),i=r(23),o=r(302);var u=Math.max;function a(e,t,r){var a=e==null?0:e.length;if(!a){return-1}var s=r==null?0:o(r);if(s<0){s=u(a+s,0)}return n(e,i(t,3),s)}e.exports=a},function(e,t,r){var n=r(303);function i(e){var t=n(e),r=t%1;return t===t?r?t-r:t:0}e.exports=i},function(e,t,r){var n=r(304);var i=1/0,o=1.7976931348623157e308;function u(e){if(!e){return e===0?e:0}e=n(e);if(e===i||e===-i){var t=e<0?-1:1;return t*o}return e===e?e:0}e.exports=u},function(e,t,r){var n=r(14),i=r(52);var o=0/0;var u=/^\s+|\s+$/g;var a=/^[-+]0x[0-9a-f]+$/i;var s=/^0b[01]+$/i;var c=/^0o[0-7]+$/i;var f=parseInt;function l(e){if(typeof e=="number"){return e}if(i(e)){return o}if(n(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=n(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=e.replace(u,"");var r=s.test(e);return r||c.test(e)?f(e.slice(2),r?2:8):a.test(e)?o:+e}e.exports=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HttpMiddleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=s(i);var u=r(1);var a=r(35);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=t.HttpMiddleware=function(e){l(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Http Middleware";c(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}n(t,[{key:"handle",value:function e(){return o.default.reject(new u.KinveyError("Unable to send network request.","Please override the core HttpMiddleware."))}},{key:"cancel",value:function e(){return o.default.resolve()}}]);return t}(a.Middleware)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ParseMiddleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=s(i);var u=r(2);var a=r(35);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=t.ParseMiddleware=function(e){l(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Parse Middleware";c(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}n(t,[{key:"handle",value:function e(t,r){if((0,u.isDefined)(r)&&(0,u.isDefined)(r.data)){var n=r.headers["content-type"]||r.headers["Content-Type"];if(n){if(n.indexOf("application/json")===0){try{r.data=JSON.parse(r.data)}catch(e){}}}}return o.default.resolve({response:r})}}]);return t}(a.Middleware)},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.SerializeMiddleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=s(i);var u=r(2);var a=r(35);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=t.SerializeMiddleware=function(t){l(r,t);function r(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Serialize Middleware";c(this,r);return f(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}n(r,[{key:"handle",value:function t(r){if((0,u.isDefined)(r)&&(0,u.isDefined)(r.body)){var n=r.headers["content-type"]||r.headers["Content-Type"];if((0,u.isDefined)(n)){if(n.indexOf("application/json")===0){r.body=JSON.stringify(r.body)}else if(n.indexOf("application/x-www-form-urlencoded")===0){var i=r.body;var a=[];Object.keys(i).forEach(function(t){a.push(e.encodeURIComponent(t)+"="+e.encodeURIComponent(i[t]))});r.body=a.join("&")}}}return o.default.resolve({request:r})}}]);return r}(a.Middleware)}).call(t,r(18))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DeltaFetchRequest=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n,i){var o=Object.getOwnPropertyDescriptor(t,r);if(o===undefined){var u=Object.getPrototypeOf(t);if(u!==null){e(u,r,n,i)}}else if("value"in o&&o.writable){o.value=n}else{var a=o.set;if(a!==undefined){a.call(i,n)}}return n};var o=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var u=r(6);var a=T(u);var s=r(81);var c=T(s);var f=r(77);var l=T(f);var h=r(125);var d=T(h);var p=r(80);var v=T(p);var y=r(48);var b=T(y);var g=r(4);var m=T(g);var _=r(8);var w=T(_);var O=r(1);var E=r(2);var k=r(12);var P=r(49);var j=r(126);var S=r(94);var A=r(34);function T(e){return e&&e.__esModule?e:{default:e}}function x(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function C(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function M(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var R=200;var I=t.DeltaFetchRequest=function(e){M(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};x(this,t);var r=C(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.tag=e.tag;return r}n(t,[{key:"execute",value:function e(){var t=this;var r=new S.CacheRequest({method:P.RequestMethod.GET,url:this.url,headers:this.headers,query:this.query,timeout:this.timeout,client:this.client,tag:this.tag});return r.execute().then(function(e){return e.data}).catch(function(e){if(!(e instanceof O.NotFoundError)){throw e}return[]}).then(function(e){if((0,m.default)(e)&&e.length>0){var r=(0,c.default)(e,"_id");var n=new k.Query((0,d.default)(t.query,"toJSON",t.query));n.fields=["_id","_kmd.lmt"];var i=new j.KinveyRequest({method:P.RequestMethod.GET,url:t.url,headers:t.headers,authType:t.authType,query:n,timeout:t.timeout,client:t.client,properties:t.properties,skipBL:t.skipBL,trace:t.trace,followRedirect:t.followRedirect,cache:t.cache});return i.execute().then(function(e){return e.data}).then(function(e){var n=(0,c.default)(e,"_id");var i=n;var o=Object.keys(r);(0,b.default)(o,function(e){var t=r[e];var o=n[e];if(o){if((0,E.isDefined)(o._kmd)&&(0,E.isDefined)(t._kmd)&&o._kmd.lmt===t._kmd.lmt){delete i[e]}else{delete r[e]}}else{delete r[e]}});var u=Object.keys(i);var s=[];var f=0;while(f<u.length){var l=new k.Query((0,d.default)(t.query,"toJSON",t.query));var h=u.slice(f,u.length>R+f?R:u.length);l.contains("_id",h);var p=new j.KinveyRequest({method:P.RequestMethod.GET,url:t.url,headers:t.headers,authType:t.authType,query:l,timeout:t.timeout,client:t.client,properties:t.properties,skipBL:t.skipBL,trace:t.trace,followRedirect:t.followRedirect,cache:t.cache});var v=p.execute();s.push(v);f+=R}return a.default.all(s)}).then(function(e){var n=(0,l.default)(e,function(e,t){if(t.isSuccess()){var r=e.headers;r.addAll(t.headers);e.headers=r;e.data=e.data.concat(t.data)}return e},new A.Response({statusCode:A.StatusCode.Ok,data:[]}));n.data=n.data.concat((0,v.default)(r));if(t.query){var i=new k.Query((0,d.default)(t.query,"toJSON",t.query));i.skip=0;i.limit=0;n.data=i.process(n.data)}return n})}var o=new j.KinveyRequest({method:P.RequestMethod.GET,url:t.url,headers:t.headers,authType:t.authType,query:t.query,timeout:t.timeout,client:t.client,properties:t.properties,skipBL:t.skipBL,trace:t.trace,followRedirect:t.followRedirect,cache:t.cache});return o.execute()})}},{key:"method",get:function e(){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",this)},set:function e(r){if(!(0,w.default)(r)){r=String(r)}r=r.toUpperCase();switch(r){case P.RequestMethod.GET:i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",r,this);break;case P.RequestMethod.POST:case P.RequestMethod.PATCH:case P.RequestMethod.PUT:case P.RequestMethod.DELETE:default:throw new O.KinveyError("Invalid request Method. Only RequestMethod.GET is allowed.")}}}]);return t}(j.KinveyRequest)},function(e,t,r){"use strict";(function(e){var n=r(310);var i=r(311);var o=r(312);t.Buffer=c;t.SlowBuffer=m;t.INSPECT_MAX_BYTES=50;c.TYPED_ARRAY_SUPPORT=e.TYPED_ARRAY_SUPPORT!==undefined?e.TYPED_ARRAY_SUPPORT:u();t.kMaxLength=a();function u(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42&&typeof e.subarray==="function"&&e.subarray(1,1).byteLength===0}catch(e){return false}}function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t){throw new RangeError("Invalid typed array length")}if(c.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=c.prototype}else{if(e===null){e=new c(t)}e.length=t}return e}function c(e,t,r){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c)){return new c(e,t,r)}if(typeof e==="number"){if(typeof t==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return d(this,e)}return f(this,e,t,r)}c.poolSize=8192;c._augment=function(e){e.__proto__=c.prototype;return e};function f(e,t,r,n){if(typeof t==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&t instanceof ArrayBuffer){return y(e,t,r,n)}if(typeof t==="string"){return p(e,t,r)}return b(e,t)}c.from=function(e,t,r){return f(null,e,t,r)};if(c.TYPED_ARRAY_SUPPORT){c.prototype.__proto__=Uint8Array.prototype;c.__proto__=Uint8Array;if(typeof Symbol!=="undefined"&&Symbol.species&&c[Symbol.species]===c){Object.defineProperty(c,Symbol.species,{value:null,configurable:true})}}function l(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be a number')}else if(e<0){throw new RangeError('"size" argument must not be negative')}}function h(e,t,r,n){l(t);if(t<=0){return s(e,t)}if(r!==undefined){return typeof n==="string"?s(e,t).fill(r,n):s(e,t).fill(r)}return s(e,t)}c.alloc=function(e,t,r){return h(null,e,t,r)};function d(e,t){l(t);e=s(e,t<0?0:g(t)|0);if(!c.TYPED_ARRAY_SUPPORT){for(var r=0;r<t;++r){e[r]=0}}return e}c.allocUnsafe=function(e){return d(null,e)};c.allocUnsafeSlow=function(e){return d(null,e)};function p(e,t,r){if(typeof r!=="string"||r===""){r="utf8"}if(!c.isEncoding(r)){throw new TypeError('"encoding" must be a valid string encoding')}var n=_(t,r)|0;e=s(e,n);var i=e.write(t,r);if(i!==n){e=e.slice(0,i)}return e}function v(e,t){var r=t.length<0?0:g(t.length)|0;e=s(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function y(e,t,r,n){t.byteLength;if(r<0||t.byteLength<r){throw new RangeError("'offset' is out of bounds")}if(t.byteLength<r+(n||0)){throw new RangeError("'length' is out of bounds")}if(r===undefined&&n===undefined){t=new Uint8Array(t)}else if(n===undefined){t=new Uint8Array(t,r)}else{t=new Uint8Array(t,r,n)}if(c.TYPED_ARRAY_SUPPORT){e=t;e.__proto__=c.prototype}else{e=v(e,t)}return e}function b(e,t){if(c.isBuffer(t)){var r=g(t.length)|0;e=s(e,r);if(e.length===0){return e}t.copy(e,0,0,r);return e}if(t){if(typeof ArrayBuffer!=="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t){if(typeof t.length!=="number"||te(t.length)){return s(e,0)}return v(e,t)}if(t.type==="Buffer"&&o(t.data)){return v(e,t.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function g(e){if(e>=a()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+a().toString(16)+" bytes")}return e|0}function m(e){if(+e!=e){e=0}return c.alloc(+e)}c.isBuffer=function e(t){return!!(t!=null&&t._isBuffer)};c.compare=function e(t,r){if(!c.isBuffer(t)||!c.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(t===r)return 0;var n=t.length;var i=r.length;for(var o=0,u=Math.min(n,i);o<u;++o){if(t[o]!==r[o]){n=t[o];i=r[o];break}}if(n<i)return-1;if(i<n)return 1;return 0};c.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};c.concat=function e(t,r){if(!o(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return c.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var i=c.allocUnsafe(r);var u=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a)){throw new TypeError('"list" argument must be an Array of Buffers')}a.copy(i,u);u+=a.length}return i};function _(e,t){if(c.isBuffer(e)){return e.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){e=""+e}var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Z(e).length;default:if(n)return Y(e).length;t=(""+t).toLowerCase();n=true}}}c.byteLength=_;function w(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return D(this,t,r);case"utf8":case"utf-8":return M(this,t,r);case"ascii":return q(this,t,r);case"latin1":case"binary":return U(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}c.prototype._isBuffer=true;function O(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}c.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){O(this,r,r+1)}return this};c.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){O(this,r,r+3);O(this,r+1,r+2)}return this};c.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){O(this,r,r+7);O(this,r+1,r+6);O(this,r+2,r+5);O(this,r+3,r+4)}return this};c.prototype.toString=function e(){var t=this.length|0;if(t===0)return"";if(arguments.length===0)return M(this,0,t);return w.apply(this,arguments)};c.prototype.equals=function e(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return c.compare(this,t)===0};c.prototype.inspect=function e(){var r="";var n=t.INSPECT_MAX_BYTES;if(this.length>0){r=this.toString("hex",0,n).match(/.{2}/g).join(" ");if(this.length>n)r+=" ... "}return"<Buffer "+r+">"};c.prototype.compare=function e(t,r,n,i,o){if(!c.isBuffer(t)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(i===undefined){i=0}if(o===undefined){o=this.length}if(r<0||n>t.length||i<0||o>this.length){throw new RangeError("out of range index")}if(i>=o&&r>=n){return 0}if(i>=o){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;o>>>=0;if(this===t)return 0;var u=o-i;var a=n-r;var s=Math.min(u,a);var f=this.slice(i,o);var l=t.slice(r,n);for(var h=0;h<s;++h){if(f[h]!==l[h]){u=f[h];a=l[h];break}}if(u<a)return-1;if(a<u)return 1;return 0};function E(e,t,r,n,i){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(isNaN(r)){r=i?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(i)return-1;else r=e.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof t==="string"){t=c.from(t,n)}if(c.isBuffer(t)){if(t.length===0){return-1}return k(e,t,r,n,i)}else if(typeof t==="number"){t=t&255;if(c.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return k(e,[t],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function k(e,t,r,n,i){var o=1;var u=e.length;var a=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}o=2;u/=2;a/=2;r/=2}}function s(e,t){if(o===1){return e[t]}else{return e.readUInt16BE(t*o)}}var c;if(i){var f=-1;for(c=r;c<u;c++){if(s(e,c)===s(t,f===-1?0:c-f)){if(f===-1)f=c;if(c-f+1===a)return f*o}else{if(f!==-1)c-=c-f;f=-1}}}else{if(r+a>u)r=u-a;for(c=r;c>=0;c--){var l=true;for(var h=0;h<a;h++){if(s(e,c+h)!==s(t,h)){l=false;break}}if(l)return c}}return-1}c.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};c.prototype.indexOf=function e(t,r,n){return E(this,t,r,n,true)};c.prototype.lastIndexOf=function e(t,r,n){return E(this,t,r,n,false)};function P(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");if(n>o/2){n=o/2}for(var u=0;u<n;++u){var a=parseInt(t.substr(u*2,2),16);if(isNaN(a))return u;e[r+u]=a}return u}function j(e,t,r,n){return ee(Y(t,e.length-r),e,r,n)}function S(e,t,r,n){return ee(J(t),e,r,n)}function A(e,t,r,n){return S(e,t,r,n)}function T(e,t,r,n){return ee(Z(t),e,r,n)}function x(e,t,r,n){return ee(X(t,e.length-r),e,r,n)}c.prototype.write=function e(t,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r|0;if(isFinite(n)){n=n|0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var o=this.length-r;if(n===undefined||n>o)n=o;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var u=false;for(;;){switch(i){case"hex":return P(this,t,r,n);case"utf8":case"utf-8":return j(this,t,r,n);case"ascii":return S(this,t,r,n);case"latin1":case"binary":return A(this,t,r,n);case"base64":return T(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r,n);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();u=true}}};c.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function M(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var o=e[i];var u=null;var a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var s,c,f,l;switch(a){case 1:if(o<128){u=o}break;case 2:s=e[i+1];if((s&192)===128){l=(o&31)<<6|s&63;if(l>127){u=l}}break;case 3:s=e[i+1];c=e[i+2];if((s&192)===128&&(c&192)===128){l=(o&15)<<12|(s&63)<<6|c&63;if(l>2047&&(l<55296||l>57343)){u=l}}break;case 4:s=e[i+1];c=e[i+2];f=e[i+3];if((s&192)===128&&(c&192)===128&&(f&192)===128){l=(o&15)<<18|(s&63)<<12|(c&63)<<6|f&63;if(l>65535&&l<1114112){u=l}}}}if(u===null){u=65533;a=1}else if(u>65535){u-=65536;n.push(u>>>10&1023|55296);u=56320|u&1023}n.push(u);i+=a}return I(n)}var R=4096;function I(e){var t=e.length;if(t<=R){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=R))}return r}function q(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i]&127)}return n}function U(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i])}return n}function D(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var o=t;o<r;++o){i+=W(e[o])}return i}function K(e,t,r){var n=e.slice(t,r);var i="";for(var o=0;o<n.length;o+=2){i+=String.fromCharCode(n[o]+n[o+1]*256)}return i}c.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var i;if(c.TYPED_ARRAY_SUPPORT){i=this.subarray(t,r);i.__proto__=c.prototype}else{var o=r-t;i=new c(o,undefined);for(var u=0;u<o;++u){i[u]=this[u+t]}}return i};function N(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)N(t,r,this.length);var i=this[t];var o=1;var u=0;while(++u<r&&(o*=256)){i+=this[t+u]*o}return i};c.prototype.readUIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n){N(t,r,this.length)}var i=this[t+--r];var o=1;while(r>0&&(o*=256)){i+=this[t+--r]*o}return i};c.prototype.readUInt8=function e(t,r){if(!r)N(t,1,this.length);return this[t]};c.prototype.readUInt16LE=function e(t,r){if(!r)N(t,2,this.length);return this[t]|this[t+1]<<8};c.prototype.readUInt16BE=function e(t,r){if(!r)N(t,2,this.length);return this[t]<<8|this[t+1]};c.prototype.readUInt32LE=function e(t,r){if(!r)N(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};c.prototype.readUInt32BE=function e(t,r){if(!r)N(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};c.prototype.readIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)N(t,r,this.length);var i=this[t];var o=1;var u=0;while(++u<r&&(o*=256)){i+=this[t+u]*o}o*=128;if(i>=o)i-=Math.pow(2,8*r);return i};c.prototype.readIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n)N(t,r,this.length);var i=r;var o=1;var u=this[t+--i];while(i>0&&(o*=256)){u+=this[t+--i]*o}o*=128;if(u>=o)u-=Math.pow(2,8*r);return u};c.prototype.readInt8=function e(t,r){if(!r)N(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};c.prototype.readInt16LE=function e(t,r){if(!r)N(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};c.prototype.readInt16BE=function e(t,r){if(!r)N(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};c.prototype.readInt32LE=function e(t,r){if(!r)N(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};c.prototype.readInt32BE=function e(t,r){if(!r)N(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};c.prototype.readFloatLE=function e(t,r){if(!r)N(t,4,this.length);return i.read(this,t,true,23,4)};c.prototype.readFloatBE=function e(t,r){if(!r)N(t,4,this.length);return i.read(this,t,false,23,4)};c.prototype.readDoubleLE=function e(t,r){if(!r)N(t,8,this.length);return i.read(this,t,true,52,8)};c.prototype.readDoubleBE=function e(t,r){if(!r)N(t,8,this.length);return i.read(this,t,false,52,8)};function L(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}c.prototype.writeUIntLE=function e(t,r,n,i){t=+t;r=r|0;n=n|0;if(!i){var o=Math.pow(2,8*n)-1;L(this,t,r,n,o,0)}var u=1;var a=0;this[r]=t&255;while(++a<n&&(u*=256)){this[r+a]=t/u&255}return r+n};c.prototype.writeUIntBE=function e(t,r,n,i){t=+t;r=r|0;n=n|0;if(!i){var o=Math.pow(2,8*n)-1;L(this,t,r,n,o,0)}var u=n-1;var a=1;this[r+u]=t&255;while(--u>=0&&(a*=256)){this[r+u]=t/a&255}return r+n};c.prototype.writeUInt8=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,1,255,0);if(!c.TYPED_ARRAY_SUPPORT)t=Math.floor(t);this[r]=t&255;return r+1};function B(e,t,r,n){if(t<0)t=65535+t+1;for(var i=0,o=Math.min(e.length-r,2);i<o;++i){e[r+i]=(t&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}}c.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,65535,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{B(this,t,r,true)}return r+2};c.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,65535,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{B(this,t,r,false)}return r+2};function F(e,t,r,n){if(t<0)t=4294967295+t+1;for(var i=0,o=Math.min(e.length-r,4);i<o;++i){e[r+i]=t>>>(n?i:3-i)*8&255}}c.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,4294967295,0);if(c.TYPED_ARRAY_SUPPORT){this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255}else{F(this,t,r,true)}return r+4};c.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,4294967295,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{F(this,t,r,false)}return r+4};c.prototype.writeIntLE=function e(t,r,n,i){t=+t;r=r|0;if(!i){var o=Math.pow(2,8*n-1);L(this,t,r,n,o-1,-o)}var u=0;var a=1;var s=0;this[r]=t&255;while(++u<n&&(a*=256)){if(t<0&&s===0&&this[r+u-1]!==0){s=1}this[r+u]=(t/a>>0)-s&255}return r+n};c.prototype.writeIntBE=function e(t,r,n,i){t=+t;r=r|0;if(!i){var o=Math.pow(2,8*n-1);L(this,t,r,n,o-1,-o)}var u=n-1;var a=1;var s=0;this[r+u]=t&255;while(--u>=0&&(a*=256)){if(t<0&&s===0&&this[r+u+1]!==0){s=1}this[r+u]=(t/a>>0)-s&255}return r+n};c.prototype.writeInt8=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,1,127,-128);if(!c.TYPED_ARRAY_SUPPORT)t=Math.floor(t);if(t<0)t=255+t+1;this[r]=t&255;return r+1};c.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,32767,-32768);if(c.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{B(this,t,r,true)}return r+2};c.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,32767,-32768);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{B(this,t,r,false)}return r+2};c.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,2147483647,-2147483648);if(c.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24}else{F(this,t,r,true)}return r+4};c.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{F(this,t,r,false)}return r+4};function H(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function G(e,t,r,n,o){if(!o){H(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}i.write(e,t,r,n,23,4);return r+4}c.prototype.writeFloatLE=function e(t,r,n){return G(this,t,r,true,n)};c.prototype.writeFloatBE=function e(t,r,n){return G(this,t,r,false,n)};function z(e,t,r,n,o){if(!o){H(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}i.write(e,t,r,n,52,8);return r+8}c.prototype.writeDoubleLE=function e(t,r,n){return z(this,t,r,true,n)};c.prototype.writeDoubleBE=function e(t,r,n){return z(this,t,r,false,n)};c.prototype.copy=function e(t,r,n,i){if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(t.length-r<i-n){i=t.length-r+n}var o=i-n;var u;if(this===t&&n<r&&r<i){for(u=o-1;u>=0;--u){t[u+r]=this[u+n]}}else if(o<1e3||!c.TYPED_ARRAY_SUPPORT){for(u=0;u<o;++u){t[u+r]=this[u+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,n+o),r)}return o};c.prototype.fill=function e(t,r,n,i){if(typeof t==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(t.length===1){var o=t.charCodeAt(0);if(o<256){t=o}}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!c.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var u;if(typeof t==="number"){for(u=r;u<n;++u){this[u]=t}}else{var a=c.isBuffer(t)?t:Y(new c(t,i).toString());var s=a.length;for(u=0;u<n-r;++u){this[u+r]=a[u%s]}}return this};var V=/[^+\/0-9A-Za-z-_]/g;function Q(e){e=$(e).replace(V,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function $(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function W(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function Y(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var o=[];for(var u=0;u<n;++u){r=e.charCodeAt(u);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)o.push(239,191,189);continue}else if(u+1===n){if((t-=3)>-1)o.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)o.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)o.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return o}function J(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function X(e,t){var r,n,i;var o=[];for(var u=0;u<e.length;++u){if((t-=2)<0)break;r=e.charCodeAt(u);n=r>>8;i=r%256;o.push(i);o.push(n)}return o}function Z(e){return n.toByteArray(Q(e))}function ee(e,t,r,n){for(var i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function te(e){return e!==e}}).call(t,r(18))},function(e,t,r){"use strict";t.byteLength=f;t.toByteArray=l;t.fromByteArray=p;var n=[];var i=[];var o=typeof Uint8Array!=="undefined"?Uint8Array:Array;var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var a=0,s=u.length;a<s;++a){n[a]=u[a];i[u.charCodeAt(a)]=a}i["-".charCodeAt(0)]=62;i["_".charCodeAt(0)]=63;function c(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return e[t-2]==="="?2:e[t-1]==="="?1:0}function f(e){return e.length*3/4-c(e)}function l(e){var t,r,n,u,a;var s=e.length;u=c(e);a=new o(s*3/4-u);r=u>0?s-4:s;var f=0;for(t=0;t<r;t+=4){n=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)];a[f++]=n>>16&255;a[f++]=n>>8&255;a[f++]=n&255}if(u===2){n=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4;a[f++]=n&255}else if(u===1){n=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2;a[f++]=n>>8&255;a[f++]=n&255}return a}function h(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function d(e,t,r){var n;var i=[];for(var o=t;o<r;o+=3){n=(e[o]<<16)+(e[o+1]<<8)+e[o+2];i.push(h(n))}return i.join("")}function p(e){var t;var r=e.length;var i=r%3;var o="";var u=[];var a=16383;for(var s=0,c=r-i;s<c;s+=a){u.push(d(e,s,s+a>c?c:s+a))}if(i===1){t=e[r-1];o+=n[t>>2];o+=n[t<<4&63];o+="=="}else if(i===2){t=(e[r-2]<<8)+e[r-1];o+=n[t>>10];o+=n[t>>4&63];o+=n[t<<2&63];o+="="}u.push(o);return u.join("")}},function(e,t){t.read=function(e,t,r,n,i){var o,u;var a=i*8-n-1;var s=(1<<a)-1;var c=s>>1;var f=-7;var l=r?i-1:0;var h=r?-1:1;var d=e[t+l];l+=h;o=d&(1<<-f)-1;d>>=-f;f+=a;for(;f>0;o=o*256+e[t+l],l+=h,f-=8){}u=o&(1<<-f)-1;o>>=-f;f+=n;for(;f>0;u=u*256+e[t+l],l+=h,f-=8){}if(o===0){o=1-c}else if(o===s){return u?NaN:(d?-1:1)*Infinity}else{u=u+Math.pow(2,n);o=o-c}return(d?-1:1)*u*Math.pow(2,o-n)};t.write=function(e,t,r,n,i,o){var u,a,s;var c=o*8-i-1;var f=(1<<c)-1;var l=f>>1;var h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var d=n?0:o-1;var p=n?1:-1;var v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){a=isNaN(t)?1:0;u=f}else{u=Math.floor(Math.log(t)/Math.LN2);if(t*(s=Math.pow(2,-u))<1){u--;s*=2}if(u+l>=1){t+=h/s}else{t+=h*Math.pow(2,1-l)}if(t*s>=2){u++;s/=2}if(u+l>=f){a=0;u=f}else if(u+l>=1){a=(t*s-1)*Math.pow(2,i);u=u+l}else{a=t*Math.pow(2,l-1)*Math.pow(2,i);u=0}}for(;i>=8;e[r+d]=a&255,d+=p,a/=256,i-=8){}u=u<<i|a;c+=i;for(;c>0;e[r+d]=u&255,d+=p,u/=256,c-=8){}e[r+d-p]|=v*128}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return r.call(e)=="[object Array]"}},function(e,t,r){var n=r(113),i=r(314),o=r(74),u=r(315);var a=o(function(e){e.push(undefined,u);return n(i,undefined,e)});e.exports=a},function(e,t,r){var n=r(25),i=r(73),o=r(45);var u=i(function(e,t,r,i){n(t,o(t),e,i)});e.exports=u},function(e,t,r){var n=r(30);var i=Object.prototype;var o=i.hasOwnProperty;function u(e,t,r,u){if(e===undefined||n(e,i[r])&&!o.call(u,r)){return t}return e}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Popup=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(54);var o=r(1);function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var c=t.Popup=function(e){s(t,e);function t(){u(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"open",value:function e(){throw new o.PopupError("Unable to open a popup on this platform.")}},{key:"close",value:function e(){return this}}],[{key:"isSupported",value:function e(){return false}}]);return t}(i.EventEmitter)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Identity=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(9);var o=r(1);function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=t.Identity=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};u(this,e);this.client=t.client||i.Client.sharedInstance()}n(e,[{key:"isSupported",value:function e(){return false}},{key:"isOnline",value:function e(t){var r=(new Date).getTime()/1e3;return t&&t.access_token&&t.expires>r}},{key:"identity",get:function e(){throw new o.KinveyError("A subclass must override this property.")}}],[{key:"isSupported",value:function e(){return false}},{key:"identity",get:function e(){throw new o.KinveyError("A subclass must override this property.")}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(2);var i=r(1);var o=r(319);var u="sqlite_master";var a;var s=function(){function e(e){if(e===void 0){e="kinvey"}if(n.isDefined(e)===false){throw new Error("A name is required to use the SQLite adapter.")}if(typeof e!=="string"){throw new Error("The name must be a string to use the SQLite adapter")}this.name=e}e.prototype.openTransaction=function(e,t,r,n){if(n===void 0){n=false}var i='"'+e+'"';var a=e===u;var s=Array.isArray(t);t=s?t:[[t,r]];return new o(this.name).then(function(e){e.resultType(o.RESULTSASOBJECT);if(n&&a===false){return e.execSQL("CREATE TABLE IF NOT EXISTS "+i+" (key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)").then(function(){return e})}return e}).then(function(e){var r=[];if(t.length===0){return e.close().then(function(){return s?r:r.shift()})}return t.reduce(function(t,o){var u=o[0].replace("#{collection}",i);return t.then(function(){if(n===false){return e.all(u,o[1])}return e.execSQL(u,o[1])}).then(function(e){if(e===void 0){e=[]}if(n===false&&Array.isArray(e)&&e.length>0){for(var t=0,i=e.length;t<i;t+=1){try{var o=e[t];var u=a?o.value:JSON.parse(o.value);r.push(u)}catch(e){}}}else if(n===true){r.push(e)}return r})},Promise.resolve()).then(function(t){return e.close().then(function(){return t})}).catch(function(t){return e.close().then(function(){throw t})})})};e.prototype.find=function(e){var t="SELECT value FROM #{collection}";return this.openTransaction(e,t,[]).catch(function(){return[]})};e.prototype.findById=function(e,t){var r=this;var n="SELECT value FROM #{collection} WHERE key = ?";return this.openTransaction(e,n,[t]).then(function(n){if(n.length===0){throw new i.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+r.name+" SQLite database."))}return n[0]}).catch(function(){throw new i.NotFoundError("An entity with _id = "+t+" was not found in the "+e+(" collection on the "+r.name+" SQLite database."))})};e.prototype.save=function(e,t){var r=[];var n=false;if(Array.isArray(t)===false){n=true;t=[t]}if(t.length===0){return Promise.resolve(null)}t=t.map(function(e){r.push(["REPLACE INTO #{collection} (key, value) VALUES (?, ?)",[e._id,JSON.stringify(e)]]);return e});return this.openTransaction(e,r,null,true).then(function(){return n?t[0]:t})};e.prototype.removeById=function(e,t){var r=this;var n="DELETE FROM #{collection} WHERE key = ?";return this.openTransaction(e,n,[t],true).then(function(n){var o=n[0];if(o===0){var u="An entity with _id = "+t+" was not found in the "+e+" collection on the "+r.name+" SQLite database.";return Promise.reject(new i.NotFoundError(u))}return{count:o}})};e.prototype.clear=function(){var e=this;return this.openTransaction(u,"SELECT name AS value FROM #{collection} WHERE type = ?",["table"],false).then(function(t){if(t.length===0){return null}var r=t.filter(function(e){return/^[a-zA-Z0-9-]{1,128}/.test(e)}).map(function(e){return["DROP TABLE IF EXISTS '"+e+"'"]});return e.openTransaction(u,r,null,true)}).then(function(){return null})};return e}();t.sqLite={load:function(e){var t=new s(e);if(n.isDefined(o)===false){return Promise.resolve(undefined)}if(n.isDefined(a)){if(a){return Promise.resolve(t)}return Promise.resolve(undefined)}return t.save("__testSupport",{_id:"1"}).then(function(){a=true;return t}).catch(function(){a=false;return undefined})}}},function(e,t){e.exports=require("nativescript-sqlite")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(128);var i=r(129);var o=r(7);function u(e){if(e===void 0){e={}}var t=i.device.os;var r=i.device.osVersion;var n=i.device.manufacturer;var o=["js-"+e.name+"/"+e.version];return o.concat([t,r,n]).map(function(e){if(e){return e.toString().replace(/\s/g,"_").toLowerCase()}return"unknown"}).join(" ")}var a=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.pkg=t;return r}t.prototype.handle=function(e){var t=e.url,r=e.method,i=e.headers,o=e.body,a=e.timeout,s=e.followRedirect;i["X-Kinvey-Device-Information"]=u(this.pkg);var c={method:r,headers:i,url:t,content:o,timeout:a,dontFollowRedirects:!s};return n.request(c).then(function(e){var t=e.content.raw;try{t=e.content.toString()}catch(e){}return{response:{statusCode:e.statusCode,headers:e.headers,data:t}}})};t.prototype.cancel=function(){return Promise.resolve()};return t}(o.Middleware);t.HttpMiddleware=a},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});var n=r(54);var i=r(322);var o=r(323);var u=r(324);var a=r(325);var s=r(326);var c=function(t){__extends(r,t);function r(){var r=t.call(this)||this;return e.__native(r)}r.initWithWebViewAndIntercept=function(e,t){var n=e.createNativeView;e.createNativeView=function(){e._webViewClient=r.initWithView(e,t);var n=new android.webkit.WebView(e._context);n.getSettings().setJavaScriptEnabled(true);n.getSettings().setBuiltInZoomControls(true);n.setWebViewClient(e._webViewClient);n.client=e._webViewClient;return n}};r.initWithView=function(e,t){try{var n=new r;n._view=e;n._origClient=e._webViewClient;n._webViewIntercept=t;return n}catch(e){console.dir(e)}};r.prototype.shouldOverrideUrlLoading=function(e,t){var r="";if(typeof t==="string"){r=t}else if(typeof t==="object"){try{r=t.getUrl().toString()}catch(e){return false}}else{return false}if(this._webViewIntercept(this._view,null,r)){return true}return false};r.prototype.onPageStarted=function(e,r,n){this._webViewIntercept(this._view,null,r);t.prototype.onPageStarted.call(this,e,r,n);if(this._view){this._view._onLoadStarted(r,undefined)}};r.prototype.onPageFinished=function(e,r){t.prototype.onPageFinished.call(this,e,r);if(this._view){this._webViewIntercept(this._view,null,r);this._view._onLoadFinished(r,undefined)}};r.prototype.onReceivedError=function(){var e=arguments[0];if(arguments.length===4){var r=arguments[1];var n=arguments[2];var i=arguments[3];this._webViewIntercept(this._view,null,i);t.prototype.onReceivedError.call(this,e,r,n,i);if(this._view){this._view._onLoadFinished(i,n+"("+r+")")}}else{var o=arguments[1];var u=arguments[2];this._webViewIntercept(this._view,u);t.prototype.onReceivedError.call(this,e,o,u);if(this._view){this._view._onLoadFinished(u.getUrl&&u.getUrl(),u.getDescription()+"("+u.getErrorCode()+")")}}};return r}(android.webkit.WebViewClient);var f=function(){function e(e,t){this._authUrl=e;this._webViewIntercept=t}e.prototype.createWebViewPage=function(){var e=new s.WebView;c.initWithWebViewAndIntercept(e,this._webViewIntercept);var t=new u.GridLayout;t.addChild(e);var r=new a.StackLayout;r.addChild(t);var n=new o.Page;n.content=r;e.src=this._authUrl;return n};return e}();var l=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._open=false;return t}t.prototype.open=function(e){var t=this;if(e===void 0){e="/"}if(this._open===false){var r=function(e,r,n){var i="";try{if(r&&r.userInfo&&r.userInfo.allValues&&r.userInfo.allValues.count>0){var o=r.userInfo.allValues[0];if(o.absoluteString){i=o.absoluteString}else if(o.userInfo&&o.userInfo.allValues&&o.userInfo.allValues.count>0){i=o.userInfo.allValues[0]}else{i=o}}else if(e.request&&e.request.URL&&e.request.URL.absoluteString){i=e.request.URL.absoluteString}else if(n){i=n}}catch(e){}t.emit("loadstop",{url:i});return true};var n=new f(e,r);i.topmost().navigate(function(){return n.createWebViewPage()});this._open=true}return this};t.prototype.close=function(){if(this._open){i.topmost().goBack();this._open=false}return this};return t}(n.EventEmitter);t.Popup=l}).call(t,r(18))},function(e,t){e.exports=require("ui/frame")},function(e,t){e.exports=require("ui/page")},function(e,t){e.exports=require("ui/layouts/grid-layout")},function(e,t){e.exports=require("ui/layouts/stack-layout")},function(e,t){e.exports=require("ui/web-view")},function(e,t){e.exports={private:true,version:"3.9.9",name:"kinvey-nativescript-sdk",description:"Kinvey NativeScript SDK for developing NativeScript applications.",author:"Kinvey, Inc.",homepage:"http://www.kinvey.com",license:"Apache-2.0",main:"kinvey-nativescript-sdk.js",typings:"kinvey.d.ts",dependencies:{"nativescript-sqlite":"~1.1.11",rxjs:"~5.5.5"},scripts:{prebuild:"rm -rf dist",build:"npm run build:android && npm run build:ios","build:android":"webpack --config webpack.config.android.js","build:ios":"webpack --config webpack.config.ios.js",lint:"tslint **/*.ts --exclude **/node_modules/**/* --exclude **/*.d.ts",prerelease:"rm -rf dist",release:"npm run release:android && npm run release:ios && ./scripts/push.sh","release:android":"npm run build:android -- --env.uglify","release:ios":"npm run build:ios -- --env.uglify",postrelease:"rm -rf tmp"},files:["kinvey-nativescript-sdk.ios.js","kinvey-nativescript-sdk.ios.js.map","kinvey-nativescript-sdk.android.js","kinvey-nativescript-sdk.android.js.map","kinvey.d.ts","platforms/android/include.gradle","platforms/ios/Podfile"],nativescript:{platforms:{ios:"3.0.0",android:"3.0.0"}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.WritesToCollectionDisallowedError=t.UserAlreadyExistsError=t.TimeoutError=t.SyncError=t.StaleRequestError=t.ServerError=t.QueryError=t.PopupError=t.ParameterValueOutOfRangeError=t.NotFoundError=t.NoResponseError=t.NetworkConnectionError=t.NoActiveUserError=t.MobileIdentityConnectError=t.MissingRequestParameterError=t.MissingRequestHeaderError=t.MissingQueryError=t.KinveyInternalErrorStop=t.KinveyInternalErrorRetry=t.KinveyError=t.JSONParseError=t.InvalidQuerySyntaxError=t.InvalidIdentifierError=t.InvalidCredentialsError=t.InsufficientCredentialsError=t.IndirectCollectionAccessDisallowedError=t.IncompleteRequestBodyError=t.FeatureUnavailableError=t.DuplicateEndUsersError=t.CORSDisabledError=t.BLError=t.BadRequestError=t.AppProblemError=t.APIVersionNotImplementedError=t.APIVersionNotAvailableError=t.ActiveUserError=t.User=t.StorageProvider=t.Properties=t.Query=t.Metadata=t.Log=t.Files=t.LiveService=t.SyncOperation=t.DataStoreType=t.DataStore=t.CustomEndpoint=t.Client=t.AuthorizationGrant=t.Aggregation=t.Acl=t.ping=t.initialize=t.init=t.setAppVersion=t.getAppVersion=t.client=undefined;var n=r(329);Object.defineProperty(t,"client",{enumerable:true,get:function e(){return n.client}});Object.defineProperty(t,"getAppVersion",{enumerable:true,get:function e(){return n.getAppVersion}});Object.defineProperty(t,"setAppVersion",{enumerable:true,get:function e(){return n.setAppVersion}});Object.defineProperty(t,"init",{enumerable:true,get:function e(){return n.init}});Object.defineProperty(t,"initialize",{enumerable:true,get:function e(){return n.initialize}});Object.defineProperty(t,"ping",{enumerable:true,get:function e(){return n.ping}});var i=r(142);Object.defineProperty(t,"Acl",{enumerable:true,get:function e(){return i.Acl}});var o=r(27);Object.defineProperty(t,"Aggregation",{enumerable:true,get:function e(){return o.Aggregation}});var u=r(58);Object.defineProperty(t,"AuthorizationGrant",{enumerable:true,get:function e(){return u.AuthorizationGrant}});var a=r(9);Object.defineProperty(t,"Client",{enumerable:true,get:function e(){return a.Client}});var s=r(403);Object.defineProperty(t,"CustomEndpoint",{enumerable:true,get:function e(){return s.CustomEndpoint}});var c=r(55);Object.defineProperty(t,"DataStore",{enumerable:true,get:function e(){return c.DataStore}});Object.defineProperty(t,"DataStoreType",{enumerable:true,get:function e(){return c.DataStoreType}});Object.defineProperty(t,"SyncOperation",{enumerable:true,get:function e(){return c.SyncOperation}});var f=r(89);Object.defineProperty(t,"LiveService",{enumerable:true,get:function e(){return f.LiveService}});var l=r(404);Object.defineProperty(t,"Files",{enumerable:true,get:function e(){return l.Files}});var h=r(22);Object.defineProperty(t,"Log",{enumerable:true,get:function e(){return h.Log}});var d=r(85);Object.defineProperty(t,"Metadata",{enumerable:true,get:function e(){return d.Metadata}});var p=r(12);Object.defineProperty(t,"Query",{enumerable:true,get:function e(){return p.Query}});var v=r(7);Object.defineProperty(t,"Properties",{enumerable:true,get:function e(){return v.Properties}});Object.defineProperty(t,"StorageProvider",{enumerable:true,get:function e(){return v.StorageProvider}});var y=r(82);Object.defineProperty(t,"User",{enumerable:true,get:function e(){return y.User}});var b=r(1);Object.defineProperty(t,"ActiveUserError",{enumerable:true,get:function e(){return b.ActiveUserError}});Object.defineProperty(t,"APIVersionNotAvailableError",{enumerable:true,get:function e(){return b.APIVersionNotAvailableError}});Object.defineProperty(t,"APIVersionNotImplementedError",{enumerable:true,get:function e(){return b.APIVersionNotImplementedError}});Object.defineProperty(t,"AppProblemError",{enumerable:true,get:function e(){return b.AppProblemError}});Object.defineProperty(t,"BadRequestError",{enumerable:true,get:function e(){return b.BadRequestError}});Object.defineProperty(t,"BLError",{enumerable:true,get:function e(){return b.BLError}});Object.defineProperty(t,"CORSDisabledError",{enumerable:true,get:function e(){return b.CORSDisabledError}});Object.defineProperty(t,"DuplicateEndUsersError",{enumerable:true,get:function e(){return b.DuplicateEndUsersError}});Object.defineProperty(t,"FeatureUnavailableError",{enumerable:true,get:function e(){return b.FeatureUnavailableError}});Object.defineProperty(t,"IncompleteRequestBodyError",{enumerable:true,get:function e(){return b.IncompleteRequestBodyError}});Object.defineProperty(t,"IndirectCollectionAccessDisallowedError",{enumerable:true,get:function e(){return b.IndirectCollectionAccessDisallowedError}});Object.defineProperty(t,"InsufficientCredentialsError",{enumerable:true,get:function e(){return b.InsufficientCredentialsError}});Object.defineProperty(t,"InvalidCredentialsError",{enumerable:true,get:function e(){return b.InvalidCredentialsError}});Object.defineProperty(t,"InvalidIdentifierError",{enumerable:true,get:function e(){return b.InvalidIdentifierError}});Object.defineProperty(t,"InvalidQuerySyntaxError",{enumerable:true,get:function e(){return b.InvalidQuerySyntaxError}});Object.defineProperty(t,"JSONParseError",{enumerable:true,get:function e(){return b.JSONParseError}});Object.defineProperty(t,"KinveyError",{enumerable:true,get:function e(){return b.KinveyError}});Object.defineProperty(t,"KinveyInternalErrorRetry",{enumerable:true,get:function e(){return b.KinveyInternalErrorRetry}});Object.defineProperty(t,"KinveyInternalErrorStop",{enumerable:true,get:function e(){return b.KinveyInternalErrorStop}});Object.defineProperty(t,"MissingQueryError",{enumerable:true,get:function e(){return b.MissingQueryError}});Object.defineProperty(t,"MissingRequestHeaderError",{enumerable:true,get:function e(){return b.MissingRequestHeaderError}});Object.defineProperty(t,"MissingRequestParameterError",{enumerable:true,get:function e(){return b.MissingRequestParameterError}});Object.defineProperty(t,"MobileIdentityConnectError",{enumerable:true,get:function e(){return b.MobileIdentityConnectError}});Object.defineProperty(t,"NoActiveUserError",{enumerable:true,get:function e(){return b.NoActiveUserError}});Object.defineProperty(t,"NetworkConnectionError",{enumerable:true,get:function e(){return b.NetworkConnectionError}});Object.defineProperty(t,"NoResponseError",{enumerable:true,get:function e(){return b.NoResponseError}});Object.defineProperty(t,"NotFoundError",{enumerable:true,get:function e(){return b.NotFoundError}});Object.defineProperty(t,"ParameterValueOutOfRangeError",{enumerable:true,get:function e(){return b.ParameterValueOutOfRangeError}});Object.defineProperty(t,"PopupError",{enumerable:true,get:function e(){return b.PopupError}});Object.defineProperty(t,"QueryError",{enumerable:true,get:function e(){return b.QueryError}});Object.defineProperty(t,"ServerError",{enumerable:true,get:function e(){return b.ServerError}});Object.defineProperty(t,"StaleRequestError",{enumerable:true,get:function e(){return b.StaleRequestError}});Object.defineProperty(t,"SyncError",{enumerable:true,get:function e(){return b.SyncError}});Object.defineProperty(t,"TimeoutError",{enumerable:true,get:function e(){return b.TimeoutError}});Object.defineProperty(t,"UserAlreadyExistsError",{enumerable:true,get:function e(){return b.UserAlreadyExistsError}});Object.defineProperty(t,"WritesToCollectionDisallowedError",{enumerable:true,get:function e(){return b.WritesToCollectionDisallowedError}});r(405)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.client=undefined;t.getAppVersion=h;t.setAppVersion=d;t.init=p;t.initialize=v;t.ping=y;var n=r(6);var i=f(n);var o=r(1);var u=r(2);var a=r(9);var s=r(82);var c=r(7);function f(e){return e&&e.__esModule?e:{default:e}}function l(){return a.Client.sharedInstance()}t.client=l;function h(){var e=l();if(e){return e.appVersion}return undefined}function d(e){var t=l();if(t){t.appVersion=e}}function p(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if((0,u.isDefined)(e.appKey)===false){throw new o.KinveyError("No App Key was provided."+" Unable to create a new Client without an App Key.")}if((0,u.isDefined)(e.appSecret)===false&&(0,u.isDefined)(e.masterSecret)===false){throw new o.KinveyError("No App Secret or Master Secret was provided."+" Unable to create a new Client without an App Secret.")}return a.Client.init(e)}function v(e){try{var t=p(e);return i.default.resolve(s.User.getActiveUser(t))}catch(e){return i.default.reject(e)}}function y(){var e=l();var t=new c.KinveyRequest({method:c.RequestMethod.GET,authType:c.AuthType.All,url:e.apiHostname+"/appdata/"+e.appKey});return t.execute().then(function(e){return e.data})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.User=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=S(i);var u=r(17);var a=S(u);var s=r(8);var c=S(s);var f=r(14);var l=S(f);var h=r(47);var d=S(h);var p=r(11);var v=S(p);var y=r(9);var b=r(7);var g=r(1);var m=r(55);var _=r(58);var w=r(22);var O=r(2);var E=r(142);var k=r(85);var P=r(89);var j=r(402);function S(e){return e&&e.__esModule?e:{default:e}}function A(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var T=t.User=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};A(this,e);this.data=t;this.client=r.client||y.Client.sharedInstance()}n(e,[{key:"isActive",value:function t(){var r=e.getActiveUser(this.client);if((0,O.isDefined)(r)&&r._id===this._id){return true}return false}},{key:"isEmailVerified",value:function e(){var t=this.metadata.emailVerification;return t==="confirmed"}},{key:"login",value:function t(r,n){var i=this;var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=r;var c=this.isActive();var f=e.getActiveUser(this.client);if(c===true){return o.default.reject(new g.ActiveUserError("This user is already the active user."))}if((0,O.isDefined)(f)){return o.default.reject(new g.ActiveUserError("An active user already exists. Please logout the active user before you login."))}if((0,l.default)(s)){u=n||{}}else{s={username:r,password:n}}if((0,O.isDefined)(s.username)){s.username=String(s.username).trim()}if((0,O.isDefined)(s.password)){s.password=String(s.password).trim()}if((!(0,O.isDefined)(s.username)||s.username===""||!(0,O.isDefined)(s.password)||s.password==="")&&!(0,O.isDefined)(s._socialIdentity)){return o.default.reject(new g.KinveyError("Username and/or password missing. Please provide both a username and password to login."))}var h=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/login"}),body:s,properties:u.properties,timeout:u.timeout,client:this.client});return h.execute().then(function(e){return e.data}).then(function(e){if((0,O.isDefined)(s._socialIdentity)&&(0,O.isDefined)(e._socialIdentity)){var t=Object.keys(e._socialIdentity);t.forEach(function(t){e._socialIdentity[t]=(0,a.default)({},s._socialIdentity[t],e._socialIdentity[t])});e._socialIdentity=(0,a.default)({},s._socialIdentity,e._socialIdentity)}delete e.password;return i.client.setActiveUser(e)}).then(function(e){i.data=e;return i})}},{key:"loginWithMIC",value:function t(r,n){var i=this;var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var a=this.isActive();var s=e.getActiveUser(this.client);if(a){return o.default.reject(new g.ActiveUserError("This user is already the active user."))}if((0,O.isDefined)(s)){return o.default.reject(new g.ActiveUserError("An active user already exists. Please logout the active user before you login."))}var c=new _.MobileIdentityConnect({client:this.client});return c.login(r,n,u).then(function(e){return i.connectIdentity(_.MobileIdentityConnect.identity,e,u)})}},{key:"connectIdentity",value:function e(t,r){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var o=this.isActive();var u={};var a=u._socialIdentity||{};a[t]=r;u._socialIdentity=a;if(o){return this.update(u,i)}return this.login(u,i).catch(function(e){if(e instanceof g.NotFoundError){return n.signup(u,i).then(function(){return n.connectIdentity(t,r,i)})}throw e})}},{key:"disconnectIdentity",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=o.default.resolve();if(t===_.MobileIdentityConnect.identity){i=_.MobileIdentityConnect.logout(this,n)}return i.catch(function(e){w.Log.error(e)}).then(function(){var e=r.data;var i=e._socialIdentity||{};delete i[t];e._socialIdentity=i;r.data=e;if(!r._id){return r}return r.update(e,n)}).then(function(){return r})}},{key:"logout",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.Session,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_logout"}),properties:r.properties,timeout:r.timeout,client:this.client});return this.unregisterFromLiveService().then(function(){return n.execute()}).catch(function(e){w.Log.error(e);return null}).then(function(){return t.client.setActiveUser(null)}).catch(function(e){w.Log.error(e);return null}).then(function(){return m.DataStore.clearCache({client:t.client})}).catch(function(e){w.Log.error(e);return null}).then(function(){return t})}},{key:"signup",value:function t(r){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var o=e.getActiveUser(this.client);i=(0,a.default)({state:true},i);if(i.state===true&&(0,O.isDefined)(o)){throw new g.ActiveUserError("An active user already exists. Please logout the active user before you login.")}if(r instanceof e){r=r.data}r=(0,a.default)(this.data,r);var u=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname}),body:(0,d.default)(r)?null:r,properties:i.properties,timeout:i.timeout,client:this.client});return u.execute().then(function(e){return e.data}).then(function(e){if(i.state===true){return n.client.setActiveUser(e)}return e}).then(function(e){n.data=e;return n})}},{key:"signupWithIdentity",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i={};i._socialIdentity={};i._socialIdentity[t]=r;return this.signup(i,n)}},{key:"update",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};t=(0,a.default)(this.data,t);var i=new j.UserStore;return i.update(t,n).then(function(e){if(r.isActive()){return r.client.setActiveUser(e)}return e}).then(function(e){r.data=e;return r})}},{key:"me",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=new b.KinveyRequest({method:b.RequestMethod.GET,authType:b.AuthType.Session,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_me"}),properties:r.properties,timeout:r.timeout});return n.execute().then(function(e){return e.data}).then(function(e){e=(0,a.default)(t.data,e);delete e.password;if(t.isActive()){return t.client.setActiveUser(e)}return e}).then(function(e){t.data=e;return t})}},{key:"registerForLiveService",value:function e(){var t=(0,P.getLiveService)(this.client);var r=o.default.resolve();if(!t.isInitialized()){r=t.fullInitialization(this)}return r}},{key:"unregisterFromLiveService",value:function e(){var t=(0,P.getLiveService)(this.client);var r=o.default.resolve();if(t.isInitialized()){r=t.fullUninitialization()}return r}},{key:"_id",get:function e(){return this.data._id}},{key:"_acl",get:function e(){return new E.Acl(this.data)}},{key:"metadata",get:function e(){return new k.Metadata(this.data)}},{key:"_kmd",get:function e(){return this.metadata}},{key:"_socialIdentity",get:function e(){return this.data._socialIdentity}},{key:"authtoken",get:function e(){return this.metadata.authtoken}},{key:"username",get:function e(){return this.data.username}},{key:"email",get:function e(){return this.data.email}},{key:"pathname",get:function e(){return"/user/"+this.client.appKey}}],[{key:"login",value:function t(r,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var o=new e({},i);return o.login(r,n,i)}},{key:"loginWithMIC",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=new this({},n);return i.loginWithMIC(t,r,n)}},{key:"connectIdentity",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=new this({},n);return i.connectIdentity(t,r,n)}},{key:"logout",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=e.getActiveUser(r.client);if((0,O.isDefined)(n)){return n.logout(r)}return o.default.resolve(null)}},{key:"signup",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new this({},r);return n.signup(t,r)}},{key:"signupWithIdentity",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=new this({},n);return i.signupWithIdentity(t,r,n)}},{key:"update",value:function t(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=e.getActiveUser(n.client);if((0,O.isDefined)(i)){return i.update(r,n)}return o.default.resolve(null)}},{key:"registerForLiveService",value:function t(){var r=e.getActiveUser();if(r){return r.registerForLiveService()}return o.default.reject(new g.ActiveUserError("There is no active user"))}},{key:"unregisterFromLiveService",value:function t(){var r=e.getActiveUser();if(r){return r.unregisterFromLiveService()}return o.default.reject(new g.ActiveUserError("There is no active user"))}},{key:"me",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=e.getActiveUser(r.client);if(n){return n.me(r)}return o.default.resolve(null)}},{key:"getActiveUser",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:y.Client.sharedInstance();var r=t.getActiveUser();if((0,O.isDefined)(r)){return new this(r,{client:t})}return null}},{key:"verifyEmail",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return o.default.reject(new g.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."))}if(!(0,c.default)(t)){return o.default.reject(new g.KinveyError("The provided username is not a string."))}var n=r.client||y.Client.sharedInstance();var i=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+t+"/user-email-verification-initiate"}),properties:r.properties,timeout:r.timeout,client:n});return i.execute().then(function(e){return e.data})}},{key:"forgotUsername",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return o.default.reject(new g.KinveyError("An email was not provided.","Please provide an email for the user that you would like to retrieve their username."))}if(!(0,c.default)(t)){return o.default.reject(new g.KinveyError("The provided email is not a string."))}var n=r.client||y.Client.sharedInstance();var i=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/user-forgot-username"}),properties:r.properties,data:{email:t},timeout:r.timeout,client:n});return i.execute().then(function(e){return e.data})}},{key:"resetPassword",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return o.default.reject(new g.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."))}if(!(0,c.default)(t)){return o.default.reject(new g.KinveyError("The provided username is not a string."))}var n=r.client||y.Client.sharedInstance();var i=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+t+"/user-password-reset-initiate"}),properties:r.properties,timeout:r.timeout,client:n});return i.execute().then(function(e){return e.data})}},{key:"lookup",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new j.UserStore;return n.lookup(t,r)}},{key:"exists",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new j.UserStore;return n.exists(t,r)}},{key:"remove",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new j.UserStore;return n.removeById(t,r)}},{key:"restore",value:function e(){return o.default.reject(new g.KinveyError("This function requires a master secret to be provided for your application."+" We strongly advise not to do this."))}}]);return e}()},function(e,t,r){var n=r(332),i=r(338),o=r(23),u=r(74),a=r(340),s=r(130);var c=u(function(e,t){var r=s(t);if(a(r)){r=undefined}return a(e)?n(e,i(t,1,a,true),o(r,2)):[]});e.exports=c},function(e,t,r){var n=r(118),i=r(333),o=r(337),u=r(53),a=r(100),s=r(119);var c=200;function f(e,t,r,f){var l=-1,h=i,d=true,p=e.length,v=[],y=t.length;if(!p){return v}if(r){t=u(t,a(r))}if(f){h=o;d=false}else if(t.length>=c){h=s;d=false;t=new n(t)}e:while(++l<p){var b=e[l],g=r==null?b:r(b);b=f||b!==0?b:0;if(d&&g===g){var m=y;while(m--){if(t[m]===g){continue e}}v.push(b)}else if(!h(t,g,f)){v.push(b)}}return v}e.exports=f},function(e,t,r){var n=r(334);function i(e,t){var r=e==null?0:e.length;return!!r&&n(e,t,0)>-1}e.exports=i},function(e,t,r){var n=r(124),i=r(335),o=r(336);function u(e,t,r){return t===t?o(e,t,r):n(e,i,r)}e.exports=u},function(e,t){function r(e){return e!==e}e.exports=r},function(e,t){function r(e,t,r){var n=r-1,i=e.length;while(++n<i){if(e[n]===t){return n}}return-1}e.exports=r},function(e,t){function r(e,t,r){var n=-1,i=e==null?0:e.length;while(++n<i){if(r(t,e[n])){return true}}return false}e.exports=r},function(e,t,r){var n=r(67),i=r(339);function o(e,t,r,u,a){var s=-1,c=e.length;r||(r=i);a||(a=[]);while(++s<c){var f=e[s];if(t>0&&r(f)){if(t>1){o(f,t-1,r,u,a)}else{n(a,f)}}else if(!u){a[a.length]=f}}return a}e.exports=o},function(e,t,r){var n=r(26),i=r(42),o=r(4);var u=n?n.isConcatSpreadable:undefined;function a(e){return o(e)||i(e)||!!(u&&e&&e[u])}e.exports=a},function(e,t,r){var n=r(16),i=r(15);function o(e){return i(e)&&n(e)}e.exports=o},function(e,t,r){var n=r(23),i=r(342);function o(e,t){var r=[];if(!(e&&e.length)){return r}var o=-1,u=[],a=e.length;t=n(t,3);while(++o<a){var s=e[o];if(t(s,o,e)){r.push(s);u.push(o)}}i(e,u);return r}e.exports=o},function(e,t,r){var n=r(343),i=r(44);var o=Array.prototype;var u=o.splice;function a(e,t){var r=e?t.length:0,o=r-1;while(r--){var a=t[r];if(r==o||a!==s){var s=a;if(i(a)){u.call(e,a,1)}else{n(e,a)}}}return e}e.exports=a},function(e,t,r){var n=r(51),i=r(130),o=r(344),u=r(28);function a(e,t){t=n(t,e);e=o(e,t);return e==null||delete e[u(i(t))]}e.exports=a},function(e,t,r){var n=r(78),i=r(345);function o(e,t){return t.length<2?e:n(e,i(t,0,-1))}e.exports=o},function(e,t){function r(e,t,r){var n=-1,i=e.length;if(t<0){t=-t>i?0:i+t}r=r>i?i:r;if(r<0){r+=i}i=t>r?0:r-t>>>0;t>>>=0;var o=Array(i);while(++n<i){o[n]=e[n+t]}return o}e.exports=r},function(e,t,r){var n=r(33),i=r(16);function o(e,t){var r=-1,o=i(e)?Array(e.length):[];n(e,function(e,n,i){o[++r]=t(e,n,i)});return o}e.exports=o},function(e,t,r){"use strict";var n=r(86);var i=r(348);var o=r(354);var u=r(355);var a=function(){function e(e){this._isScalar=false;if(e){this._subscribe=e}}e.prototype.lift=function(t){var r=new e;r.source=this;r.operator=t;return r};e.prototype.subscribe=function(e,t,r){var n=this.operator;var o=i.toSubscriber(e,t,r);if(n){n.call(o,this.source)}else{o.add(this.source?this._subscribe(o):this._trySubscribe(o))}if(o.syncErrorThrowable){o.syncErrorThrowable=false;if(o.syncErrorThrown){throw o.syncErrorValue}}return o};e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=true;e.syncErrorValue=t;e.error(t)}};e.prototype.forEach=function(e,t){var r=this;if(!t){if(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise){t=n.root.Rx.config.Promise}else if(n.root.Promise){t=n.root.Promise}}if(!t){throw new Error("no Promise impl found")}return new t(function(t,n){var i;i=r.subscribe(function(t){if(i){try{e(t)}catch(e){n(e);i.unsubscribe()}}else{e(t)}},n,t)})};e.prototype._subscribe=function(e){return this.source.subscribe(e)};e.prototype[o.observable]=function(){return this};e.prototype.pipe=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t-0]=arguments[t]}if(e.length===0){return this}return u.pipeFromArray(e)(this)};e.prototype.toPromise=function(e){var t=this;if(!e){if(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise){e=n.root.Rx.config.Promise}else if(n.root.Promise){e=n.root.Promise}}if(!e){throw new Error("no Promise impl found")}return new e(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})};e.create=function(t){return new e(t)};return e}();t.Observable=a},function(e,t,r){"use strict";var n=r(131);var i=r(87);var o=r(134);function u(e,t,r){if(e){if(e instanceof n.Subscriber){return e}if(e[i.rxSubscriber]){return e[i.rxSubscriber]()}}if(!e&&!t&&!r){return new n.Subscriber(o.empty)}return new n.Subscriber(e,t,r)}t.toSubscriber=u},function(e,t,r){"use strict";var n=r(350);var i=r(351);var o=r(132);var u=r(352);var a=r(133);var s=r(353);var c=function(){function e(e){this.closed=false;this._parent=null;this._parents=null;this._subscriptions=null;if(e){this._unsubscribe=e}}e.prototype.unsubscribe=function(){var e=false;var t;if(this.closed){return}var r=this,c=r._parent,l=r._parents,h=r._unsubscribe,d=r._subscriptions;this.closed=true;this._parent=null;this._parents=null;this._subscriptions=null;var p=-1;var v=l?l.length:0;while(c){c.remove(this);c=++p<v&&l[p]||null}if(o.isFunction(h)){var y=u.tryCatch(h).call(this);if(y===a.errorObject){e=true;t=t||(a.errorObject.e instanceof s.UnsubscriptionError?f(a.errorObject.e.errors):[a.errorObject.e])}}if(n.isArray(d)){p=-1;v=d.length;while(++p<v){var b=d[p];if(i.isObject(b)){var y=u.tryCatch(b.unsubscribe).call(b);if(y===a.errorObject){e=true;t=t||[];var g=a.errorObject.e;if(g instanceof s.UnsubscriptionError){t=t.concat(f(g.errors))}else{t.push(g)}}}}}if(e){throw new s.UnsubscriptionError(t)}};e.prototype.add=function(t){if(!t||t===e.EMPTY){return e.EMPTY}if(t===this){return this}var r=t;switch(typeof t){case"function":r=new e(t);case"object":if(r.closed||typeof r.unsubscribe!=="function"){return r}else if(this.closed){r.unsubscribe();return r}else if(typeof r._addParent!=="function"){var n=r;r=new e;r._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=this._subscriptions||(this._subscriptions=[]);i.push(r);r._addParent(this);return r};e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);if(r!==-1){t.splice(r,1)}}};e.prototype._addParent=function(e){var t=this,r=t._parent,n=t._parents;if(!r||r===e){this._parent=e}else if(!n){this._parents=[e]}else if(n.indexOf(e)===-1){n.push(e)}};e.EMPTY=function(e){e.closed=true;return e}(new e);return e}();t.Subscription=c;function f(e){return e.reduce(function(e,t){return e.concat(t instanceof s.UnsubscriptionError?t.errors:t)},[])}},function(e,t,r){"use strict";t.isArray=Array.isArray||function(e){return e&&typeof e.length==="number"}},function(e,t,r){"use strict";function n(e){return e!=null&&typeof e==="object"}t.isObject=n},function(e,t,r){"use strict";var n=r(133);var i;function o(){try{return i.apply(this,arguments)}catch(e){n.errorObject.e=e;return n.errorObject}}function u(e){i=e;return o}t.tryCatch=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};var i=function(e){n(t,e);function t(t){e.call(this);this.errors=t;var r=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError";this.stack=r.stack;this.message=r.message}return t}(Error);t.UnsubscriptionError=i},function(e,t,r){"use strict";var n=r(86);function i(e){var t;var r=e.Symbol;if(typeof r==="function"){if(r.observable){t=r.observable}else{t=r("observable");r.observable=t}}else{t="@@observable"}return t}t.getSymbolObservable=i;t.observable=i(n.root);t.$$observable=t.observable},function(e,t,r){"use strict";var n=r(356);function i(){var e=[];for(var t=0;t<arguments.length;t++){e[t-0]=arguments[t]}return o(e)}t.pipe=i;function o(e){if(!e){return n.noop}if(e.length===1){return e[0]}return function t(r){return e.reduce(function(e,t){return t(e)},r)}}t.pipeFromArray=o},function(e,t,r){"use strict";function n(){}t.noop=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(358);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LiveCollectionManager=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();t.getLiveCollectionManager=l;var i=r(9);var o=r(1);var u=r(7);var a=r(56);function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=t.LiveCollectionManager=function(){function e(t){s(this,e);this._client=t||i.Client.sharedInstance()}n(e,[{key:"subscribeCollection",value:function e(t,r){var n=this;if(!(0,a.isValidChannelName)(t)){return Promise.reject(new o.KinveyError("Invalid or missing collection name"))}if(!(0,a.isValidReceiver)(r)){return Promise.reject(new o.KinveyError("Invalid or missing receiver"))}return this._makeSubscriptionRequest(t,"_subscribe").then(function(){var e=n._buildChannelName(t);var i=n._buildPersonalChannelName(t);var o=(0,a.getLiveService)();o.subscribeToChannel(e,r);o.subscribeToChannel(i,r)})}},{key:"unsubscribeCollection",value:function e(t){var r=this;if(!(0,a.isValidChannelName)(t)){return Promise.reject(new o.KinveyError("Invalid or missing collection name"))}return this._makeSubscriptionRequest(t,"_unsubscribe").then(function(){var e=r._buildChannelName(t);var n=r._buildPersonalChannelName(t);var i=(0,a.getLiveService)();i.unsubscribeFromChannel(e);i.unsubscribeFromChannel(n)})}},{key:"_buildChannelName",value:function e(t){return this._client.appKey+".c-"+t}},{key:"_buildPersonalChannelName",value:function e(t){var r=this._buildChannelName(t);var n=this._client.getActiveUser()._id;return r+".u-"+n}},{key:"_makeSubscriptionRequest",value:function e(t,r){return u.KinveyRequest.executeShort({method:u.RequestMethod.POST,pathname:"/appdata/"+this._client.appKey+"/"+t+"/"+r,body:{deviceId:this._client.deviceId}})}}]);return e}();var f=void 0;function l(e){if(!f){f=new c(e)}return f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(360);var i=l(n);var o=r(389);var u=l(o);var a=r(390);var s=l(a);var c=r(391);var f=r(3);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){p(t,e);function t(e){h(this,t);e.db=new s.default;e.networking=new u.default({del:c.del,get:c.get,post:c.post});e.sdkFamily="NativeScript";return d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return t}(i.default);t.default=v;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(29);var o=pe(i);var u=r(135);var a=pe(u);var s=r(363);var c=pe(s);var f=r(136);var l=pe(f);var h=r(366);var d=pe(h);var p=r(367);var v=de(p);var y=r(368);var b=de(y);var g=r(369);var m=de(g);var _=r(370);var w=de(_);var O=r(371);var E=de(O);var k=r(372);var P=de(k);var j=r(373);var S=de(j);var A=r(374);var T=de(A);var x=r(375);var C=de(x);var M=r(376);var R=de(M);var I=r(377);var q=de(I);var U=r(378);var D=de(U);var K=r(379);var N=de(K);var L=r(380);var B=de(L);var F=r(381);var H=de(F);var G=r(382);var z=de(G);var V=r(383);var Q=de(V);var $=r(384);var W=de($);var Y=r(385);var J=de(Y);var X=r(386);var Z=de(X);var ee=r(387);var te=de(ee);var re=r(137);var ne=de(re);var ie=r(388);var oe=de(ie);var ue=r(5);var ae=pe(ue);var se=r(57);var ce=pe(se);var fe=r(3);var le=r(90);var he=pe(le);function de(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}function pe(e){return e&&e.__esModule?e:{default:e}}function ve(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var ye=function(){function e(t){var r=this;ve(this,e);var n=t.db,i=t.networking;var u=this._config=new o.default({setup:t,db:n});var s=new a.default({config:u});i.init(u);var f={config:u,networking:i,crypto:s};var h=d.default.bind(this,f,ne);var p=d.default.bind(this,f,R);var y=d.default.bind(this,f,D);var g=d.default.bind(this,f,B);var _=d.default.bind(this,f,oe);var O=this._listenerManager=new l.default;var k=new c.default({timeEndpoint:h,leaveEndpoint:p,heartbeatEndpoint:y,setStateEndpoint:g,subscribeEndpoint:_,crypto:f.crypto,config:f.config,listenerManager:O});this.addListener=O.addListener.bind(O);this.removeListener=O.removeListener.bind(O);this.removeAllListeners=O.removeAllListeners.bind(O);this.channelGroups={listGroups:d.default.bind(this,f,w),listChannels:d.default.bind(this,f,E),addChannels:d.default.bind(this,f,v),removeChannels:d.default.bind(this,f,b),deleteGroup:d.default.bind(this,f,m)};this.push={addChannels:d.default.bind(this,f,P),removeChannels:d.default.bind(this,f,S),deleteDevice:d.default.bind(this,f,C),listChannels:d.default.bind(this,f,T)};this.hereNow=d.default.bind(this,f,H);this.whereNow=d.default.bind(this,f,q);this.getState=d.default.bind(this,f,N);this.setState=k.adaptStateChange.bind(k);this.grant=d.default.bind(this,f,Q);this.audit=d.default.bind(this,f,z);this.publish=d.default.bind(this,f,W);this.fire=function(e,t){e.replicate=false;e.storeInHistory=false;return r.publish(e,t)};this.history=d.default.bind(this,f,J);this.deleteMessages=d.default.bind(this,f,Z);this.fetchMessages=d.default.bind(this,f,te);this.time=h;this.subscribe=k.adaptSubscribeChange.bind(k);this.unsubscribe=k.adaptUnsubscribeChange.bind(k);this.disconnect=k.disconnect.bind(k);this.reconnect=k.reconnect.bind(k);this.destroy=function(e){k.unsubscribeAll(e);k.disconnect()};this.stop=this.destroy;this.unsubscribeAll=k.unsubscribeAll.bind(k);this.getSubscribedChannels=k.getSubscribedChannels.bind(k);this.getSubscribedChannelGroups=k.getSubscribedChannelGroups.bind(k);this.encrypt=s.encrypt.bind(s);this.decrypt=s.decrypt.bind(s);this.getAuthKey=f.config.getAuthKey.bind(f.config);this.setAuthKey=f.config.setAuthKey.bind(f.config);this.setCipherKey=f.config.setCipherKey.bind(f.config);this.getUUID=f.config.getUUID.bind(f.config);this.setUUID=f.config.setUUID.bind(f.config);this.getFilterExpression=f.config.getFilterExpression.bind(f.config);this.setFilterExpression=f.config.setFilterExpression.bind(f.config);this.setHeartbeatInterval=f.config.setHeartbeatInterval.bind(f.config)}n(e,[{key:"getVersion",value:function e(){return this._config.getVersion()}},{key:"networkDownDetected",value:function e(){this._listenerManager.announceNetworkDown();if(this._config.restore){this.disconnect()}else{this.destroy(true)}}},{key:"networkUpDetected",value:function e(){this._listenerManager.announceNetworkUp();this.reconnect()}}],[{key:"generateUUID",value:function e(){return he.default.createUUID()}}]);return e}();ye.OPERATIONS=ae.default;ye.CATEGORIES=ce.default;t.default=ye;e.exports=t["default"]},function(e,t,r){var n,i,o;(function(r,u){if(true){!(i=[t],n=u,o=typeof n==="function"?n.apply(t,i):n,o!==undefined&&(e.exports=o))}else if(typeof t==="object"){u(t);if(typeof e==="object"&&e!==null){e.exports=t.uuid}}else{u(r.lil=r.lil||{})}})(this,function(e){var t="0.1.0";var r={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function n(){var e="",t,r;for(t=0;t<32;t++){r=Math.random()*16|0;if(t===8||t===12||t===16||t===20)e+="-";e+=(t===12?4:t===16?r&3|8:r).toString(16)}return e}function i(e,t){var n=r[t||"all"];return n&&n.test(e)||false}n.isUUID=i;n.VERSION=t;e.uuid=n;e.isUUID=i})},function(e,t,r){"use strict";var n=n||function(e,t){var r={},n=r.lib={},i=function e(){},o=n.Base={extend:function e(t){i.prototype=this;var r=new i;t&&r.mixIn(t);r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)});r.init.prototype=r;r.$super=this;return r},create:function e(){var t=this.extend();t.init.apply(t,arguments);return t},init:function e(){},mixIn:function e(t){for(var r in t){t.hasOwnProperty(r)&&(this[r]=t[r])}t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function e(){return this.init.prototype.extend(this)}},u=n.WordArray=o.extend({init:function e(r,n){r=this.words=r||[];this.sigBytes=n!=t?n:4*r.length},toString:function e(t){return(t||s).stringify(this)},concat:function e(t){var r=this.words,n=t.words,i=this.sigBytes;t=t.sigBytes;this.clamp();if(i%4)for(var o=0;o<t;o++){r[i+o>>>2]|=(n[o>>>2]>>>24-8*(o%4)&255)<<24-8*((i+o)%4)}else if(65535<n.length)for(o=0;o<t;o+=4){r[i+o>>>2]=n[o>>>2]}else r.push.apply(r,n);this.sigBytes+=t;return this},clamp:function t(){var r=this.words,n=this.sigBytes;r[n>>>2]&=4294967295<<32-8*(n%4);r.length=e.ceil(n/4)},clone:function e(){var t=o.clone.call(this);t.words=this.words.slice(0);return t},random:function t(r){for(var n=[],i=0;i<r;i+=4){n.push(4294967296*e.random()|0)}return new u.init(n,r)}}),a=r.enc={},s=a.Hex={stringify:function e(t){var r=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){var o=r[i>>>2]>>>24-8*(i%4)&255;n.push((o>>>4).toString(16));n.push((o&15).toString(16))}return n.join("")},parse:function e(t){for(var r=t.length,n=[],i=0;i<r;i+=2){n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-4*(i%8)}return new u.init(n,r/2)}},c=a.Latin1={stringify:function e(t){var r=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){n.push(String.fromCharCode(r[i>>>2]>>>24-8*(i%4)&255))}return n.join("")},parse:function e(t){for(var r=t.length,n=[],i=0;i<r;i++){n[i>>>2]|=(t.charCodeAt(i)&255)<<24-8*(i%4)}return new u.init(n,r)}},f=a.Utf8={stringify:function e(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function e(t){return c.parse(unescape(encodeURIComponent(t)))}},l=n.BufferedBlockAlgorithm=o.extend({reset:function e(){this._data=new u.init;this._nDataBytes=0},_append:function e(t){"string"==typeof t&&(t=f.parse(t));this._data.concat(t);this._nDataBytes+=t.sigBytes},_process:function t(r){var n=this._data,i=n.words,o=n.sigBytes,a=this.blockSize,s=o/(4*a),s=r?e.ceil(s):e.max((s|0)-this._minBufferSize,0);r=s*a;o=e.min(4*r,o);if(r){for(var c=0;c<r;c+=a){this._doProcessBlock(i,c)}c=i.splice(0,r);n.sigBytes-=o}return new u.init(c,o)},clone:function e(){var t=o.clone.call(this);t._data=this._data.clone();return t},_minBufferSize:0});n.Hasher=l.extend({cfg:o.extend(),init:function e(t){this.cfg=this.cfg.extend(t);this.reset()},reset:function e(){l.reset.call(this);this._doReset()},update:function e(t){this._append(t);this._process();return this},finalize:function e(t){t&&this._append(t);return this._doFinalize()},blockSize:16,_createHelper:function e(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function e(t){return function(e,r){return new h.HMAC.init(t,r).finalize(e)}}});var h=r.algo={};return r}(Math);(function(e){for(var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,r=t.algo,u=[],a=[],s=function e(t){return 4294967296*(t-(t|0))|0},c=2,f=0;64>f;){var l;e:{l=c;for(var h=e.sqrt(l),d=2;d<=h;d++){if(!(l%d)){l=!1;break e}}l=!0}l&&(8>f&&(u[f]=s(e.pow(c,.5))),a[f]=s(e.pow(c,1/3)),f++);c++}var p=[],r=r.SHA256=o.extend({_doReset:function e(){this._hash=new i.init(u.slice(0))},_doProcessBlock:function e(t,r){for(var n=this._hash.words,i=n[0],o=n[1],u=n[2],s=n[3],c=n[4],f=n[5],l=n[6],h=n[7],d=0;64>d;d++){if(16>d)p[d]=t[r+d]|0;else{var v=p[d-15],y=p[d-2];p[d]=((v<<25|v>>>7)^(v<<14|v>>>18)^v>>>3)+p[d-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+p[d-16]}v=h+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&f^~c&l)+a[d]+p[d];y=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&o^i&u^o&u);h=l;l=f;f=c;c=s+v|0;s=u;u=o;o=i;i=v+y|0}n[0]=n[0]+i|0;n[1]=n[1]+o|0;n[2]=n[2]+u|0;n[3]=n[3]+s|0;n[4]=n[4]+c|0;n[5]=n[5]+f|0;n[6]=n[6]+l|0;n[7]=n[7]+h|0},_doFinalize:function t(){var r=this._data,n=r.words,i=8*this._nDataBytes,o=8*r.sigBytes;n[o>>>5]|=128<<24-o%32;n[(o+64>>>9<<4)+14]=e.floor(i/4294967296);n[(o+64>>>9<<4)+15]=i;r.sigBytes=4*n.length;this._process();return this._hash},clone:function e(){var t=o.clone.call(this);t._hash=this._hash.clone();return t}});t.SHA256=o._createHelper(r);t.HmacSHA256=o._createHmacHelper(r)})(Math);(function(){var e=n,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function e(r,n){r=this._hasher=new r.init;"string"==typeof n&&(n=t.parse(n));var i=r.blockSize,o=4*i;n.sigBytes>o&&(n=r.finalize(n));n.clamp();for(var u=this._oKey=n.clone(),a=this._iKey=n.clone(),s=u.words,c=a.words,f=0;f<i;f++){s[f]^=1549556828,c[f]^=909522486}u.sigBytes=a.sigBytes=o;this.reset()},reset:function e(){var t=this._hasher;t.reset();t.update(this._iKey)},update:function e(t){this._hasher.update(t);return this},finalize:function e(t){var r=this._hasher;t=r.finalize(t);r.reset();return r.finalize(this._oKey.clone().concat(t))}})})();(function(){var e=n,t=e.lib.WordArray;e.enc.Base64={stringify:function e(t){var r=t.words,n=t.sigBytes,i=this._map;t.clamp();t=[];for(var o=0;o<n;o+=3){for(var u=(r[o>>>2]>>>24-8*(o%4)&255)<<16|(r[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|r[o+2>>>2]>>>24-8*((o+2)%4)&255,a=0;4>a&&o+.75*a<n;a++){t.push(i.charAt(u>>>6*(3-a)&63))}}if(r=i.charAt(64))for(;t.length%4;){t.push(r)}return t.join("")},parse:function e(r){var n=r.length,i=this._map,o=i.charAt(64);o&&(o=r.indexOf(o),-1!=o&&(n=o));for(var o=[],u=0,a=0;a<n;a++){if(a%4){var s=i.indexOf(r.charAt(a-1))<<2*(a%4),c=i.indexOf(r.charAt(a))>>>6-2*(a%4);o[u>>>2]|=(s|c)<<24-8*(u%4);u++}}return t.create(o,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(e){function t(e,t,r,n,i,o,u){e=e+(t&r|~t&n)+i+u;return(e<<o|e>>>32-o)+t}function r(e,t,r,n,i,o,u){e=e+(t&n|r&~n)+i+u;return(e<<o|e>>>32-o)+t}function i(e,t,r,n,i,o,u){e=e+(t^r^n)+i+u;return(e<<o|e>>>32-o)+t}function o(e,t,r,n,i,o,u){e=e+(r^(t|~n))+i+u;return(e<<o|e>>>32-o)+t}for(var u=n,a=u.lib,s=a.WordArray,c=a.Hasher,a=u.algo,f=[],l=0;64>l;l++){f[l]=4294967296*e.abs(e.sin(l+1))|0}a=a.MD5=c.extend({_doReset:function e(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function e(n,u){for(var a=0;16>a;a++){var s=u+a,c=n[s];n[s]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}var a=this._hash.words,s=n[u+0],c=n[u+1],l=n[u+2],h=n[u+3],d=n[u+4],p=n[u+5],v=n[u+6],y=n[u+7],b=n[u+8],g=n[u+9],m=n[u+10],_=n[u+11],w=n[u+12],O=n[u+13],E=n[u+14],k=n[u+15],P=a[0],j=a[1],S=a[2],A=a[3],P=t(P,j,S,A,s,7,f[0]),A=t(A,P,j,S,c,12,f[1]),S=t(S,A,P,j,l,17,f[2]),j=t(j,S,A,P,h,22,f[3]),P=t(P,j,S,A,d,7,f[4]),A=t(A,P,j,S,p,12,f[5]),S=t(S,A,P,j,v,17,f[6]),j=t(j,S,A,P,y,22,f[7]),P=t(P,j,S,A,b,7,f[8]),A=t(A,P,j,S,g,12,f[9]),S=t(S,A,P,j,m,17,f[10]),j=t(j,S,A,P,_,22,f[11]),P=t(P,j,S,A,w,7,f[12]),A=t(A,P,j,S,O,12,f[13]),S=t(S,A,P,j,E,17,f[14]),j=t(j,S,A,P,k,22,f[15]),P=r(P,j,S,A,c,5,f[16]),A=r(A,P,j,S,v,9,f[17]),S=r(S,A,P,j,_,14,f[18]),j=r(j,S,A,P,s,20,f[19]),P=r(P,j,S,A,p,5,f[20]),A=r(A,P,j,S,m,9,f[21]),S=r(S,A,P,j,k,14,f[22]),j=r(j,S,A,P,d,20,f[23]),P=r(P,j,S,A,g,5,f[24]),A=r(A,P,j,S,E,9,f[25]),S=r(S,A,P,j,h,14,f[26]),j=r(j,S,A,P,b,20,f[27]),P=r(P,j,S,A,O,5,f[28]),A=r(A,P,j,S,l,9,f[29]),S=r(S,A,P,j,y,14,f[30]),j=r(j,S,A,P,w,20,f[31]),P=i(P,j,S,A,p,4,f[32]),A=i(A,P,j,S,b,11,f[33]),S=i(S,A,P,j,_,16,f[34]),j=i(j,S,A,P,E,23,f[35]),P=i(P,j,S,A,c,4,f[36]),A=i(A,P,j,S,d,11,f[37]),S=i(S,A,P,j,y,16,f[38]),j=i(j,S,A,P,m,23,f[39]),P=i(P,j,S,A,O,4,f[40]),A=i(A,P,j,S,s,11,f[41]),S=i(S,A,P,j,h,16,f[42]),j=i(j,S,A,P,v,23,f[43]),P=i(P,j,S,A,g,4,f[44]),A=i(A,P,j,S,w,11,f[45]),S=i(S,A,P,j,k,16,f[46]),j=i(j,S,A,P,l,23,f[47]),P=o(P,j,S,A,s,6,f[48]),A=o(A,P,j,S,y,10,f[49]),S=o(S,A,P,j,E,15,f[50]),j=o(j,S,A,P,p,21,f[51]),P=o(P,j,S,A,w,6,f[52]),A=o(A,P,j,S,h,10,f[53]),S=o(S,A,P,j,m,15,f[54]),j=o(j,S,A,P,c,21,f[55]),P=o(P,j,S,A,b,6,f[56]),A=o(A,P,j,S,k,10,f[57]),S=o(S,A,P,j,v,15,f[58]),j=o(j,S,A,P,O,21,f[59]),P=o(P,j,S,A,d,6,f[60]),A=o(A,P,j,S,_,10,f[61]),S=o(S,A,P,j,l,15,f[62]),j=o(j,S,A,P,g,21,f[63]);a[0]=a[0]+P|0;a[1]=a[1]+j|0;a[2]=a[2]+S|0;a[3]=a[3]+A|0},_doFinalize:function t(){var r=this._data,n=r.words,i=8*this._nDataBytes,o=8*r.sigBytes;n[o>>>5]|=128<<24-o%32;var u=e.floor(i/4294967296);n[(o+64>>>9<<4)+15]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360;n[(o+64>>>9<<4)+14]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;r.sigBytes=4*(n.length+1);this._process();r=this._hash;n=r.words;for(i=0;4>i;i++){o=n[i],n[i]=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360}return r},clone:function e(){var t=c.clone.call(this);t._hash=this._hash.clone();return t}});u.MD5=c._createHelper(a);u.HmacMD5=c._createHmacHelper(a)})(Math);(function(){var e=n,t=e.lib,r=t.Base,i=t.WordArray,t=e.algo,o=t.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function e(t){this.cfg=this.cfg.extend(t)},compute:function e(t,r){for(var n=this.cfg,o=n.hasher.create(),u=i.create(),a=u.words,s=n.keySize,n=n.iterations;a.length<s;){c&&o.update(c);var c=o.update(t).finalize(r);o.reset();for(var f=1;f<n;f++){c=o.finalize(c),o.reset()}u.concat(c)}u.sigBytes=4*s;return u}});e.EvpKDF=function(e,t,r){return o.create(r).compute(e,t)}})();n.lib.Cipher||function(e){var t=n,r=t.lib,i=r.Base,o=r.WordArray,u=r.BufferedBlockAlgorithm,a=t.enc.Base64,s=t.algo.EvpKDF,c=r.Cipher=u.extend({cfg:i.extend(),createEncryptor:function e(t,r){return this.create(this._ENC_XFORM_MODE,t,r)},createDecryptor:function e(t,r){return this.create(this._DEC_XFORM_MODE,t,r)},init:function e(t,r,n){this.cfg=this.cfg.extend(n);this._xformMode=t;this._key=r;this.reset()},reset:function e(){u.reset.call(this);this._doReset()},process:function e(t){this._append(t);return this._process()},finalize:function e(t){t&&this._append(t);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function e(t){return{encrypt:function e(r,n,i){return("string"==typeof n?v:p).encrypt(t,r,n,i)},decrypt:function e(r,n,i){return("string"==typeof n?v:p).decrypt(t,r,n,i)}}}});r.StreamCipher=c.extend({_doFinalize:function e(){return this._process(!0)},blockSize:1});var f=t.mode={},l=function t(r,n,i){var o=this._iv;o?this._iv=e:o=this._prevBlock;for(var u=0;u<i;u++){r[n+u]^=o[u]}},h=(r.BlockCipherMode=i.extend({createEncryptor:function e(t,r){return this.Encryptor.create(t,r)},createDecryptor:function e(t,r){return this.Decryptor.create(t,r)},init:function e(t,r){this._cipher=t;this._iv=r}})).extend();h.Encryptor=h.extend({processBlock:function e(t,r){var n=this._cipher,i=n.blockSize;l.call(this,t,r,i);n.encryptBlock(t,r);this._prevBlock=t.slice(r,r+i)}});h.Decryptor=h.extend({processBlock:function e(t,r){var n=this._cipher,i=n.blockSize,o=t.slice(r,r+i);n.decryptBlock(t,r);l.call(this,t,r,i);this._prevBlock=o}});f=f.CBC=h;h=(t.pad={}).Pkcs7={pad:function e(t,r){for(var n=4*r,n=n-t.sigBytes%n,i=n<<24|n<<16|n<<8|n,u=[],a=0;a<n;a+=4){u.push(i)}n=o.create(u,n);t.concat(n)},unpad:function e(t){t.sigBytes-=t.words[t.sigBytes-1>>>2]&255}};r.BlockCipher=c.extend({cfg:c.cfg.extend({mode:f,padding:h}),reset:function e(){c.reset.call(this);var t=this.cfg,r=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,r&&r.words)},_doProcessBlock:function e(t,r){this._mode.processBlock(t,r)},_doFinalize:function e(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var r=this._process(!0)}else r=this._process(!0),t.unpad(r);return r},blockSize:4});var d=r.CipherParams=i.extend({init:function e(t){this.mixIn(t)},toString:function e(t){return(t||this.formatter).stringify(this)}}),f=(t.format={}).OpenSSL={stringify:function e(t){var r=t.ciphertext;t=t.salt;return(t?o.create([1398893684,1701076831]).concat(t).concat(r):r).toString(a)},parse:function e(t){t=a.parse(t);var r=t.words;if(1398893684==r[0]&&1701076831==r[1]){var n=o.create(r.slice(2,4));r.splice(0,4);t.sigBytes-=16}return d.create({ciphertext:t,salt:n})}},p=r.SerializableCipher=i.extend({cfg:i.extend({format:f}),encrypt:function e(t,r,n,i){i=this.cfg.extend(i);var o=t.createEncryptor(n,i);r=o.finalize(r);o=o.cfg;return d.create({ciphertext:r,key:n,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function e(t,r,n,i){i=this.cfg.extend(i);r=this._parse(r,i.format);return t.createDecryptor(n,i).finalize(r.ciphertext)},_parse:function e(t,r){return"string"==typeof t?r.parse(t,this):t}}),t=(t.kdf={}).OpenSSL={execute:function e(t,r,n,i){i||(i=o.random(8));t=s.create({keySize:r+n}).compute(t,i);n=o.create(t.words.slice(r),4*n);t.sigBytes=4*r;return d.create({key:t,iv:n,salt:i})}},v=r.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:t}),encrypt:function e(t,r,n,i){i=this.cfg.extend(i);n=i.kdf.execute(n,t.keySize,t.ivSize);i.iv=n.iv;t=p.encrypt.call(this,t,r,n.key,i);t.mixIn(n);return t},decrypt:function e(t,r,n,i){i=this.cfg.extend(i);r=this._parse(r,i.format);n=i.kdf.execute(n,t.keySize,t.ivSize,r.salt);i.iv=n.iv;return p.decrypt.call(this,t,r,n.key,i)}})}();(function(){for(var e=n,t=e.lib.BlockCipher,r=e.algo,i=[],o=[],u=[],a=[],s=[],c=[],f=[],l=[],h=[],d=[],p=[],v=0;256>v;v++){p[v]=128>v?v<<1:v<<1^283}for(var y=0,b=0,v=0;256>v;v++){var g=b^b<<1^b<<2^b<<3^b<<4,g=g>>>8^g&255^99;i[y]=g;o[g]=y;var m=p[y],_=p[m],w=p[_],O=257*p[g]^16843008*g;u[y]=O<<24|O>>>8;a[y]=O<<16|O>>>16;s[y]=O<<8|O>>>24;c[y]=O;O=16843009*w^65537*_^257*m^16843008*y;f[g]=O<<24|O>>>8;l[g]=O<<16|O>>>16;h[g]=O<<8|O>>>24;d[g]=O;y?(y=m^p[p[p[w^m]]],b^=p[p[b]]):y=b=1}var E=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=t.extend({_doReset:function e(){for(var t=this._key,r=t.words,n=t.sigBytes/4,t=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],u=0;u<t;u++){if(u<n)o[u]=r[u];else{var a=o[u-1];u%n?6<n&&4==u%n&&(a=i[a>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[a&255]):(a=a<<8|a>>>24,a=i[a>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[a&255],a^=E[u/n|0]<<24);o[u]=o[u-n]^a}}r=this._invKeySchedule=[];for(n=0;n<t;n++){u=t-n,a=n%4?o[u]:o[u-4],r[n]=4>n||4>=u?a:f[i[a>>>24]]^l[i[a>>>16&255]]^h[i[a>>>8&255]]^d[i[a&255]]}},encryptBlock:function e(t,r){this._doCryptBlock(t,r,this._keySchedule,u,a,s,c,i)},decryptBlock:function e(t,r){var n=t[r+1];t[r+1]=t[r+3];t[r+3]=n;this._doCryptBlock(t,r,this._invKeySchedule,f,l,h,d,o);n=t[r+1];t[r+1]=t[r+3];t[r+3]=n},_doCryptBlock:function e(t,r,n,i,o,u,a,s){for(var c=this._nRounds,f=t[r]^n[0],l=t[r+1]^n[1],h=t[r+2]^n[2],d=t[r+3]^n[3],p=4,v=1;v<c;v++){var y=i[f>>>24]^o[l>>>16&255]^u[h>>>8&255]^a[d&255]^n[p++],b=i[l>>>24]^o[h>>>16&255]^u[d>>>8&255]^a[f&255]^n[p++],g=i[h>>>24]^o[d>>>16&255]^u[f>>>8&255]^a[l&255]^n[p++],d=i[d>>>24]^o[f>>>16&255]^u[l>>>8&255]^a[h&255]^n[p++],f=y,l=b,h=g}y=(s[f>>>24]<<24|s[l>>>16&255]<<16|s[h>>>8&255]<<8|s[d&255])^n[p++];b=(s[l>>>24]<<24|s[h>>>16&255]<<16|s[d>>>8&255]<<8|s[f&255])^n[p++];g=(s[h>>>24]<<24|s[d>>>16&255]<<16|s[f>>>8&255]<<8|s[l&255])^n[p++];d=(s[d>>>24]<<24|s[f>>>16&255]<<16|s[l>>>8&255]<<8|s[h&255])^n[p++];t[r]=y;t[r+1]=b;t[r+2]=g;t[r+3]=d},keySize:8});e.AES=t._createHelper(r)})();n.mode.ECB=function(){var e=n.lib.BlockCipherMode.extend();e.Encryptor=e.extend({processBlock:function e(t,r){this._cipher.encryptBlock(t,r)}});e.Decryptor=e.extend({processBlock:function e(t,r){this._cipher.decryptBlock(t,r)}});return e}();e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(135);var o=m(i);var u=r(29);var a=m(u);var s=r(136);var c=m(s);var f=r(364);var l=m(f);var h=r(365);var d=m(h);var p=r(10);var v=m(p);var y=r(3);var b=r(57);var g=m(b);function m(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=function(){function e(t){var r=t.subscribeEndpoint,n=t.leaveEndpoint,i=t.heartbeatEndpoint,o=t.setStateEndpoint,u=t.timeEndpoint,a=t.config,s=t.crypto,c=t.listenerManager;_(this,e);this._listenerManager=c;this._config=a;this._leaveEndpoint=n;this._heartbeatEndpoint=i;this._setStateEndpoint=o;this._subscribeEndpoint=r;this._crypto=s;this._channels={};this._presenceChannels={};this._channelGroups={};this._presenceChannelGroups={};this._pendingChannelSubscriptions=[];this._pendingChannelGroupSubscriptions=[];this._currentTimetoken=0;this._lastTimetoken=0;this._storedTimetoken=null;this._subscriptionStatusAnnounced=false;this._isOnline=true;this._reconnectionManager=new l.default({timeEndpoint:u});this._dedupingManager=new d.default({config:a})}n(e,[{key:"adaptStateChange",value:function e(t,r){var n=this;var i=t.state,o=t.channels,u=o===undefined?[]:o,a=t.channelGroups,s=a===undefined?[]:a;u.forEach(function(e){if(e in n._channels)n._channels[e].state=i});s.forEach(function(e){if(e in n._channelGroups)n._channelGroups[e].state=i});return this._setStateEndpoint({state:i,channels:u,channelGroups:s},r)}},{key:"adaptSubscribeChange",value:function e(t){var r=this;var n=t.timetoken,i=t.channels,o=i===undefined?[]:i,u=t.channelGroups,a=u===undefined?[]:u,s=t.withPresence,c=s===undefined?false:s;if(!this._config.subscribeKey||this._config.subscribeKey===""){if(console&&console.log)console.log("subscribe key missing; aborting subscribe");return}if(n){this._lastTimetoken=this._currentTimetoken;this._currentTimetoken=n}if(this._currentTimetoken!=="0"){this._storedTimetoken=this._currentTimetoken;this._currentTimetoken=0}o.forEach(function(e){r._channels[e]={state:{}};if(c)r._presenceChannels[e]={};r._pendingChannelSubscriptions.push(e)});a.forEach(function(e){r._channelGroups[e]={state:{}};if(c)r._presenceChannelGroups[e]={};r._pendingChannelGroupSubscriptions.push(e)});this._subscriptionStatusAnnounced=false;this.reconnect()}},{key:"adaptUnsubscribeChange",value:function e(t,r){var n=this;var i=t.channels,o=i===undefined?[]:i,u=t.channelGroups,a=u===undefined?[]:u;var s=[];var c=[];o.forEach(function(e){if(e in n._channels){delete n._channels[e];s.push(e)}if(e in n._presenceChannels){delete n._presenceChannels[e];s.push(e)}});a.forEach(function(e){if(e in n._channelGroups){delete n._channelGroups[e];c.push(e)}if(e in n._presenceChannelGroups){delete n._channelGroups[e];c.push(e)}});if(s.length===0&&c.length===0){return}if(this._config.suppressLeaveEvents===false&&!r){this._leaveEndpoint({channels:s,channelGroups:c},function(e){e.affectedChannels=s;e.affectedChannelGroups=c;e.currentTimetoken=n._currentTimetoken;e.lastTimetoken=n._lastTimetoken;n._listenerManager.announceStatus(e)})}if(Object.keys(this._channels).length===0&&Object.keys(this._presenceChannels).length===0&&Object.keys(this._channelGroups).length===0&&Object.keys(this._presenceChannelGroups).length===0){this._lastTimetoken=0;this._currentTimetoken=0;this._storedTimetoken=null;this._region=null;this._reconnectionManager.stopPolling()}this.reconnect()}},{key:"unsubscribeAll",value:function e(t){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},t)}},{key:"getSubscribedChannels",value:function e(){return Object.keys(this._channels)}},{key:"getSubscribedChannelGroups",value:function e(){return Object.keys(this._channelGroups)}},{key:"reconnect",value:function e(){this._startSubscribeLoop();this._registerHeartbeatTimer()}},{key:"disconnect",value:function e(){this._stopSubscribeLoop();this._stopHeartbeatTimer();this._reconnectionManager.stopPolling()}},{key:"_registerHeartbeatTimer",value:function e(){this._stopHeartbeatTimer();if(this._config.getHeartbeatInterval()===0){return}this._performHeartbeatLoop();this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),this._config.getHeartbeatInterval()*1e3)}},{key:"_stopHeartbeatTimer",value:function e(){if(this._heartbeatTimer){clearInterval(this._heartbeatTimer);this._heartbeatTimer=null}}},{key:"_performHeartbeatLoop",value:function e(){var t=this;var r=Object.keys(this._channels);var n=Object.keys(this._channelGroups);var i={};if(r.length===0&&n.length===0){return}r.forEach(function(e){var r=t._channels[e].state;if(Object.keys(r).length)i[e]=r});n.forEach(function(e){var r=t._channelGroups[e].state;if(Object.keys(r).length)i[e]=r});var o=function e(r){if(r.error&&t._config.announceFailedHeartbeats){t._listenerManager.announceStatus(r)}if(r.error&&t._config.autoNetworkDetection&&t._isOnline){t._isOnline=false;t.disconnect();t._listenerManager.announceNetworkDown();t.reconnect()}if(!r.error&&t._config.announceSuccessfulHeartbeats){t._listenerManager.announceStatus(r)}};this._heartbeatEndpoint({channels:r,channelGroups:n,state:i},o.bind(this))}},{key:"_startSubscribeLoop",value:function e(){this._stopSubscribeLoop();var t=[];var r=[];Object.keys(this._channels).forEach(function(e){return t.push(e)});Object.keys(this._presenceChannels).forEach(function(e){return t.push(e+"-pnpres")});Object.keys(this._channelGroups).forEach(function(e){return r.push(e)});Object.keys(this._presenceChannelGroups).forEach(function(e){return r.push(e+"-pnpres")});if(t.length===0&&r.length===0){return}var n={channels:t,channelGroups:r,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(n,this._processSubscribeResponse.bind(this))}},{key:"_processSubscribeResponse",value:function e(t,r){var n=this;if(t.error){if(t.category===g.default.PNTimeoutCategory){this._startSubscribeLoop()}else if(t.category===g.default.PNNetworkIssuesCategory){this.disconnect();if(t.error&&this._config.autoNetworkDetection&&this._isOnline){this._isOnline=false;this._listenerManager.announceNetworkDown()}this._reconnectionManager.onReconnection(function(){if(n._config.autoNetworkDetection&&!n._isOnline){n._isOnline=true;n._listenerManager.announceNetworkUp()}n.reconnect();n._subscriptionStatusAnnounced=true;var e={category:g.default.PNReconnectedCategory,operation:t.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(e)});this._reconnectionManager.startPolling();this._listenerManager.announceStatus(t)}else if(t.category===g.default.PNBadRequestCategory){this._stopHeartbeatTimer();this._listenerManager.announceStatus(t)}else{this._listenerManager.announceStatus(t)}return}if(this._storedTimetoken){this._currentTimetoken=this._storedTimetoken;this._storedTimetoken=null}else{this._lastTimetoken=this._currentTimetoken;this._currentTimetoken=r.metadata.timetoken}if(!this._subscriptionStatusAnnounced){var i={};i.category=g.default.PNConnectedCategory;i.operation=t.operation;i.affectedChannels=this._pendingChannelSubscriptions;i.subscribedChannels=this.getSubscribedChannels();i.affectedChannelGroups=this._pendingChannelGroupSubscriptions;i.lastTimetoken=this._lastTimetoken;i.currentTimetoken=this._currentTimetoken;this._subscriptionStatusAnnounced=true;this._listenerManager.announceStatus(i);this._pendingChannelSubscriptions=[];this._pendingChannelGroupSubscriptions=[]}var o=r.messages||[];var u=this._config,a=u.requestMessageCountThreshold,s=u.dedupeOnSubscribe;if(a&&o.length>=a){var c={};c.category=g.default.PNRequestMessageCountExceededCategory;c.operation=t.operation;this._listenerManager.announceStatus(c)}o.forEach(function(e){var t=e.channel;var r=e.subscriptionMatch;var i=e.publishMetaData;if(t===r){r=null}if(s){if(n._dedupingManager.isDuplicate(e)){return}else{n._dedupingManager.addEntry(e)}}if(v.default.endsWith(e.channel,"-pnpres")){var o={};o.channel=null;o.subscription=null;o.actualChannel=r!=null?t:null;o.subscribedChannel=r!=null?r:t;if(t){o.channel=t.substring(0,t.lastIndexOf("-pnpres"))}if(r){o.subscription=r.substring(0,r.lastIndexOf("-pnpres"))}o.action=e.payload.action;o.state=e.payload.data;o.timetoken=i.publishTimetoken;o.occupancy=e.payload.occupancy;o.uuid=e.payload.uuid;o.timestamp=e.payload.timestamp;if(e.payload.join){o.join=e.payload.join}if(e.payload.leave){o.leave=e.payload.leave}if(e.payload.timeout){o.timeout=e.payload.timeout}n._listenerManager.announcePresence(o)}else{var u={};u.channel=null;u.subscription=null;u.actualChannel=r!=null?t:null;u.subscribedChannel=r!=null?r:t;u.channel=t;u.subscription=r;u.timetoken=i.publishTimetoken;u.publisher=e.issuingClientId;if(e.userMetadata){u.userMetadata=e.userMetadata}if(n._config.cipherKey){u.message=n._crypto.decrypt(e.payload)}else{u.message=e.payload}n._listenerManager.announceMessage(u)}});this._region=r.metadata.region;this._startSubscribeLoop()}},{key:"_stopSubscribeLoop",value:function e(){if(this._subscribeCall){if(typeof this._subscribeCall.abort==="function"){this._subscribeCall.abort()}this._subscribeCall=null}}}]);return e}();t.default=w;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(137);var o=a(i);var u=r(3);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){var r=t.timeEndpoint;s(this,e);this._timeEndpoint=r}n(e,[{key:"onReconnection",value:function e(t){this._reconnectionCallback=t}},{key:"startPolling",value:function e(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:"stopPolling",value:function e(){clearInterval(this._timeTimer)}},{key:"_performTimeLoop",value:function e(){var t=this;this._timeEndpoint(function(e){if(!e.error){clearInterval(t._timeTimer);t._reconnectionCallback()}})}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(29);var o=a(i);var u=r(3);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function e(t){var r=0;if(t.length===0)return r;for(var n=0;n<t.length;n+=1){var i=t.charCodeAt(n);r=(r<<5)-r+i;r=r&r}return r};var f=function(){function e(t){var r=t.config;s(this,e);this.hashHistory=[];this._config=r}n(e,[{key:"getKey",value:function e(t){var r=c(JSON.stringify(t.payload)).toString();var n=t.publishMetaData.publishTimetoken;return n+"-"+r}},{key:"isDuplicate",value:function e(t){return this.hashHistory.includes(this.getKey(t))}},{key:"addEntry",value:function e(t){if(this.hashHistory.length>=this._config.maximumCacheSize){this.hashHistory.shift()}this.hashHistory.push(this.getKey(t))}},{key:"clearHistory",value:function e(){this.hashHistory=[]}}]);return e}();t.default=f;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e,t){var r=e.networking,n=e.config;var o=null;var u=null;var s={};if(t.getOperation()===l.default.PNTimeOperation||t.getOperation()===l.default.PNChannelGroupsOperation){o=arguments.length<=2?undefined:arguments[2]}else{s=arguments.length<=2?undefined:arguments[2];o=arguments.length<=3?undefined:arguments[3]}if(typeof Promise!=="undefined"&&!o){u=a.default.createPromise()}var c=t.validateParams(e,s);if(c){if(o){return o(g(c))}else if(u){u.reject(new y("Validation failed, check status for details",g(c)));return u.promise}return}var f=t.prepareParams(e,s);var h=m(t,e,s);var d=void 0;var p={url:h,operation:t.getOperation(),timeout:t.getRequestTimeout(e)};f.uuid=n.UUID;f.pnsdk=_(n);if(n.useInstanceId){f.instanceid=n.instanceId}if(n.useRequestId){f.requestid=i.default.createUUID()}if(t.isAuthSupported()&&n.getAuthKey()){f.auth=n.getAuthKey()}if(n.secretKey){w(e,h,f)}var v=function r(n,i){if(n.error){if(o){o(n)}else if(u){u.reject(new y("PubNub call failed, check status for details",n))}return}var a=t.handleResponse(e,i,s);if(o){o(n,a)}else if(u){u.fulfill(a)}};if(t.usePost&&t.usePost(e,s)){var b=t.postPayload(e,s);d=r.POST(f,b,p,v)}else if(t.useDelete&&t.useDelete()){d=r.DELETE(f,p,v)}else{d=r.GET(f,p,v)}if(t.getOperation()===l.default.PNSubscribeOperation){return d}if(u){return u.promise}};var n=r(90);var i=h(n);var o=r(3);var u=r(10);var a=h(u);var s=r(29);var c=h(s);var f=r(5);var l=h(f);function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var y=function(e){v(t,e);function t(e,r){d(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.name=n.constructor.name;n.status=r;n.message=e;return n}return t}(Error);function b(e,t){e.type=t;e.error=true;return e}function g(e){return b({message:e},"validationError")}function m(e,t,r){if(e.usePost&&e.usePost(t,r)){return e.postURL(t,r)}else{return e.getURL(t,r)}}function _(e){if(e.sdkName){return e.sdkName}var t="PubNub-JS-"+e.sdkFamily;if(e.partnerId){t+="-"+e.partnerId}t+="/"+e.getVersion();return t}function w(e,t,r){var n=e.config,i=e.crypto;r.timestamp=Math.floor((new Date).getTime()/1e3);var o=n.subscribeKey+"\n"+n.publishKey+"\n"+t+"\n";o+=a.default.signPamFromParams(r);var u=i.HMACSHA256(o);u=u.replace(/\+/g,"-");u=u.replace(/\//g,"_");r.signature=u}e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNAddChannelsToGroupOperation}function f(e,t){var r=t.channels,n=t.channelGroup;var i=e.config;if(!n)return"Missing Channel Group";if(!r||r.length===0)return"Missing Channels";if(!i.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channels,n=r===undefined?[]:r;return{add:n.join(",")}}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNRemoveChannelsFromGroupOperation}function f(e,t){var r=t.channels,n=t.channelGroup;var i=e.config;if(!n)return"Missing Channel Group";if(!r||r.length===0)return"Missing Channels";if(!i.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channels,n=r===undefined?[]:r;return{remove:n.join(",")}}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.isAuthSupported=h;t.getRequestTimeout=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNRemoveGroupOperation}function f(e,t){var r=t.channelGroup;var n=e.config;if(!r)return"Missing Channel Group";if(!n.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)+"/remove"}function h(){return true}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return{}}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNChannelGroupsOperation}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function c(e){var t=e.config;return"/v1/channel-registration/sub-key/"+t.subscribeKey+"/channel-group"}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(){return{}}function d(e,t){return{groups:t.payload.groups}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNChannelsForGroupOperation}function f(e,t){var r=t.channelGroup;var n=e.config;if(!r)return"Missing Channel Group";if(!n.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(){return{}}function v(e,t){return{channels:t.payload.channels}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNPushNotificationEnabledChannelsOperation}function s(e,t){var r=t.device,n=t.pushGateway,i=t.channels;var o=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i||i.length===0)return"Missing Channels";if(!o.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway,n=t.channels,i=n===undefined?[]:n;return{type:r,add:i.join(",")}}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNPushNotificationEnabledChannelsOperation}function s(e,t){var r=t.device,n=t.pushGateway,i=t.channels;var o=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i||i.length===0)return"Missing Channels";if(!o.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway,n=t.channels,i=n===undefined?[]:n;return{type:r,remove:i.join(",")}}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNPushNotificationEnabledChannelsOperation}function s(e,t){var r=t.device,n=t.pushGateway;var i=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway;return{type:r}}function d(e,t){return{channels:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNRemoveAllPushNotificationsOperation}function s(e,t){var r=t.device,n=t.pushGateway;var i=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r+"/remove"}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway;return{type:r}}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNUnsubscribeOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(o)+"/leave"}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r;var i={};if(n.length>0){i["channel-group"]=n.join(",")}return i}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNWhereNowOperation}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=e.config;var n=t.uuid,i=n===undefined?r.UUID:n;return"/v2/presence/sub-key/"+r.subscribeKey+"/uuid/"+i}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(){return{}}function d(e,t){if(!t.payload){return{channels:[]}}return{channels:t.payload.channels}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.isAuthSupported=h;t.getRequestTimeout=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNHeartbeatOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(o)+"/heartbeat"}function h(){return true}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r,i=t.state,o=i===undefined?{}:i;var u=e.config;var a={};if(n.length>0){a["channel-group"]=n.join(",")}a.state=JSON.stringify(o);a.heartbeat=u.getPresenceTimeout();return a}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNGetStateOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.uuid,i=n===undefined?r.UUID:n,o=t.channels,u=o===undefined?[]:o;var s=u.length>0?u.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(s)+"/uuid/"+i}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r;var i={};if(n.length>0){i["channel-group"]=n.join(",")}return i}function v(e,t,r){var n=r.channels,i=n===undefined?[]:n,o=r.channelGroups,u=o===undefined?[]:o;var a={};if(i.length===1&&u.length===0){a[i[0]]=t.payload}else{a=t.payload}return{channels:a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNSetStateOperation}function f(e,t){var r=e.config;var n=t.state,i=t.channels,o=i===undefined?[]:i,u=t.channelGroups,a=u===undefined?[]:u;if(!n)return"Missing State";if(!r.subscribeKey)return"Missing Subscribe Key";if(o.length===0&&a.length===0)return"Please provide a list of channels and/or channel-groups"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(o)+"/uuid/"+r.UUID+"/data"}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.state,n=t.channelGroups,i=n===undefined?[]:n;var o={};o.state=JSON.stringify(r);if(i.length>0){o["channel-group"]=i.join(",")}return o}function v(e,t){return{state:t.payload}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNHereNowOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n,o=t.channelGroups,u=o===undefined?[]:o;var s="/v2/presence/sub-key/"+r.subscribeKey;if(i.length>0||u.length>0){var c=i.length>0?i.join(","):",";s+="/channel/"+a.default.encodeString(c)}return s}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r,i=t.includeUUIDs,o=i===undefined?true:i,u=t.includeState,a=u===undefined?false:u;var s={};if(!o)s.disable_uuids=1;if(a)s.state=1;if(n.length>0){s["channel-group"]=n.join(",")}return s}function v(e,t,r){var n=r.channels,i=n===undefined?[]:n,o=r.channelGroups,u=o===undefined?[]:o,a=r.includeUUIDs,s=a===undefined?true:a,c=r.includeState,f=c===undefined?false:c;var l=function e(){var r={};var n=[];r.totalChannels=1;r.totalOccupancy=t.occupancy;r.channels={};r.channels[i[0]]={occupants:n,name:i[0],occupancy:t.occupancy};if(s&&t.uuids){t.uuids.forEach(function(e){if(f){n.push({state:e.state,uuid:e.uuid})}else{n.push({state:null,uuid:e})}})}return r};var h=function e(){var r={};r.totalChannels=t.payload.total_channels;r.totalOccupancy=t.payload.total_occupancy;r.channels={};Object.keys(t.payload.channels).forEach(function(e){var n=t.payload.channels[e];var i=[];r.channels[e]={occupants:i,name:e,occupancy:n.occupancy};if(s){n.uuids.forEach(function(e){if(f){i.push({state:e.state,uuid:e.uuid})}else{i.push({state:null,uuid:e})}})}return r});return r};var d=void 0;if(i.length>1||u.length>0||u.length===0&&i.length===0){d=h()}else{d=l()}return d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNAccessManagerAudit}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function c(e){var t=e.config;return"/v2/auth/audit/sub-key/"+t.subscribeKey}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return false}function h(e,t){var r=t.channel,n=t.channelGroup,i=t.authKeys,o=i===undefined?[]:i;var u={};if(r){u.channel=r}if(n){u["channel-group"]=n}if(o.length>0){u.auth=o.join(",")}return u}function d(e,t){return t.payload}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(3);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNAccessManagerGrant}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key";if(!t.publishKey)return"Missing Publish Key";if(!t.secretKey)return"Missing Secret Key"}function c(e){var t=e.config;return"/v2/auth/grant/sub-key/"+t.subscribeKey}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return false}function h(e,t){var r=t.channels,n=r===undefined?[]:r,i=t.channelGroups,o=i===undefined?[]:i,u=t.ttl,a=t.read,s=a===undefined?false:a,c=t.write,f=c===undefined?false:c,l=t.manage,h=l===undefined?false:l,d=t.authKeys,p=d===undefined?[]:d;var v={};v.r=s?"1":"0";v.w=f?"1":"0";v.m=h?"1":"0";if(n.length>0){v.channel=n.join(",")}if(o.length>0){v["channel-group"]=o.join(",")}if(p.length>0){v.auth=p.join(",")}if(u||u===0){v.ttl=u}return v}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getOperation=l;t.validateParams=h;t.usePost=d;t.getURL=p;t.postURL=v;t.getRequestTimeout=y;t.isAuthSupported=b;t.postPayload=g;t.prepareParams=m;t.handleResponse=_;var i=r(3);var o=r(5);var u=c(o);var a=r(10);var s=c(a);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var r=e.crypto,n=e.config;var i=JSON.stringify(t);if(n.cipherKey){i=r.encrypt(i);i=JSON.stringify(i)}return i}function l(){return u.default.PNPublishOperation}function h(e,t){var r=e.config;var n=t.message,i=t.channel;if(!i)return"Missing Channel";if(!n)return"Missing Message";if(!r.subscribeKey)return"Missing Subscribe Key"}function d(e,t){var r=t.sendByPost,n=r===undefined?false:r;return n}function p(e,t){var r=e.config;var n=t.channel,i=t.message;var o=f(e,i);return"/publish/"+r.publishKey+"/"+r.subscribeKey+"/0/"+s.default.encodeString(n)+"/0/"+s.default.encodeString(o)}function v(e,t){var r=e.config;var n=t.channel;return"/publish/"+r.publishKey+"/"+r.subscribeKey+"/0/"+s.default.encodeString(n)+"/0"}function y(e){var t=e.config;return t.getTransactionTimeout()}function b(){return true}function g(e,t){var r=t.message;return f(e,r)}function m(e,t){var r=t.meta,i=t.replicate,o=i===undefined?true:i,u=t.storeInHistory,a=t.ttl;var s={};if(u!=null){if(u){s.store="1"}else{s.store="0"}}if(a){s.ttl=a}if(o===false){s.norep="true"}if(r&&(typeof r==="undefined"?"undefined":n(r))==="object"){s.meta=JSON.stringify(r)}return s}function _(e,t){return{timetoken:t[2]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=f;t.validateParams=l;t.getURL=h;t.getRequestTimeout=d;t.isAuthSupported=p;t.prepareParams=v;t.handleResponse=y;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var r=e.config,n=e.crypto;if(!r.cipherKey)return t;try{return n.decrypt(t)}catch(e){return t}}function f(){return o.default.PNHistoryOperation}function l(e,t){var r=t.channel;var n=e.config;if(!r)return"Missing channel";if(!n.subscribeKey)return"Missing Subscribe Key"}function h(e,t){var r=t.channel;var n=e.config;return"/v2/history/sub-key/"+n.subscribeKey+"/channel/"+a.default.encodeString(r)}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return true}function v(e,t){var r=t.start,n=t.end,i=t.reverse,o=t.count,u=o===undefined?100:o,a=t.stringifiedTimeToken,s=a===undefined?false:a;var c={include_token:"true"};c.count=u;if(r)c.start=r;if(n)c.end=n;if(s)c.string_message_token="true";if(i!=null)c.reverse=i.toString();return c}function y(e,t){var r={messages:[],startTimeToken:t[1],endTimeToken:t[2]};t[0].forEach(function(t){var n={timetoken:t.timetoken,entry:c(e,t.message)};r.messages.push(n)});return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.useDelete=l;t.getURL=h;t.getRequestTimeout=d;t.isAuthSupported=p;t.prepareParams=v;t.handleResponse=y;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNDeleteMessagesOperation}function f(e,t){var r=t.channel;var n=e.config;if(!r)return"Missing channel";if(!n.subscribeKey)return"Missing Subscribe Key"}function l(){return true}function h(e,t){var r=t.channel,n=t.start,i=t.end;var o=e.config;var u="";if(n){u="?start="+n}if(i){u+=(u!==""?"&":"?")+"end="+i}return"/v3/history/sub-key/"+o.subscribeKey+"/channel/"+a.default.encodeString(r)+u}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return true}function v(e,t){var r=t.start,n=t.end;var i={};if(r)i.start=r;if(n)i.end=n;return{}}function y(e,t){return t.payload}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=f;t.validateParams=l;t.getURL=h;t.getRequestTimeout=d;t.isAuthSupported=p;t.prepareParams=v;t.handleResponse=y;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var r=e.config,n=e.crypto;if(!r.cipherKey)return t;try{return n.decrypt(t)}catch(e){return t}}function f(){return o.default.PNFetchMessagesOperation}function l(e,t){var r=t.channels;var n=e.config;if(!r||r.length===0)return"Missing channels";if(!n.subscribeKey)return"Missing Subscribe Key"}function h(e,t){var r=t.channels,n=r===undefined?[]:r;var i=e.config;var o=n.length>0?n.join(","):",";return"/v3/history/sub-key/"+i.subscribeKey+"/channel/"+a.default.encodeString(o)}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return true}function v(e,t){var r=t.start,n=t.end,i=t.count;var o={};if(i)o.max=i;if(r)o.start=r;if(n)o.end=n;return o}function y(e,t){var r={channels:{}};Object.keys(t.channels||{}).forEach(function(n){r.channels[n]=[];(t.channels[n]||[]).forEach(function(t){var i={};i.channel=n;i.subscription=null;i.timetoken=t.timetoken;i.message=c(e,t.message);r.channels[n].push(i)})});return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(3);var i=r(5);var o=s(i);var u=r(10);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNSubscribeOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/subscribe/"+r.subscribeKey+"/"+a.default.encodeString(o)+"/0"}function h(e){var t=e.config;return t.getSubscribeTimeout()}function d(){return true}function p(e,t){var r=e.config;var n=t.channelGroups,i=n===undefined?[]:n,o=t.timetoken,u=t.filterExpression,a=t.region;var s={heartbeat:r.getPresenceTimeout()};if(i.length>0){s["channel-group"]=i.join(",")}if(u&&u.length>0){s["filter-expr"]=u}if(o){s.tt=o}if(a){s.tr=a}return s}function v(e,t){var r=[];t.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r};var n={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};r.push(n)});var n={timetoken:t.t.t,region:t.t.r};return{messages:r,metadata:n}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(29);var o=c(i);var u=r(57);var a=c(u);var s=r(3);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function e(t){var r=this;f(this,e);this._modules={};Object.keys(t).forEach(function(e){r._modules[e]=t[e].bind(r)})}n(e,[{key:"init",value:function e(t){this._config=t;this._maxSubDomain=20;this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain);this._providedFQDN=(this._config.secure?"https://":"http://")+this._config.origin;this._coreParams={};this.shiftStandardOrigin()}},{key:"nextOrigin",value:function e(){if(this._providedFQDN.indexOf("pubsub.")===-1){return this._providedFQDN}var t=void 0;this._currentSubDomain=this._currentSubDomain+1;if(this._currentSubDomain>=this._maxSubDomain){this._currentSubDomain=1}t=this._currentSubDomain.toString();return this._providedFQDN.replace("pubsub","ps"+t)}},{key:"shiftStandardOrigin",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this._standardOrigin=this.nextOrigin(t);return this._standardOrigin}},{key:"getStandardOrigin",value:function e(){return this._standardOrigin}},{key:"POST",value:function e(t,r,n,i){return this._modules.post(t,r,n,i)}},{key:"GET",value:function e(t,r,n){return this._modules.get(t,r,n)}},{key:"DELETE",value:function e(t,r,n){return this._modules.del(t,r,n)}},{key:"_detectErrorCategory",value:function e(t){if(t.code==="ENOTFOUND")return a.default.PNNetworkIssuesCategory;if(t.code==="ECONNREFUSED")return a.default.PNNetworkIssuesCategory;if(t.code==="ECONNRESET")return a.default.PNNetworkIssuesCategory;if(t.code==="EAI_AGAIN")return a.default.PNNetworkIssuesCategory;if(t.status===0||t.hasOwnProperty("status")&&typeof t.status==="undefined")return a.default.PNNetworkIssuesCategory;if(t.timeout)return a.default.PNTimeoutCategory;if(t.response){if(t.response.badRequest)return a.default.PNBadRequestCategory;if(t.response.forbidden)return a.default.PNAccessDeniedCategory}return a.default.PNUnknownCategory}}]);return e}();t.default=l;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function e(){i(this,e);this.storage={}}n(e,[{key:"get",value:function e(t){return this.storage[t]}},{key:"set",value:function e(t,r){this.storage[t]=r}}]);return e}();t.default=o;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.get=s;t.post=c;t.del=f;var n=r(128);var i=r(3);var o=r(392);function u(e,t,r){var n=function e(){if(console&&console.log)return console;return console};var i=(new Date).getTime();var o=(new Date).toISOString();var u=n();u.log("<<<<<");u.log("["+o+"]","\n",e,"\n",t);u.log("-----");var a=(new Date).getTime();var s=a-i;var c=(new Date).toISOString();u.log(">>>>>>");u.log("["+c+" / "+s+"]","\n",e,"\n",t,"\n",r);u.log("-----")}function a(e,t,r,i,a,s){var c=this;var f={};f.operation=a.operation;return(0,n.request)({method:e,url:(0,o.buildUrl)(t,r),content:i,timeout:a.timeout}).then(function(e){f.error=false;if(e.statusCode){f.statusCode=e.statusCode}return e.content.toJSON()}).then(function(e){var n=e;if(c._config.logVerbosity){u(t,r,n)}s(f,n)}).catch(function(e){f.error=true;f.errorData=e;f.category=c._detectErrorCategory(e);s(f,null)})}function s(e,t,r){var n=this.getStandardOrigin()+t.url;return a.call(this,"GET",n,e,"",t,r)}function c(e,t,r,n){var i=this.getStandardOrigin()+r.url;return a.call(this,"POST",i,e,t,r,n)}function f(e,t,r){var n=this.getStandardOrigin()+t.url;return a.call(this,"DELETE",n,e,"",t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.encodedKeyValuePair=i;t.buildUrl=o;function i(e,t,r){if(r!=null){if(Array.isArray(r)){r.forEach(function(r){i(e,t,r)})}else if((typeof r==="undefined"?"undefined":n(r))==="object"){Object.keys(r).forEach(function(n){i(e,t+"["+n+"]",r[n])})}else{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}}else if(r===null){e.push(encodeURIComponent(""+encodeURIComponent(t)))}}function o(e,t){var r=[];Object.keys(t).forEach(function(e){i(r,e,t[e])});return e+"?"+r.join("&")}},function(e,t,r){e.exports=r(394)},function(e,t,r){var n=r(25),i=r(73),o=r(45);var u=i(function(e,t){n(t,o(t),e)});e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(396);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(139);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Stream=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(1);var o=r(9);var u=r(2);var a=r(56);var s=r(7);var c=r(139);function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=t.Stream=function(){function e(t){f(this,e);this.name=t;this._client=o.Client.sharedInstance();this._liveService=(0,a.getLiveService)(this._client);this._subscribeChannels={};this._publishChannels={}}n(e,[{key:"getSubstreams",value:function e(){return this._makeStreamRequest("_substreams",s.RequestMethod.GET)}},{key:"getACL",value:function e(t){if(!(0,u.isNonemptyString)(t)){return Promise.reject(new i.KinveyError("Invalid or missing id"))}return this._makeStreamRequest(t,s.RequestMethod.GET)}},{key:"setACL",value:function e(t,r){if(!(0,u.isNonemptyString)(t)){return Promise.reject(new i.KinveyError("Invalid or missing id"))}if(!c.StreamACL.isValidACLObject(r)){return Promise.reject(new i.KinveyError("Invalid or missing ACL object"))}if(!(r instanceof c.StreamACL)){r=new c.StreamACL(r)}return this._makeStreamRequest(t,s.RequestMethod.PUT,r.toPlainObject())}},{key:"follow",value:function e(t,r){return this._subscribe(t,r)}},{key:"unfollow",value:function e(t){return this._unsubscribe(t)}},{key:"post",value:function e(t){var r=this._client.getActiveUser()._id;return this._publish(r,t)}},{key:"listen",value:function e(t){var r=this._client.getActiveUser()._id;return this._subscribe(r,t)}},{key:"stopListening",value:function e(){var t=this._client.getActiveUser()._id;return this._unsubscribe(t)}},{key:"send",value:function e(t,r){return this._publish(t,r)}},{key:"_unsubscribeFromSubstream",value:function e(t){var r=t+"/unsubscribe";return this._makeStreamRequest(r,s.RequestMethod.POST,{deviceId:this._client.deviceId})}},{key:"_subscribe",value:function e(t,r){var n=this;return this._requestSubscribeAccess(t).then(function(){var e=n._subscribeChannels[t];n._liveService.subscribeToChannel(e,r)})}},{key:"_unsubscribe",value:function e(t){var r=this;return this._unsubscribeFromSubstream(t).then(function(){var e=r._subscribeChannels[t];r._liveService.unsubscribeFromChannel(e);delete r._subscribeChannels[t]})}},{key:"_publish",value:function e(t,r){if(this._publishChannels[t]){return this._retriablePublish(t,r)}return this._publishWithAccessRequest(t,r)}},{key:"_publishWithAccessRequest",value:function e(t,r){var n=this;return this._requestPublishAccess(t).then(function(){var e=n._publishChannels[t];return n._liveService.publishToChannel(e,r)})}},{key:"_retriablePublish",value:function e(t,r){var n=this;var i=this._publishChannels[t];return this._liveService.publishToChannel(i,r).catch(function(e){var i=Promise.reject(e);if(e.statusCode===s.StatusCode.Forbidden){i=n._publishWithAccessRequest(t,r)}return i})}},{key:"_requestPublishAccess",value:function e(t){var r=this;return this._makeStreamRequest(t+"/publish",s.RequestMethod.POST).then(function(e){if(e.substreamChannelName){r._publishChannels[t]=e.substreamChannelName}return e})}},{key:"_requestSubscribeAccess",value:function e(t){var r=this;var n={deviceId:this._client.deviceId};return this._makeStreamRequest(t+"/subscribe",s.RequestMethod.POST,n).then(function(e){r._subscribeChannels[t]=e.substreamChannelName;return e})}},{key:"_makeStreamRequest",value:function e(t,r,n){return s.KinveyRequest.executeShort({method:r,pathname:"/stream/"+this._client.appKey+"/"+this.name+"/"+t,body:n},this._client)}}],[{key:"StreamACL",get:function e(){return c.StreamACL}}]);return e}()},function(e,t,r){var n=r(398),i=r(399),o=r(23),u=r(4),a=r(114);function s(e,t,r){var s=u(e)?n:i;if(r&&a(e,t,r)){t=undefined}return s(e,o(t,3))}e.exports=s},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length;while(++r<n){if(!t(e[r],r,e)){return false}}return true}e.exports=r},function(e,t,r){var n=r(33);function i(e,t){var r=true;n(e,function(e,n,i){r=!!t(e,n,i);return r});return r}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.onConnectionStatusUpdates=u;t.offConnectionStatusUpdates=a;t.isInitialized=s;var n=r(9);var i=r(56);function o(){var e=n.Client.sharedInstance();return(0,i.getLiveService)(e)}function u(e){o().onConnectionStatusUpdates(e)}function a(e){o().offConnectionStatusUpdates(e)}function s(){return o().isInitialized()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DataStore=t.DataStoreType=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(8);var o=v(i);var u=r(11);var a=v(u);var s=r(7);var c=r(1);var f=r(2);var l=r(9);var h=r(88);var d=r(83);var p=r(141);function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=t.DataStoreType={Cache:"Cache",Network:"Network",Sync:"Sync"};Object.freeze(b);var g=function(){function e(){y(this,e);throw new c.KinveyError("Not allowed to construct a DataStore instance."+" Please use the collection() function to get an instance of a DataStore instance.")}n(e,null,[{key:"collection",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:b.Cache;var n=arguments[2];var i=void 0;if((0,f.isDefined)(t)===false||(0,o.default)(t)===false){throw new c.KinveyError("A collection is required and must be a string.")}switch(r){case b.Network:i=new h.NetworkStore(t,n);break;case b.Sync:i=new p.SyncStore(t,n);break;case b.Cache:default:i=new d.CacheStore(t,n)}return i}},{key:"getInstance",value:function e(t,r,n){return this.collection(t,r,n)}},{key:"clearCache",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=t.client||l.Client.sharedInstance();var n="/appdata/"+r.appKey;var i=new s.CacheRequest({method:s.RequestMethod.DELETE,url:a.default.format({protocol:r.apiProtocol,host:r.apiHost,pathname:n}),properties:t.properties,timeout:t.timeout});return i.execute().then(function(e){return e.data})}}]);return e}();t.DataStore=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UserStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var o=r(6);var u=m(o);var a=r(4);var s=m(a);var c=r(8);var f=m(c);var l=r(11);var h=m(l);var d=r(7);var p=r(1);var v=r(36);var y=r(2);var b=r(12);var g=r(55);function m(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function w(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function O(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var E=t.UserStore=function(e){O(t,e);function t(e){_(this,t);return w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null,e))}n(t,[{key:"lookup",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){if((0,y.isDefined)(t)&&!(t instanceof b.Query)){return e.error(new p.KinveyError("Invalid query. It must be an instance of the Query class."))}var i=new d.KinveyRequest({method:d.RequestMethod.POST,authType:d.AuthType.Default,url:h.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/_lookup"}),properties:n.properties,body:(0,y.isDefined)(t)?t.toPlainObject().filter:null,timeout:n.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i}},{key:"create",value:function e(){return u.default.reject(new p.KinveyError("Please use `User.signup()` to create a user."))}},{key:"update",value:function e(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!r){return u.default.reject(new p.KinveyError("No user was provided to be updated."))}if((0,s.default)(r)){return u.default.reject(new p.KinveyError("Only one user can be updated at one time.",r))}if(!r._id){return u.default.reject(new p.KinveyError("User must have an _id."))}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,r,n)}},{key:"exists",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new d.KinveyRequest({method:d.RequestMethod.POST,authType:d.AuthType.App,url:h.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:"/rpc/"+this.client.appKey+"/check-username-exists"}),properties:r.properties,data:{username:t},timeout:r.timeout,client:this.client});return n.execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return e.usernameExists===true})}},{key:"removeById",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){if((0,y.isDefined)(t)===false){return e.error(new p.KinveyError("An id was not provided.","Please provide a valid id for a user that you would like to remove."))}if((0,f.default)(t)===false){return e.error(new p.KinveyError("The id provided is not a string.","Please provide a valid id for a user that you would like to remove."))}var i=new d.KinveyRequest({method:d.RequestMethod.DELETE,authType:d.AuthType.Default,url:h.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t,query:n.hard===true?{hard:true}:undefined}),properties:n.properties,timeout:n.timeout});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"pathname",get:function e(){return"/user/"+this.client.appKey}}]);return t}(g.NetworkStore)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CustomEndpoint=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=d(i);var u=r(8);var a=d(u);var s=r(11);var c=d(s);var f=r(1);var l=r(9);var h=r(7);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var v=t.CustomEndpoint=function(){function e(){p(this,e);throw new f.KinveyError("Not allowed to create an instance of the `CustomEndpoint` class.","Please use `CustomEndpoint.execute()` function.")}n(e,null,[{key:"execute",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=n.client||l.Client.sharedInstance();if(!t){return o.default.reject(new f.KinveyError("An endpoint argument is required."))}if(!(0,a.default)(t)){return o.default.reject(new f.KinveyError("The endpoint argument must be a string."))}var u=new h.KinveyRequest({method:h.RequestMethod.POST,authType:h.AuthType.Default,url:c.default.format({protocol:i.apiProtocol,host:i.apiHost,pathname:"/rpc/"+i.appKey+"/custom/"+t}),properties:n.properties,body:r,timeout:n.timeout,client:i});return u.execute().then(function(e){return e.data})}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Files=t.FileStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=E(i);var u=r(84);var a=E(u);var s=r(17);var c=E(s);var f=r(20);var l=E(f);var h=r(75);var d=E(h);var p=r(11);var v=E(p);var y=r(7);var b=r(1);var g=r(36);var m=r(22);var _=r(2);var w=r(12);var O=r(55);function E(e){return e&&e.__esModule?e:{default:e}}function k(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function P(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function j(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function S(e,t){return Math.floor(Math.random()*(t-e))+e}function A(e,t){var r=e?parseInt(e.split("-")[1],10)+1:0;return r>=t?t-1:r}var T=t.FileStore=function(e){j(t,e);function t(){k(this,t);return P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"find",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};n=(0,c.default)({tls:true},n);var i={tls:n.tls===true};if((0,d.default)(n.ttl)){i.ttl_in_seconds=parseInt(n.ttl,10)}var u=g.KinveyObservable.create(function(e){if((0,_.isDefined)(t)&&!(t instanceof w.Query)){return e.error(new b.KinveyError("Invalid query. It must be an instance of the Query class."))}var o=new y.KinveyRequest({method:y.RequestMethod.GET,authType:y.AuthType.Default,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname,query:i}),properties:n.properties,query:t,timeout:n.timeout,client:r.client});return o.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return u.toPromise().then(function(e){if(n.download===true){return o.default.all((0,a.default)(e,function(e){return r.downloadByUrl(e._downloadURL,n)}))}return e})}},{key:"findById",value:function e(t,r){return this.download(t,r)}},{key:"download",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};n=(0,c.default)({tls:true},n);var i={tls:n.tls===true};if((0,d.default)(n.ttl)){i.ttl_in_seconds=parseInt(n.ttl,10)}var o=g.KinveyObservable.create(function(e){if((0,_.isDefined)(t)===false){e.next(undefined);return e.complete()}var o=new y.KinveyRequest({method:y.RequestMethod.GET,authType:y.AuthType.Default,url:v.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+t,query:i}),properties:n.properties,timeout:n.timeout,client:r.client});return o.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return o.toPromise().then(function(e){if(n.stream===true){return e}n.mimeType=e.mimeType;return r.downloadByUrl(e._downloadURL,n)})}},{key:"downloadByUrl",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new y.NetworkRequest({method:y.RequestMethod.GET,url:t,timeout:r.timeout});return n.execute().then(function(e){return e.data})}},{key:"stream",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};r.stream=true;return this.download(t,r)}},{key:"upload",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};n=this.transformMetadata(t,n);var u=null;return this.saveFileMetadata(i,n).then(function(e){u=e.data;return r.makeStatusCheckRequest(e.data._uploadURL,e.data._requiredHeaders,n,i.timeout)}).then(function(e){m.Log.debug("File upload status check response",e);if(!e.isSuccess()){return o.default.reject(e.error)}if(e.statusCode===200||e.statusCode===201){return e}if(e.statusCode!==308){var a=new b.KinveyError("Unexpected response for upload file status check request.",false,e.statusCode,e.headers.get("X-Kinvey-Request-ID"));return o.default.reject(a)}var s={start:A(e.headers.get("range"),n.size),timeout:i.timeout,maxBackoff:i.maxBackoff,headers:u._requiredHeaders};return r.retriableUpload(u._uploadURL,t,n,s)}).then(function(){delete u._expiresAt;delete u._requiredHeaders;delete u._uploadURL;u._data=t;return u})}},{key:"transformMetadata",value:function e(t,r){var n=(0,c.default)({filename:t._filename||t.name,public:false,size:t.size||t.length,mimeType:t.mimeType||t.type||"application/octet-stream"},r);n._filename=r.filename;delete n.filename;n._public=r.public;delete n.public;return n}},{key:"saveFileMetadata",value:function e(t,r){var n=(0,_.isDefined)(r._id);var i=new y.KinveyRequest({method:n?y.RequestMethod.PUT:y.RequestMethod.POST,authType:y.AuthType.Default,headers:{"X-Kinvey-Content-Type":r.mimeType},url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:n?this.pathname+"/"+r._id:this.pathname}),properties:t.properties,timeout:t.timeout,body:r,client:this.client});return i.execute()}},{key:"makeStatusCheckRequest",value:function e(t,r,n,i){var o=new y.Headers(r);o.set("content-type",n.mimeType);o.set("content-range","bytes */"+n.size);var u=new y.NetworkRequest({method:y.RequestMethod.PUT,url:t,timeout:i,headers:o});return u.execute()}},{key:"retriableUpload",value:function e(t,r,n,i){var u=this;i=(0,c.default)({count:0,start:0,maxBackoff:32*1e3},i);m.Log.debug("Start file upload");m.Log.debug("File upload headers",i.headers);m.Log.debug("File upload upload url",v.default);m.Log.debug("File upload file",r);m.Log.debug("File upload metadata",n);m.Log.debug("File upload options",i);return this.makeUploadRequest(t,r,n,i).then(function(e){m.Log.debug("File upload response",e);if(e.isClientError()){return o.default.reject(e.error)}if(!e.isSuccess()&&!e.isServerError()&&e.statusCode!==308){var t=new b.KinveyError("Unexpected response for upload file request.",false,e.statusCode,e.headers.get("X-Kinvey-Request-ID"));return o.default.reject(t)}return e}).then(function(e){var t=0;if(e.isServerError()){m.Log.debug("File upload server error. Probably network congestion.",e.statusCode,e.data);t=Math.pow(2,i.count)+S(1,1001);if(t>=i.maxBackoff){return o.default.reject(e.error)}m.Log.debug("File upload will try again in "+t+" seconds.");return new o.default(function(e){setTimeout(function(){i.count+=1;e(true)},t)})}if(e.statusCode===308){m.Log.debug("File upload was incomplete (statusCode 308). Trying to upload the remainder of file.");i.start=A(e.headers.get("range"),n.size);return new o.default(function(e){setTimeout(function(){i.count=0;e(true)},t)})}return new o.default(function(e){setTimeout(function(){e(false)},t)})}).then(function(e){if(e){return u.retriableUpload(t,r,n,i)}return null})}},{key:"makeUploadRequest",value:function e(t,r,n,i){var o=new y.Headers(i.headers);o.set("content-type",n.mimeType);o.set("content-range","bytes "+i.start+"-"+(n.size-1)+"/"+n.size);var u=new y.NetworkRequest({method:y.RequestMethod.PUT,url:t,headers:o,body:(0,l.default)(r.slice)?r.slice(i.start):r,timeout:i.timeout});return u.execute()}},{key:"create",value:function e(t,r,n){return this.upload(t,r,n)}},{key:"update",value:function e(t,r,n){return this.upload(t,r,n)}},{key:"remove",value:function e(){throw new b.KinveyError("Please use removeById() to remove files one by one.")}},{key:"pathname",get:function e(){return"/blob/"+this.client.appKey}}]);return t}(O.NetworkStore);var x=t.Files=new T},function(e,t,r){"use strict";r(406)},function(e,t,r){"use strict";if(typeof Object.assign!="function"){Object.defineProperty(Object,"assign",{value:function e(t,r){"use strict";if(t==null){throw new TypeError("Cannot convert undefined or null to object")}var n=Object(t);for(var i=1;i<arguments.length;i++){var o=arguments[i];if(o!=null){for(var u in o){if(Object.prototype.hasOwnProperty.call(o,u)){n[u]=o[u]}}}}return n},writable:true,configurable:true})}},function(e,t,r){"use strict";function n(e){for(var r in e)if(!t.hasOwnProperty(r))t[r]=e[r]}Object.defineProperty(t,"__esModule",{value:true});n(r(408));var i=r(412);t.Push=i.Push;var o=r(127);t.StorageProvider=o.StorageProvider},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(6);var i=r(2);var o=r(1);var u=r(409);var a="user";var s="kinvey_active_user";function c(e){if(e===void 0){e={}}if(!i.isDefined(e.appKey)){throw new o.KinveyError("No App Key was provided."+" Unable to create a new Client without an App Key.")}if(!i.isDefined(e.appSecret)&&!i.isDefined(e.masterSecret)){throw new o.KinveyError("No App Secret or Master Secret was provided."+" Unable to create a new Client without an App Secret.")}return u.Client.init(e)}t.init=c;function f(e){var t=c(e);return n.Promise.resolve(t.getActiveUser())}t.initialize=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(9);var i=r(1);var o=r(2);var u=r(22);var a=r(410);var s=new a.SecureStorage;var c=function(){function e(){}e.prototype.get=function(e){if(typeof e!=="string"){throw new i.KinveyError("The key argument must be a string.")}try{return JSON.parse(s.get(e))}catch(e){u.Log.debug("Unable to parse stored active user.",e);return null}};e.prototype.set=function(e,t){if(typeof e!=="string"){throw new i.KinveyError("The key argument must be a string.")}if(o.isDefined(t)){s.set(e,t)}else{this.remove(e)}return t};e.prototype.remove=function(e){if(typeof e!=="string"){throw new i.KinveyError("The key argument must be a string.")}s.remove(e);return null};return e}();var f=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.init=function(e){var t=n.Client.init(e);t.activeUserStorage=new c;return t};return t}(n.Client);t.Client=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(411);var i=com.orhanobut.hawk.Hawk;var o=function(){function e(){this.hawk=i.init(n.ad.getApplicationContext()).build()}e.prototype.get=function(e){if(typeof e!=="string"){throw new Error("The key argument must be a string.")}return i.get(e)};e.prototype.set=function(e,t){if(typeof e!=="string"){throw new Error("The key argument must be a string.")}if(t!==null&&t!==undefined&&typeof t==="object"){t=JSON.stringify(t)}if(t!==null&&t!==undefined&&typeof t!=="string"){t=String(t)}return i.put(e,t)};e.prototype.remove=function(e){if(typeof e!=="string"){throw new Error("The key argument must be a string.")}return i.delete(e)};return e}();t.SecureStorage=o},function(e,t){e.exports=require("utils/utils")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(6);var i=r(2);var o=r(1);var u=r(413);var a;try{a=r(414)}catch(e){}var s=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype._registerWithPushPlugin=function(e){var t=this;if(e===void 0){e={}}var r=e.android||{};return new n.Promise(function(e,n){if(i.isDefined(a)===false){return n(new o.KinveyError("NativeScript Push Plugin is not installed.","Please refer to http://devcenter.kinvey.com/nativescript/guides/push#ProjectSetUp for help with"+" setting up your project."))}a.register(r,e,n);a.onMessageReceived(function(e){t.emit("notification",e)})})};t.prototype._unregisterWithPushPlugin=function(e){if(e===void 0){e={}}return new n.Promise(function(t,r){if(i.isDefined(a)===false){return r(new o.KinveyError("NativeScript Push Plugin is not installed.","Please refer to http://devcenter.kinvey.com/nativescript/guides/push#ProjectSetUp for help with"+" setting up your project."))}a.unregister(t,r,e)})};return t}(u.PushCommon);var c=new s;t.Push=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(6);var i=r(54);var o=r(129);var u=r(9);var a=r(1);var s=r(2);var c=r(82);var f=r(7);var l=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"client",{get:function(){if(s.isDefined(this._client)===false){return u.Client.sharedInstance()}return this._client},set:function(e){if(s.isDefined(e)&&e instanceof u.Client===false){throw new Error("client must be an instance of Client.")}this._client=e},enumerable:true,configurable:true});t.prototype.onNotification=function(e){return this.on("notification",e)};t.prototype.onceNotification=function(e){return this.once("notification",e)};t.prototype.register=function(e){var t=this;if(e===void 0){e={}}return this._registerWithPushPlugin(e).then(function(r){if(s.isDefined(r)===false){throw new a.KinveyError("Unable to retrieve the device token to register this device for push notifications.")}return t._registerWithKinvey(r,e)}).then(function(r){return t._saveTokenToCache(r,e)})};t.prototype.unregister=function(e){var t=this;if(e===void 0){e={}}return this._unregisterWithPushPlugin(e).then(function(){return t._getTokenFromCache(e)}).then(function(r){if(s.isDefined(r)===false){throw new a.KinveyError("Unable to retrieve the device token to unregister this device for push notifications.")}return t._unregisterWithKinvey(r,e)}).then(function(){return t._deleteTokenFromCache(e)})};t.prototype._registerWithPushPlugin=function(e){if(e===void 0){e={}}return n.Promise.reject(new a.KinveyError("Unable to register for push notifications."))};t.prototype._unregisterWithPushPlugin=function(e){if(e===void 0){e={}}return n.Promise.reject(new a.KinveyError("Unable to unregister for push notifications."))};t.prototype._registerWithKinvey=function(e,t){if(t===void 0){t={}}var r=c.User.getActiveUser(this.client);if(s.isDefined(r)===false){return n.Promise.reject(new a.KinveyError("Unable to register this device for push notifications.","You must login a user."))}var i=new f.KinveyRequest({method:f.RequestMethod.POST,url:this.client.apiHostname+"/push/"+this.client.appKey+"/register-device",authType:r?f.AuthType.Session:f.AuthType.Master,data:{platform:o.device.os.toLowerCase(),framework:"nativescript",deviceId:e},timeout:t.timeout,client:this.client});return i.execute().then(function(){return e})};t.prototype._unregisterWithKinvey=function(e,t){if(t===void 0){t={}}var r=c.User.getActiveUser(this.client);if(s.isDefined(r)===false){return n.Promise.reject(new a.KinveyError("Unable to unregister this device for push notifications.","You must login a user."))}var i=new f.KinveyRequest({method:f.RequestMethod.POST,url:this.client.apiHostname+"/push/"+this.client.appKey+"/unregister-device",authType:s.isDefined(r)?f.AuthType.Session:f.AuthType.Master,data:{platform:o.device.os.toLowerCase(),framework:"nativescript",deviceId:e},timeout:t.timeout,client:this.client});return i.execute().then(function(e){return e.data})};t.prototype._getTokenFromCache=function(e){if(e===void 0){e={}}var t=c.User.getActiveUser(this.client);if(s.isDefined(t)===false){throw new a.KinveyError("Unable to retrieve device token.","You must login a user.")}var r=new f.CacheRequest({method:f.RequestMethod.GET,url:this.client.apiHostname+"/appdata/"+this.client.appKey+"/__device/"+t._id,client:this.client});return r.execute().catch(function(e){if(e instanceof a.NotFoundError){return{}}throw e}).then(function(e){return e.data}).then(function(e){if(s.isDefined(e)){return e.token}return null})};t.prototype._saveTokenToCache=function(e,t){if(t===void 0){t={}}var r=c.User.getActiveUser(this.client);if(s.isDefined(r)===false){throw new a.KinveyError("Unable to save device token.","You must login a user.")}var n=new f.CacheRequest({method:f.RequestMethod.PUT,url:this.client.apiHostname+"/appdata/"+this.client.appKey+"/__device",data:{userId:r._id,token:e},client:this.client});return n.execute().then(function(){return e})};t.prototype._deleteTokenFromCache=function(e){if(e===void 0){e={}}var t=c.User.getActiveUser(this.client);if(s.isDefined(t)===false){throw new a.KinveyError("Unable to delete device token.","You must login a user.")}var r=new f.CacheRequest({method:f.RequestMethod.DELETE,url:this.client.apiHostname+"/appdata/"+this.client.appKey+"/__device/"+t._id,client:this.client});return r.execute().catch(function(e){if(e instanceof a.NotFoundError){return{}}throw e}).then(function(){return null})};return t}(i.EventEmitter);t.PushCommon=l},function(e,t){e.exports=require("nativescript-push-notifications")}]);
//# sourceMappingURL=kinvey-nativescript-sdk.android.js.map