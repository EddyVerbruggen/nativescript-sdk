/**
 * kinvey-nativescript-sdk - Kinvey NativeScript SDK for developing NativeScript applications.
 * @version v3.9.10
 * @author Kinvey, Inc.
 * @link http://www.kinvey.com
 * @license Apache-2.0
 */
module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=143)}([function(e,t,r){"use strict";function n(e,t,r,n){this.name="BaseError",this.message=e||"An error occurred.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}Object.defineProperty(t,"__esModule",{value:!0}),t.BaseError=n,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(214);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(215);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=r(216);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var u=r(217);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=r(218);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=r(0);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=r(219);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var l=r(220);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var f=r(221);Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})});var h=r(222);Object.keys(h).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})});var p=r(223);Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return p[e]}})});var d=r(224);Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})});var y=r(225);Object.keys(y).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return y[e]}})});var v=r(226);Object.keys(v).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}})});var b=r(227);Object.keys(b).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return b[e]}})});var g=r(228);Object.keys(g).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})});var m=r(229);Object.keys(m).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})});var _=r(230);Object.keys(_).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return _[e]}})});var w=r(231);Object.keys(w).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return w[e]}})});var O=r(232);Object.keys(O).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return O[e]}})});var E=r(233);Object.keys(E).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return E[e]}})});var k=r(234);Object.keys(k).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return k[e]}})});var P=r(235);Object.keys(P).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return P[e]}})});var j=r(236);Object.keys(j).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return j[e]}})});var S=r(237);Object.keys(S).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return S[e]}})});var A=r(238);Object.keys(A).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return A[e]}})});var T=r(239);Object.keys(T).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return T[e]}})});var x=r(240);Object.keys(x).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return x[e]}})});var C=r(241);Object.keys(C).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return C[e]}})});var M=r(242);Object.keys(M).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return M[e]}})});var R=r(243);Object.keys(R).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return R[e]}})});var I=r(244);Object.keys(I).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return I[e]}})});var q=r(245);Object.keys(q).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return q[e]}})});var U=r(246);Object.keys(U).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return U[e]}})});var D=r(247);Object.keys(D).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return D[e]}})});var K=r(248);Object.keys(K).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return K[e]}})});var N=r(249);Object.keys(N).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return N[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(110);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(253);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=r(254);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,r){"use strict";e.exports={}},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNDeleteMessagesOperation:"PNDeleteMessagesOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerAudit:"PNAccessManagerAudit"},e.exports=t.default},function(e,t,r){(function(t,n){var i;i=function(){"use strict";function e(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,u=void 0,a=void 0,s=function(e,t){y[o]=e,y[o+1]=t,2===(o+=2)&&(a?a(v):w())};var c="undefined"!=typeof window?window:void 0,l=c||{},f=l.MutationObserver||l.WebKitMutationObserver,h="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(v,1)}}var y=new Array(1e3);function v(){for(var e=0;e<o;e+=2){(0,y[e])(y[e+1]),y[e]=void 0,y[e+1]=void 0}o=0}var b,g,m,_,w=void 0;function O(e,t){var r=arguments,n=this,i=new this.constructor(P);void 0===i[k]&&F(i);var o,u=n._state;return u?(o=r[u-1],s(function(){return L(u,i,o,n._result)})):U(n,i,e,t),i}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(P);return M(t,e),t}h?w=function(){return t.nextTick(v)}:f?(g=0,m=new f(v),_=document.createTextNode(""),m.observe(_,{characterData:!0}),w=function(){_.data=g=++g%2}):p?((b=new MessageChannel).port1.onmessage=v,w=function(){return b.port2.postMessage(0)}):w=void 0===c?function(){try{var e=r(146);return void 0!==(u=e.runOnLoop||e.runOnContext)?function(){u(v)}:d()}catch(e){return d()}}():d();var k=Math.random().toString(36).substring(16);function P(){}var j=void 0,S=1,A=2,T=new K;function x(e){try{return e.then}catch(e){return T.error=e,T}}function C(t,r,n){r.constructor===t.constructor&&n===O&&r.constructor.resolve===E?function(e,t){t._state===S?I(e,t._result):t._state===A?q(e,t._result):U(t,void 0,function(t){return M(e,t)},function(t){return q(e,t)})}(t,r):n===T?(q(t,T.error),T.error=null):void 0===n?I(t,r):e(n)?function(e,t,r){s(function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,function(r){n||(n=!0,t!==r?M(e,r):I(e,r))},function(t){n||(n=!0,q(e,t))},e._label);!n&&i&&(n=!0,q(e,i))},e)}(t,r,n):I(t,r)}function M(e,t){var r,n;e===t?q(e,new TypeError("You cannot resolve a promise with itself")):(n=typeof(r=t),null===r||"object"!==n&&"function"!==n?I(e,t):C(e,t,x(t)))}function R(e){e._onerror&&e._onerror(e._result),D(e)}function I(e,t){e._state===j&&(e._result=t,e._state=S,0!==e._subscribers.length&&s(D,e))}function q(e,t){e._state===j&&(e._state=A,e._result=t,s(R,e))}function U(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+S]=r,i[o+A]=n,0===o&&e._state&&s(D,e)}function D(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,u=0;u<t.length;u+=3)n=t[u],i=t[u+r],n?L(r,n,i,o):i(o);e._subscribers.length=0}}function K(){this.error=null}var N=new K;function L(t,r,n,i){var o=e(n),u=void 0,a=void 0,s=void 0,c=void 0;if(o){if((u=function(e,t){try{return e(t)}catch(e){return N.error=e,N}}(n,i))===N?(c=!0,a=u.error,u.error=null):s=!0,r===u)return void q(r,new TypeError("A promises callback cannot return that same promise."))}else u=i,s=!0;r._state!==j||(o&&s?M(r,u):c?q(r,a):t===S?I(r,u):t===A&&q(r,u))}var B=0;function F(e){e[k]=B++,e._state=void 0,e._result=void 0,e._subscribers=[]}function H(e,t){this._instanceConstructor=e,this.promise=new e(P),this.promise[k]||F(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?I(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&I(this.promise,this._result))):q(this.promise,new Error("Array Methods must be provided an Array"))}function G(e){this[k]=B++,this._result=this._state=void 0,this._subscribers=[],P!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof G?function(e,t){try{t(function(t){M(e,t)},function(t){q(e,t)})}catch(t){q(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return H.prototype._enumerate=function(e){for(var t=0;this._state===j&&t<e.length;t++)this._eachEntry(e[t],t)},H.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===E){var i=x(e);if(i===O&&e._state!==j)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===G){var o=new r(P);C(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},H.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===j&&(this._remaining--,e===A?q(n,r):this._result[t]=r),0===this._remaining&&I(n,this._result)},H.prototype._willSettleAt=function(e,t){var r=this;U(e,void 0,function(e){return r._settledAt(S,t,e)},function(e){return r._settledAt(A,t,e)})},G.all=function(e){return new H(this,e).promise},G.race=function(e){var t=this;return i(e)?new t(function(r,n){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(r,n)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},G.resolve=E,G.reject=function(e){var t=new this(P);return q(t,e),t},G._setScheduler=function(e){a=e},G._setAsap=function(e){s=e},G._asap=s,G.prototype={constructor:G,then:O,catch:function(e){return this.then(null,e)}},G.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=G},G.Promise=G,G},e.exports=i()}).call(t,r(145),r(23))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(94);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(308);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=r(50);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var u=r(126);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=r(49);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=r(34);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=r(76);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var l=r(122);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})})},function(e,t,r){var n=r(18),i=r(4),o=r(15),u="[object String]";e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&n(e)==u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=f(r(115)),o=f(r(11)),u=f(r(8)),a=f(r(75)),s=r(1),c=r(21),l=r(2);function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p=6e4,d=null,y=function(){function e(){h(this,e),this.memory=new i.default}return n(e,[{key:"get",value:function(e){if(!(0,u.default)(e))throw new s.KinveyError("ActiveUserStorage key must be a string.");try{return JSON.parse(this.memory.get(e))}catch(e){return null}}},{key:"set",value:function(e,t){if(!(0,u.default)(e))throw new s.KinveyError("ActiveUserStorage key must be a string.");return(0,l.isDefined)(t)?this.memory.set(e,JSON.stringify(t)):this.memory.delete(e),t}}]),e}();t.Client=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,e);var r=(0,u.default)(t.apiHostname)?t.apiHostname:"https://baas.kinvey.com";!1===/^https?:\/\//i.test(r)&&(r="https://"+r);var n=o.default.parse(r);this.deviceId=(0,l.uuidv4)(),this.apiProtocol=n.protocol,this.apiHost=n.host;var i=(0,u.default)(t.micHostname)?t.micHostname:"https://auth.kinvey.com";!1===/^https?:\/\//i.test(i)&&(i="https://"+i);var s=o.default.parse(i);this.micProtocol=s.protocol,this.micHost=s.host,this.appKey=t.appKey,this.appSecret=t.appSecret,this.masterSecret=t.masterSecret,this.encryptionKey=t.encryptionKey,this.appVersion=t.appVersion,this.defaultTimeout=(0,a.default)(t.defaultTimeout)&&t.defaultTimeout>=0?t.defaultTimeout:p,this.storageProviders=t.storage,this.activeUserStorage=new y}return n(e,[{key:"getActiveUser",value:function(){return this.activeUserStorage.get(this.appKey+".active_user")}},{key:"setActiveUser",value:function(e){return this.activeUserStorage.set(this.appKey+".active_user",e)}},{key:"toPlainObject",value:function(){return{deviceId:this.deviceId,apiHostname:this.apiHostname,apiProtocol:this.apiProtocol,apiHost:this.apiHost,micHostname:this.micHostname,micProtocol:this.micProtocol,micHost:this.micHost,appKey:this.appKey,appSecret:this.appSecret,masterSecret:this.masterSecret,encryptionKey:this.encryptionKey,appVersion:this.appVersion,storageProviders:this.storageProviders}}},{key:"apiHostname",get:function(){return o.default.format({protocol:this.apiProtocol,host:this.apiHost})}},{key:"micHostname",get:function(){return o.default.format({protocol:this.micProtocol,host:this.micHost})}},{key:"appVersion",get:function(){return this._appVersion},set:function(e){e&&!(0,u.default)(e)&&(e=String(e)),this._appVersion=e}},{key:"defaultTimeout",get:function(){return this._defaultTimeout},set:function(e){if(e=parseInt(e,10),!1===(0,a.default)(e)||isNaN(e))throw new s.KinveyError("Invalid timeout. Timeout must be a number.");e<0&&(c.Log.info("Default timeout is less than 0. Setting default timeout to "+defaultTimeout+"ms."),e=defaultTimeout),this._defaultTimeout=e}}],[{key:"initialize",value:function(){throw new s.KinveyError("Please use Client.init().")}},{key:"init",value:function(t){return d=new e(t)}},{key:"sharedInstance",value:function(){if(!1===(0,l.isDefined)(d))throw new s.KinveyError("You have not initialized the library. Please call Kinvey.init() to initialize the library.");return d}}]),e}()},function(e,t,r){"use strict";function n(e){return encodeURIComponent(e).replace(/[!~*'()]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function i(e){return function(e){var t=[];return Object.keys(e).forEach(function(e){return t.push(e)}),t}(e).sort()}e.exports={signPamFromParams:function(e){return i(e).map(function(t){return t+"="+n(e[t])}).join("&")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e=void 0,t=void 0;return{promise:new Promise(function(r,n){e=r,t=n}),reject:t,fulfill:e}},encodeString:n}},function(e,t,r){"use strict";var n=r(149),i=r(150);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=m,t.resolve=function(e,t){return m(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?m(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=m(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var u=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),f=["%","/","?",";","#"].concat(l),h=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=r(151);function m(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(a);c[0]=c[0].replace(/\\/g,"/");var m=e=c.join(a);if(m=m.trim(),!r&&1===e.split("#").length){var _=s.exec(m);if(_)return this.path=m,this.href=m,this.pathname=_[1],_[2]?(this.search=_[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=u.exec(m);if(w){var O=(w=w[0]).toLowerCase();this.protocol=O,m=m.substr(w.length)}if(r||w||m.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===m.substr(0,2);!E||w&&v[w]||(m=m.substr(2),this.slashes=!0)}if(!v[w]&&(E||w&&!b[w])){for(var k,P,j=-1,S=0;S<h.length;S++){-1!==(A=m.indexOf(h[S]))&&(-1===j||A<j)&&(j=A)}-1!==(P=-1===j?m.lastIndexOf("@"):m.lastIndexOf("@",j))&&(k=m.slice(0,P),m=m.slice(P+1),this.auth=decodeURIComponent(k)),j=-1;for(S=0;S<f.length;S++){var A;-1!==(A=m.indexOf(f[S]))&&(-1===j||A<j)&&(j=A)}-1===j&&(j=m.length),this.host=m.slice(0,j),m=m.slice(j),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var x=this.hostname.split(/\./),C=(S=0,x.length);S<C;S++){var M=x[S];if(M&&!M.match(p)){for(var R="",I=0,q=M.length;I<q;I++)M.charCodeAt(I)>127?R+="x":R+=M[I];if(!R.match(p)){var U=x.slice(0,S),D=x.slice(S+1),K=M.match(d);K&&(U.push(K[1]),D.unshift(K[2])),D.length&&(m="/"+D.join(".")+m),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=n.toASCII(this.hostname));var N=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+N,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==m[0]&&(m="/"+m))}if(!y[O])for(S=0,C=l.length;S<C;S++){var B=l[S];if(-1!==m.indexOf(B)){var F=encodeURIComponent(B);F===B&&(F=escape(B)),m=m.split(B).join(F)}}var H=m.indexOf("#");-1!==H&&(this.hash=m.substr(H),m=m.slice(0,H));var G=m.indexOf("?");if(-1!==G?(this.search=m.substr(G),this.query=m.substr(G+1),t&&(this.query=g.parse(this.query)),m=m.slice(0,G)):t&&(this.search="",this.query={}),m&&(this.pathname=m),b[O]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){N=this.pathname||"";var z=this.search||"";this.path=N+z}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,u="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(u=g.stringify(this.query));var a=this.search||u&&"?"+u||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||b[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(m(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),u=0;u<n.length;u++){var a=n[u];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),c=0;c<s.length;c++){var l=s[c];"protocol"!==l&&(r[l]=e[l])}return b[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!b[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var p=f[h];r[p]=e[p]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||v[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var y=r.pathname||"",g=r.search||"";r.path=y+g}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=_||m||r.host&&e.pathname,O=w,E=r.pathname&&r.pathname.split("/")||[],k=(d=e.pathname&&e.pathname.split("/")||[],r.protocol&&!b[r.protocol]);if(k&&(r.hostname="",r.port=null,r.host&&(""===E[0]?E[0]=r.host:E.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),w=w&&(""===d[0]||""===E[0])),_)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,E=d;else if(d.length)E||(E=[]),E.pop(),E=E.concat(d),r.search=e.search,r.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(k)r.hostname=r.host=E.shift(),(T=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=T.shift(),r.host=r.hostname=T.shift());return r.search=e.search,r.query=e.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!E.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var P=E.slice(-1)[0],j=(r.host||e.host||E.length>1)&&("."===P||".."===P)||""===P,S=0,A=E.length;A>=0;A--)"."===(P=E[A])?E.splice(A,1):".."===P?(E.splice(A,1),S++):S&&(E.splice(A,1),S--);if(!w&&!O)for(;S--;S)E.unshift("..");!w||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),j&&"/"!==E.join("/").substr(-1)&&E.push("");var T,x=""===E[0]||E[0]&&"/"===E[0].charAt(0);k&&(r.hostname=r.host=x?"":E.length?E.shift():"",(T=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=T.shift(),r.host=r.hostname=T.shift()));return(w=w||r.host&&E.length)&&!x&&E.unshift(""),E.length?r.pathname=E.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Query=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=c(r(250)),o=c(r(32)),u=r(1),a=r(2),s=r(21);function c(e){return e&&e.__esModule?e:{default:e}}var l=["_id","_acl"],f=["$nearSphere"],h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=Object.assign({fields:[],filter:{},sort:null,limit:null,skip:0},t),this.fields=t.fields,this.filter=t.filter,this.sort=t.sort,this.limit=t.limit,this.skip=t.skip,this._parent=null}return n(e,[{key:"isSupportedOffline",value:function(){var e=this;return Object.keys(this.filter).reduce(function(t,r){if(t){var n=e.filter[r];return f.some(function(e){return!n||!Object.keys(n).some(function(t){return t===e})})}return t},!0)}},{key:"equalTo",value:function(e,t){return this.addFilter(e,t)}},{key:"contains",value:function(e,t){if(!1===(0,a.isDefined)(t))throw new u.QueryError("You must supply a value.");return!1===Array.isArray(t)&&(t=[t]),this.addFilter(e,"$in",t)}},{key:"containsAll",value:function(e,t){if(!1===(0,a.isDefined)(t))throw new u.QueryError("You must supply a value.");return!1===Array.isArray(t)&&(t=[t]),this.addFilter(e,"$all",t)}},{key:"greaterThan",value:function(e,t){if(!1===(0,a.isNumber)(t)&&"string"!=typeof t)throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$gt",t)}},{key:"greaterThanOrEqualTo",value:function(e,t){if(!1===(0,a.isNumber)(t)&&"string"!=typeof t)throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$gte",t)}},{key:"lessThan",value:function(e,t){if(!1===(0,a.isNumber)(t)&&"string"!=typeof t)throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$lt",t)}},{key:"lessThanOrEqualTo",value:function(e,t){if(!1===(0,a.isNumber)(t)&&"string"!=typeof t)throw new u.QueryError("You must supply a number or string.");return this.addFilter(e,"$lte",t)}},{key:"notEqualTo",value:function(e,t){return this.addFilter(e,"$ne",t)}},{key:"notContainedIn",value:function(e,t){return!1===Array.isArray(t)&&(t=[t]),this.addFilter(e,"$nin",t)}},{key:"and",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.join("$and",t)}},{key:"nor",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;return(0,a.isDefined)(this._parent)&&Object.hasOwnProperty.call(this._parent.filter,"$and")?(n=this._parent).nor.apply(n,t):this.join("$nor",t)}},{key:"or",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;return(0,a.isDefined)(this._parent)?(n=this._parent).or.apply(n,t):this.join("$or",t)}},{key:"exists",value:function(e,t){return t=void 0===t||(t||!1),this.addFilter(e,"$exists",t)}},{key:"mod",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("string"==typeof t&&(t=parseFloat(t)),"string"==typeof r&&(r=parseFloat(r)),!(0,a.isNumber)(t))throw new u.QueryError("divisor must be a number");if(!(0,a.isNumber)(r))throw new u.QueryError("remainder must be a number");return this.addFilter(e,"$mod",[t,r])}},{key:"matches",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=[];if(t instanceof RegExp||(t=new RegExp(t)),0!==t.source.indexOf("^"))throw new u.QueryError("regExp must have '^' at the beginning of the expression to make it an anchored expression.");if((t.ignoreCase||r.ignoreCase)&&!1!==r.ignoreCase)throw new u.QueryError("ignoreCase flag is not supported");return(t.multiline||r.multiline)&&!1!==r.multiline&&n.push("m"),!0===r.extended&&n.push("x"),!0===r.dotMatchesAll&&n.push("s"),n.length>0&&this.addFilter(e,"$options",n.join("")),this.addFilter(e,"$regex",t.source)}},{key:"near",value:function(e,t,r){if(!Array.isArray(t)||!(0,a.isNumber)(t[0])||!(0,a.isNumber)(t[1]))throw new u.QueryError("coord must be a [number, number]");var n=this.addFilter(e,"$nearSphere",[t[0],t[1]]);return(0,a.isNumber)(r)&&this.addFilter(e,"$maxDistance",r),n}},{key:"withinBox",value:function(e,t,r){if(!Array.isArray(t)||!(0,a.isNumber)(t[0])||!(0,a.isNumber)(t[1]))throw new u.QueryError("bottomLeftCoord must be a [number, number]");if(!Array.isArray(r)||!(0,a.isNumber)(r[0])||!(0,a.isNumber)(r[1]))throw new u.QueryError("upperRightCoord must be a [number, number]");t[0]=parseFloat(t[0]),t[1]=parseFloat(t[1]),r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1]);var n=[[t[0],t[1]],[r[0],r[1]]];return this.addFilter(e,"$within",{$box:n})}},{key:"withinPolygon",value:function(e,t){if(!1===Array.isArray(t)||0===t.length||t.length>3)throw new u.QueryError("coords must be a [[number, number]]");return t=t.map(function(e){if(!1===(0,a.isNumber)(e[0])||!1===(0,a.isNumber)(e[1]))throw new u.QueryError("coords argument must be a [number, number]");return[parseFloat(e[0]),parseFloat(e[1])]}),this.addFilter(e,"$within",{$polygon:t})}},{key:"size",value:function(e,t){if("string"==typeof t&&(t=parseFloat(t)),!(0,a.isNumber)(t))throw new u.QueryError("size must be a number");return this.addFilter(e,"$size",t)}},{key:"ascending",value:function(e){return(0,a.isDefined)(this._parent)?this._parent.ascending(e):this.sort[e]=1,this}},{key:"descending",value:function(e){return(0,a.isDefined)(this._parent)?this._parent.descending(e):this.sort[e]=-1,this}},{key:"addFilter",value:function(e,t,r){return(0,a.isDefined)(t)&&((0,a.isDefined)(r)||3===arguments.length)?((0,o.default)(this.filter[e])||(this.filter[e]={}),this.filter[e][t]=r):this.filter[e]=t,this}},{key:"join",value:function(t,r){var n=this,i=this,a={};return 0===(r=r.map(function(t){if(!(t instanceof e)){if(!(0,o.default)(t))throw new u.QueryError("query argument must be of type: Kinvey.Query[] or Object[].");t=new e(t)}return t.toPlainObject().filter})).length&&(r=[(i=new e).toPlainObject().filter],i._parent=this),Object.keys(this.filter).forEach(function(e){a[e]=n.filter[e],delete n.filter[e]}),this.filter[t]=[a].concat(r),i}},{key:"process",value:function(e){if(!this.isSupportedOffline()){var t="This query is not able to run locally. The following filters are not supported locally:";throw f.forEach(function(e){t=t+" "+e}),s.Log.error(t),new u.QueryError(t)}if(!Array.isArray(e))throw new u.QueryError("data argument must be of type: Array.");s.Log.debug("Data length before processiong query",e.length);var r=this.toPlainObject();if(e=(0,i.default)(r.filter,e),s.Log.debug("Data length after applying query filter",r.filter,e.length),(0,a.isDefined)(r.sort)&&(s.Log.debug("Sorting data",r.sort),e.sort(function(e,t){for(var n in r.sort)if(r.sort.hasOwnProperty(n)){var i=(0,a.nested)(e,n),o=(0,a.nested)(t,n),u=r.sort[n];if((0,a.isDefined)(i)&&!1===(0,a.isDefined)(o))return 1*u;if(!1===(0,a.isDefined)(i)&&(0,a.isDefined)(o))return-1*u;if(void 0===i&&null===o)return 0;if(null===i&&void 0===o)return 0;if(i!==o)return(i<o?-1:1)*u}return 0})),Array.isArray(r.fields)&&r.fields.length>0){var n=Array.concat([],r.fields,l);s.Log.debug("Removing fields from data",r.fields),e=e.map(function(e){return Object.keys(e).forEach(function(t){-1===n.indexOf(t)&&delete e[t]}),e})}return(0,a.isNumber)(r.skip)?(0,a.isNumber)(r.limit)&&r.limit>0?(s.Log.debug("Skipping and limiting data",r.skip,r.limit),e.slice(r.skip,r.skip+r.limit)):(s.Log.debug("Skipping data",r.skip),e.slice(r.skip)):e}},{key:"toPlainObject",value:function(){return(0,a.isDefined)(this._parent)?this._parent.toPlainObject():{fields:this.fields,filter:this.filter,sort:this.sort,skip:this.skip,limit:this.limit}}},{key:"toQueryString",value:function(){var e={};return Object.keys(this.filter).length>0&&(e.query=this.filter),this.fields.length>0&&(e.fields=this.fields.join(",")),(0,a.isNumber)(this.limit)&&(e.limit=this.limit),(0,a.isNumber)(this.skip)&&this.skip>0&&(e.skip=this.skip),Object.keys(this.sort).length>0&&(e.sort=this.sort),Object.keys(e).forEach(function(t){e[t]="string"==typeof e[t]?e[t]:JSON.stringify(e[t])}),e}},{key:"toString",value:function(){return JSON.stringify(this.toQueryString())}},{key:"fields",get:function(){return this._fields},set:function(e){if(e=e||[],!Array.isArray(e))throw new u.QueryError("fields must be an Array");(0,a.isDefined)(this._parent)?this._parent.fields=e:this._fields=e}},{key:"filter",get:function(){return this._filter},set:function(e){this._filter=e}},{key:"sort",get:function(){return this._sort},set:function(e){if(e&&!(0,o.default)(e))throw new u.QueryError("sort must an Object");(0,a.isDefined)(this._parent)?this._parent.sort=e:this._sort=e||{}}},{key:"limit",get:function(){return this._limit},set:function(e){if("string"==typeof e&&(e=parseFloat(e)),(0,a.isDefined)(e)&&!1===(0,a.isNumber)(e))throw new u.QueryError("limit must be a number");this._parent?this._parent.limit=e:this._limit=e}},{key:"skip",get:function(){return this._skip},set:function(e){if("string"==typeof e&&(e=parseFloat(e)),!1===(0,a.isNumber)(e))throw new u.QueryError("skip must be a number");(0,a.isDefined)(this._parent)?this._parent.skip=e:this._skip=e}}]),e}();t.Query=h},function(e,t,r){var n=r(93),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();e.exports=o},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,r){var n=r(19),i=r(65);e.exports=function(e){return null!=e&&i(e.length)&&!n(e)}},function(e,t,r){var n=r(62),i=r(25),o=r(73),u=r(16),a=r(31),s=r(20),c=Object.prototype.hasOwnProperty,l=o(function(e,t){if(a(t)||u(t))i(t,s(t),e);else for(var r in t)c.call(t,r)&&n(e,r,t[r])});e.exports=l},function(e,t,r){var n=r(26),i=r(147),o=r(148),u="[object Null]",a="[object Undefined]",s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?a:u:s&&s in Object(e)?i(e):o(e)}},function(e,t,r){var n=r(18),i=r(14),o="[object AsyncFunction]",u="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";e.exports=function(e){if(!i(e))return!1;var t=n(e);return t==u||t==a||t==o||t==s}},function(e,t,r){var n=r(99),i=r(101),o=r(16);e.exports=function(e){return o(e)?n(e):i(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0;var n,i=r(262),o=(n=i)&&n.__esModule?n:{default:n};o.default.setDefaultLevel(o.default.levels.SILENT);var u=o.default.methodFactory;o.default.methodFactory=function(e,t,r){var n=u(e,t,r);return function(e){e="Kinvey: "+e;for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];r.length>0?n(e,r):n(e)}},t.Log=o.default},function(e,t,r){var n=r(268),i=r(277),o=r(46),u=r(4),a=r(287);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?u(e)?i(e[0],e[1]):n(e):a(e)}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(166),i=r(169);e.exports=function(e,t){var r=i(e,t);return n(r)?r:void 0}},function(e,t,r){var n=r(62),i=r(63);e.exports=function(e,t,r,o){var u=!r;r||(r={});for(var a=-1,s=t.length;++a<s;){var c=t[a],l=o?o(r[c],e[c],c,r,e):void 0;void 0===l&&(l=e[c]),u?i(r,c,l):n(r,c,l)}return r}},function(e,t,r){var n=r(13).Symbol;e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Aggregation=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=p(r(17)),o=p(r(48)),u=p(r(8)),a=p(r(14)),s=p(r(19)),c=p(r(95)),l=r(1),f=r(2),h=r(12);function p(e){return e&&e.__esModule?e:{default:e}}t.Aggregation=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=(0,i.default)({query:null,initial:{},key:{},reduceFn:function(){}.toString()},t),this.query=t.query,this.initial=t.initial,this.key=t.key,this.reduceFn=t.reduceFn}return n(e,[{key:"by",value:function(e){return this.key[e]=!0,this}},{key:"process",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.toPlainObject(),r=Object.keys(t.key),n=t.reduceFn.replace(/function[\s\S]*?\([\s\S]*?\)/,"");if(t.reduce=new Function(["doc","out"],n),this.query&&(e=this.query.process(e)),r.length>0){var u=[];return r.forEach(function(r){var n={};e.forEach(function(e){var i=e[r],o=(0,f.isDefined)(n[i])?n[i]:(0,c.default)(t.initial),u=t.reduce(e,o);(0,f.isDefined)(u)&&(o=u),n[i]=o}),Object.keys(n).forEach(function(e){var t={};t[r]=e,t=(0,i.default)({},t,n[e]),u.push(t)})}),u}var a=(0,c.default)(t.initial);return(0,o.default)(e,function(e){var r=t.reduce(e,a);(0,f.isDefined)(r)&&(a=r)}),a}},{key:"toPlainObject",value:function(){return{key:this.key,initial:this.initial,reduce:this.reduceFn,reduceFn:this.reduceFn,condition:this.query?this.query.toPlainObject().filter:{},query:this.query?this.query.toPlainObject():null}}},{key:"initial",get:function(){return(0,c.default)(this._initial)},set:function(e){if(!(0,a.default)(e))throw new l.KinveyError("initial must be an Object.");this._initial=e}},{key:"query",get:function(){return this._query},set:function(e){if((0,f.isDefined)(e)&&!(e instanceof h.Query))throw new l.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"reduceFn",get:function(){return this._reduceFn},set:function(e){if((0,s.default)(e)&&(e=e.toString()),!(0,u.default)(e))throw new l.KinveyError("fn argument must be of type function or string.");this._reduceFn=e}}],[{key:"count",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var r=new e;return r.by(t),r.initial={count:0},r.reduceFn="function(doc, out) {  out.count += 1;  return out;}",r}},{key:"sum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var r=new e;return r.initial={sum:0},r.reduceFn='function(doc, out) {  out.sum += doc["'+t+'"];  return out;}',r}},{key:"min",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var r=new e;return r.initial={min:1/0},r.reduceFn='function(doc, out) {  out.min = Math.min(out.min, doc["'+t+'"]);  return out;}',r}},{key:"max",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var r=new e;return r.initial={max:-1/0},r.reduceFn='function(doc, out) {  out.max = Math.max(out.max, doc["'+t+'"]);  return out;}',r}},{key:"average",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t=t.replace("'","\\'");var r=new e;return r.initial={count:0,average:0},r.reduceFn='function(doc, out) {  out.average = (out.average * out.count + doc["'+t+'"]) / (out.count + 1);  out.count += 1;  return out;}',r}}]),e}()},function(e,t,r){var n=r(52),i=1/0;e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(90),u=(n=o)&&n.__esModule?n:{default:n};r(3);var a=function(){function e(t){var r=t.setup,n=t.db;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._db=n,this.instanceId="pn-"+u.default.createUUID(),this.secretKey=r.secretKey||r.secret_key,this.subscribeKey=r.subscribeKey||r.subscribe_key,this.publishKey=r.publishKey||r.publish_key,this.sdkName=r.sdkName,this.sdkFamily=r.sdkFamily,this.partnerId=r.partnerId,this.setAuthKey(r.authKey),this.setCipherKey(r.cipherKey),this.setFilterExpression(r.filterExpression),this.origin=r.origin||"pubsub.pndsn.com",this.secure=r.ssl||!1,this.restore=r.restore||!1,this.proxy=r.proxy,this.keepAlive=r.keepAlive,this.keepAliveSettings=r.keepAliveSettings,this.autoNetworkDetection=r.autoNetworkDetection||!1,this.dedupeOnSubscribe=r.dedupeOnSubscribe||!1,this.maximumCacheSize=r.maximumCacheSize||100,this.customEncrypt=r.customEncrypt,this.customDecrypt=r.customDecrypt,"undefined"!=typeof location&&"https:"===location.protocol&&(this.secure=!0),this.logVerbosity=r.logVerbosity||!1,this.suppressLeaveEvents=r.suppressLeaveEvents||!1,this.announceFailedHeartbeats=r.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=r.announceSuccessfulHeartbeats||!1,this.useInstanceId=r.useInstanceId||!1,this.useRequestId=r.useRequestId||!1,this.requestMessageCountThreshold=r.requestMessageCountThreshold,this.setTransactionTimeout(r.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(r.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(r.useSendBeacon||!0),this.setPresenceTimeout(r.presenceTimeout||300),null!=r.heartbeatInterval&&this.setHeartbeatInterval(r.heartbeatInterval),this.setUUID(this._decideUUID(r.uuid))}return i(e,[{key:"getAuthKey",value:function(){return this.authKey}},{key:"setAuthKey",value:function(e){return this.authKey=e,this}},{key:"setCipherKey",value:function(e){return this.cipherKey=e,this}},{key:"getUUID",value:function(){return this.UUID}},{key:"setUUID",value:function(e){return this._db&&this._db.set&&this._db.set(this.subscribeKey+"uuid",e),this.UUID=e,this}},{key:"getFilterExpression",value:function(){return this.filterExpression}},{key:"setFilterExpression",value:function(e){return this.filterExpression=e,this}},{key:"getPresenceTimeout",value:function(){return this._presenceTimeout}},{key:"setPresenceTimeout",value:function(e){return this._presenceTimeout=e,this.setHeartbeatInterval(this._presenceTimeout/2-1),this}},{key:"setProxy",value:function(e){this.proxy=e}},{key:"getHeartbeatInterval",value:function(){return this._heartbeatInterval}},{key:"setHeartbeatInterval",value:function(e){return this._heartbeatInterval=e,this}},{key:"getSubscribeTimeout",value:function(){return this._subscribeRequestTimeout}},{key:"setSubscribeTimeout",value:function(e){return this._subscribeRequestTimeout=e,this}},{key:"getTransactionTimeout",value:function(){return this._transactionalRequestTimeout}},{key:"setTransactionTimeout",value:function(e){return this._transactionalRequestTimeout=e,this}},{key:"isSendBeaconEnabled",value:function(){return this._useSendBeacon}},{key:"setSendBeaconConfig",value:function(e){return this._useSendBeacon=e,this}},{key:"getVersion",value:function(){return"4.20.1"}},{key:"_decideUUID",value:function(e){return e||(this._db&&this._db.get&&this._db.get(this.subscribeKey+"uuid")?this._db.get(this.subscribeKey+"uuid"):"pn-"+u.default.createUUID())}}]),e}();t.default=a,e.exports=t.default},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},function(e,t,r){var n=r(18),i=r(68),o=r(15),u="[object Object]",a=Function.prototype,s=Object.prototype,c=a.toString,l=s.hasOwnProperty,f=c.call(Object);e.exports=function(e){if(!o(e)||n(e)!=u)return!1;var t=i(e);if(null===t)return!0;var r=l.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==f}},function(e,t,r){var n=r(263),i=r(266)(n);e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyResponse=t.Response=t.StatusCode=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(17),u=(n=o)&&n.__esModule?n:{default:n},a=r(50),s=r(1);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=t.StatusCode={Ok:200,Created:201,Empty:204,MovedPermanently:301,Found:302,NotModified:304,TemporaryRedirect:307,PermanentRedirect:308,Unauthorized:401,Forbidden:403,NotFound:404,ServerError:500};Object.freeze(l);var f=t.Response=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),t=(0,u.default)({statusCode:l.Empty,headers:new a.Headers,data:null},t),this.statusCode=t.statusCode,this.headers=t.headers,this.data=t.data}return i(e,[{key:"isSuccess",value:function(){return this.statusCode>=200&&this.statusCode<300||this.statusCode===l.MovedPermanently||this.statusCode===l.Found||this.statusCode===l.NotModified||this.statusCode===l.TemporaryRedirect||this.statusCode===l.PermanentRedirect}},{key:"isServerError",value:function(){return this.statusCode>=500&&this.statusCode<600}},{key:"isClientError",value:function(){return this.statusCode>=400&&this.statusCode<500}},{key:"toPlainObject",value:function(){return{statusCode:this.statusCode,headers:this.headers.toPlainObject(),data:this.data}}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof a.Headers||(e=new a.Headers(e)),this._headers=e}},{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},t=e.message||e.description,r=e.debug,n=this.statusCode,i=this.headers.get("X-Kinvey-Request-ID");return n===l.Unauthorized?new s.InsufficientCredentialsError(t,r,n,i):n===l.NotFound?new s.NotFoundError(t,r,n,i):n===l.ServerError?new s.ServerError(t,r,n,i):new s.KinveyError(t,r,n,i)}}]),e}();t.KinveyResponse=function(e){function t(){return c(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,f),i(t,[{key:"error",get:function(){if(this.isSuccess())return null;var e=this.data||{},r=e.name||e.error,n=e.message||e.description,i=e.debug,o=this.statusCode,u=this.headers.get("X-Kinvey-Request-ID"),a=void 0;if("APIVersionNotAvailable"===r)a=new s.APIVersionNotAvailableError(n,i,o,u);else if("APIVersionNotImplemented"===r)a=new s.APIVersionNotImplementedError(n,i,o,u);else if("AppProblem"===r)a=new s.AppProblemError(n,i,o,u);else if("AppProblem"===r)a=new s.AppProblemError(n,i,o,u);else if("BadRequest"===r)a=new s.BadRequestError(n,i,o,u);else if("BLInternalError"===r||"BLRuntimeError"===r||"BLSyntaxError"===r||"BLTimeoutError"===r||"BLViolationError"===r)a=new s.BLError(n,i,o,u);else if("CORSDisabled"===r)a=new s.CORSDisabledError(n,i,o,u);else if("DuplicateEndUsers"===r)a=new s.DuplicateEndUsersError(n,i,o,u);else if("FeatureUnavailable"===r)a=new s.FeatureUnavailableError(n,i,o,u);else if("IncompleteRequestBody"===r)a=new s.IncompleteRequestBodyError(n,i,o,u);else if("IndirectCollectionAccessDisallowed"===r)a=new s.IndirectCollectionAccessDisallowedError(n,i,o,u);else if("InsufficientCredentials"===r)a=new s.InsufficientCredentialsError(n,i,o,u);else if("InvalidCredentials"===r)a=new s.InvalidCredentialsError(n,i,o,u);else if("InvalidIdentifier"===r)a=new s.InvalidIdentifierError(n,i,o,u);else if("InvalidQuerySyntax"===r)a=new s.InvalidQuerySyntaxError(n,i,o,u);else if("JSONParseError"===r)a=new s.JSONParseError(n,i,o,u);else if("KinveyInternalErrorRetry"===r)a=new s.KinveyInternalErrorRetry(n,i,o,u);else if("KinveyInternalErrorStop"===r)a=new s.KinveyInternalErrorStop(n,i,o,u);else if("MissingQuery"===r)a=new s.MissingQueryError(n,i,o,u);else if("MissingRequestHeader"===r)a=new s.MissingRequestHeaderError(n,i,o,u);else if("MissingRequestParameter"===r)a=new s.MissingRequestParameterError(n,i,o,u);else if("EntityNotFound"===r||"CollectionNotFound"===r||"AppNotFound"===r||"UserNotFound"===r||"BlobNotFound"===r||"DocumentNotFound"===r)a=new s.NotFoundError(n,i,o,u);else if("ParameterValueOutOfRange"===r)a=new s.ParameterValueOutOfRangeError(n,i,o,u);else if("ServerError"===r)a=new s.ServerError(n,i,o,u);else if("StaleRequest"===r)a=new s.StaleRequestError(n,i,o,u);else if("UserAlreadyExists"===r)a=new s.UserAlreadyExistsError(n,i,o,u);else{if("WritesToCollectionDisallowed"!==r)return function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"error",this);a=new s.WritesToCollectionDisallowedError(n,i,o,u)}return a}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Middleware=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(6),u=(n=o)&&n.__esModule?n:{default:n},a=r(293);t.Middleware=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Middleware";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t}return i(e,[{key:"handle",value:function(){return u.default.reject(new Error("A subclass middleware must override the handle function."))}},{key:"cancel",value:function(){return u.default.resolve()}},{key:"generateTree",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{value:this.name,level:e,nodes:[]}}},{key:"toString",value:function(){var e=this.generateTree();return a.AsciiTree.generate(e)}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyObservable=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=f(r(6)),u=r(347),a=r(131),s=r(87),c=f(r(19)),l=r(2);function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var y={closed:!0,next:function(){},error:function(e){throw e},complete:function(){},status:function(){},presence:function(){}},v=function(e){function t(e,r,n,i,o,u){h(this,t);var a=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),s=void 0,l=a;return a._parentSubscriber=e,(0,c.default)(r)?s=r:r&&(s=r.next,n=r.error,i=r.complete,r!==y&&(l=Object.create(r),(0,c.default)(l.unsubscribe)&&a.add(l.unsubscribe.bind(l)),l.unsubscribe=a.unsubscribe.bind(a))),a._context=l,a._next=s,a._error=n,a._complete=i,a._status=o,a._presence=u,a}return d(t,a.Subscriber),i(t,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}}},{key:"status",value:function(e){if(!this.isStopped&&this._status){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._status,e)&&this.unsubscribe():this.__tryOrUnsub(this._status,e)}}},{key:"presence",value:function(e){if(!this.isStopped&&this._presence){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._presence,e)&&this.unsubscribe():this.__tryOrUnsub(this._presence,e)}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}}},{key:"__tryOrSetError",value:function(e,t,r){try{t.call(this._context,r)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),t}(),b=function(e){function t(e,r,i,o,u){h(this,t);var s=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i));switch(arguments.length){case 0:s.destination=y;break;case 1:if(!1===(0,l.isDefined)(e)){s.destination=y;break}if("object"===(void 0===e?"undefined":n(e))){e instanceof a.Subscriber?(s.destination=e,s.destination.add(s)):(s.syncErrorThrowable=!0,s.destination=new v(s,e));break}default:s.syncErrorThrowable=!0,s.destination=new v(s,e,r,i,o,u)}return s}return d(t,a.Subscriber),i(t,[{key:"status",value:function(e){this.isStopped||this._status(e)}},{key:"presence",value:function(e){this.isStopped||this._presence(e)}},{key:"_status",value:function(e){this.destination.status(e)}},{key:"_presence",value:function(e){this.destination.presence(e)}}]),t}();t.KinveyObservable=function(e){function t(){return h(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d(t,u.Observable),i(t,[{key:"subscribe",value:function(e,t,r,n,i){var o=this.operator,u=function(e,t,r,n,i){if(e){if(e instanceof b)return e;if(e[s.rxSubscriber])return e[s.rxSubscriber]()}return e||t||r||n||i?new b(e,t,r,n,i):new b(y)}(e,t,r,n,i);if(o?o.call(u,this.source):u.add(this._trySubscribe(u)),u.syncErrorThrowable&&(u.syncErrorThrowable=!1,u.syncErrorThrown))throw u.syncErrorValue;return u}},{key:"toPromise",value:function(){var e=this;return new o.default(function(t,r){var n=void 0;e.subscribe(function(e){n=e},r,function(){t(n)})})}}],[{key:"create",value:function(e){return new t(e)}}]),t}()},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){var n=r(156),i=r(157),o=r(158),u=r(159),a=r(160);function s(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=u,s.prototype.set=a,e.exports=s},function(e,t,r){var n=r(30);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},function(e,t,r){var n=r(24)(Object,"create");e.exports=n},function(e,t,r){var n=r(178);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},function(e,t,r){var n=r(184),i=r(15),o=Object.prototype,u=o.hasOwnProperty,a=o.propertyIsEnumerable,s=n(function(){return arguments}())?n:function(e){return i(e)&&u.call(e,"callee")&&!a.call(e,"callee")};e.exports=s},function(e,t,r){(function(e){var n=r(13),i=r(185),o="object"==typeof t&&t&&!t.nodeType&&t,u=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=u&&u.exports===o?n.Buffer:void 0,s=(a?a.isBuffer:void 0)||i;e.exports=s}).call(t,r(37)(e))},function(e,t){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,r){var n=r(99),i=r(190),o=r(16);e.exports=function(e){return o(e)?n(e,!0):i(e)}},function(e,t){e.exports=function(e){return e}},function(e,t,r){var n=r(101),i=r(69),o=r(42),u=r(4),a=r(16),s=r(43),c=r(31),l=r(64),f="[object Map]",h="[object Set]",p=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(u(e)||"string"==typeof e||"function"==typeof e.splice||s(e)||l(e)||o(e)))return!e.length;var t=i(e);if(t==f||t==h)return!e.size;if(c(e))return!n(e).length;for(var r in e)if(p.call(e,r))return!1;return!0}},function(e,t,r){var n=r(97),i=r(33),o=r(267),u=r(4);e.exports=function(e,t){return(u(e)?n:i)(e,o(t))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.RequestMethod=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=d(r(6)),o=d(r(72)),u=d(r(17)),a=d(r(8)),s=d(r(75)),c=r(9),l=r(1),f=r(2),h=r(34),p=r(50);function d(e){return e&&e.__esModule?e:{default:e}}var y=t.RequestMethod={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};Object.freeze(y);t.Request=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=(0,u.default)({followRedirect:!0},t),this.id=(0,f.randomString)(),this.client=t.client,this.method=t.method||y.GET,this.headers=t.headers||new p.Headers,this.url=t.url||"",this.body=t.body||t.data,this.timeout=(0,f.isDefined)(t.timeout)?t.timeout:this.client.defaultTimeout,this.followRedirect=!0===t.followRedirect,this.cache=!0===t.cache}return n(e,[{key:"execute",value:function(){return!1===(0,f.isDefined)(this.rack)?(Log.error("Unable to execute the request. Please provide a rack to execute the request."),i.default.reject(new l.KinveyError("Unable to execute the request. Please provide a rack to execute the request."))):this.rack.execute(this.toPlainObject()).then(function(e){if(!1===(0,f.isDefined)(e))throw new l.NoResponseError;return e instanceof h.Response==!1&&(e=new h.Response({statusCode:e.statusCode,headers:e.headers,data:e.data})),e})}},{key:"cancel",value:function(){return this.rack.cancel()}},{key:"toPlainObject",value:function(){return{id:this.id,method:this.method,headers:this.headers.toPlainObject(),url:this.url,body:this.body,timeout:this.timeout,followRedirect:this.followRedirect,encryptionKey:this.client.encryptionKey}}},{key:"client",get:function(){return this._client||c.Client.sharedInstance()},set:function(e){if(e&&e instanceof c.Client==!1)throw new l.KinveyError("client must be an instance of the Client class.");this._client=e}},{key:"method",get:function(){return this._method},set:function(e){switch((0,a.default)(e)||(e=String(e)),e=e.toUpperCase()){case y.GET:case y.POST:case y.PATCH:case y.PUT:case y.DELETE:this._method=e;break;default:throw new l.KinveyError("Invalid request method. Only GET, POST, PATCH, PUT, and DELETE are allowed.")}}},{key:"headers",get:function(){return this._headers},set:function(e){e instanceof p.Headers||(e=new p.Headers(e)),this._headers=e}},{key:"url",get:function(){return!0===this.cache?(0,f.appendQuery)(this._url,o.default.stringify({_:Math.random().toString(36).substr(2)})):this._url},set:function(e){this._url=e}},{key:"data",get:function(){return this.body},set:function(e){this.body=e}},{key:"timeout",get:function(){return this._timeout},set:function(e){if(e=parseInt(e,10),!1===(0,s.default)(e)||isNaN(e))throw new l.KinveyError("Invalid timeout. Timeout must be a number.");this._timeout=e}},{key:"followRedirect",get:function(){return this._followRedirect},set:function(e){this._followRedirect=!!e}},{key:"cache",get:function(){return this._cache},set:function(e){this._cache=!!e}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Headers=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(r(48)),o=s(r(8)),u=s(r(32)),a=r(2);function s(e){return e&&e.__esModule?e:{default:e}}t.Headers=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.headers={},this.addAll(t)}return n(e,[{key:"get",value:function(e){if(e)return!1===(0,o.default)(e)&&(e=String(e)),this.headers[e.toLowerCase()]}},{key:"set",value:function(e,t){if(!1===(0,a.isDefined)(e)||!1===(0,a.isDefined)(t))throw new Error("A name and value must be provided to set a header.");!1===(0,o.default)(e)&&(e=String(e));var r=this.headers;return e=e.toLowerCase(),!1===(0,o.default)(t)?r[e]=JSON.stringify(t):r[e]=t,this.headers=r,this}},{key:"has",value:function(e){return!!this.get(e)}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.set(e.name,e.value)}},{key:"addAll",value:function(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r instanceof e&&(r=r.toPlainObject()),!1===(0,u.default)(r))throw new Error("Headers argument must be an object.");var n=Object.keys(r);return(0,i.default)(n,function(e){try{t.set(e,r[e])}catch(e){}}),this}},{key:"remove",value:function(e){if(e){!1===(0,o.default)(e)&&(e=String(e));var t=this.headers;delete t[e.toLowerCase()],this.headers=t}return this}},{key:"clear",value:function(){return this.headers={},this}},{key:"toPlainObject",value:function(){return this.headers}},{key:"toString",value:function(){return JSON.stringify(this.toPlainObject())}}]),e}()},function(e,t,r){var n=r(4),i=r(79),o=r(279),u=r(282);e.exports=function(e,t){return n(e)?e:i(e,t)?[e]:o(u(e))}},function(e,t,r){var n=r(18),i=r(15),o="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||i(e)&&n(e)==o}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,u,a,s,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(o(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(i(r))for(a=Array.prototype.slice.call(arguments,1),u=(c=r.slice()).length,s=0;s<u;s++)c[s].apply(this,a);return!0},r.prototype.addListener=function(e,t){var u;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(u=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&u>0&&this._events[e].length>u&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},r.prototype.removeListener=function(e,t){var r,o,u,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(u=(r=this._events[e]).length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(a=u;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){o=a;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(83);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(88);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=r(141);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var u=r(401);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=r(140);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveService=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.isValidReceiver=p,t.isValidChannelName=d,t.getLiveService=function(e){v||(v=new y(e));return v};var i=h(r(359)),o=h(r(19)),u=h(r(393)),a=r(9),s=r(7),c=r(1),l=r(2),f=r(138);function h(e){return e&&e.__esModule?e:{default:e}}function p(e){if(!e)return!1;var t=e.onMessage,r=e.onError,n=e.onStatus;return(0,o.default)(t)||(0,o.default)(r)||(0,o.default)(n)}function d(e){return(0,l.isNonemptyString)(e)}var y=t.LiveService=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._client=t||a.Client.sharedInstance(),this._pubnubClient=void 0,this._pubnubListener=void 0,this._userChannelGroup=void 0,this._pubnubConfig=void 0,this._registeredUser=void 0}return n(e,[{key:"fullInitialization",value:function(e){var t=this;return this.registerUser(e).then(function(e){var r=new i.default(e),n=new f.PubNubListener;t.initialize(r,n)})}},{key:"fullUninitialization",value:function(){var e=this;return this.unregisterUser().then(function(t){return e.uninitialize(),t})}},{key:"isInitialized",value:function(){return!!this.__pubnubClient&&!!this.__pubnubListener&&!!this._registeredUser}},{key:"registerUser",value:function(e){var t=this;return e&&e.isActive()?this.isInitialized()?Promise.reject(new c.KinveyError("Live service already initialized")):this._makeRegisterRequest(e._id).then(function(r){return t._registeredUser=e,t._userChannelGroup=r.userChannelGroup,(0,u.default)({ssl:!0,authKey:t._registeredUser._kmd.authtoken},r)}):Promise.reject(new c.ActiveUserError("Missing or invalid active user"))}},{key:"initialize",value:function(e,t){if(this.isInitialized())throw new c.KinveyError("Live service already initialized");this._pubnubListener=t,this._pubnubClient=e,this._pubnubClient.addListener(this._pubnubListener),this._subscribeToUserChannelGroup()}},{key:"uninitialize",value:function(){this._unsubscribeFromAll(),this._pubnubClient=null,this._pubnubListener=null}},{key:"onConnectionStatusUpdates",value:function(e){this._pubnubListener.on(f.PubNubListener.unclassifiedEvents,e),this._pubnubListener.on(this._userChannelGroup,e)}},{key:"offConnectionStatusUpdates",value:function(e){e?(this._pubnubListener.removeListener(f.PubNubListener.unclassifiedEvents,e),this._pubnubListener.removeListener(this._userChannelGroup,e)):(this._pubnubListener.removeAllListeners(f.PubNubListener.unclassifiedEvents),this._pubnubListener.removeAllListeners(this._userChannelGroup))}},{key:"publishToChannel",value:function(e,t){if(!this.isInitialized())return Promise.reject(new c.KinveyError("Live service is not initialized"));var r=this._validatePublishData(e,t);return r?Promise.reject(r):this._pubnubClient.publish({message:t,channel:e}).catch(function(e){e=e.status&&e.status.errorData;var t=new s.Response({data:e,statusCode:e.status,headers:e.response&&e.response.headers});return Promise.reject(t)})}},{key:"subscribeToChannel",value:function(e,t){var r=this._validateSubscribeData(e,t);if(r)throw r;this._subscribeToListener(e,t)}},{key:"unsubscribeFromChannel",value:function(e){this._unsubscribeFromListener(e)}},{key:"unregisterUser",value:function(){var e=this;if(!this._registeredUser){return Promise.reject(new c.KinveyError("Cannot unregister when no user has been registered for live service"))}var t=this._registeredUser._id;return this._makeUnregisterRequst(t).then(function(t){return e._registeredUser=null,t})}},{key:"_unsubscribeFromAll",value:function(){this._pubnubClient.unsubscribeAll(),this._pubnubListener.removeAllListeners()}},{key:"_validatePublishData",value:function(e,t){var r=null;return d(e)||(r=new c.KinveyError("Invalid channel name")),void 0===t&&(r=new c.KinveyError("Missing or invalid message")),r}},{key:"_validateSubscribeData",value:function(e,t){var r=null;return d(e)||(r=new c.KinveyError("Invalid channel name")),t&&p(t)||(r=new c.KinveyError("Missing or invalid receiver")),r}},{key:"_subscribeToUserChannelGroup",value:function(){this._pubnubClient.subscribe({channelGroups:[this._userChannelGroup]})}},{key:"_subscribeToListener",value:function(e,t){(0,o.default)(t.onMessage)&&this._pubnubListener.on(e,t.onMessage),((0,o.default)(t.onError)||(0,o.default)(t.onStatus))&&this._pubnubListener.on(""+f.PubNubListener.statusPrefix+e,function(e){var r=e.error?t.onError:t.onStatus;(0,o.default)(r)&&r.call(t,e)})}},{key:"_unsubscribeFromListener",value:function(e){this._pubnubListener.removeAllListeners(e),this._pubnubListener.removeAllListeners(""+f.PubNubListener.statusPrefix+e)}},{key:"_makeRegisterRequest",value:function(e){return this._makeUserManagementRequest(e,"register-realtime")}},{key:"_makeUnregisterRequst",value:function(e){return this._makeUserManagementRequest(e,"unregister-realtime")}},{key:"_makeUserManagementRequest",value:function(e,t){return s.KinveyRequest.executeShort({method:s.RequestMethod.POST,pathname:"/user/"+this._client.appKey+"/"+e+"/"+t,body:{deviceId:this._client.deviceId}},this._client)}},{key:"_throwNotInitializedError",value:function(){throw new c.KinveyError("Live service has not been initialized")}},{key:"_pubnubClient",get:function(){return this.__pubnubClient||this._throwNotInitializedError(),this.__pubnubClient},set:function(e){this.__pubnubClient=e}},{key:"_pubnubListener",set:function(e){this.__pubnubListener=e},get:function(){return this.__pubnubListener||this._throwNotInitializedError(),this.__pubnubListener}}]),e}(),v=void 0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory"},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(92);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(144);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t,r){var n=r(38),i=r(161),o=r(162),u=r(163),a=r(164),s=r(165);function c(e){var t=this.__data__=new n(e);this.size=t.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=u,c.prototype.has=a,c.prototype.set=s,e.exports=c},function(e,t,r){var n=r(24)(r(13),"Map");e.exports=n},function(e,t,r){var n=r(170),i=r(177),o=r(179),u=r(180),a=r(181);function s(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=u,s.prototype.set=a,e.exports=s},function(e,t,r){var n=r(63),i=r(30),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var u=e[t];o.call(e,t)&&i(u,r)&&(void 0!==r||t in e)||n(e,t,r)}},function(e,t,r){var n=r(98);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},function(e,t,r){var n=r(186),i=r(100),o=r(187),u=o&&o.isTypedArray,a=u?i(u):n;e.exports=a},function(e,t){var r=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},function(e,t,r){var n=r(195),i=r(103),o=Object.prototype.propertyIsEnumerable,u=Object.getOwnPropertySymbols,a=u?function(e){return null==e?[]:(e=Object(e),n(u(e),function(t){return o.call(e,t)}))}:i;e.exports=a},function(e,t){e.exports=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},function(e,t,r){var n=r(102)(Object.getPrototypeOf,Object);e.exports=n},function(e,t,r){var n=r(198),i=r(60),o=r(199),u=r(200),a=r(201),s=r(18),c=r(96),l=c(n),f=c(i),h=c(o),p=c(u),d=c(a),y=s;(n&&"[object DataView]"!=y(new n(new ArrayBuffer(1)))||i&&"[object Map]"!=y(new i)||o&&"[object Promise]"!=y(o.resolve())||u&&"[object Set]"!=y(new u)||a&&"[object WeakMap]"!=y(new a))&&(y=function(e){var t=s(e),r="[object Object]"==t?e.constructor:void 0,n=r?c(r):"";if(n)switch(n){case l:return"[object DataView]";case f:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case d:return"[object WeakMap]"}return t}),e.exports=y},function(e,t,r){var n=r(107);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},function(e,t){e.exports=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}},function(e,t,r){"use strict";var n=r(255),i=r(256),o=r(112);e.exports={formats:o,parse:i,stringify:n}},function(e,t,r){var n=r(74),i=r(114);e.exports=function(e){return n(function(t,r){var n=-1,o=r.length,u=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(u=e.length>3&&"function"==typeof u?(o--,u):void 0,a&&i(r[0],r[1],a)&&(u=o<3?void 0:u,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,u)}return t})}},function(e,t,r){var n=r(46),i=r(257),o=r(258);e.exports=function(e,t){return o(i(e,t,n),e+"")}},function(e,t,r){var n=r(18),i=r(15),o="[object Number]";e.exports=function(e){return"number"==typeof e||i(e)&&n(e)==o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkRack=t.CacheRack=t.Rack=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0},o=h(r(6)),u=h(r(77)),a=h(r(19)),s=h(r(80)),c=r(2),l=r(21),f=r(122);function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=t.Rack=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Rack";p(this,t);var r=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.middlewares=[],r.canceled=!1,r.activeMiddleware=void 0,r}return y(t,f.Middleware),n(t,[{key:"use",value:function(e){if((0,c.isDefined)(e)){if(e instanceof f.Middleware)return void this.middlewares.push(e);throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"reset",value:function(){this.middlewares=[]}},{key:"execute",value:function(e){var t=this;return!1===(0,c.isDefined)(e)?o.default.reject(new Error("Request is undefined. Please provide a valid request.")):(0,u.default)((0,s.default)(this.middlewares),function(r,n){return r.then(function(r){var i=r.request,u=r.response;return t.canceled?o.default.reject(new Error("Cancelled")):(t.activeMiddleware=n,n.handle(i||e,u))})},o.default.resolve({request:e})).then(function(e){var r=e.response;return!0===t.canceled?o.default.reject(new Error("Cancelled")):(t.canceled=!1,t.activeMiddleware=void 0,r)}).catch(function(e){throw t.canceled=!1,t.activeMiddleware=void 0,e})}},{key:"cancel",value:function(){return this.canceled=!0,(0,c.isDefined)(this.activeMiddleware)&&(0,a.default)(this.activeMiddleware.cancel)?this.activeMiddleware.cancel():o.default.resolve()}},{key:"handle",value:function(e){return this.execute(e)}},{key:"generateTree",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"generateTree",this).call(this,e);return(0,s.default)(this.middlewares).forEach(function(t){r.nodes.push(t.generateTree(e+1))}),r}}]),t}(),b=new(function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cache Rack";p(this,t);var r=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.use(new f.CacheMiddleware),r}return y(t,v),n(t,[{key:"useCacheMiddleware",value:function(e){this.reset(),this.use(e)}},{key:"execute",value:function(e){return l.Log.debug("Executing cache request",e),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e).then(function(t){return l.Log.debug("Received response for cache request id: "+e.id,t),t}).catch(function(t){throw l.Log.error("Received error for cache request id: "+e.id,t),t})}}]),t}()),g=new(function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Network Rack";p(this,t);var r=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.use(new f.SerializeMiddleware),r.use(new f.HttpMiddleware),r.use(new f.ParseMiddleware),r}return y(t,v),n(t,[{key:"useHttpMiddleware",value:function(e){this.reset(),this.use(new f.SerializeMiddleware),this.use(e),this.use(new f.ParseMiddleware)}},{key:"execute",value:function(e){return l.Log.debug("Executing network request",e),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,e).then(function(t){return l.Log.debug("Received response for network request: "+e.id,t),t}).catch(function(t){throw l.Log.error("Received error for network request id: "+e.id,t),t})}}]),t}());t.CacheRack=b,t.NetworkRack=g},function(e,t,r){var n=r(71),i=r(33),o=r(22),u=r(290),a=r(4);e.exports=function(e,t,r){var s=a(e)?n:u,c=arguments.length<3;return s(e,o(t,4),r,c,i)}},function(e,t,r){var n=r(51),i=r(28);e.exports=function(e,t){for(var r=0,o=(t=n(t,e)).length;null!=e&&r<o;)e=e[i(t[r++])];return r&&r==o?e:void 0}},function(e,t,r){var n=r(4),i=r(52),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!i(e))||u.test(e)||!o.test(e)||null!=t&&e in Object(t)}},function(e,t,r){var n=r(291),i=r(20);e.exports=function(e){return null==e?[]:n(e,i(e))}},function(e,t,r){var n=r(63),i=r(296)(function(e,t,r){n(e,r,t)});e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(330);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheStore=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0},o=E(r(6)),u=E(r(331)),a=E(r(17)),s=E(r(81)),c=E(r(341)),l=E(r(4)),f=E(r(77)),h=E(r(84)),p=E(r(11)),d=r(7),y=r(1),v=r(12),b=r(27),g=r(85),m=r(2),_=r(36),w=r(88),O=r(140);function E(e){return e&&e.__esModule?e:{default:e}}t.CacheStore=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return n.ttl=r.ttl||void 0,n.syncManager=new O.SyncManager(n.collection,r),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,w.NetworkStore),n(t,[{key:"find",value:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(n=(0,a.default)({syncAutomatically:this.syncAutomatically},n)).syncAutomatically;return _.KinveyObservable.create(function(a){return!e||e instanceof v.Query?new d.CacheRequest({method:d.RequestMethod.GET,url:p.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:e,timeout:n.timeout,tag:r.tag}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a.next(c),!0===o?r.pendingSyncCount(e,n).then(function(t){return t>0?r.push(e,n).then(function(){return r.pendingSyncCount(e,n)}):t}).then(function(o){if(o>0)throw new y.KinveyError("Unable to fetch the entities on the backend. There are "+o+" entities that need to be synced.");return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"find",r).call(r,e,n).toPromise()}).then(function(e){var t=(0,u.default)(c,e,"_id"),i=Object.keys((0,s.default)(t,"_id")),o=(new v.Query).contains("_id",i);return r.clear(o,n).then(function(){return e})}).then(function(e){return new d.CacheRequest({method:d.RequestMethod.PUT,url:p.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,body:e,timeout:n.timeout,tag:r.tag}).execute().then(function(e){return e.data})}):c}).then(function(e){a.next(e)}).then(function(){a.complete()}).catch(function(e){return a.error(e)}):a.error(new y.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"findById",value:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(n=(0,a.default)({syncAutomatically:this.syncAutomatically},n)).syncAutomatically;return _.KinveyObservable.create(function(u){return!1===(0,m.isDefined)(e)?(u.next(void 0),u.complete()):new d.CacheRequest({method:d.RequestMethod.GET,url:p.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/"+e}),properties:n.properties,timeout:n.timeout,tag:r.tag}).execute().then(function(e){return e.data}).catch(function(){}).then(function(a){if(u.next(a),!0===o){var s=new v.Query;return s.equalTo("_id",e),r.pendingSyncCount(s,n).then(function(e){return e>0?r.push(s,n).then(function(){return r.pendingSyncCount(s,n)}):e}).then(function(e){if(e>0)throw new y.KinveyError("Unable to find the entity on the backend. There are "+e+" entities that need to be synced.")}).then(function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"findById",r).call(r,e,n).toPromise()}).then(function(e){return new d.CacheRequest({method:d.RequestMethod.PUT,url:p.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,body:e,timeout:n.timeout,tag:r.tag}).execute().then(function(e){return e.data})})}return a}).then(function(e){return u.next(e)}).then(function(){return u.complete()}).catch(function(e){return u.error(e)})})}},{key:"group",value:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(n=(0,a.default)({syncAutomatically:this.syncAutomatically},n)).syncAutomatically;return _.KinveyObservable.create(function(u){return e instanceof b.Aggregation?new d.CacheRequest({method:d.RequestMethod.POST,url:p.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname+"/_group"}),properties:n.properties,aggregation:e,timeout:n.timeout,tag:r.tag}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return u.next(a),!0===o?r.pendingSyncCount(null,n).then(function(e){return e>0?r.push(null,n).then(function(){return r.pendingSyncCount(null,n)}):e}).then(function(o){if(o>0)throw new y.KinveyError("Unable to group entities on the backend. There are "+o+" entities that need to be synced.");return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"group",r).call(r,e,n).toPromise()}):a}).then(function(e){return u.next(e)}).then(function(){return u.complete()}).catch(function(e){return u.error(e)}):u.error(new y.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))})}},{key:"count",value:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!0===(n=(0,a.default)({syncAutomatically:this.syncAutomatically},n)).syncAutomatically;return _.KinveyObservable.create(function(u){return!e||e instanceof v.Query?new d.CacheRequest({method:d.RequestMethod.GET,url:p.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:r.pathname}),properties:n.properties,query:e,timeout:n.timeout,tag:r.tag}).execute().then(function(e){return e.data}).catch(function(){return[]}).then(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).length}).then(function(a){return u.next(a),!0===o?r.pendingSyncCount(e,n).then(function(t){return t>0?r.push(e,n).then(function(){return r.pendingSyncCount(e,n)}):t}).then(function(e){if(e>0)throw new y.KinveyError("Unable to count entities on the backend. There are "+e+" entities that need to be synced.")}).then(function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"count",r).call(r,e,n).toPromise()}):a}).then(function(e){return u.next(e)}).then(function(){return u.complete()}).catch(function(e){return u.error(e)}):u.error(new y.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"create",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _.KinveyObservable.create(function(n){return!1===(0,m.isDefined)(e)?(n.next(null),n.complete()):(0,l.default)(e)?n.error(new y.KinveyError("Unable to create an array of entities.","Please create entities one by one.")):new d.CacheRequest({method:d.RequestMethod.POST,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,body:e,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return t.syncManager.addCreateOperation(e,r).then(function(){return e})}).then(function(e){if(!0===t.syncAutomatically){var n=(new v.Query).equalTo("_id",e._id);return t.push(n,r).then(function(e){var t=e[0];if((0,m.isDefined)(t.error))throw t.error;return t.entity})}return e}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}).toPromise()}},{key:"update",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _.KinveyObservable.create(function(n){return!1===(0,m.isDefined)(e)?(n.next(null),n.complete()):(0,l.default)(e)?n.error(new y.KinveyError("Unable to update an array of entities.","Please update entities one by one.")):!1===(0,m.isDefined)(e._id)?n.error(new y.KinveyError("The entity provided does not contain an _id. An _id is required to update the entity.",e)):new d.CacheRequest({method:d.RequestMethod.PUT,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,body:e,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return t.syncManager.addUpdateOperation(e,r).then(function(){return e})}).then(function(e){if(!0===t.syncAutomatically){var n=(new v.Query).equalTo("_id",e._id);return t.push(n,r).then(function(e){var t=e[0];if((0,m.isDefined)(t.error))throw t.error;return t.entity})}return e}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}).toPromise()}},{key:"remove",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _.KinveyObservable.create(function(n){return!e||e instanceof v.Query?new d.CacheRequest({method:d.RequestMethod.GET,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:e,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length>0?o.default.all((0,h.default)(e,function(e){if(new g.Metadata(e).isLocal()){var n=new v.Query;return n.equalTo("_id",e._id),t.clearSync(n,r).then(function(){return e})}return t.syncManager.addDeleteOperation(e,r).then(function(){return e})})).then(function(){return e}):e}).then(function(e){if(e.length>0&&!0===t.syncAutomatically){var n=(0,c.default)(e,function(e){return new g.Metadata(e).isLocal()}),i=Object.keys((0,s.default)(e,"_id")),o=(new v.Query).contains("_id",i);return t.push(o,r).then(function(e){return e.concat(n)})}return e}).then(function(e){return o.default.all((0,h.default)(e,function(e){return!1===(0,m.isDefined)(e.error)?new d.CacheRequest({method:d.RequestMethod.DELETE,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,authType:d.AuthType.Default,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}):{count:0}}))}).then(function(e){return(0,f.default)(e,function(e,t){return e.count+=t.count,e},{count:0})}).then().then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)}):n.error(new y.KinveyError("Invalid query. It must be an instance of the Query class."))}).toPromise()}},{key:"removeById",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _.KinveyObservable.create(function(n){return!1===(0,m.isDefined)(e)?(n.next({count:0}),n.complete()):new d.CacheRequest({method:d.RequestMethod.GET,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:r.properties,authType:d.AuthType.Default,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).catch(function(e){if(e instanceof y.NotFoundError)return null;throw e}).then(function(e){if((0,m.isDefined)(e)){if(new g.Metadata(e).isLocal()){var n=new v.Query;return n.equalTo("_id",e._id),t.clearSync(n,r).then(function(){return e})}return t.syncManager.addDeleteOperation(e,r).then(function(){return e})}return e}).then(function(e){if(!0===t.syncAutomatically){var n=(new v.Query).equalTo("_id",e._id);return t.push(n,r).then(function(){return e})}return e}).then(function(e){return new d.CacheRequest({method:d.RequestMethod.DELETE,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,authType:d.AuthType.Default,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data})}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}).toPromise()}},{key:"clear",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _.KinveyObservable.create(function(n){return!e||e instanceof v.Query?new d.CacheRequest({method:d.RequestMethod.GET,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:e,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return o.default.all((0,h.default)(e,function(e){return o.default.resolve(e).then(function(e){if(new g.Metadata(e).isLocal()){var n=new v.Query;return n.equalTo("_id",e._id),t.clearSync(n,r).then(function(){return e})}return e}).then(function(e){return new d.CacheRequest({method:d.RequestMethod.DELETE,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,authType:d.AuthType.Default,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data})})}))}).then(function(e){return(0,f.default)(e,function(e,t){return e.count+=t.count,e},{count:0})}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)}):n.error(new y.KinveyError("Invalid query. It must be an instance of the Query class."))}).toPromise()}},{key:"pendingSyncCount",value:function(e,t){return this.syncManager.count(e,t)}},{key:"pendingSyncEntities",value:function(e,t){return this.syncManager.find(e,t)}},{key:"push",value:function(e,t){return this.syncManager.push(e,t)}},{key:"pull",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=(0,a.default)({useDeltaFetch:this.useDeltaFetch},r),this.syncManager.pull(e,r).then(function(n){return t.clear(e,r).then(function(){return new d.CacheRequest({method:d.RequestMethod.PUT,url:p.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,body:n,timeout:r.timeout,tag:t.tag}).execute()}).then(function(){return n})})}},{key:"sync",value:function(e,t){var r=this;return t=(0,a.default)({useDeltaFetch:this.useDeltaFetch},t),this.push(e,t).then(function(n){return r.pull(e,t).then(function(e){return{push:n,pull:e}})})}},{key:"clearSync",value:function(e,t){return this.syncManager.clear(e,t)}},{key:"syncAutomatically",get:function(){return!0}}]),t}()},function(e,t,r){var n=r(53),i=r(22),o=r(346),u=r(4);e.exports=function(e,t){return(u(e)?n:o)(e,i(t,3))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(32),u=(n=o)&&n.__esModule?n:{default:n},a=r(1),s=r(2);t.Metadata=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!1===(0,u.default)(t))throw new a.KinveyError("entity argument must be an object");t._kmd=t._kmd||{},this.entity=t}return i(e,[{key:"isLocal",value:function(){return!0===this.entity._kmd.local}},{key:"toPlainObject",value:function(){return this.entity._kmd}},{key:"createdAt",get:function(){if((0,s.isDefined)(this.entity._kmd.ect))return new Date(this.entity._kmd.ect)}},{key:"ect",get:function(){return this.createdAt}},{key:"emailVerification",get:function(){if((0,s.isDefined)(this.entity._kmd.emailVerification))return this.entity._kmd.emailVerification.status}},{key:"lastModified",get:function(){if((0,s.isDefined)(this.entity._kmd.lmt))return new Date(this.entity._kmd.lmt)}},{key:"lmt",get:function(){return this.lastModified}},{key:"authtoken",get:function(){return this.entity._kmd.authtoken}}]),e}()},function(e,t,r){"use strict";(function(e){var r="undefined"!=typeof window&&window,n="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,i=r||void 0!==e&&e||n;t.root=i,function(){if(!i)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(t,r(23))},function(e,t,r){"use strict";var n=r(86).root.Symbol;t.rxSubscriber="function"==typeof n&&"function"==typeof n.for?n.for("rxSubscriber"):"@@rxSubscriber",t.$$rxSubscriber=t.rxSubscriber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkStore=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=y(r(8)),o=y(r(4)),u=y(r(11)),a=r(7),s=r(1),c=r(12),l=r(9),f=r(2),h=r(36),p=r(27),d=r(89);function y(e){return e&&e.__esModule?e:{default:e}}t.NetworkStore=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&!(0,i.default)(t))throw new s.KinveyError("Collection must be a string.");if(this.collection=t,r.tag){var n=r.tag;if(!(0,i.default)(n))throw new s.KinveyError("A tag must be a string.");if(!/^[a-zA-Z0-9-]+$/.test(n))throw new s.KinveyError('A tag can only contain letters, numbers, and "-".');this.tag=n}this.client=r.client,this.useDeltaFetch=!0===r.useDeltaFetch}return n(e,[{key:"find",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!0===r.useDeltaFetch||this.useDeltaFetch;return h.KinveyObservable.create(function(i){if((0,f.isDefined)(e)&&!(e instanceof c.Query))return i.error(new s.KinveyError("Invalid query. It must be an instance of the Query class."));var o={method:a.RequestMethod.GET,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:e,timeout:r.timeout,client:t.client,tag:t.tag},l=new a.KinveyRequest(o);return!0===n&&(l=new a.DeltaFetchRequest(o)),l.execute().then(function(e){return e.data}).then(function(e){return i.next(e)}).then(function(){return i.complete()}).catch(function(e){return i.error(e)})})}},{key:"findById",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.useDeltaFetch||this.useDeltaFetch;return h.KinveyObservable.create(function(i){if(!e)return i.next(void 0),i.complete();var o={method:a.RequestMethod.GET,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:r.properties,timeout:r.timeout,client:t.client,tag:t.tag},s=new a.KinveyRequest(o);return!0===n&&(s=new a.DeltaFetchRequest(o)),s.execute().then(function(e){return e.data}).then(function(e){return i.next(e)}).then(function(){return i.complete()}).catch(function(e){return i.error(e)})})}},{key:"group",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){return e instanceof p.Aggregation?new a.KinveyRequest({method:a.RequestMethod.POST,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_group"}),properties:r.properties,aggregation:e,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)}):n.error(new s.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))})}},{key:"count",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){try{if(e&&!(e instanceof c.Query))throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");return new a.KinveyRequest({method:a.RequestMethod.GET,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_count"}),properties:r.properties,query:e,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return n.next(e?e.count:0)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}catch(e){return n.error(e)}})}},{key:"create",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){return!1===(0,f.isDefined)(e)?(n.next(null),n.complete()):(0,o.default)(e)?n.error(new s.KinveyError("Unable to create an array of entities.","Please create entities one by one.")):new a.KinveyRequest({method:a.RequestMethod.POST,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,data:e,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}).toPromise()}},{key:"update",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){return!1===(0,f.isDefined)(e)?(n.next(null),n.complete()):(0,o.default)(e)?n.error(new s.KinveyError("Unable to update an array of entities.","Please update entities one by one.")):!1===(0,f.isDefined)(e._id)?n.error(new s.KinveyError("Unable to update entity.","Entity must contain an _id to be updated.")):new a.KinveyRequest({method:a.RequestMethod.PUT,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,data:e,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}).toPromise()}},{key:"save",value:function(e,t){return e._id?this.update(e,t):this.create(e,t)}},{key:"remove",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){try{if(e&&!(e instanceof c.Query))throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");return new a.KinveyRequest({method:a.RequestMethod.DELETE,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:e,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}catch(e){return n.error(e)}}).toPromise()}},{key:"removeById",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){try{return!1===(0,f.isDefined)(e)?(n.next(void 0),n.complete()):new a.KinveyRequest({method:a.RequestMethod.DELETE,authType:a.AuthType.Default,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:r.properties,timeout:r.timeout}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}catch(e){return n.error(e)}}).toPromise()}},{key:"subscribe",value:function(e){return(0,d.getLiveCollectionManager)().subscribeCollection(this.collection,e)}},{key:"unsubscribe",value:function(){return(0,d.getLiveCollectionManager)().unsubscribeCollection(this.collection)}},{key:"client",get:function(){return(0,f.isDefined)(this._client)?this._client:l.Client.sharedInstance()},set:function(e){e instanceof l.Client?this._client=e:this._client=null}},{key:"pathname",get:function(){var e="/appdata/"+this.client.appKey;return this.collection&&(e=e+"/"+this.collection),e}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(357);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(395);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=r(56);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var u=r(138);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=r(400);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(361),o=(n=i)&&n.__esModule?n:{default:n};t.default={createUUID:function(){return o.default.uuid?o.default.uuid():(0,o.default)()}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(58),i=r(7),o=r(127),u=r(320),a=r(321),s=r(327);i.CacheRack.useCacheMiddleware(new o.CacheMiddleware),i.NetworkRack.useHttpMiddleware(new u.HttpMiddleware(s.default)),n.MobileIdentityConnect.usePopupClass(a.Popup);var c=r(328);t.client=c.client,t.getAppVersion=c.getAppVersion,t.setAppVersion=c.setAppVersion,t.ping=c.ping,t.Acl=c.Acl,t.Aggregation=c.Aggregation,t.AuthorizationGrant=c.AuthorizationGrant,t.CustomEndpoint=c.CustomEndpoint,t.DataStore=c.DataStore,t.DataStoreType=c.DataStoreType,t.SyncOperation=c.SyncOperation,t.LiveService=c.LiveService,t.Files=c.Files,t.Log=c.Log,t.Metadata=c.Metadata,t.Query=c.Query,t.User=c.User,t.ActiveUserError=c.ActiveUserError,t.APIVersionNotAvailableError=c.APIVersionNotAvailableError,t.APIVersionNotImplementedError=c.APIVersionNotImplementedError,t.AppProblemError=c.AppProblemError,t.BadRequestError=c.BadRequestError,t.BLError=c.BLError,t.CORSDisabledError=c.CORSDisabledError,t.DuplicateEndUsersError=c.DuplicateEndUsersError,t.FeatureUnavailableError=c.FeatureUnavailableError,t.IncompleteRequestBodyError=c.IncompleteRequestBodyError,t.IndirectCollectionAccessDisallowedError=c.IndirectCollectionAccessDisallowedError,t.InsufficientCredentialsError=c.InsufficientCredentialsError,t.InvalidCredentialsError=c.InvalidCredentialsError,t.InvalidIdentifierError=c.InvalidIdentifierError,t.InvalidQuerySyntaxError=c.InvalidQuerySyntaxError,t.JSONParseError=c.JSONParseError,t.KinveyError=c.KinveyError,t.KinveyInternalErrorRetry=c.KinveyInternalErrorRetry,t.KinveyInternalErrorStop=c.KinveyInternalErrorStop,t.MissingQueryError=c.MissingQueryError,t.MissingRequestHeaderError=c.MissingRequestHeaderError,t.MissingRequestParameterError=c.MissingRequestParameterError,t.MobileIdentityConnectError=c.MobileIdentityConnectError,t.NoActiveUserError=c.NoActiveUserError,t.NetworkConnectionError=c.NetworkConnectionError,t.NoResponseError=c.NoResponseError,t.NotFoundError=c.NotFoundError,t.ParameterValueOutOfRangeError=c.ParameterValueOutOfRangeError,t.PopupError=c.PopupError,t.QueryError=c.QueryError,t.ServerError=c.ServerError,t.StaleRequestError=c.StaleRequestError,t.SyncError=c.SyncError,t.TimeoutError=c.TimeoutError,t.UserAlreadyExistsError=c.UserAlreadyExistsError,t.WritesToCollectionDisallowedError=c.WritesToCollectionDisallowedError,function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(407))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.SocialIdentity={Kinvey:"kinvey",MobileIdentityConnect:"kinveyAuth"};Object.freeze(n)},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(t,r(23))},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.CacheRequest=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0},o=d(r(11)),u=d(r(95)),a=r(1),s=r(12),c=r(27),l=r(2),f=r(49),h=r(34),p=r(76);function d(e){return e&&e.__esModule?e:{default:e}}t.CacheRequest=function(t){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return t.aggregation=e.aggregation,t.query=e.query,t.rack=p.CacheRack,t.tag=e.tag,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,f.Request),n(r,[{key:"execute",value:function(){var e=this;return i(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"execute",this).call(this).then(function(t){if(t instanceof h.KinveyResponse||(t=new h.KinveyResponse({statusCode:t.statusCode,headers:t.headers,data:t.data})),!t.isSuccess())throw t.error;return(0,l.isDefined)(e.query)&&(0,l.isDefined)(t.data)&&(t.data=e.query.process(t.data)),(0,l.isDefined)(e.aggregation)&&(0,l.isDefined)(t.data)&&(t.data=e.aggregation.process(t.data)),t})}},{key:"toPlainObject",value:function(){var e=i(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toPlainObject",this).call(this);return e.appKey=this.appKey,e.collection=this.collection,e.entityId=this.entityId,e.encryptionKey=this.client?this.client.encryptionKey:void 0,e.storageProviders=this.client?this.client.storageProviders:void 0,e}},{key:"body",get:function(){return this._body},set:function(e){this._body=(0,u.default)(e)}},{key:"query",get:function(){return this._query},set:function(e){if((0,l.isDefined)(e)&&!(e instanceof s.Query))throw new a.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"aggregation",get:function(){return this._aggregation},set:function(e){if((0,l.isDefined)(e)&&!(e instanceof c.Aggregation))throw new a.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.");this._aggregation=e}},{key:"collection",get:function(){return(0,l.isDefined)(this.tag)?this._collection+"."+this.tag:this._collection},set:function(e){this._collection=e}},{key:"url",get:function(){return i(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"url",this)},set:function(t){!function e(t,r,n,i){var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var u=Object.getPrototypeOf(t);null!==u&&e(u,r,n,i)}else if("value"in o&&o.writable)o.value=n;else{var a=o.set;void 0!==a&&a.call(i,n)}return n}(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"url",t,this);var n=e.decodeURIComponent(o.default.parse(t).pathname).replace(/^\//,"").split("/");this.appKey=n[1],this.collection=n[2],this.entityId=n[3]}}]),r}()}).call(t,r(23))},function(e,t,r){var n=r(155),i=1,o=4;e.exports=function(e){return n(e,i|o)}},function(e,t){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},function(e,t,r){var n=r(24),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t,r){var n=r(183),i=r(42),o=r(4),u=r(43),a=r(44),s=r(64),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=o(e),l=!r&&i(e),f=!r&&!l&&u(e),h=!r&&!l&&!f&&s(e),p=r||l||f||h,d=p?n(e.length,String):[],y=d.length;for(var v in e)!t&&!c.call(e,v)||p&&("length"==v||f&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||a(v,y))||d.push(v);return d}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,r){var n=r(31),i=r(188),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=[];for(var r in Object(e))o.call(e,r)&&"constructor"!=r&&t.push(r);return t}},function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},function(e,t){e.exports=function(){return[]}},function(e,t,r){var n=r(67),i=r(68),o=r(66),u=r(103),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,o(e)),e=i(e);return t}:u;e.exports=a},function(e,t,r){var n=r(106),i=r(66),o=r(20);e.exports=function(e){return n(e,o,i)}},function(e,t,r){var n=r(67),i=r(4);e.exports=function(e,t,r){var o=t(e);return i(e)?o:n(o,r(e))}},function(e,t,r){var n=r(13).Uint8Array;e.exports=n},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isDefined=a,t.isNumber=function(e){return!Number.isNaN(parseFloat(e))&&Number.isFinite(e)},t.nested=function(e,t,r){if(!1===a(t))return e=r||e;var n=t.split("."),i=n.shift();for(;i&&e;)e=e[i],i=n.shift();return r||e},t.keyBy=function(e,t){if(!e)return{};return e.reduce(function(e,r){return e[t]=r[t],e},{})},t.isEmpty=function(e){return!a(e)||!(e.length>0)&&(0===e.length||"object"!==(void 0===e?"undefined":n(e))||Object.keys(e).reduce(function(t,r){return!!t&&!Object.hasOwnProperty.call(e,r)},!0))};var i=u(r(251)),o=u(r(252));function u(e){return e&&e.__esModule?e:{default:e}}function a(e){return!1===(0,o.default)(e)&&!1===(0,i.default)(e)}},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,i=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}();t.arrayToObject=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},t.merge=function(e,r,i){if(!r)return e;if("object"!=typeof r){if(Array.isArray(e))e.push(r);else{if("object"!=typeof e)return[e,r];(i.plainObjects||i.allowPrototypes||!n.call(Object.prototype,r))&&(e[r]=!0)}return e}if("object"!=typeof e)return[e].concat(r);var o=e;return Array.isArray(e)&&!Array.isArray(r)&&(o=t.arrayToObject(e,i)),Array.isArray(e)&&Array.isArray(r)?(r.forEach(function(r,o){n.call(e,o)?e[o]&&"object"==typeof e[o]?e[o]=t.merge(e[o],r,i):e.push(r):e[o]=r}),e):Object.keys(r).reduce(function(e,o){var u=r[o];return n.call(e,o)?e[o]=t.merge(e[o],u,i):e[o]=u,e},o)},t.assign=function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),r="",n=0;n<t.length;++n){var o=t.charCodeAt(n);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?r+=t.charAt(n):o<128?r+=i[o]:o<2048?r+=i[192|o>>6]+i[128|63&o]:o<55296||o>=57344?r+=i[224|o>>12]+i[128|o>>6&63]+i[128|63&o]:(n+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(n)),r+=i[240|o>>18]+i[128|o>>12&63]+i[128|o>>6&63]+i[128|63&o])}return r},t.compact=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],o=i.obj[i.prop],u=Object.keys(o),a=0;a<u.length;++a){var s=u[a],c=o[s];"object"==typeof c&&null!==c&&-1===r.indexOf(c)&&(t.push({obj:o,prop:s}),r.push(c))}return function(e){for(var t;e.length;){var r=e.pop();if(t=r.obj[r.prop],Array.isArray(t)){for(var n=[],i=0;i<t.length;++i)void 0!==t[i]&&n.push(t[i]);r.obj[r.prop]=n}}return t}(t)},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&void 0!==e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,r){"use strict";var n=String.prototype.replace,i=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return n.call(e,i,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},function(e,t,r){var n=r(30),i=r(16),o=r(44),u=r(14);e.exports=function(e,t,r){if(!u(r))return!1;var a=typeof t;return!!("number"==a?i(r)&&o(t,r.length):"string"==a&&t in r)&&n(r[t],e)}},function(e,t,r){"use strict";function n(){this._cache=i(),this._timeouts=i()}function i(){return Object.create(null)}n.prototype.get=function(e){return this._cache[e]},n.prototype.set=function(e,t,r){this.delete(e),this._cache[e]=t,r&&(this._timeouts[e]=setTimeout(this.delete.bind(this,e),1e3*r))},n.prototype.delete=function(e){delete this._cache[e],e in this._timeouts&&(clearTimeout(this._timeouts[e]),delete this._timeouts[e])},n.prototype.clear=function(){for(var e in this._cache=i(),this._timeouts)clearTimeout(this._timeouts[e]);this._timeouts=i()},e.exports=n},function(e,t,r){var n=r(270),i=r(15);e.exports=function e(t,r,o,u,a){return t===r||(null==t||null==r||!i(t)&&!i(r)?t!=t&&r!=r:n(t,r,o,u,e,a))}},function(e,t,r){var n=r(118),i=r(273),o=r(119),u=1,a=2;e.exports=function(e,t,r,s,c,l){var f=r&u,h=e.length,p=t.length;if(h!=p&&!(f&&p>h))return!1;var d=l.get(e);if(d&&l.get(t))return d==t;var y=-1,v=!0,b=r&a?new n:void 0;for(l.set(e,t),l.set(t,e);++y<h;){var g=e[y],m=t[y];if(s)var _=f?s(m,g,y,t,e,l):s(g,m,y,e,t,l);if(void 0!==_){if(_)continue;v=!1;break}if(b){if(!i(t,function(e,t){if(!o(b,t)&&(g===e||c(g,e,r,s,l)))return b.push(t)})){v=!1;break}}else if(g!==m&&!c(g,m,r,s,l)){v=!1;break}}return l.delete(e),l.delete(t),v}},function(e,t,r){var n=r(61),i=r(271),o=r(272);function u(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}u.prototype.add=u.prototype.push=i,u.prototype.has=o,e.exports=u},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,r){var n=r(14);e.exports=function(e){return e==e&&!n(e)}},function(e,t){e.exports=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(292);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(305);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var o=r(35);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var u=r(306);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var a=r(307);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=r(123);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryAdapter=t.Storage=t.StorageProvider=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=h(r(6)),o=h(r(8)),u=h(r(4)),a=r(2),s=r(294),c=r(21),l=r(1),f=r(295);function h(e){return e&&e.__esModule?e:{default:e}}var p=new s.Queue(1,1/0),d=t.StorageProvider={Memory:"Memory"};Object.freeze(d);t.Storage=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[d.Memory];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new l.KinveyError("Unable to create a Storage instance without a name.");if(!(0,o.default)(t))throw new l.KinveyError("The name is not a string. A name must be a string to create a Storage instance.");this.name=t,Array.isArray(r)||(r=[r]),this.storageProviders=r}return n(e,[{key:"loadAdapter",value:function(){var e=this;return this.storageProviders.reduce(function(t,r){return t.then(function(t){if(t)return t;switch(r){case d.Memory:return f.MemoryAdapter.load(e.name);default:return null}})},i.default.resolve()).then(function(e){return e||i.default.reject(new l.KinveyError("Unable to load a storage adapter."))})}},{key:"generateObjectId",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,t="abcdef0123456789",r="",n=0,i=t.length;n<e;n+=1){var o=Math.floor(Math.random()*i);r+=t.substring(o,o+1)}return r}},{key:"find",value:function(e){return this.loadAdapter().then(function(t){return c.Log.debug("Find all the entities stored in the "+e+" collection.",t),t.find(e)}).catch(function(t){return c.Log.error("Unable to find all the entities stored in the "+e+" collection.",t),t instanceof l.NotFoundError||404===t.code?[]:i.default.reject(t)}).then(function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]})}},{key:"findById",value:function(e,t){if(!(0,o.default)(t)){var r=new l.KinveyError("id must be a string",t);return c.Log.error("Unable to find an entity with id "+t+" stored in the "+e+" collection.",r.message),i.default.reject(r)}return this.loadAdapter().then(function(r){return c.Log.debug("Find an entity with id "+t+" stored in the "+e+" collection.",r),r.findById(e,t)})}},{key:"save",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return p.add(function(){var n=!1;return(0,a.isDefined)(r)?((0,u.default)(r)||(n=!0,r=[r]),r=r.map(function(e){if(!(0,a.isDefined)(e._id)){var r=e._kmd||{};r.local=!0,e._kmd=r,e._id=t.generateObjectId()}return e}),t.loadAdapter().then(function(t){return t.save(e,r)}).then(function(e){return n&&e.length>0?e[0]:e})):i.default.resolve(null)})}},{key:"remove",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.default.all(r.map(function(r){return(0,a.isDefined)(r._id)?t.removeById(e,r._id):i.default.reject(new l.KinveyError("Unable to remove this entity because it does not have _id."))})).then(function(e){return e.reduce(function(e,t){return e.count+=t.count,e},{count:0})})}},{key:"removeById",value:function(e,t){var r=this;return p.add(function(){return(0,o.default)(t)?r.loadAdapter().then(function(r){return r.removeById(e,t)}):i.default.reject(new l.KinveyError("id must be a string",t))})}},{key:"clear",value:function(){var e=this;return p.add(function(){return e.loadAdapter().then(function(e){return e.clear()})})}}]),e}();t.MemoryAdapter=f.MemoryAdapter},function(e,t){e.exports=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},function(e,t,r){var n=r(51),i=r(19),o=r(28);e.exports=function(e,t,r){var u=-1,a=(t=n(t,e)).length;for(a||(a=1,e=void 0);++u<a;){var s=null==e?void 0:e[o(t[u])];void 0===s&&(u=a,s=r),e=i(s)?s.call(e):s}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyRequest=t.Properties=t.AuthType=t.NetworkRequest=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n,i){var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var u=Object.getPrototypeOf(t);null!==u&&e(u,r,n,i)}else if("value"in o&&o.writable)o.value=n;else{var a=o.set;void 0!==a&&a.call(i,n)}return n},o=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0},u=E(r(6)),a=r(309),s=E(r(72)),c=E(r(17)),l=E(r(313)),f=E(r(47)),h=E(r(11)),p=E(r(8)),d=r(9),y=r(12),v=r(27),b=r(2),g=r(1),m=r(49),_=r(50),w=r(76),O=r(34);function E(e){return e&&e.__esModule?e:{default:e}}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var S=t.NetworkRequest=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k(this,t);var r=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.rack=w.NetworkRack,r}return j(t,m.Request),t}(),A=t.AuthType={All:"All",App:"App",Basic:"Basic",Default:"Default",Master:"Master",None:"None",Session:"Session"};Object.freeze(A);var T={all:function(e){return T.session(e).catch(function(){return T.basic(e)})},app:function(e){return e.appKey&&e.appSecret?u.default.resolve({scheme:"Basic",username:e.appKey,password:e.appSecret}):u.default.reject(new Error("Missing client appKey and/or appSecret. Use Kinvey.initialize() to set the appKey and appSecret for the client."))},basic:function(e){return T.master(e).catch(function(){return T.app(e)})},master:function(e){return e.appKey&&e.masterSecret?u.default.resolve({scheme:"Basic",username:e.appKey,password:e.masterSecret}):u.default.reject(new Error("Missing client appKey and/or masterSecret. Use Kinvey.initialize() to set the appKey and masterSecret for the client."))},none:function(){return u.default.resolve(null)},session:function(e){var t=e.getActiveUser();return(0,b.isDefined)(t)?u.default.resolve({scheme:"Kinvey",credentials:t._kmd.authtoken}):u.default.reject(new g.NoActiveUserError("There is not an active user. Please login a user and retry the request."))}};var x=t.Properties=function(e){function t(){return k(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return j(t,_.Headers),t}();t.KinveyRequest=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k(this,t);var r=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e=(0,c.default)({skipBL:!1,trace:!1},e),r.authType=e.authType||A.None,r.query=e.query,r.aggregation=e.aggregation,r.properties=e.properties||new x,r.skipBL=!0===e.skipBL,r.trace=!0===e.trace,r}return j(t,S),n(t,[{key:"getAuthorizationHeader",value:function(){var e=this,t=u.default.resolve(void 0);if(this.authType)switch(this.authType){case A.All:t=T.all(this.client);break;case A.App:t=T.app(this.client);break;case A.Basic:t=T.basic(this.client);break;case A.Master:t=T.master(this.client);break;case A.None:t=T.none(this.client);break;case A.Session:t=T.session(this.client);break;default:t=T.session(this.client).catch(function(t){return T.master(e.client).catch(function(){throw t})})}return t.then(function(e){if((0,b.isDefined)(e)){var t=e.credentials;return e.username&&(t=new a.Buffer(e.username+":"+e.password).toString("base64")),e.scheme+" "+t}})}},{key:"execute",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.getAuthorizationHeader().then(function(t){(0,b.isDefined)(t)?e.headers.set("Authorization",t):e.headers.remove("Authorization")}).then(function(){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",e).call(e)}).then(function(e){if(e instanceof O.KinveyResponse==!1&&(e=new O.KinveyResponse({statusCode:e.statusCode,headers:e.headers,data:e.data})),!1===r&&!1===e.isSuccess())throw e.error;return e}).catch(function(i){if(n&&i instanceof g.InvalidCredentialsError){var o=e.client.getActiveUser();if((0,b.isDefined)(o)){var a=(0,b.isDefined)(o._socialIdentity)?o._socialIdentity:{},s=Object.keys(a).find(function(e){return"kinveyAuth"===a[e].identity}),c=a[s];if((0,b.isDefined)(c))return new t({method:m.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:A.App,url:h.default.format({protocol:e.client.micProtocol,host:e.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:c.client_id,redirect_uri:c.redirect_uri,refresh_token:c.refresh_token},properties:e.properties,timeout:e.timeout}).execute().then(function(e){return e.data}).then(function(t){return t.identity=c.identity,t.client_id=c.client_id,t.redirect_uri=c.redirect_uri,t.protocol=e.client.micProtocol,t.host=e.client.micHost,t}).then(function(r){var n={};return a[r.identity]=r,n._socialIdentity=a,new t({method:m.RequestMethod.POST,authType:A.App,url:h.default.format({protocol:e.client.apiProtocol,host:e.client.apiHost,pathname:"/user/"+e.client.appKey+"/login"}),properties:e.properties,body:n,timeout:e.timeout,client:e.client}).execute().then(function(e){return e.data}).then(function(t){return t._socialIdentity[r.identity]=(0,l.default)(t._socialIdentity[r.identity],r),e.client.setActiveUser(t)})}).then(function(){return e.execute(r,!1)}).catch(function(){return u.default.reject(i)})}}return u.default.reject(i)})}},{key:"appVersion",get:function(){return this.client.appVersion}},{key:"query",get:function(){return this._query},set:function(e){if((0,b.isDefined)(e)&&!(e instanceof y.Query))throw new g.KinveyError("Invalid query. It must be an instance of the Query class.");this._query=e}},{key:"aggregation",get:function(){return this._aggregation},set:function(e){if((0,b.isDefined)(e)&&!(e instanceof v.Aggregation))throw new g.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.");(0,b.isDefined)(e)&&(this.body=e.toPlainObject()),this._aggregation=e}},{key:"headers",get:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",this);if(e.has("Accept")||e.set("Accept","application/json; charset=utf-8"),e.has("Content-Type")||e.set("Content-Type","application/json; charset=utf-8"),e.has("X-Kinvey-Api-Version")||e.set("X-Kinvey-Api-Version",4),!0===this.skipBL?e.set("X-Kinvey-Skip-Business-Logic",!0):e.remove("X-Kinvey-Skip-Business-Logic"),!0===this.trace?(e.set("X-Kinvey-Include-Headers-In-Response","X-Kinvey-Request-Id"),e.set("X-Kinvey-ResponseWrapper",!0)):(e.remove("X-Kinvey-Include-Headers-In-Response"),e.remove("X-Kinvey-ResponseWrapper")),this.appVersion?e.set("X-Kinvey-Client-App-Version",this.appVersion):e.remove("X-Kinvey-Client-App-Version"),this.properties){var r=this.properties.toString();if((0,f.default)(r))e.remove("X-Kinvey-Custom-Request-Properties");else{var n=function(e){if(e){var t=0,r=e.length;e=String(e||"");for(var n=0;n<r;n+=1){var i=encodeURI(e[n]).split("%").length;t+=1===i?1:i-1}return t}return 0}(r);if(n>=2e3)throw new Error("The custom properties are "+n+" bytes.It must be less then 2000 bytes.","Please remove some custom properties.");e.set("X-Kinvey-Custom-Request-Properties",r)}}else e.remove("X-Kinvey-Custom-Request-Properties");return e},set:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",e,this)}},{key:"url",get:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",this),r=this.query?this.query.toQueryString():{};return(0,f.default)(r)?e:(0,b.appendQuery)(e,s.default.stringify(r))},set:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",e,this)}},{key:"properties",get:function(){return this._properties},set:function(e){e&&e instanceof x==!1&&(e=new x(e)),this._properties=e}}],[{key:"executeShort",value:function(e,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=(0,c.default)({method:m.RequestMethod.GET,authType:A.Session},e);r=r||d.Client.sharedInstance(),!i.url&&(0,p.default)(i.pathname)&&r&&(i.url=h.default.format({protocol:r.apiProtocol,host:r.apiHost,pathname:i.pathname}));var o=t.execute(i);return n&&(o=o.then(function(e){return e.data})),o}},{key:"execute",value:function(e){return new t(e).execute()}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),i=r(318);t.StorageProvider=Object.assign({},n.StorageProvider,{SQLite:"SQLite"}),Object.freeze(t.StorageProvider);var o=function(e){function r(r,n){return void 0===n&&(n=[t.StorageProvider.SQLite,t.StorageProvider.Memory]),e.call(this,r,n)||this}return __extends(r,e),r.prototype.loadAdapter=function(){var r=this;return this.storageProviders.reduce(function(n,o){return n.then(function(n){if(n)return n;switch(o){case t.StorageProvider.SQLite:return i.sqLite.load(r.name);default:return e.prototype.loadAdapter.call(r)}})},Promise.resolve())},r}(n.Storage),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.loadStorage=function(e,t){return new o(e,t)},t}(n.CacheMiddleware);t.CacheMiddleware=u},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("platform")},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=r(132),o=r(349),u=r(134),a=r(87),s=function(e){function t(r,n,i){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=u.empty;break;case 1:if(!r){this.destination=u.empty;break}if("object"==typeof r){r instanceof t?(this.syncErrorThrowable=r.syncErrorThrowable,this.destination=r,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new c(this,r));break}default:this.syncErrorThrowable=!0,this.destination=new c(this,r,n,i)}}return n(t,e),t.prototype[a.rxSubscriber]=function(){return this},t.create=function(e,r,n){var i=new t(e,r,n);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this},t}(o.Subscription);t.Subscriber=s;var c=function(e){function t(t,r,n,o){var a;e.call(this),this._parentSubscriber=t;var s=this;i.isFunction(r)?a=r:r&&(a=r.next,n=r.error,o=r.complete,r!==u.empty&&(s=Object.create(r),i.isFunction(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=a,this._error=n,this._complete=o}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}},t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(s)},function(e,t,r){"use strict";t.isFunction=function(e){return"function"==typeof e}},function(e,t,r){"use strict";t.errorObject={e:{}}},function(e,t,r){"use strict";t.empty={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(o(r(29)),o(r(362)));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var r=t.config;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=r,this._iv="0123456789012345",this._allowedKeyEncodings=["hex","utf8","base64","binary"],this._allowedKeyLengths=[128,256],this._allowedModes=["ecb","cbc"],this._defaultOptions={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}return n(e,[{key:"HMACSHA256",value:function(e){return i.default.HmacSHA256(e,this._config.secretKey).toString(i.default.enc.Base64)}},{key:"SHA256",value:function(e){return i.default.SHA256(e).toString(i.default.enc.Hex)}},{key:"_parseOptions",value:function(e){var t=e||{};return t.hasOwnProperty("encryptKey")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty("keyEncoding")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty("keyLength")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty("mode")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t}},{key:"_decodeKey",value:function(e,t){return"base64"===t.keyEncoding?i.default.enc.Base64.parse(e):"hex"===t.keyEncoding?i.default.enc.Hex.parse(e):e}},{key:"_getPaddedKey",value:function(e,t){return e=this._decodeKey(e,t),t.encryptKey?i.default.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e}},{key:"_getMode",value:function(e){return"ecb"===e.mode?i.default.mode.ECB:i.default.mode.CBC}},{key:"_getIV",value:function(e){return"cbc"===e.mode?i.default.enc.Utf8.parse(this._iv):null}},{key:"encrypt",value:function(e,t,r){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,r)}},{key:"decrypt",value:function(e,t,r){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,r)}},{key:"pnEncrypt",value:function(e,t,r){if(!t&&!this._config.cipherKey)return e;r=this._parseOptions(r);var n=this._getIV(r),o=this._getMode(r),u=this._getPaddedKey(t||this._config.cipherKey,r);return i.default.AES.encrypt(e,u,{iv:n,mode:o}).ciphertext.toString(i.default.enc.Base64)||e}},{key:"pnDecrypt",value:function(e,t,r){if(!t&&!this._config.cipherKey)return e;r=this._parseOptions(r);var n=this._getIV(r),o=this._getMode(r),u=this._getPaddedKey(t||this._config.cipherKey,r);try{var a=i.default.enc.Base64.parse(e),s=i.default.AES.decrypt({ciphertext:a},u,{iv:n,mode:o}).toString(i.default.enc.Utf8);return JSON.parse(s)}catch(e){return null}}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(r(3),r(57)),u=(n=o)&&n.__esModule?n:{default:n};var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners=[]}return i(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"removeListener",value:function(e){var t=[];this._listeners.forEach(function(r){r!==e&&t.push(r)}),this._listeners=t}},{key:"removeAllListeners",value:function(){this._listeners=[]}},{key:"announcePresence",value:function(e){this._listeners.forEach(function(t){t.presence&&t.presence(e)})}},{key:"announceStatus",value:function(e){this._listeners.forEach(function(t){t.status&&t.status(e)})}},{key:"announceMessage",value:function(e){this._listeners.forEach(function(t){t.message&&t.message(e)})}},{key:"announceNetworkUp",value:function(){var e={};e.category=u.default.PNNetworkUpCategory,this.announceStatus(e)}},{key:"announceNetworkDown",value:function(){var e={};e.category=u.default.PNNetworkDownCategory,this.announceStatus(e)}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNTimeOperation},t.getURL=function(){return"/time/0"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(){return{}},t.isAuthSupported=function(){return!1},t.handleResponse=function(e,t){return{timetoken:t[0]}},t.validateParams=function(){};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PubNubListener=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(54);t.PubNubListener=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.EventEmitter),n(t,[{key:"message",value:function(e){this.emit(e.channel,e.message)}},{key:"status",value:function(e){var r=this,n=this._getEventNamesFromStatus(e.affectedChannels,e.affectedChannelGroups);n.length?n.forEach(function(n){r.emit(""+t.statusPrefix+n,e)}):this.emit(t.unclassifiedEvents,e)}},{key:"_getEventNamesFromStatus",value:function(e,t){var r=t||[];return(e||[]).concat(r)}}],[{key:"statusPrefix",get:function(){return"status:"}},{key:"unclassifiedEvents",get:function(){return"pubNubEventsNotRouted"}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamACL=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(r(4)),o=s(r(397)),u=r(1),a=r(2);function s(e){return e&&e.__esModule?e:{default:e}}t.StreamACL=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.publishers=[],this.subscribers=[],this.publisherGroups=[],this.subscriberGroups=[],t&&(t instanceof e&&(t=t.toPlainObject()),this._parsePlainObject(t))}return n(e,[{key:"addPublishers",value:function(e){return this._addToAcl(this.publishers,e),this}},{key:"addSubscribers",value:function(e){return this._addToAcl(this.subscribers,e),this}},{key:"addPublisherGroups",value:function(e){return this._addToAcl(this.publisherGroups,e),this}},{key:"addSubscriberGroups",value:function(e){return this._addToAcl(this.subscriberGroups,e),this}},{key:"removePublishers",value:function(e){return this._removeFromAcl(this.publishers,e),this}},{key:"removeSubscribers",value:function(e){return this._removeFromAcl(this.subscribers,e),this}},{key:"removePublisherGroups",value:function(e){return this._removeFromAcl(this.publisherGroups,e),this}},{key:"removeSubscriberGroups",value:function(e){return this._removeFromAcl(this.subscriberGroups,e),this}},{key:"isNotEmpty",value:function(){return this.publishers.length||this.subscribers.length||this.publisherGroups.length||this.subscriberGroups.length}},{key:"toPlainObject",value:function(){var e={};return this.subscribers.length&&(e.subscribe=this.subscribers.slice(0)),this.publishers.length&&(e.publish=this.publishers.slice(0)),this.subscriberGroups.length&&(e.groups=e.groups||{},e.groups.subscribe=this.addSubscriberGroups.slice(0)),this.publisherGroups.length&&(e.groups=e.groups||{},e.groups.publish=this.publisherGroups.slice(0)),e}},{key:"_parsePlainObject",value:function(e){e.subscribe&&(this.subscribers=this._ensureValidIdArray(e.subscribe)),e.publish&&(this.publishers=this._ensureValidIdArray(e.publish)),e.groups&&(e.groups.publish&&(this.publisherGroups=this._ensureValidIdArray(e.groups.publish)),e.groups.subscribe&&(this.subscriberGroups=this._ensureValidIdArray(e.groups.subscribe)))}},{key:"_ensureValidIdArray",value:function(e){if(!this._isValidIdArray(e))throw new u.KinveyError("Invalid ACL object value");return e}},{key:"_isValidIdArray",value:function(e){var t=this;return(0,i.default)(e)&&(0,o.default)(e,function(e){var r=t._getAsId(e);return(0,a.isNonemptyString)(r)})}},{key:"_addToAcl",value:function(e,t){var r=this,n=(0,i.default)(t)?t:[t];if(!this._isValidIdArray(n))throw new u.KinveyError("Invalid ACL object value");n.forEach(function(t){var n=r._getAsId(t);e.push(n)})}},{key:"_removeFromAcl",value:function(e,t){var r=this;((0,i.default)(t)?t:[t]).forEach(function(t){var n=r._getAsId(t),i=e.indexOf(n);i>=0&&e.splice(i,1)})}},{key:"_getAsId",value:function(e){return e&&e._id?e._id:e}}],[{key:"isValidACLObject",value:function(t){try{return new e(t).isNotEmpty()}catch(e){return!1}}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncManager=t.SyncOperation=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=y(r(6)),o=y(r(84)),u=y(r(125)),a=y(r(4)),s=y(r(8)),c=y(r(11)),l=r(7),f=r(1),h=r(2),p=r(9),d=r(12);function y(e){return e&&e.__esModule?e:{default:e}}var v=new Map,b=t.SyncOperation={Create:l.RequestMethod.POST,Update:l.RequestMethod.PUT,Delete:l.RequestMethod.DELETE};Object.freeze(b);t.SyncManager=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new f.SyncError("A collection is required.");if(!(0,s.default)(t))throw new f.SyncError("Collection must be a string.");this.collection=t,this.tag=r.tag||void 0,this.client=r.client||p.Client.sharedInstance()}return n(e,[{key:"find",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,h.isDefined)(e)&&e instanceof d.Query==!1&&(e=new d.Query((0,u.default)(e,"toJSON",e))),new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.backendPathname}),query:e,properties:r.properties,timeout:r.timeout,client:this.client,tag:this.tag}).execute().then(function(e){return e.data}).then(function(n){var i=new d.Query;return i.equalTo("collection",t.collection),(0,h.isDefined)(e)&&i.contains("entityId",(0,o.default)(n,function(e){return e._id})),new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:i,timeout:r.timeout,client:t.client,tag:t.tag}).execute().then(function(e){return e.data})})}},{key:"count",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.find(e,t).then(function(e){return e.length})}},{key:"addCreateOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(b.Create,e,t)}},{key:"addUpdateOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(b.Update,e,t)}},{key:"addDeleteOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addOperation(b.Delete,e,t)}},{key:"addOperation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.Create,t=this,r=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=!1;return(0,a.default)(r)||(u=!0,r=[r]),i.default.all((0,o.default)(r,function(r){if(!r)return i.default.resolve(null);var o=r._id;if(!o)return i.default.reject(new f.SyncError("An entity is missing an _id. All entities must have an _id in order to be added to the sync table.",r));var u=(new d.Query).equalTo("entityId",o);return new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,query:u,timeout:n.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(r){var i=1===r.length?r[0]:{collection:t.collection,state:{},entityId:o};return i.state=i.state||{},i.state.operation=e,new l.CacheRequest({method:l.RequestMethod.PUT,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:n.properties,body:i,timeout:n.timeout,tag:t.tag}).execute()})})).then(function(){return!0===u?r[0]:r})}},{key:"pull",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e||e instanceof d.Query?this.count(e).then(function(r){return r>0?t.push(e).then(function(){return t.count(e)}):r}).then(function(n){if(n>0)throw new f.SyncError("Unable to pull data from the network. There are "+n+" entities that need to be synced before data is loaded from the network.");var i={method:l.RequestMethod.GET,authType:l.AuthType.Default,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname}),properties:r.properties,query:e,timeout:r.timeout,client:t.client,tag:t.tag},o=new l.KinveyRequest(i);return!0===r.useDeltaFetch&&(o=new l.DeltaFetchRequest(i)),o.execute()}).then(function(e){return e.data}):i.default.reject(new f.SyncError("Invalid query. It must be an instance of the Query class."))}},{key:"push",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0;return!0===v.get(this.collection)?i.default.reject(new f.SyncError("Data is already being pushed to the backend. Please wait for it to complete before pushing new data to the backend.")):(v.set(this.collection,!0),this.find(e).then(function(e){if(e.length>0){return function u(a){return new i.default(function(s){var p=e.slice(n,n+100);return n+=100,i.default.all((0,o.default)(p,function(e){var n=e.entityId,i=e.state,o=void 0===i?{}:i,u=o.operation||o.method;if(u===b.Delete)return new l.KinveyRequest({method:l.RequestMethod.DELETE,authType:l.AuthType.Default,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+n}),properties:r.properties,timeout:r.timeout,client:t.client,tag:t.tag}).execute().then(function(){return new l.CacheRequest({method:l.RequestMethod.DELETE,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,timeout:r.timeout,tag:t.tag}).execute()}).then(function(){return{_id:n,operation:u}}).catch(function(e){return{_id:n,operation:u,error:e}});if(u===b.Create||u===b.Update){var a=!1;return new l.CacheRequest({method:l.RequestMethod.GET,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+n}),properties:r.properties,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(i){var o=new l.KinveyRequest({method:l.RequestMethod.PUT,authType:l.AuthType.Default,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+n}),properties:r.properties,timeout:r.timeout,body:i,client:t.client});return u===b.Create&&((0,h.isDefined)(i._kmd)&&!0===i._kmd.local&&(a=!0,delete i._id),o.method=l.RequestMethod.POST,o.url=c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname})),o.execute().then(function(e){return e.data}).then(function(i){return new l.CacheRequest({method:l.RequestMethod.DELETE,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,timeout:r.timeout,tag:t.tag}).execute().then(function(){return new l.CacheRequest({method:l.RequestMethod.PUT,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+i._id}),properties:r.properties,timeout:r.timeout,body:i,tag:t.tag}).execute().then(function(e){return e.data})}).then(function(e){return a?new l.CacheRequest({method:l.RequestMethod.DELETE,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.backendPathname+"/"+n}),properties:r.properties,timeout:r.timeout,tag:t.tag}).execute().then(function(){return e}):e}).then(function(e){return{_id:n,operation:u,entity:e}})}).catch(function(e){return i._id=n,{_id:n,operation:u,entity:i,error:e}})}).catch(function(e){return{_id:n,operation:u,entity:void 0,error:e}})}return{_id:n,operation:u,entity:void 0,error:new f.SyncError("Unable to sync the entity since the operation was not recognized.",e)}})).then(function(t){return a=a.concat(t),n<e.length?s(u(a)):s(a)})})}([])}return[]}).then(function(e){return v.set(t.collection,!1),e}).catch(function(e){throw v.set(t.collection,!1),e}))}},{key:"clear",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.find(e,r).then(function(e){return i.default.all((0,o.default)(e,function(e){return new l.CacheRequest({method:l.RequestMethod.DELETE,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e._id}),properties:r.properties,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data})}))})}},{key:"pathname",get:function(){return"/appdata/"+this.client.appKey+"/kinvey_sync"}},{key:"backendPathname",get:function(){return"/appdata/"+this.client.appKey+"/"+this.collection}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncStore=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(11),u=(n=o)&&n.__esModule?n:{default:n},a=r(7),s=r(1),c=r(12),l=r(27),f=r(2),h=r(36),p=r(83);t.SyncStore=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.CacheStore),i(t,[{key:"find",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){return!e||e instanceof c.Query?new a.CacheRequest({method:a.RequestMethod.GET,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:e,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)}):n.error(new s.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"findById",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){try{return!1===(0,f.isDefined)(e)?(n.next(void 0),n.complete()):new a.CacheRequest({method:a.RequestMethod.GET,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e}),properties:r.properties,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}catch(e){return n.error(e)}})}},{key:"group",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){return e instanceof l.Aggregation?new a.CacheRequest({method:a.RequestMethod.POST,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_group"}),properties:r.properties,aggregation:e,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)}):n.error(new s.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))})}},{key:"count",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h.KinveyObservable.create(function(n){try{if(e&&!(e instanceof c.Query))throw new s.KinveyError("Invalid query. It must be an instance of the Query class.");return new a.CacheRequest({method:a.RequestMethod.GET,url:u.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname}),properties:r.properties,query:e,timeout:r.timeout,tag:t.tag}).execute().then(function(e){return e.data}).then(function(e){return n.next(e?e.length:0)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}catch(e){return n.error(e)}})}},{key:"syncAutomatically",get:function(){return!1}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Acl=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=c(r(32)),o=c(r(4)),u=c(r(17)),a=r(1),s=r(2);function c(e){return e&&e.__esModule?e:{default:e}}t.Acl=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!1===(0,i.default)(t))throw new a.KinveyError("entity argument must be an object");t._acl=t._acl||{},this.entity=t}return n(e,[{key:"addReader",value:function(e){var t=this.readers;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.r=t,this}},{key:"addReaderGroup",value:function(e){var t=this.readerGroups;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.groups=(0,u.default)({},this.entity._acl.groups,{r:t}),this}},{key:"addWriter",value:function(e){var t=this.writers;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.w=t,this}},{key:"addWriterGroup",value:function(e){var t=this.writerGroups;return-1===t.indexOf(e)&&t.push(e),this.entity._acl.groups=(0,u.default)({},this.entity._acl.groups,{w:t}),this}},{key:"isGloballyReadable",value:function(){return!0===this.entity._acl.gr&&this.entity._acl.gr}},{key:"isGloballyWritable",value:function(){return!0===this.entity._acl.gw&&this.entity._acl.gw}},{key:"removeReader",value:function(e){var t=this.readers,r=t.indexOf(e);return-1!==r&&t.splice(r,1),this.entity._acl.r=t,this}},{key:"removeReaderGroup",value:function(e){var t=this.readerGroups,r=t.indexOf(e);return-1!==r&&t.splice(r,1),this.entity._acl.groups=(0,u.default)({},this.entity._acl.groups,{r:t}),this}},{key:"removeWriter",value:function(e){var t=this.writers,r=t.indexOf(e);return-1!==r&&t.splice(r,1),this.entity._acl.w=t,this}},{key:"removeWriterGroup",value:function(e){var t=this.writerGroups,r=t.indexOf(e);return-1!==r&&t.splice(r,1),this.entity._acl.groups=(0,u.default)({},this.entity._acl.groups,{w:t}),this}},{key:"toPlainObject",value:function(){return this.entity._acl}},{key:"creator",get:function(){return this.entity._acl.creator}},{key:"readers",get:function(){return(0,o.default)(this.entity._acl.r)?this.entity._acl.r:[]}},{key:"writers",get:function(){return(0,o.default)(this.entity._acl.w)?this.entity._acl.w:[]}},{key:"readerGroups",get:function(){return(0,s.isDefined)(this.entity._acl.groups)&&(0,o.default)(this.entity._acl.groups.r)?this.entity._acl.groups.r:[]}},{key:"writerGroups",get:function(){return(0,s.isDefined)(this.entity._acl.groups)&&(0,o.default)(this.entity._acl.groups.w)?this.entity._acl.groups.w:[]}},{key:"globallyReadable",set:function(e){this.entity._acl.gr=!0===e&&e}},{key:"globallyWritable",set:function(e){this.entity._acl.gw=!0===e&&e}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(91));var n=r(91);t.Kinvey=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileIdentityConnect=t.AuthorizationGrant=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=d(r(6)),o=d(r(8)),u=d(r(11)),a=d(r(154)),s=r(7),c=r(1),l=r(2),f=r(316),h=r(317),p=r(92);function d(e){return e&&e.__esModule?e:{default:e}}var y=f.Popup,v=t.AuthorizationGrant={AuthorizationCodeLoginPage:"AuthorizationCodeLoginPage",AuthorizationCodeAPI:"AuthorizationCodeAPI"};Object.freeze(v);t.MobileIdentityConnect=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,h.Identity),n(t,[{key:"isSupported",value:function(){return!0}},{key:"login",value:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.AuthorizationCodeLoginPage,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this.client.appKey;return(0,o.default)(u.micId)&&(a=a+"."+u.micId),i.default.resolve().then(function(){if(n===v.AuthorizationCodeLoginPage)return r.requestCodeWithPopup(a,e,u);if(n===v.AuthorizationCodeAPI)return r.requestTempLoginUrl(a,e,u).then(function(t){return r.requestCodeWithUrl(t,a,e,u)});throw new c.KinveyError("The authorization grant "+n+" is unsupported. Please use a supported authorization grant.")}).then(function(t){return r.requestToken(t,a,e,u)}).then(function(n){return n.identity=t.identity,n.client_id=a,n.redirect_uri=e,n.protocol=r.client.micProtocol,n.host=r.client.micHost,n})}},{key:"refresh",value:function(e,r,n){var o=this,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i.default.resolve().then(function(){return o.refreshToken(e,r,n,u)}).then(function(e){return e.identity=t.identity,e.client_id=r,e.redirect_uri=n,e.protocol=o.client.micProtocol,e.host=o.client.micHost,e})}},{key:"requestTempLoginUrl",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n="/oauth/auth";if(r.version){var i=r.version;!1===(0,o.default)(i)&&(i=String(i)),n=(0,a.default)(0===i.indexOf("v")?i:"v"+i,n)}return new s.KinveyRequest({method:s.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:u.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:n}),properties:r.properties,body:{client_id:e,redirect_uri:t,response_type:"code"}}).execute().then(function(e){return e.data.temp_login_uri})}},{key:"requestCodeWithPopup",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i.default.resolve().then(function(){var i="/oauth/auth",s=new y;if(n.version){var c=n.version;(0,o.default)(c)||(c=String(c)),i=(0,a.default)(0===c.indexOf("v")?c:"v"+c,i)}return s.open(u.default.format({protocol:r.client.micProtocol,host:r.client.micHost,pathname:i,query:{client_id:e,redirect_uri:t,response_type:"code"}}))}).then(function(e){return new i.default(function(r,n){var i=!1;function o(n){try{n.url&&0===n.url.indexOf(t)&&!1===i&&(i=!0,e.removeAllListeners(),e.close(),r(u.default.parse(n.url,!0).query.code))}catch(e){}}e.on("loadstart",o),e.on("loadstop",o),e.on("error",function(o){try{o.url&&0===o.url.indexOf(t)&&!1===i?(i=!0,e.removeAllListeners(),e.close(),r(u.default.parse(o.url,!0).query.code)):!1===i&&(e.removeAllListeners(),e.close(),n(new c.KinveyError(o.message,"",o.code)))}catch(e){}}),e.on("exit",function(){!1===i&&(e.removeAllListeners(),n(new c.KinveyError("Login has been cancelled.")))})})})}},{key:"requestCodeWithUrl",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i.default.resolve().then(function(){return new s.KinveyRequest({method:s.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:e,properties:n.properties,body:{client_id:t,redirect_uri:r,response_type:"code",username:n.username,password:n.password},followRedirect:!1}).execute()}).then(function(e){var t=e.headers.get("location");if(t)return u.default.parse(t,!0).query.code;throw new c.MobileIdentityConnectError("Unable to authorize user with username "+n.username+".","A location header was not provided with a code to exchange for an auth token.")})}},{key:"requestToken",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new s.KinveyRequest({method:s.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:s.AuthType.App,url:u.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),properties:n.properties,body:{grant_type:"authorization_code",client_id:t,redirect_uri:r,code:e}}).execute().then(function(e){return e.data})}},{key:"refreshToken",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new s.KinveyRequest({method:s.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:s.AuthType.App,url:u.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:t,redirect_uri:r,refresh_token:e},properties:n.properties,timeout:n.timeout}).execute().then(function(e){return e.data})}},{key:"logout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new s.KinveyRequest({method:s.RequestMethod.GET,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:s.AuthType.App,url:u.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/invalidate",query:{user:e._id}}),properties:t.properties}).execute().then(function(e){return e.data})}},{key:"identity",get:function(){return p.SocialIdentity.MobileIdentityConnect}}],[{key:"isSupported",value:function(){return!0}},{key:"usePopupClass",value:function(e){(0,l.isDefined)(e)&&(y=e)}},{key:"identity",get:function(){return p.SocialIdentity.MobileIdentityConnect}}]),t}()},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:u}catch(e){n=u}}();var s,c=[],l=!1,f=-1;function h(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&p())}function p(){if(!l){var e=a(h);l=!0;for(var t=c.length;t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===u||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||l||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){},function(e,t,r){var n=r(26),i=Object.prototype,o=i.hasOwnProperty,u=i.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var i=u.call(e);return n&&(t?e[a]=r:delete e[a]),i}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},function(e,t,r){(function(e,n){var i;!function(o){"object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType;var u="object"==typeof n&&n;u.global!==u&&u.window!==u&&u.self;var a,s=2147483647,c=36,l=1,f=26,h=38,p=700,d=72,y=128,v="-",b=/^xn--/,g=/[^\x20-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=c-l,O=Math.floor,E=String.fromCharCode;function k(e){throw new RangeError(_[e])}function P(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function j(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+P((e=e.replace(m,".")).split("."),t).join(".")}function S(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function A(e){return P(e,function(e){var t="";return e>65535&&(t+=E((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=E(e)}).join("")}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function x(e,t,r){var n=0;for(e=r?O(e/p):e>>1,e+=O(e/t);e>w*f>>1;n+=c)e=O(e/w);return O(n+(w+1)*e/(e+h))}function C(e){var t,r,n,i,o,u,a,h,p,b,g,m=[],_=e.length,w=0,E=y,P=d;for((r=e.lastIndexOf(v))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&k("not-basic"),m.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<_;){for(o=w,u=1,a=c;i>=_&&k("invalid-input"),((h=(g=e.charCodeAt(i++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:c)>=c||h>O((s-w)/u))&&k("overflow"),w+=h*u,!(h<(p=a<=P?l:a>=P+f?f:a-P));a+=c)u>O(s/(b=c-p))&&k("overflow"),u*=b;P=x(w-o,t=m.length+1,0==o),O(w/t)>s-E&&k("overflow"),E+=O(w/t),w%=t,m.splice(w++,0,E)}return A(m)}function M(e){var t,r,n,i,o,u,a,h,p,b,g,m,_,w,P,j=[];for(m=(e=S(e)).length,t=y,r=0,o=d,u=0;u<m;++u)(g=e[u])<128&&j.push(E(g));for(n=i=j.length,i&&j.push(v);n<m;){for(a=s,u=0;u<m;++u)(g=e[u])>=t&&g<a&&(a=g);for(a-t>O((s-r)/(_=n+1))&&k("overflow"),r+=(a-t)*_,t=a,u=0;u<m;++u)if((g=e[u])<t&&++r>s&&k("overflow"),g==t){for(h=r,p=c;!(h<(b=p<=o?l:p>=o+f?f:p-o));p+=c)P=h-b,w=c-b,j.push(E(T(b+P%w,0))),h=O(P/w);j.push(E(T(h,0))),o=x(r,_,n==i),r=0,++n}++r,++t}return j.join("")}a={version:"1.4.1",ucs2:{decode:S,encode:A},decode:C,encode:M,toASCII:function(e){return j(e,function(e){return g.test(e)?"xn--"+M(e):e})},toUnicode:function(e){return j(e,function(e){return b.test(e)?C(e.slice(4).toLowerCase()):e})}},void 0===(i=function(){return a}.call(t,r,t,e))||(e.exports=i)}()}).call(t,r(37)(e),r(23))},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(152),t.encode=t.stringify=r(153)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var u={};if("string"!=typeof e||0===e.length)return u;var a=/\+/g;e=e.split(t);var s=1e3;o&&"number"==typeof o.maxKeys&&(s=o.maxKeys);var c=e.length;s>0&&c>s&&(c=s);for(var l=0;l<c;++l){var f,h,p,d,y=e[l].replace(a,"%20"),v=y.indexOf(r);v>=0?(f=y.substr(0,v),h=y.substr(v+1)):(f=y,h=""),p=decodeURIComponent(f),d=decodeURIComponent(h),n(u,p)?i(u[p])?u[p].push(d):u[p]=[u[p],d]:u[p]=d}return u};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?o(u(e),function(u){var a=encodeURIComponent(n(u))+r;return i(e[u])?o(e[u],function(e){return a+encodeURIComponent(n(e))}).join(t):a+encodeURIComponent(n(e[u]))}).join(t):a?encodeURIComponent(n(a))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var u=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){var n,i,o;o=function(){return function(){var e=arguments;"object"==typeof arguments[0]&&(e=arguments[0],arguments[1]);var t,r=[].slice.call(e,0).join("/");return t=(t=(t=function(e,t){return e.substr(0,t.length)===t}(t=r,"file://")?t.replace(/(\/{0,3})\/*/g,"$1"):(t=t.replace(/:\//g,"://")).replace(/([^:\s\%\3\A])\/+/g,"$1/")).replace(/\/(\?|&|#[^!])/g,"$1")).replace(/(\?.+)\?/g,"$1&")}},void 0!==e&&e.exports?e.exports=o():void 0===(i="function"==typeof(n=o)?n.call(t,r,t,e):n)||(e.exports=i)},function(e,t,r){var n=r(59),i=r(97),o=r(62),u=r(182),a=r(189),s=r(192),c=r(193),l=r(194),f=r(196),h=r(105),p=r(197),d=r(69),y=r(202),v=r(203),b=r(212),g=r(4),m=r(43),_=r(14),w=r(20),O=1,E=2,k=4,P="[object Arguments]",j="[object Function]",S="[object GeneratorFunction]",A="[object Object]",T={};T[P]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object DataView]"]=T["[object Boolean]"]=T["[object Date]"]=T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Map]"]=T["[object Number]"]=T[A]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object Symbol]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Error]"]=T[j]=T["[object WeakMap]"]=!1,e.exports=function e(t,r,x,C,M,R){var I,q=r&O,U=r&E,D=r&k;if(x&&(I=M?x(t,C,M,R):x(t)),void 0!==I)return I;if(!_(t))return t;var K=g(t);if(K){if(I=y(t),!q)return c(t,I)}else{var N=d(t),L=N==j||N==S;if(m(t))return s(t,q);if(N==A||N==P||L&&!M){if(I=U||L?{}:b(t),!q)return U?f(t,a(I,t)):l(t,u(I,t))}else{if(!T[N])return M?t:{};I=v(t,N,e,q)}}R||(R=new n);var B=R.get(t);if(B)return B;R.set(t,I);var F=D?U?p:h:U?keysIn:w,H=K?void 0:F(t);return i(H||t,function(n,i){H&&(n=t[i=n]),o(I,i,e(n,r,x,i,t,R))}),I}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,r){var n=r(39),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0||(r==t.length-1?t.pop():i.call(t,r,1),--this.size,0))}},function(e,t,r){var n=r(39);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},function(e,t,r){var n=r(39);e.exports=function(e){return n(this.__data__,e)>-1}},function(e,t,r){var n=r(39);e.exports=function(e,t){var r=this.__data__,i=n(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}},function(e,t,r){var n=r(38);e.exports=function(){this.__data__=new n,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,r){var n=r(38),i=r(60),o=r(61),u=200;e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!i||a.length<u-1)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new o(a)}return r.set(e,t),this.size=r.size,this}},function(e,t,r){var n=r(19),i=r(167),o=r(14),u=r(96),a=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,l=s.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(n(e)?h:a).test(u(e))}},function(e,t,r){var n,i=r(168),o=(n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!o&&o in e}},function(e,t,r){var n=r(13)["__core-js_shared__"];e.exports=n},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,r){var n=r(171),i=r(38),o=r(60);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||i),string:new n}}},function(e,t,r){var n=r(172),i=r(173),o=r(174),u=r(175),a=r(176);function s(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=u,s.prototype.set=a,e.exports=s},function(e,t,r){var n=r(40);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,r){var n=r(40),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return r===i?void 0:r}return o.call(t,e)?t[e]:void 0}},function(e,t,r){var n=r(40),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:i.call(t,e)}},function(e,t,r){var n=r(40),i="__lodash_hash_undefined__";e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?i:t,this}},function(e,t,r){var n=r(41);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,r){var n=r(41);e.exports=function(e){return n(this,e).get(e)}},function(e,t,r){var n=r(41);e.exports=function(e){return n(this,e).has(e)}},function(e,t,r){var n=r(41);e.exports=function(e,t){var r=n(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}},function(e,t,r){var n=r(25),i=r(20);e.exports=function(e,t){return e&&n(t,i(t),e)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},function(e,t,r){var n=r(18),i=r(15),o="[object Arguments]";e.exports=function(e){return i(e)&&n(e)==o}},function(e,t){e.exports=function(){return!1}},function(e,t,r){var n=r(18),i=r(65),o=r(15),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!u[n(e)]}},function(e,t,r){(function(e){var n=r(93),i="object"==typeof t&&t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,u=o&&o.exports===i&&n.process,a=function(){try{return u&&u.binding&&u.binding("util")}catch(e){}}();e.exports=a}).call(t,r(37)(e))},function(e,t,r){var n=r(102)(Object.keys,Object);e.exports=n},function(e,t,r){var n=r(25),i=r(45);e.exports=function(e,t){return e&&n(t,i(t),e)}},function(e,t,r){var n=r(14),i=r(31),o=r(191),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=i(e),r=[];for(var a in e)("constructor"!=a||!t&&u.call(e,a))&&r.push(a);return r}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},function(e,t,r){(function(e){var n=r(13),i="object"==typeof t&&t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,u=o&&o.exports===i?n.Buffer:void 0,a=u?u.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}}).call(t,r(37)(e))},function(e,t){e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},function(e,t,r){var n=r(25),i=r(66);e.exports=function(e,t){return n(e,i(e),t)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var u=e[r];t(u,r,e)&&(o[i++]=u)}return o}},function(e,t,r){var n=r(25),i=r(104);e.exports=function(e,t){return n(e,i(e),t)}},function(e,t,r){var n=r(106),i=r(104),o=r(45);e.exports=function(e){return n(e,o,i)}},function(e,t,r){var n=r(24)(r(13),"DataView");e.exports=n},function(e,t,r){var n=r(24)(r(13),"Promise");e.exports=n},function(e,t,r){var n=r(24)(r(13),"Set");e.exports=n},function(e,t,r){var n=r(24)(r(13),"WeakMap");e.exports=n},function(e,t){var r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},function(e,t,r){var n=r(70),i=r(204),o=r(205),u=r(207),a=r(208),s=r(210),c=r(211),l="[object Boolean]",f="[object Date]",h="[object Map]",p="[object Number]",d="[object RegExp]",y="[object Set]",v="[object String]",b="[object Symbol]",g="[object ArrayBuffer]",m="[object DataView]",_="[object Float32Array]",w="[object Float64Array]",O="[object Int8Array]",E="[object Int16Array]",k="[object Int32Array]",P="[object Uint8Array]",j="[object Uint8ClampedArray]",S="[object Uint16Array]",A="[object Uint32Array]";e.exports=function(e,t,r,T){var x=e.constructor;switch(t){case g:return n(e);case l:case f:return new x(+e);case m:return i(e,T);case _:case w:case O:case E:case k:case P:case j:case S:case A:return c(e,T);case h:return o(e,T,r);case p:case v:return new x(e);case d:return u(e);case y:return a(e,T,r);case b:return s(e)}}},function(e,t,r){var n=r(70);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},function(e,t,r){var n=r(206),i=r(71),o=r(108),u=1;e.exports=function(e,t,r){var a=t?r(o(e),u):o(e);return i(a,n,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.set(t[0],t[1]),e}},function(e,t){var r=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,r){var n=r(209),i=r(71),o=r(109),u=1;e.exports=function(e,t,r){var a=t?r(o(e),u):o(e);return i(a,n,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.add(t),e}},function(e,t,r){var n=r(26),i=n?n.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},function(e,t,r){var n=r(70);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},function(e,t,r){var n=r(213),i=r(68),o=r(31);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:n(i(e))}},function(e,t,r){var n=r(14),i=Object.create,o=function(){function e(){}return function(t){if(!n(t))return{};if(i)return i(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActiveUserError=i;var n=r(0);function i(e,t,r,n){this.name="ActiveUserError",this.message=e||"An active user already exists.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APIVersionNotAvailableError=i;var n=r(0);function i(e,t,r,n){this.name="APIVersionNotAvailableError",this.message=e||"This API version is not available for your app.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APIVersionNotImplementedError=i;var n=r(0);function i(e,t,r,n){this.name="APIVersionNotImplementedError",this.message=e||"This API version is not implemented.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppProblemError=i;var n=r(0);function i(e,t,r,n){this.name="AppProblemError",this.message=e||"There is a problem with this app backend that prevents execution of this operation. Please contact support@kinvey.com for assistance.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BadRequestError=i;var n=r(0);function i(e,t,r,n){this.name="BadRequestError",this.message=e||"Unable to understand request.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLError=i;var n=r(0);function i(e,t,r,n){this.name="BLError",this.message=e||"The Business Logic script did not complete.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CORSDisabledError=i;var n=r(0);function i(e,t,r,n){this.name="CORSDisabledError",this.message=e||"Cross Origin Support is disabled for this application.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DuplicateEndUsersError=i;var n=r(0);function i(e,t,r,n){this.name="DuplicateEndUsersError",this.message=e||"More than one user registered with this username for this application.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureUnavailableError=i;var n=r(0);function i(e,t,r,n){this.name="FeatureUnavailableError",this.message=e||"Requested functionality is unavailable in this API version.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IncompleteRequestBodyError=i;var n=r(0);function i(e,t,r,n){this.name="IncompleteRequestBodyError",this.message=e||"The request body is either missing or incomplete.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndirectCollectionAccessDisallowedError=i;var n=r(0);function i(e,t,r,n){this.name="IndirectCollectionAccessDisallowedError",this.message=e||"Please use the appropriate API to access this collection for this app backend.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InsufficientCredentialsError=i;var n=r(0);function i(e,t,r,n){this.name="InsufficientCredentialsError",this.message=e||"The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidCredentialsError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidCredentialsError",this.message=e||"Invalid credentials. Please retry your request with correct credentials.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidIdentifierError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidIdentifierError",this.message=e||"One of more identifier names in the request has an invalid format.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidQuerySyntaxError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidQuerySyntaxError",this.message=e||"The query string in the request has an invalid syntax.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONParseError=i;var n=r(0);function i(e,t,r,n){this.name="JSONParseError",this.message=e||"Unable to parse the JSON in the request.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyInternalErrorRetry=i;var n=r(0);function i(e,t,r,n){this.name="KinveyInternalErrorRetry",this.message=e||"The Kinvey server encountered an unexpected error. Please retry your request.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyInternalErrorStop=i;var n=r(0);function i(e,t,r,n){this.name="KinveyInternalErrorStop",this.message=e||"The Kinvey server encountered an unexpected error. Please contact support@kinvey.com for assistance.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KinveyError=i;var n=r(0);function i(e,t,r,n){this.name="KinveyError",this.message=e||"An error occurred.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingQueryError=i;var n=r(0);function i(e,t,r,n){this.name="MissingQueryError",this.message=e||"The request is missing a query string.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRequestHeaderError=i;var n=r(0);function i(e,t,r,n){this.name="MissingRequestHeaderError",this.message=e||"The request is missing a required header.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRequestParameterError=i;var n=r(0);function i(e,t,r,n){this.name="MissingRequestParameterError",this.message=e||"A required parameter is missing from the request.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileIdentityConnectError=i;var n=r(0);function i(e,t,r,n){this.name="MobileIdentityConnectError",this.message=e||"An error has occurred with Mobile Identity Connect.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkConnectionError=i;var n=r(0);function i(e,t,r,n){this.name="NetworkConnectionError",this.message=e||"There was an error connecting to the network.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoActiveUserError=i;var n=r(0);function i(e,t,r,n){this.name="NoActiveUserError",this.message=e||"There is not an active user.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoResponseError=i;var n=r(0);function i(e,t,r,n){this.name="NoResponseError",this.message=e||"No response was provided.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=i;var n=r(0);function i(e,t,r,n){this.name="NotFoundError",this.message=e||"The entity was not found.",this.debug=t||void 0,this.code=r||404,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParameterValueOutOfRangeError=i;var n=r(0);function i(e,t,r,n){this.name="ParameterValueOutOfRangeError",this.message=e||"The value specified for one of the request parameters is out of range.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupError=i;var n=r(0);function i(e,t,r,n){this.name="PopupError",this.message=e||"Unable to open a popup on this platform.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryError=i;var n=r(0);function i(e,t,r,n){this.name="QueryError",this.message=e||"An error occurred with the query.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerError=i;var n=r(0);function i(e,t,r,n){this.name="ServerError",this.message=e||"An error occurred on the server.",this.debug=t||void 0,this.code=r||500,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StaleRequestError=i;var n=r(0);function i(e,t,r,n){this.name="StaleRequestError",this.message=e||"The time window for this request has expired.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncError=i;var n=r(0);function i(e,t,r,n){this.name="SyncError",this.message=e||"An error occurred during sync.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeoutError=i;var n=r(0);function i(e,t,r,n){this.name="TimeoutError",this.message=e||"The request timed out.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserAlreadyExistsError=i;var n=r(0);function i(e,t,r,n){this.name="UserAlreadyExistsError",this.message=e||"This username is already taken. Please retry your request with a different username.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WritesToCollectionDisallowedError=i;var n=r(0);function i(e,t,r,n){this.name="WritesToCollectionDisallowedError",this.message=e||"This collection is configured to disallow any modifications to an existing entity or creation of new entities.",this.debug=t||void 0,this.code=r||void 0,this.kinveyRequestId=n||void 0,this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype),i.prototype.constructor=i},function(e,t){!function(){"use strict";function r(e){return"function"==typeof e}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return e instanceof Date?e.getTime():n(e)?e.map(i):e&&"function"==typeof e.toJSON?e.toJSON():e}function o(e,t){return r(e.get)?e.get(t):e[t]}function u(e){return function(t,r){if(!n(r)||!r.length)return e(t,r);for(var i=0,u=r.length;i<u;i++)if(e(t,o(r,i)))return!0;return!1}}function a(e,t,r,n){return e.v(e.a,t,r,n)}var s,c={$eq:u(function(e,t){return e(t)}),$ne:(s=function(e,t){return!e(t)},function(e,t){if(!n(t)||!t.length)return s(e,t);for(var r=0,i=t.length;r<i;r++)if(!s(e,o(t,r)))return!1;return!0}),$gt:u(function(e,t){return b.compare(i(t),e)>0}),$gte:u(function(e,t){return b.compare(i(t),e)>=0}),$lt:u(function(e,t){return b.compare(i(t),e)<0}),$lte:u(function(e,t){return b.compare(i(t),e)<=0}),$mod:u(function(e,t){return t%e[0]==e[1]}),$in:function(e,t){if(!(t instanceof Array)){var r=i(t);if(r===t&&"object"==typeof t)for(u=e.length;u--;)if(String(e[u])===String(t)&&"[object Object]"!==String(t))return!0;if(void 0===r)for(u=e.length;u--;)if(null==e[u])return!0;for(u=e.length;u--;){var n=a(v(o(e,u),void 0),t,u,e);if(n&&"[object Object]"!==String(n)&&"[object Object]"!==String(t))return!0}return!!~e.indexOf(r)}for(var u=t.length;u--;)if(~e.indexOf(i(o(t,u))))return!0;return!1},$nin:function(e,t,r,n){return!c.$in(e,t,r,n)},$not:function(e,t,r,n){return!a(e,t,r,n)},$type:function(e,t){return void 0!=t&&(t instanceof e||t.constructor==e)},$all:function(e,t,r,n){return c.$and(e,t,r,n)},$size:function(e,t){return!!t&&e===t.length},$or:function(e,t,r,n){for(var i=0,u=e.length;i<u;i++)if(a(o(e,i),t,r,n))return!0;return!1},$nor:function(e,t,r,n){return!c.$or(e,t,r,n)},$and:function(e,t,r,n){for(var i=0,u=e.length;i<u;i++)if(!a(o(e,i),t,r,n))return!1;return!0},$regex:u(function(e,t){return"string"==typeof t&&e.test(t)}),$where:function(e,t,r,n){return e.call(t,t,r,n)},$elemMatch:function(e,t,r,i){return n(t)?!!~f(t,e):a(e,t,r,i)},$exists:function(e,t,r,n){return n.hasOwnProperty(r)===e}},l={$eq:function(e){return e instanceof RegExp?function(t){return"string"==typeof t&&e.test(t)}:e instanceof Function?e:n(e)&&!e.length?function(e){return n(e)&&!e.length}:null===e?function(e){return null==e}:function(t){return 0===b.compare(i(t),e)}},$ne:function(e){return l.$eq(e)},$and:function(e){return e.map(y)},$all:function(e){return l.$and(e)},$or:function(e){return e.map(y)},$nor:function(e){return e.map(y)},$not:function(e){return y(e)},$regex:function(e,t){return new RegExp(e,t.$options)},$where:function(e){return"string"==typeof e?new Function("obj","return "+e):e},$elemMatch:function(e){return y(e)},$exists:function(e){return!!e}};function f(e,t){for(var r=0;r<e.length;r++){o(e,r);if(a(t,o(e,r)))return r}return-1}function h(e,t){return{a:e,v:t}}function p(e,t){var r=[];if(function e(t,r,i,u,a){if(i===r.length||void 0==t)return void a.push([t,r[i-1],u]);var s=o(r,i);if(n(t)&&isNaN(Number(s)))for(var c=0,l=t.length;c<l;c++)e(o(t,c),r,i,t,a);else e(o(t,s),r,i+1,t,a)}(t,e.k,0,t,r),1===r.length){var i=r[0];return a(e.nv,i[0],i[1],i[2])}for(var u=0;u<r.length;u++){var s=r[u];if(a(e.nv,s[0],s[1],s[2]))return!0}return!1}function d(e,t){return{a:{k:e,nv:t},v:p}}function y(e){var t;(e=i(e))&&((t=e)&&t.constructor===Object)||(e={$eq:e});var r=[];for(var n in e){var o=e[n];if("$options"!==n)if(c[n])l[n]&&(o=l[n](o,e)),r.push(h(i(o),c[n]));else{if(36===n.charCodeAt(0))throw new Error("Unknown operation "+n);r.push(d(n.split("."),y(o)))}}return 1===r.length?r[0]:h(r,c.$and)}function v(e,t){var r=y(e);return t&&(r={a:r,v:function(e,r,n,i){return a(e,t(r),n,i)}}),r}function b(e,t,n){r(t)&&(n=t,t=void 0);var i=v(e,n);function o(e,t,r){return a(i,e,t,r)}return t?t.filter(o):o}b.use=function(e){if(r(e))return e(b);for(var t in e)36===t.charCodeAt(0)&&(c[t]=e[t])},b.indexOf=function(e,t,r){return f(t,v(e,r))},b.compare=function(e,t){if(e===t)return 0;if(typeof e==typeof t){if(e>t)return 1;if(e<t)return-1}},void 0!==e&&void 0!==e.exports&&(Object.defineProperty(t,"__esModule",{value:!0}),e.exports=b,t.default=e.exports.default=b),"undefined"!=typeof window&&(window.sift=b)}()},function(e,t){e.exports=function(e){return null===e}},function(e,t){e.exports=function(e){return void 0===e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return""+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")+function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n+=1)t+=r.charAt(Math.floor(Math.random()*r.length));return t}(e)},t.isNonemptyString=function(e){return"string"==typeof e&&""!==e},t.uuidv4=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return""+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appendQuery=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},f=n.default.parse(e,!0),h=(0,s.default)(t)?i.default.parse(t):t,p=(0,o.default)({},f.query,h);r=(0,o.default)({encodeComponents:!0,removeNull:!1},r),f.query=null;var d=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n=arguments[2];var i=[];var o=!1;(0,u.default)(t)&&(0,l.isDefined)(n)&&(o=!0);Object.keys(t).forEach(function(u){var s=void 0,c=t[u],f=n?n+"["+(o?"":u)+"]":u;if(!1===(0,l.isDefined)(c)){if(!0===r.removeNull)return;s=!0===r.encodeComponents?encodeURIComponent(f):f}else s=(0,a.default)(c)?e(c,r,f):r.encodeComponents?encodeURIComponent(f)+"="+encodeURIComponent(c):f+"="+c;i.push(s)});return i.join("&")}(p,r);return f.search=(0,l.isDefined)(d)&&!1===(0,c.default)(d)?"?"+d:null,n.default.format(f)};var n=f(r(11)),i=f(r(72)),o=f(r(17)),u=f(r(4)),a=f(r(32)),s=f(r(8)),c=f(r(47)),l=r(110);function f(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";var n=r(111),i=r(112),o={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Date.prototype.toISOString,a={delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},s=function e(t,r,i,o,u,s,c,l,f,h,p,d){var y=t;if("function"==typeof c)y=c(r,y);else if(y instanceof Date)y=h(y);else if(null===y){if(o)return s&&!d?s(r,a.encoder):r;y=""}if("string"==typeof y||"number"==typeof y||"boolean"==typeof y||n.isBuffer(y))return s?[p(d?r:s(r,a.encoder))+"="+p(s(y,a.encoder))]:[p(r)+"="+p(String(y))];var v,b=[];if(void 0===y)return b;if(Array.isArray(c))v=c;else{var g=Object.keys(y);v=l?g.sort(l):g}for(var m=0;m<v.length;++m){var _=v[m];u&&null===y[_]||(b=Array.isArray(y)?b.concat(e(y[_],i(r,_),i,o,u,s,c,l,f,h,p,d)):b.concat(e(y[_],r+(f?"."+_:"["+_+"]"),i,o,u,s,c,l,f,h,p,d)))}return b};e.exports=function(e,t){var r=e,u=t?n.assign({},t):{};if(null!==u.encoder&&void 0!==u.encoder&&"function"!=typeof u.encoder)throw new TypeError("Encoder has to be a function.");var c=void 0===u.delimiter?a.delimiter:u.delimiter,l="boolean"==typeof u.strictNullHandling?u.strictNullHandling:a.strictNullHandling,f="boolean"==typeof u.skipNulls?u.skipNulls:a.skipNulls,h="boolean"==typeof u.encode?u.encode:a.encode,p="function"==typeof u.encoder?u.encoder:a.encoder,d="function"==typeof u.sort?u.sort:null,y=void 0!==u.allowDots&&u.allowDots,v="function"==typeof u.serializeDate?u.serializeDate:a.serializeDate,b="boolean"==typeof u.encodeValuesOnly?u.encodeValuesOnly:a.encodeValuesOnly;if(void 0===u.format)u.format=i.default;else if(!Object.prototype.hasOwnProperty.call(i.formatters,u.format))throw new TypeError("Unknown format option provided.");var g,m,_=i.formatters[u.format];"function"==typeof u.filter?r=(m=u.filter)("",r):Array.isArray(u.filter)&&(g=m=u.filter);var w,O=[];if("object"!=typeof r||null===r)return"";w=u.arrayFormat in o?u.arrayFormat:"indices"in u?u.indices?"indices":"repeat":"indices";var E=o[w];g||(g=Object.keys(r)),d&&g.sort(d);for(var k=0;k<g.length;++k){var P=g[k];f&&null===r[P]||(O=O.concat(s(r[P],P,E,l,f,h?p:null,m,d,y,v,_,b)))}var j=O.join(c),S=!0===u.addQueryPrefix?"?":"";return j.length>0?S+j:""}},function(e,t,r){"use strict";var n=r(111),i=Object.prototype.hasOwnProperty,o={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},u=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/g,u=/(\[[^[\]]*])/.exec(n),a=u?n.slice(0,u.index):n,s=[];if(a){if(!r.plainObjects&&i.call(Object.prototype,a)&&!r.allowPrototypes)return;s.push(a)}for(var c=0;null!==(u=o.exec(n))&&c<r.depth;){if(c+=1,!r.plainObjects&&i.call(Object.prototype,u[1].slice(1,-1))&&!r.allowPrototypes)return;s.push(u[1])}return u&&s.push("["+n.slice(u.index)+"]"),function(e,t,r){for(var n=t,i=e.length-1;i>=0;--i){var o,u=e[i];if("[]"===u)o=(o=[]).concat(n);else{o=r.plainObjects?Object.create(null):{};var a="["===u.charAt(0)&&"]"===u.charAt(u.length-1)?u.slice(1,-1):u,s=parseInt(a,10);!isNaN(s)&&u!==a&&String(s)===a&&s>=0&&r.parseArrays&&s<=r.arrayLimit?(o=[])[s]=n:o[a]=n}n=o}return n}(s,t,r)}};e.exports=function(e,t){var r=t?n.assign({},t):{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.ignoreQueryPrefix=!0===r.ignoreQueryPrefix,r.delimiter="string"==typeof r.delimiter||n.isRegExp(r.delimiter)?r.delimiter:o.delimiter,r.depth="number"==typeof r.depth?r.depth:o.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:o.arrayLimit,r.parseArrays=!1!==r.parseArrays,r.decoder="function"==typeof r.decoder?r.decoder:o.decoder,r.allowDots="boolean"==typeof r.allowDots?r.allowDots:o.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:o.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:o.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:o.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:o.strictNullHandling,""===e||null===e||void 0===e)return r.plainObjects?Object.create(null):{};for(var a="string"==typeof e?function(e,t){for(var r={},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,u=t.parameterLimit===1/0?void 0:t.parameterLimit,a=n.split(t.delimiter,u),s=0;s<a.length;++s){var c,l,f=a[s],h=f.indexOf("]="),p=-1===h?f.indexOf("="):h+1;-1===p?(c=t.decoder(f,o.decoder),l=t.strictNullHandling?null:""):(c=t.decoder(f.slice(0,p),o.decoder),l=t.decoder(f.slice(p+1),o.decoder)),i.call(r,c)?r[c]=[].concat(r[c]).concat(l):r[c]=l}return r}(e,r):e,s=r.plainObjects?Object.create(null):{},c=Object.keys(a),l=0;l<c.length;++l){var f=c[l],h=u(f,a[f],r);s=n.merge(s,h,r)}return n.compact(s)}},function(e,t,r){var n=r(113),i=Math.max;e.exports=function(e,t,r){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,u=-1,a=i(o.length-t,0),s=Array(a);++u<a;)s[u]=o[t+u];u=-1;for(var c=Array(t+1);++u<t;)c[u]=o[u];return c[t]=r(s),n(e,this,c)}}},function(e,t,r){var n=r(259),i=r(261)(n);e.exports=i},function(e,t,r){var n=r(260),i=r(98),o=r(46),u=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:o;e.exports=u},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t){var r=800,n=16,i=Date.now;e.exports=function(e){var t=0,o=0;return function(){var u=i(),a=n-(u-o);if(o=u,a>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,r){var n,i;!function(o,u){"use strict";void 0===(i="function"==typeof(n=u)?n.call(t,r,t,e):n)||(e.exports=i)}(0,function(){"use strict";var e=function(){},t="undefined",r=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function i(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function o(r,o,u){return function(r){return"debug"===r&&(r="log"),typeof console!==t&&(void 0!==console[r]?n(console,r):void 0!==console.log?n(console,"log"):e)}(r)||function(e,r,n){return function(){typeof console!==t&&(i.call(this,r,n),this[e].apply(this,arguments))}}.apply(this,arguments)}function u(e,n,u){var a,s=this,c="loglevel";function l(){var e;if(typeof window!==t){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var r=window.document.cookie,n=r.indexOf(encodeURIComponent(c)+"=");-1!==n&&(e=/^([^;]+)/.exec(r.slice(n))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}e&&(c+=":"+e),s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=u||o,s.getLevel=function(){return a},s.setLevel=function(n,o){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(a=n,!1!==o&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),i.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){l()||s.setLevel(e,!1)},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var f=l();null==f&&(f=null==n?"WARN":n),s.setLevel(f,!1)}var a=new u,s={};a.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=s[e];return t||(t=s[e]=new u(e,a.getLevel(),a.methodFactory)),t};var c=typeof window!==t?window.log:void 0;return a.noConflict=function(){return typeof window!==t&&window.log===a&&(window.log=c),a},a})},function(e,t,r){var n=r(264),i=r(20);e.exports=function(e,t){return e&&n(e,t,i)}},function(e,t,r){var n=r(265)();e.exports=n},function(e,t){e.exports=function(e){return function(t,r,n){for(var i=-1,o=Object(t),u=n(t),a=u.length;a--;){var s=u[e?a:++i];if(!1===r(o[s],s,o))break}return t}}},function(e,t,r){var n=r(16);e.exports=function(e,t){return function(r,i){if(null==r)return r;if(!n(r))return e(r,i);for(var o=r.length,u=t?o:-1,a=Object(r);(t?u--:++u<o)&&!1!==i(a[u],u,a););return r}}},function(e,t,r){var n=r(46);e.exports=function(e){return"function"==typeof e?e:n}},function(e,t,r){var n=r(269),i=r(276),o=r(121);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},function(e,t,r){var n=r(59),i=r(116),o=1,u=2;e.exports=function(e,t,r,a){var s=r.length,c=s,l=!a;if(null==e)return!c;for(e=Object(e);s--;){var f=r[s];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++s<c;){var h=(f=r[s])[0],p=e[h],d=f[1];if(l&&f[2]){if(void 0===p&&!(h in e))return!1}else{var y=new n;if(a)var v=a(p,d,h,e,t,y);if(!(void 0===v?i(d,p,o|u,a,y):v))return!1}}return!0}},function(e,t,r){var n=r(59),i=r(117),o=r(274),u=r(275),a=r(69),s=r(4),c=r(43),l=r(64),f=1,h="[object Arguments]",p="[object Array]",d="[object Object]",y=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,v,b,g){var m=s(e),_=s(t),w=m?p:a(e),O=_?p:a(t),E=(w=w==h?d:w)==d,k=(O=O==h?d:O)==d,P=w==O;if(P&&c(e)){if(!c(t))return!1;m=!0,E=!1}if(P&&!E)return g||(g=new n),m||l(e)?i(e,t,r,v,b,g):o(e,t,w,r,v,b,g);if(!(r&f)){var j=E&&y.call(e,"__wrapped__"),S=k&&y.call(t,"__wrapped__");if(j||S){var A=j?e.value():e,T=S?t.value():t;return g||(g=new n),b(A,T,r,v,g)}}return!!P&&(g||(g=new n),u(e,t,r,v,b,g))}},function(e,t){var r="__lodash_hash_undefined__";e.exports=function(e){return this.__data__.set(e,r),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},function(e,t,r){var n=r(26),i=r(107),o=r(30),u=r(117),a=r(108),s=r(109),c=1,l=2,f="[object Boolean]",h="[object Date]",p="[object Error]",d="[object Map]",y="[object Number]",v="[object RegExp]",b="[object Set]",g="[object String]",m="[object Symbol]",_="[object ArrayBuffer]",w="[object DataView]",O=n?n.prototype:void 0,E=O?O.valueOf:void 0;e.exports=function(e,t,r,n,O,k,P){switch(r){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _:return!(e.byteLength!=t.byteLength||!k(new i(e),new i(t)));case f:case h:case y:return o(+e,+t);case p:return e.name==t.name&&e.message==t.message;case v:case g:return e==t+"";case d:var j=a;case b:var S=n&c;if(j||(j=s),e.size!=t.size&&!S)return!1;var A=P.get(e);if(A)return A==t;n|=l,P.set(e,t);var T=u(j(e),j(t),n,O,k,P);return P.delete(e),T;case m:if(E)return E.call(e)==E.call(t)}return!1}},function(e,t,r){var n=r(105),i=1,o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,u,a,s){var c=r&i,l=n(e),f=l.length;if(f!=n(t).length&&!c)return!1;for(var h=f;h--;){var p=l[h];if(!(c?p in t:o.call(t,p)))return!1}var d=s.get(e);if(d&&s.get(t))return d==t;var y=!0;s.set(e,t),s.set(t,e);for(var v=c;++h<f;){var b=e[p=l[h]],g=t[p];if(u)var m=c?u(g,b,p,t,e,s):u(b,g,p,e,t,s);if(!(void 0===m?b===g||a(b,g,r,u,s):m)){y=!1;break}v||(v="constructor"==p)}if(y&&!v){var _=e.constructor,w=t.constructor;_!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w)&&(y=!1)}return s.delete(e),s.delete(t),y}},function(e,t,r){var n=r(120),i=r(20);e.exports=function(e){for(var t=i(e),r=t.length;r--;){var o=t[r],u=e[o];t[r]=[o,u,n(u)]}return t}},function(e,t,r){var n=r(116),i=r(278),o=r(284),u=r(79),a=r(120),s=r(121),c=r(28),l=1,f=2;e.exports=function(e,t){return u(e)&&a(t)?s(c(e),t):function(r){var u=i(r,e);return void 0===u&&u===t?o(r,e):n(t,u,l|f)}}},function(e,t,r){var n=r(78);e.exports=function(e,t,r){var i=null==e?void 0:n(e,t);return void 0===i?r:i}},function(e,t,r){var n=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,u=r(280)(function(e){var t=[];return n.test(e)&&t.push(""),e.replace(i,function(e,r,n,i){t.push(n?i.replace(o,"$1"):r||e)}),t});e.exports=u},function(e,t,r){var n=r(281),i=500;e.exports=function(e){var t=n(e,function(e){return r.size===i&&r.clear(),e}),r=t.cache;return t}},function(e,t,r){var n=r(61),i="Expected a function";function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var u=e.apply(this,n);return r.cache=o.set(i,u)||o,u};return r.cache=new(o.Cache||n),r}o.Cache=n,e.exports=o},function(e,t,r){var n=r(283);e.exports=function(e){return null==e?"":n(e)}},function(e,t,r){var n=r(26),i=r(53),o=r(4),u=r(52),a=1/0,s=n?n.prototype:void 0,c=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(u(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-a?"-0":r}},function(e,t,r){var n=r(285),i=r(286);e.exports=function(e,t){return null!=e&&i(e,t,n)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,r){var n=r(51),i=r(42),o=r(4),u=r(44),a=r(65),s=r(28);e.exports=function(e,t,r){for(var c=-1,l=(t=n(t,e)).length,f=!1;++c<l;){var h=s(t[c]);if(!(f=null!=e&&r(e,h)))break;e=e[h]}return f||++c!=l?f:!!(l=null==e?0:e.length)&&a(l)&&u(h,l)&&(o(e)||i(e))}},function(e,t,r){var n=r(288),i=r(289),o=r(79),u=r(28);e.exports=function(e){return o(e)?n(u(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,r){var n=r(78);e.exports=function(e){return function(t){return n(t,e)}}},function(e,t){e.exports=function(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r}},function(e,t,r){var n=r(53);e.exports=function(e,t){return n(t,function(t){return e[t]})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CacheMiddleware=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(47),u=(n=o)&&n.__esModule?n:{default:n},a=r(2),s=r(35),c=r(123);t.CacheMiddleware=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cache Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Middleware),i(t,[{key:"loadStorage",value:function(e,t){return new c.Storage(e,t)}},{key:"handle",value:function(e){var t=e.method,r=e.body,n=e.appKey,i=e.collection,o=e.entityId,s=e.encryptionKey,c=e.storageProviders,l=this.loadStorage(n,c,s),f=void 0;return"GET"===t?f=(0,a.isDefined)(o)?l.findById(i,o):l.find(i):"POST"===t||"PUT"===t?f="_group"===o?l.find(i):l.save(i,r):"DELETE"===t&&(f=!1===(0,a.isDefined)(i)?l.clear():l.removeById(i,o)),f.then(function(e){var r={statusCode:"POST"===t?201:200,data:e};return"POST"===t&&"_group"===o&&(r.statusCode=200),(!1===(0,a.isDefined)(e)||(0,u.default)(e))&&(r.statusCode=204),r}).catch(function(e){return{statusCode:e.code}}).then(function(e){return{response:e}})}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=[],o=String.fromCharCode(9500),u=String.fromCharCode(9472),a=String.fromCharCode(9492),s=String.fromCharCode(9474);t.AsciiTree=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"generate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=function(e,t){if(0===e.level)return e.value;for(var r="\r\n",n=t?a:o,c=1;c<e.level;c+=1)r=""+r+(i[c]?" ":s),r+="  ";return""+r+n+u+" "+e.value}(t,arguments[1]);if(t.nodes.length>0){var n=t.nodes.length-1;t.nodes.forEach(function(t,o){i[t.level]=o===n,r+=e.generate(t,o===n)})}return r}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(6),u=(n=o)&&n.__esModule?n:{default:n};var a=function(){};t.Queue=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pendingPromises=0,this.maxPendingPromises=void 0!==t?t:1/0,this.maxQueuedPromises=void 0!==r?r:1/0,this.queue=[]}return i(e,[{key:"add",value:function(e){var t=this;return new u.default(function(r,n,i){t.queue.length>=t.maxQueuedPromises?n(new Error("Queue limit reached")):(t.queue.push({promiseGenerator:e,resolve:r,reject:n,notify:i||a}),t._dequeue())})}},{key:"getPendingLength",value:function(){return this.pendingPromises}},{key:"getQueueLength",value:function(){return this.queue.length}},{key:"_dequeue",value:function(){var e=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var t,r=this.queue.shift();if(!r)return!1;try{this.pendingPromises+=1,(t=r.promiseGenerator(),t&&"function"==typeof t.then?t:u.default.resolve(t)).then(function(t){e.pendingPromises-=1,r.resolve(t),e._dequeue()},function(t){e.pendingPromises-=1,r.reject(t),e._dequeue()},function(e){r.notify(e)})}catch(e){this.pendingPromises-=1,r.reject(e),this._dequeue()}return!0}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryAdapter=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=d(r(6)),o=d(r(115)),u=d(r(81)),a=d(r(48)),s=d(r(80)),c=d(r(299)),l=d(r(8)),f=d(r(4)),h=r(2),p=r(1);function d(e){return e&&e.__esModule?e:{default:e}}var y={},v=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(0,h.isDefined)(t))throw new Error("A name for the collection is required to use the memory persistence adapter.",t);if(!(0,l.default)(t))throw new Error("The name of the collection must be a string to use the memory persistence adapter",t);this.name=t,this.cache=y[t],(0,h.isDefined)(this.cache)||(this.cache=new o.default,y[t]=this.cache)}return n(e,[{key:"find",value:function(e){try{var t=this.cache.get(e);return t?i.default.resolve(JSON.parse(t)):i.default.resolve([])}catch(e){return i.default.reject(e)}}},{key:"findById",value:function(e,t){var r=this;return this.find(e).then(function(n){var o=(0,c.default)(n,function(e){return e._id===t});return o||i.default.reject(new p.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+r.name+" memory database."))})}},{key:"save",value:function(e,t){var r=this,n=!1;return(0,f.default)(t)||(t=[t],n=!0),0===t.length?i.default.resolve(t):this.find(e).then(function(i){i=(0,u.default)(i,"_id"),t=(0,u.default)(t,"_id");var o=Object.keys(t);return(0,a.default)(o,function(e){i[e]=t[e]}),r.cache.set(e,JSON.stringify((0,s.default)(i))),t=(0,s.default)(t),n?t[0]:t})}},{key:"removeById",value:function(e,t){var r=this;return this.find(e).then(function(n){var o=(n=(0,u.default)(n,"_id"))[t];return(0,h.isDefined)(o)?(delete n[t],r.cache.set(e,JSON.stringify((0,s.default)(n))),{count:1}):i.default.reject(new p.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+r.name+" memory database."))})}},{key:"clear",value:function(){return this.cache.clear(),i.default.resolve(null)}}]),e}();t.MemoryAdapter={load:function(e){return i.default.resolve(new v(e))}}},function(e,t,r){var n=r(297),i=r(298),o=r(22),u=r(4);e.exports=function(e,t){return function(r,a){var s=u(r)?n:i,c=t?t():{};return s(r,e,o(a,2),c)}}},function(e,t){e.exports=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var u=e[i];t(n,u,r(u),e)}return n}},function(e,t,r){var n=r(33);e.exports=function(e,t,r,i){return n(e,function(e,n,o){t(i,e,r(e),o)}),i}},function(e,t,r){var n=r(300)(r(301));e.exports=n},function(e,t,r){var n=r(22),i=r(16),o=r(20);e.exports=function(e){return function(t,r,u){var a=Object(t);if(!i(t)){var s=n(r,3);t=o(t),r=function(e){return s(a[e],e,a)}}var c=e(t,r,u);return c>-1?a[s?t[c]:c]:void 0}}},function(e,t,r){var n=r(124),i=r(22),o=r(302),u=Math.max;e.exports=function(e,t,r){var a=null==e?0:e.length;if(!a)return-1;var s=null==r?0:o(r);return s<0&&(s=u(a+s,0)),n(e,i(t,3),s)}},function(e,t,r){var n=r(303);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},function(e,t,r){var n=r(304),i=1/0,o=1.7976931348623157e308;e.exports=function(e){return e?(e=n(e))===i||e===-i?(e<0?-1:1)*o:e==e?e:0:0===e?e:0}},function(e,t,r){var n=r(14),i=r(52),o=NaN,u=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return o;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var r=s.test(e);return r||c.test(e)?l(e.slice(2),r?2:8):a.test(e)?o:+e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpMiddleware=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(6),u=(n=o)&&n.__esModule?n:{default:n},a=r(1),s=r(35);t.HttpMiddleware=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Http Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Middleware),i(t,[{key:"handle",value:function(){return u.default.reject(new a.KinveyError("Unable to send network request.","Please override the core HttpMiddleware."))}},{key:"cancel",value:function(){return u.default.resolve()}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseMiddleware=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(6),u=(n=o)&&n.__esModule?n:{default:n},a=r(2),s=r(35);t.ParseMiddleware=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Parse Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Middleware),i(t,[{key:"handle",value:function(e,t){if((0,a.isDefined)(t)&&(0,a.isDefined)(t.data)){var r=t.headers["content-type"]||t.headers["Content-Type"];if(r&&0===r.indexOf("application/json"))try{t.data=JSON.parse(t.data)}catch(e){}}return u.default.resolve({response:t})}}]),t}()},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SerializeMiddleware=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(6),u=(n=o)&&n.__esModule?n:{default:n},a=r(2),s=r(35);t.SerializeMiddleware=function(t){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Serialize Middleware";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,s.Middleware),i(r,[{key:"handle",value:function(t){if((0,a.isDefined)(t)&&(0,a.isDefined)(t.body)){var r=t.headers["content-type"]||t.headers["Content-Type"];if((0,a.isDefined)(r))if(0===r.indexOf("application/json"))t.body=JSON.stringify(t.body);else if(0===r.indexOf("application/x-www-form-urlencoded")){var n=t.body,i=[];Object.keys(n).forEach(function(t){i.push(e.encodeURIComponent(t)+"="+e.encodeURIComponent(n[t]))}),t.body=i.join("&")}}return u.default.resolve({request:t})}}]),r}()}).call(t,r(23))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFetchRequest=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=m(r(6)),o=m(r(81)),u=m(r(77)),a=m(r(125)),s=m(r(80)),c=m(r(48)),l=m(r(4)),f=m(r(8)),h=r(1),p=r(2),d=r(12),y=r(49),v=r(126),b=r(94),g=r(34);function m(e){return e&&e.__esModule?e:{default:e}}t.DeltaFetchRequest=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.tag=e.tag,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.KinveyRequest),n(t,[{key:"execute",value:function(){var e=this;return new b.CacheRequest({method:y.RequestMethod.GET,url:this.url,headers:this.headers,query:this.query,timeout:this.timeout,client:this.client,tag:this.tag}).execute().then(function(e){return e.data}).catch(function(e){if(!(e instanceof h.NotFoundError))throw e;return[]}).then(function(t){if((0,l.default)(t)&&t.length>0){var r=(0,o.default)(t,"_id"),n=new d.Query((0,a.default)(e.query,"toJSON",e.query));return n.fields=["_id","_kmd.lmt"],new v.KinveyRequest({method:y.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:n,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute().then(function(e){return e.data}).then(function(t){var n=(0,o.default)(t,"_id"),u=n,s=Object.keys(r);(0,c.default)(s,function(e){var t=r[e],i=n[e];i&&(0,p.isDefined)(i._kmd)&&(0,p.isDefined)(t._kmd)&&i._kmd.lmt===t._kmd.lmt?delete u[e]:delete r[e]});for(var l=Object.keys(u),f=[],h=0;h<l.length;){var b=new d.Query((0,a.default)(e.query,"toJSON",e.query)),g=l.slice(h,l.length>200+h?200:l.length);b.contains("_id",g);var m=new v.KinveyRequest({method:y.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:b,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute();f.push(m),h+=200}return i.default.all(f)}).then(function(t){var n=(0,u.default)(t,function(e,t){if(t.isSuccess()){var r=e.headers;r.addAll(t.headers),e.headers=r,e.data=e.data.concat(t.data)}return e},new g.Response({statusCode:g.StatusCode.Ok,data:[]}));if(n.data=n.data.concat((0,s.default)(r)),e.query){var i=new d.Query((0,a.default)(e.query,"toJSON",e.query));i.skip=0,i.limit=0,n.data=i.process(n.data)}return n})}return new v.KinveyRequest({method:y.RequestMethod.GET,url:e.url,headers:e.headers,authType:e.authType,query:e.query,timeout:e.timeout,client:e.client,properties:e.properties,skipBL:e.skipBL,trace:e.trace,followRedirect:e.followRedirect,cache:e.cache}).execute()})}},{key:"method",get:function(){return function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",this)},set:function(e){switch((0,f.default)(e)||(e=String(e)),e=e.toUpperCase()){case y.RequestMethod.GET:!function e(t,r,n,i){var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var u=Object.getPrototypeOf(t);null!==u&&e(u,r,n,i)}else if("value"in o&&o.writable)o.value=n;else{var a=o.set;void 0!==a&&a.call(i,n)}return n}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"method",e,this);break;case y.RequestMethod.POST:case y.RequestMethod.PATCH:case y.RequestMethod.PUT:case y.RequestMethod.DELETE:default:throw new h.KinveyError("Invalid request Method. Only RequestMethod.GET is allowed.")}}}]),t}()},function(e,t,r){"use strict";(function(e){var n=r(310),i=r(311),o=r(312);function u(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(u()<t)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=s.prototype:(null===e&&(e=new s(t)),e.length=t),e}function s(e,t,r){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return c(this,e,t,r)}function c(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);s.TYPED_ARRAY_SUPPORT?(e=t).__proto__=s.prototype:e=h(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!s.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(t,r),i=(e=a(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(s.isBuffer(t)){var r=0|p(t.length);return 0===(e=a(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?a(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=a(e,t<0?0:0|p(t)),!s.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|p(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e){if(e>=u())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u().toString(16)+" bytes");return 0|e}function d(e,t){if(s.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return L(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return B(e).length;default:if(n)return L(e).length;t=(""+t).toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){var o,u=1,a=e.length,s=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;u=2,a/=2,s/=2,r/=2}function c(e,t){return 1===u?e[t]:e.readUInt16BE(t*u)}if(i){var l=-1;for(o=r;o<a;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===s)return l*u}else-1!==l&&(o-=o-l),l=-1}else for(r+s>a&&(r=a-s),o=r;o>=0;o--){for(var f=!0,h=0;h<s;h++)if(c(e,o+h)!==c(t,h)){f=!1;break}if(f)return o}return-1}function g(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var a=parseInt(t.substr(2*u,2),16);if(isNaN(a))return u;e[r+u]=a}return u}function m(e,t,r,n){return F(L(t,e.length-r),e,r,n)}function _(e,t,r,n){return F(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return _(e,t,r,n)}function O(e,t,r,n){return F(B(t),e,r,n)}function E(e,t,r,n){return F(function(e,t){for(var r,n,i,o=[],u=0;u<e.length&&!((t-=2)<0);++u)r=e.charCodeAt(u),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function P(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,u,a,s,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(s=(31&c)<<6|63&o)>127&&(l=s);break;case 3:o=e[i+1],u=e[i+2],128==(192&o)&&128==(192&u)&&(s=(15&c)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(l=s);break;case 4:o=e[i+1],u=e[i+2],a=e[i+3],128==(192&o)&&128==(192&u)&&128==(192&a)&&(s=(15&c)<<18|(63&o)<<12|(63&u)<<6|63&a)>65535&&s<1114112&&(l=s)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=j)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=j));return r}(n)}t.Buffer=s,t.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},t.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=u(),s.poolSize=8192,s._augment=function(e){return e.__proto__=s.prototype,e},s.from=function(e,t,r){return c(null,e,t,r)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},s.allocUnsafe=function(e){return f(null,e)},s.allocUnsafeSlow=function(e){return f(null,e)},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=s.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var u=e[r];if(!s.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(n,i),i+=u.length}return n},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},s.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?P(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return P(this,t,r);case"ascii":return S(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},s.prototype.compare=function(e,t,r,n,i){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var o=i-n,u=r-t,a=Math.min(o,u),c=this.slice(n,i),l=e.slice(t,r),f=0;f<a;++f)if(c[f]!==l[f]){o=c[f],u=l[f];break}return o<u?-1:u<o?1:0},s.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return g(this,e,t,r);case"utf8":case"utf-8":return m(this,e,t,r);case"ascii":return _(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return O(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var j=4096;function S(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function T(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=N(e[o]);return i}function x(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function C(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function I(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function q(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(e,t,r,n,o){return o||q(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function D(e,t,r,n,o){return o||q(e,0,r,8),i.write(e,t,r,n,52,8),r+8}s.prototype.slice=function(e,t){var r,n=this.length;if(e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),s.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=s.prototype;else{var i=t-e;r=new s(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},s.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||C(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},s.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||C(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUInt8=function(e,t){return t||C(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return t||C(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return t||C(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||C(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||C(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){t||C(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){t||C(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return t||C(e,4,this.length),i.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return t||C(e,4,this.length),i.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return t||C(e,8,this.length),i.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return t||C(e,8,this.length),i.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},s.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},s.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=0,u=1,a=0;for(this[t]=255&e;++o<r&&(u*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/u>>0)-a&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=r-1,u=1,a=0;for(this[t+o]=255&e;--o>=0&&(u*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/u>>0)-a&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},s.prototype.writeFloatLE=function(e,t,r){return U(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return U(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!s.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var u=s.isBuffer(e)?e:L(new s(e,n).toString()),a=u.length;for(o=0;o<r-t;++o)this[o+t]=u[o%a]}return this};var K=/[^+\/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function L(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],u=0;u<n;++u){if((r=e.charCodeAt(u))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function B(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(K,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(t,r(23))},function(e,t,r){"use strict";t.byteLength=function(e){return 3*e.length/4-c(e)},t.toByteArray=function(e){var t,r,n,u,a,s=e.length;u=c(e),a=new o(3*s/4-u),r=u>0?s-4:s;var l=0;for(t=0;t<r;t+=4)n=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)],a[l++]=n>>16&255,a[l++]=n>>8&255,a[l++]=255&n;2===u?(n=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4,a[l++]=255&n):1===u&&(n=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2,a[l++]=n>>8&255,a[l++]=255&n);return a},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o="",u=[],a=0,s=r-i;a<s;a+=16383)u.push(l(e,a,a+16383>s?s:a+16383));1===i?(t=e[r-1],o+=n[t>>2],o+=n[t<<4&63],o+="=="):2===i&&(t=(e[r-2]<<8)+e[r-1],o+=n[t>>10],o+=n[t>>4&63],o+=n[t<<2&63],o+="=");return u.push(o),u.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=u.length;a<s;++a)n[a]=u[a],i[u.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function l(e,t,r){for(var i,o,u=[],a=t;a<r;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],u.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return u.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,u,a=8*i-n-1,s=(1<<a)-1,c=s>>1,l=-7,f=r?i-1:0,h=r?-1:1,p=e[t+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=h,l-=8);for(u=o&(1<<-l)-1,o>>=-l,l+=n;l>0;u=256*u+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===s)return u?NaN:1/0*(p?-1:1);u+=Math.pow(2,n),o-=c}return(p?-1:1)*u*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var u,a,s,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,u=l):(u=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-u))<1&&(u--,s*=2),(t+=u+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(u++,s/=2),u+f>=l?(a=0,u=l):u+f>=1?(a=(t*s-1)*Math.pow(2,i),u+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),u=0));i>=8;e[r+p]=255&a,p+=d,a/=256,i-=8);for(u=u<<i|a,c+=i;c>0;e[r+p]=255&u,p+=d,u/=256,c-=8);e[r+p-d]|=128*y}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){var n=r(113),i=r(314),o=r(74),u=r(315),a=o(function(e){return e.push(void 0,u),n(i,void 0,e)});e.exports=a},function(e,t,r){var n=r(25),i=r(73),o=r(45),u=i(function(e,t,r,i){n(t,o(t),e,i)});e.exports=u},function(e,t,r){var n=r(30),i=Object.prototype,o=i.hasOwnProperty;e.exports=function(e,t,r,u){return void 0===e||n(e,i[r])&&!o.call(u,r)?t:e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(54),o=r(1);t.Popup=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.EventEmitter),n(t,[{key:"open",value:function(){throw new o.PopupError("Unable to open a popup on this platform.")}},{key:"close",value:function(){return this}}],[{key:"isSupported",value:function(){return!1}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Identity=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(9),o=r(1);t.Identity=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=t.client||i.Client.sharedInstance()}return n(e,[{key:"isSupported",value:function(){return!1}},{key:"isOnline",value:function(e){var t=(new Date).getTime()/1e3;return e&&e.access_token&&e.expires>t}},{key:"identity",get:function(){throw new o.KinveyError("A subclass must override this property.")}}],[{key:"isSupported",value:function(){return!1}},{key:"identity",get:function(){throw new o.KinveyError("A subclass must override this property.")}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(2),o=r(1),u=r(319),a=function(){function e(e){if(void 0===e&&(e="kinvey"),!1===i.isDefined(e))throw new Error("A name is required to use the SQLite adapter.");if("string"!=typeof e)throw new Error("The name must be a string to use the SQLite adapter");this.name=e}return e.prototype.openTransaction=function(e,t,r,n){void 0===n&&(n=!1);var i='"'+e+'"',o="sqlite_master"===e,a=Array.isArray(t);return t=a?t:[[t,r]],new u(this.name).then(function(e){return e.resultType(u.RESULTSASOBJECT),n&&!1===o?e.execSQL("CREATE TABLE IF NOT EXISTS "+i+" (key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)").then(function(){return e}):e}).then(function(e){var r=[];return 0===t.length?e.close().then(function(){return a?r:r.shift()}):t.reduce(function(t,u){var a=u[0].replace("#{collection}",i);return t.then(function(){return!1===n?e.all(a,u[1]):e.execSQL(a,u[1])}).then(function(e){if(void 0===e&&(e=[]),!1===n&&Array.isArray(e)&&e.length>0)for(var t=0,i=e.length;t<i;t+=1)try{var u=e[t],a=o?u.value:JSON.parse(u.value);r.push(a)}catch(e){}else!0===n&&r.push(e);return r})},Promise.resolve()).then(function(t){return e.close().then(function(){return t})}).catch(function(t){return e.close().then(function(){throw t})})})},e.prototype.find=function(e){return this.openTransaction(e,"SELECT value FROM #{collection}",[]).catch(function(){return[]})},e.prototype.findById=function(e,t){var r=this;return this.openTransaction(e,"SELECT value FROM #{collection} WHERE key = ?",[t]).then(function(n){if(0===n.length)throw new o.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+r.name+" SQLite database.");return n[0]}).catch(function(){throw new o.NotFoundError("An entity with _id = "+t+" was not found in the "+e+" collection on the "+r.name+" SQLite database.")})},e.prototype.save=function(e,t){var r=[],n=!1;return!1===Array.isArray(t)&&(n=!0,t=[t]),0===t.length?Promise.resolve(null):(t=t.map(function(e){return r.push(["REPLACE INTO #{collection} (key, value) VALUES (?, ?)",[e._id,JSON.stringify(e)]]),e}),this.openTransaction(e,r,null,!0).then(function(){return n?t[0]:t}))},e.prototype.removeById=function(e,t){var r=this;return this.openTransaction(e,"DELETE FROM #{collection} WHERE key = ?",[t],!0).then(function(n){var i=n[0];if(0===i){var u="An entity with _id = "+t+" was not found in the "+e+" collection on the "+r.name+" SQLite database.";return Promise.reject(new o.NotFoundError(u))}return{count:i}})},e.prototype.clear=function(){var e=this;return this.openTransaction("sqlite_master","SELECT name AS value FROM #{collection} WHERE type = ?",["table"],!1).then(function(t){if(0===t.length)return null;var r=t.filter(function(e){return/^[a-zA-Z0-9-]{1,128}/.test(e)}).map(function(e){return["DROP TABLE IF EXISTS '"+e+"'"]});return e.openTransaction("sqlite_master",r,null,!0)}).then(function(){return null})},e}();t.sqLite={load:function(e){var t=new a(e);return!1===i.isDefined(u)?Promise.resolve(void 0):i.isDefined(n)?n?Promise.resolve(t):Promise.resolve(void 0):t.save("__testSupport",{_id:"1"}).then(function(){return n=!0,t}).catch(function(){n=!1})}}},function(e,t){e.exports=require("nativescript-sqlite")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(128),i=r(129);var o=function(e){function t(t){var r=e.call(this)||this;return r.pkg=t,r}return __extends(t,e),t.prototype.handle=function(e){var t=e.url,r=e.method,o=e.headers,u=e.body,a=e.timeout,s=e.followRedirect;o["X-Kinvey-Device-Information"]=function(e){void 0===e&&(e={});var t=i.device.os,r=i.device.osVersion,n=i.device.manufacturer;return["js-"+e.name+"/"+e.version].concat([t,r,n]).map(function(e){return e?e.toString().replace(/\s/g,"_").toLowerCase():"unknown"}).join(" ")}(this.pkg);var c={method:r,headers:o,url:t,content:u,timeout:a,dontFollowRedirects:!s};return n.request(c).then(function(e){var t=e.content.raw;try{t=e.content.toString()}catch(e){}return{response:{statusCode:e.statusCode,headers:e.headers,data:t}}})},t.prototype.cancel=function(){return Promise.resolve()},t}(r(7).Middleware);t.HttpMiddleware=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(54),i=r(322),o=r(323),u=r(324),a=r(325),s=r(326),c=function(){function e(e,t){this.authUrl=e,this.webviewIntercept=t}return e.prototype.createWebViewPage=function(){var e=this,t=new s.WebView;t.on(s.WebView.loadFinishedEvent,function(r){e.webviewIntercept(t,r.error,r.url)}),t.on(s.WebView.loadStartedEvent,function(r){e.webviewIntercept(t,r.error,r.url)});var r=new u.GridLayout;r.addChild(t);var n=new a.StackLayout;n.addChild(r);var i=new o.Page;return i.content=n,t.src=this.authUrl,i},e}(),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._open=!1,t}return __extends(t,e),t.prototype.open=function(e){var t=this;if(void 0===e&&(e="/"),!1===this._open){var r=new c(e,function(e,r,n){var i="";try{if(r&&r.userInfo&&r.userInfo.allValues&&r.userInfo.allValues.count>0){var o=r.userInfo.allValues[0];i=o.absoluteString?o.absoluteString:o.userInfo&&o.userInfo.allValues&&o.userInfo.allValues.count>0?o.userInfo.allValues[0]:o}else e.request&&e.request.URL&&e.request.URL.absoluteString?i=e.request.URL.absoluteString:n&&(i=n)}catch(e){}return t.emit("loadstop",{url:i}),!0});i.topmost().navigate(function(){return r.createWebViewPage()}),this._open=!0}return this},t.prototype.close=function(){return this._open&&(i.topmost().goBack(),this._open=!1),this},t}(n.EventEmitter);t.Popup=l},function(e,t){e.exports=require("ui/frame")},function(e,t){e.exports=require("ui/page")},function(e,t){e.exports=require("ui/layouts/grid-layout")},function(e,t){e.exports=require("ui/layouts/stack-layout")},function(e,t){e.exports=require("ui/web-view")},function(e,t){e.exports={private:!0,version:"3.9.10",name:"kinvey-nativescript-sdk",description:"Kinvey NativeScript SDK for developing NativeScript applications.",author:"Kinvey, Inc.",homepage:"http://www.kinvey.com",license:"Apache-2.0",main:"kinvey-nativescript-sdk.js",typings:"kinvey.d.ts",dependencies:{"nativescript-sqlite":"~1.1.11",rxjs:"~5.5.5"},scripts:{prebuild:"rm -rf dist",build:"npm run build:android && npm run build:ios","build:android":"webpack --config webpack.config.android.js","build:ios":"webpack --config webpack.config.ios.js",lint:"tslint **/*.ts --exclude **/node_modules/**/* --exclude **/*.d.ts",prerelease:"rm -rf dist",release:"npm run release:android && npm run release:ios && ./scripts/push.sh","release:android":"npm run build:android -- --env.uglify","release:ios":"npm run build:ios -- --env.uglify",postrelease:"rm -rf tmp"},files:["kinvey-nativescript-sdk.ios.js","kinvey-nativescript-sdk.ios.js.map","kinvey-nativescript-sdk.android.js","kinvey-nativescript-sdk.android.js.map","kinvey.d.ts","platforms/android/include.gradle","platforms/ios/Podfile"],nativescript:{platforms:{ios:"3.0.0",android:"3.0.0"}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WritesToCollectionDisallowedError=t.UserAlreadyExistsError=t.TimeoutError=t.SyncError=t.StaleRequestError=t.ServerError=t.QueryError=t.PopupError=t.ParameterValueOutOfRangeError=t.NotFoundError=t.NoResponseError=t.NetworkConnectionError=t.NoActiveUserError=t.MobileIdentityConnectError=t.MissingRequestParameterError=t.MissingRequestHeaderError=t.MissingQueryError=t.KinveyInternalErrorStop=t.KinveyInternalErrorRetry=t.KinveyError=t.JSONParseError=t.InvalidQuerySyntaxError=t.InvalidIdentifierError=t.InvalidCredentialsError=t.InsufficientCredentialsError=t.IndirectCollectionAccessDisallowedError=t.IncompleteRequestBodyError=t.FeatureUnavailableError=t.DuplicateEndUsersError=t.CORSDisabledError=t.BLError=t.BadRequestError=t.AppProblemError=t.APIVersionNotImplementedError=t.APIVersionNotAvailableError=t.ActiveUserError=t.User=t.StorageProvider=t.Properties=t.Query=t.Metadata=t.Log=t.Files=t.LiveService=t.SyncOperation=t.DataStoreType=t.DataStore=t.CustomEndpoint=t.Client=t.AuthorizationGrant=t.Aggregation=t.Acl=t.ping=t.initialize=t.init=t.setAppVersion=t.getAppVersion=t.client=void 0;var n=r(329);Object.defineProperty(t,"client",{enumerable:!0,get:function(){return n.client}}),Object.defineProperty(t,"getAppVersion",{enumerable:!0,get:function(){return n.getAppVersion}}),Object.defineProperty(t,"setAppVersion",{enumerable:!0,get:function(){return n.setAppVersion}}),Object.defineProperty(t,"init",{enumerable:!0,get:function(){return n.init}}),Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return n.initialize}}),Object.defineProperty(t,"ping",{enumerable:!0,get:function(){return n.ping}});var i=r(142);Object.defineProperty(t,"Acl",{enumerable:!0,get:function(){return i.Acl}});var o=r(27);Object.defineProperty(t,"Aggregation",{enumerable:!0,get:function(){return o.Aggregation}});var u=r(58);Object.defineProperty(t,"AuthorizationGrant",{enumerable:!0,get:function(){return u.AuthorizationGrant}});var a=r(9);Object.defineProperty(t,"Client",{enumerable:!0,get:function(){return a.Client}});var s=r(403);Object.defineProperty(t,"CustomEndpoint",{enumerable:!0,get:function(){return s.CustomEndpoint}});var c=r(55);Object.defineProperty(t,"DataStore",{enumerable:!0,get:function(){return c.DataStore}}),Object.defineProperty(t,"DataStoreType",{enumerable:!0,get:function(){return c.DataStoreType}}),Object.defineProperty(t,"SyncOperation",{enumerable:!0,get:function(){return c.SyncOperation}});var l=r(89);Object.defineProperty(t,"LiveService",{enumerable:!0,get:function(){return l.LiveService}});var f=r(404);Object.defineProperty(t,"Files",{enumerable:!0,get:function(){return f.Files}});var h=r(21);Object.defineProperty(t,"Log",{enumerable:!0,get:function(){return h.Log}});var p=r(85);Object.defineProperty(t,"Metadata",{enumerable:!0,get:function(){return p.Metadata}});var d=r(12);Object.defineProperty(t,"Query",{enumerable:!0,get:function(){return d.Query}});var y=r(7);Object.defineProperty(t,"Properties",{enumerable:!0,get:function(){return y.Properties}}),Object.defineProperty(t,"StorageProvider",{enumerable:!0,get:function(){return y.StorageProvider}});var v=r(82);Object.defineProperty(t,"User",{enumerable:!0,get:function(){return v.User}});var b=r(1);Object.defineProperty(t,"ActiveUserError",{enumerable:!0,get:function(){return b.ActiveUserError}}),Object.defineProperty(t,"APIVersionNotAvailableError",{enumerable:!0,get:function(){return b.APIVersionNotAvailableError}}),Object.defineProperty(t,"APIVersionNotImplementedError",{enumerable:!0,get:function(){return b.APIVersionNotImplementedError}}),Object.defineProperty(t,"AppProblemError",{enumerable:!0,get:function(){return b.AppProblemError}}),Object.defineProperty(t,"BadRequestError",{enumerable:!0,get:function(){return b.BadRequestError}}),Object.defineProperty(t,"BLError",{enumerable:!0,get:function(){return b.BLError}}),Object.defineProperty(t,"CORSDisabledError",{enumerable:!0,get:function(){return b.CORSDisabledError}}),Object.defineProperty(t,"DuplicateEndUsersError",{enumerable:!0,get:function(){return b.DuplicateEndUsersError}}),Object.defineProperty(t,"FeatureUnavailableError",{enumerable:!0,get:function(){return b.FeatureUnavailableError}}),Object.defineProperty(t,"IncompleteRequestBodyError",{enumerable:!0,get:function(){return b.IncompleteRequestBodyError}}),Object.defineProperty(t,"IndirectCollectionAccessDisallowedError",{enumerable:!0,get:function(){return b.IndirectCollectionAccessDisallowedError}}),Object.defineProperty(t,"InsufficientCredentialsError",{enumerable:!0,get:function(){return b.InsufficientCredentialsError}}),Object.defineProperty(t,"InvalidCredentialsError",{enumerable:!0,get:function(){return b.InvalidCredentialsError}}),Object.defineProperty(t,"InvalidIdentifierError",{enumerable:!0,get:function(){return b.InvalidIdentifierError}}),Object.defineProperty(t,"InvalidQuerySyntaxError",{enumerable:!0,get:function(){return b.InvalidQuerySyntaxError}}),Object.defineProperty(t,"JSONParseError",{enumerable:!0,get:function(){return b.JSONParseError}}),Object.defineProperty(t,"KinveyError",{enumerable:!0,get:function(){return b.KinveyError}}),Object.defineProperty(t,"KinveyInternalErrorRetry",{enumerable:!0,get:function(){return b.KinveyInternalErrorRetry}}),Object.defineProperty(t,"KinveyInternalErrorStop",{enumerable:!0,get:function(){return b.KinveyInternalErrorStop}}),Object.defineProperty(t,"MissingQueryError",{enumerable:!0,get:function(){return b.MissingQueryError}}),Object.defineProperty(t,"MissingRequestHeaderError",{enumerable:!0,get:function(){return b.MissingRequestHeaderError}}),Object.defineProperty(t,"MissingRequestParameterError",{enumerable:!0,get:function(){return b.MissingRequestParameterError}}),Object.defineProperty(t,"MobileIdentityConnectError",{enumerable:!0,get:function(){return b.MobileIdentityConnectError}}),Object.defineProperty(t,"NoActiveUserError",{enumerable:!0,get:function(){return b.NoActiveUserError}}),Object.defineProperty(t,"NetworkConnectionError",{enumerable:!0,get:function(){return b.NetworkConnectionError}}),Object.defineProperty(t,"NoResponseError",{enumerable:!0,get:function(){return b.NoResponseError}}),Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return b.NotFoundError}}),Object.defineProperty(t,"ParameterValueOutOfRangeError",{enumerable:!0,get:function(){return b.ParameterValueOutOfRangeError}}),Object.defineProperty(t,"PopupError",{enumerable:!0,get:function(){return b.PopupError}}),Object.defineProperty(t,"QueryError",{enumerable:!0,get:function(){return b.QueryError}}),Object.defineProperty(t,"ServerError",{enumerable:!0,get:function(){return b.ServerError}}),Object.defineProperty(t,"StaleRequestError",{enumerable:!0,get:function(){return b.StaleRequestError}}),Object.defineProperty(t,"SyncError",{enumerable:!0,get:function(){return b.SyncError}}),Object.defineProperty(t,"TimeoutError",{enumerable:!0,get:function(){return b.TimeoutError}}),Object.defineProperty(t,"UserAlreadyExistsError",{enumerable:!0,get:function(){return b.UserAlreadyExistsError}}),Object.defineProperty(t,"WritesToCollectionDisallowedError",{enumerable:!0,get:function(){return b.WritesToCollectionDisallowedError}}),r(405)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.client=void 0,t.getAppVersion=function(){var e=f();if(e)return e.appVersion;return},t.setAppVersion=function(e){var t=f();t&&(t.appVersion=e)},t.init=h,t.initialize=function(e){try{var t=h(e);return o.default.resolve(c.User.getActiveUser(t))}catch(e){return o.default.reject(e)}},t.ping=function(){var e=f();return new l.KinveyRequest({method:l.RequestMethod.GET,authType:l.AuthType.All,url:e.apiHostname+"/appdata/"+e.appKey}).execute().then(function(e){return e.data})};var n,i=r(6),o=(n=i)&&n.__esModule?n:{default:n},u=r(1),a=r(2),s=r(9),c=r(82),l=r(7);function f(){return s.Client.sharedInstance()}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1===(0,a.isDefined)(e.appKey))throw new u.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if(!1===(0,a.isDefined)(e.appSecret)&&!1===(0,a.isDefined)(e.masterSecret))throw new u.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Secret.");return s.Client.init(e)}t.client=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=w(r(6)),o=w(r(17)),u=w(r(8)),a=w(r(14)),s=w(r(47)),c=w(r(11)),l=r(9),f=r(7),h=r(1),p=r(55),d=r(58),y=r(21),v=r(2),b=r(142),g=r(85),m=r(89),_=r(402);function w(e){return e&&e.__esModule?e:{default:e}}t.User=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.client=r.client||l.Client.sharedInstance()}return n(e,[{key:"isActive",value:function(){var t=e.getActiveUser(this.client);return!(!(0,v.isDefined)(t)||t._id!==this._id)}},{key:"isEmailVerified",value:function(){return"confirmed"===this.metadata.emailVerification}},{key:"login",value:function(t,r){var n=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=t,l=this.isActive(),p=e.getActiveUser(this.client);return!0===l?i.default.reject(new h.ActiveUserError("This user is already the active user.")):(0,v.isDefined)(p)?i.default.reject(new h.ActiveUserError("An active user already exists. Please logout the active user before you login.")):((0,a.default)(s)?u=r||{}:s={username:t,password:r},(0,v.isDefined)(s.username)&&(s.username=String(s.username).trim()),(0,v.isDefined)(s.password)&&(s.password=String(s.password).trim()),(0,v.isDefined)(s.username)&&""!==s.username&&(0,v.isDefined)(s.password)&&""!==s.password||(0,v.isDefined)(s._socialIdentity)?new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.App,url:c.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/login"}),body:s,properties:u.properties,timeout:u.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(e){(0,v.isDefined)(s._socialIdentity)&&(0,v.isDefined)(e._socialIdentity)&&(Object.keys(e._socialIdentity).forEach(function(t){e._socialIdentity[t]=(0,o.default)({},s._socialIdentity[t],e._socialIdentity[t])}),e._socialIdentity=(0,o.default)({},s._socialIdentity,e._socialIdentity));return delete e.password,n.client.setActiveUser(e)}).then(function(e){return n.data=e,n}):i.default.reject(new h.KinveyError("Username and/or password missing. Please provide both a username and password to login.")))}},{key:"loginWithMIC",value:function(t,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=this.isActive(),a=e.getActiveUser(this.client);return u?i.default.reject(new h.ActiveUserError("This user is already the active user.")):(0,v.isDefined)(a)?i.default.reject(new h.ActiveUserError("An active user already exists. Please logout the active user before you login.")):new d.MobileIdentityConnect({client:this.client}).login(t,r,o).then(function(e){return n.connectIdentity(d.MobileIdentityConnect.identity,e,o)})}},{key:"connectIdentity",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.isActive(),o={},u=o._socialIdentity||{};return u[e]=t,o._socialIdentity=u,i?this.update(o,n):this.login(o,n).catch(function(i){if(i instanceof h.NotFoundError)return r.signup(o,n).then(function(){return r.connectIdentity(e,t,n)});throw i})}},{key:"disconnectIdentity",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.default.resolve();return e===d.MobileIdentityConnect.identity&&(n=d.MobileIdentityConnect.logout(this,r)),n.catch(function(e){y.Log.error(e)}).then(function(){var n=t.data,i=n._socialIdentity||{};return delete i[e],n._socialIdentity=i,t.data=n,t._id?t.update(n,r):t}).then(function(){return t})}},{key:"logout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.Session,url:c.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_logout"}),properties:t.properties,timeout:t.timeout,client:this.client});return this.unregisterFromLiveService().then(function(){return r.execute()}).catch(function(e){return y.Log.error(e),null}).then(function(){return e.client.setActiveUser(null)}).catch(function(e){return y.Log.error(e),null}).then(function(){return p.DataStore.clearCache({client:e.client})}).catch(function(e){return y.Log.error(e),null}).then(function(){return e})}},{key:"signup",value:function(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.getActiveUser(this.client);if(!0===(n=(0,o.default)({state:!0},n)).state&&(0,v.isDefined)(i))throw new h.ActiveUserError("An active user already exists. Please logout the active user before you login.");return t instanceof e&&(t=t.data),t=(0,o.default)(this.data,t),new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.App,url:c.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname}),body:(0,s.default)(t)?null:t,properties:n.properties,timeout:n.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(e){return!0===n.state?r.client.setActiveUser(e):e}).then(function(e){return r.data=e,r})}},{key:"signupWithIdentity",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={_socialIdentity:{}};return n._socialIdentity[e]=t,this.signup(n,r)}},{key:"update",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=(0,o.default)(this.data,e),(new _.UserStore).update(e,r).then(function(e){return t.isActive()?t.client.setActiveUser(e):e}).then(function(e){return t.data=e,t})}},{key:"me",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new f.KinveyRequest({method:f.RequestMethod.GET,authType:f.AuthType.Session,url:c.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_me"}),properties:t.properties,timeout:t.timeout}).execute().then(function(e){return e.data}).then(function(t){return delete(t=(0,o.default)(e.data,t)).password,e.isActive()?e.client.setActiveUser(t):t}).then(function(t){return e.data=t,e})}},{key:"registerForLiveService",value:function(){var e=(0,m.getLiveService)(this.client),t=i.default.resolve();return e.isInitialized()||(t=e.fullInitialization(this)),t}},{key:"unregisterFromLiveService",value:function(){var e=(0,m.getLiveService)(this.client),t=i.default.resolve();return e.isInitialized()&&(t=e.fullUninitialization()),t}},{key:"_id",get:function(){return this.data._id}},{key:"_acl",get:function(){return new b.Acl(this.data)}},{key:"metadata",get:function(){return new g.Metadata(this.data)}},{key:"_kmd",get:function(){return this.metadata}},{key:"_socialIdentity",get:function(){return this.data._socialIdentity}},{key:"authtoken",get:function(){return this.metadata.authtoken}},{key:"username",get:function(){return this.data.username}},{key:"email",get:function(){return this.data.email}},{key:"pathname",get:function(){return"/user/"+this.client.appKey}}],[{key:"login",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new e({},n).login(t,r,n)}},{key:"loginWithMIC",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},r).loginWithMIC(e,t,r)}},{key:"connectIdentity",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},r).connectIdentity(e,t,r)}},{key:"logout",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.getActiveUser(t.client);return(0,v.isDefined)(r)?r.logout(t):i.default.resolve(null)}},{key:"signup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this({},t).signup(e,t)}},{key:"signupWithIdentity",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new this({},r).signupWithIdentity(e,t,r)}},{key:"update",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getActiveUser(r.client);return(0,v.isDefined)(n)?n.update(t,r):i.default.resolve(null)}},{key:"registerForLiveService",value:function(){var t=e.getActiveUser();return t?t.registerForLiveService():i.default.reject(new h.ActiveUserError("There is no active user"))}},{key:"unregisterFromLiveService",value:function(){var t=e.getActiveUser();return t?t.unregisterFromLiveService():i.default.reject(new h.ActiveUserError("There is no active user"))}},{key:"me",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.getActiveUser(t.client);return r?r.me(t):i.default.resolve(null)}},{key:"getActiveUser",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.Client.sharedInstance(),t=e.getActiveUser();return(0,v.isDefined)(t)?new this(t,{client:e}):null}},{key:"verifyEmail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return i.default.reject(new h.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."));if(!(0,u.default)(e))return i.default.reject(new h.KinveyError("The provided username is not a string."));var r=t.client||l.Client.sharedInstance();return new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.App,url:c.default.format({protocol:r.apiProtocol,host:r.apiHost,pathname:"/rpc/"+r.appKey+"/"+e+"/user-email-verification-initiate"}),properties:t.properties,timeout:t.timeout,client:r}).execute().then(function(e){return e.data})}},{key:"forgotUsername",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return i.default.reject(new h.KinveyError("An email was not provided.","Please provide an email for the user that you would like to retrieve their username."));if(!(0,u.default)(e))return i.default.reject(new h.KinveyError("The provided email is not a string."));var r=t.client||l.Client.sharedInstance();return new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.App,url:c.default.format({protocol:r.apiProtocol,host:r.apiHost,pathname:"/rpc/"+r.appKey+"/user-forgot-username"}),properties:t.properties,data:{email:e},timeout:t.timeout,client:r}).execute().then(function(e){return e.data})}},{key:"resetPassword",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return i.default.reject(new h.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."));if(!(0,u.default)(e))return i.default.reject(new h.KinveyError("The provided username is not a string."));var r=t.client||l.Client.sharedInstance();return new f.KinveyRequest({method:f.RequestMethod.POST,authType:f.AuthType.App,url:c.default.format({protocol:r.apiProtocol,host:r.apiHost,pathname:"/rpc/"+r.appKey+"/"+e+"/user-password-reset-initiate"}),properties:t.properties,timeout:t.timeout,client:r}).execute().then(function(e){return e.data})}},{key:"lookup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new _.UserStore).lookup(e,t)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new _.UserStore).exists(e,t)}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new _.UserStore).removeById(e,t)}},{key:"restore",value:function(){return i.default.reject(new h.KinveyError("This function requires a master secret to be provided for your application. We strongly advise not to do this."))}}]),e}()},function(e,t,r){var n=r(332),i=r(338),o=r(22),u=r(74),a=r(340),s=r(130),c=u(function(e,t){var r=s(t);return a(r)&&(r=void 0),a(e)?n(e,i(t,1,a,!0),o(r,2)):[]});e.exports=c},function(e,t,r){var n=r(118),i=r(333),o=r(337),u=r(53),a=r(100),s=r(119),c=200;e.exports=function(e,t,r,l){var f=-1,h=i,p=!0,d=e.length,y=[],v=t.length;if(!d)return y;r&&(t=u(t,a(r))),l?(h=o,p=!1):t.length>=c&&(h=s,p=!1,t=new n(t));e:for(;++f<d;){var b=e[f],g=null==r?b:r(b);if(b=l||0!==b?b:0,p&&g==g){for(var m=v;m--;)if(t[m]===g)continue e;y.push(b)}else h(t,g,l)||y.push(b)}return y}},function(e,t,r){var n=r(334);e.exports=function(e,t){return!(null==e||!e.length)&&n(e,t,0)>-1}},function(e,t,r){var n=r(124),i=r(335),o=r(336);e.exports=function(e,t,r){return t==t?o(e,t,r):n(e,i,r)}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}},function(e,t){e.exports=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}},function(e,t,r){var n=r(67),i=r(339);e.exports=function e(t,r,o,u,a){var s=-1,c=t.length;for(o||(o=i),a||(a=[]);++s<c;){var l=t[s];r>0&&o(l)?r>1?e(l,r-1,o,u,a):n(a,l):u||(a[a.length]=l)}return a}},function(e,t,r){var n=r(26),i=r(42),o=r(4),u=n?n.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(u&&e&&e[u])}},function(e,t,r){var n=r(16),i=r(15);e.exports=function(e){return i(e)&&n(e)}},function(e,t,r){var n=r(22),i=r(342);e.exports=function(e,t){var r=[];if(!e||!e.length)return r;var o=-1,u=[],a=e.length;for(t=n(t,3);++o<a;){var s=e[o];t(s,o,e)&&(r.push(s),u.push(o))}return i(e,u),r}},function(e,t,r){var n=r(343),i=r(44),o=Array.prototype.splice;e.exports=function(e,t){for(var r=e?t.length:0,u=r-1;r--;){var a=t[r];if(r==u||a!==s){var s=a;i(a)?o.call(e,a,1):n(e,a)}}return e}},function(e,t,r){var n=r(51),i=r(130),o=r(344),u=r(28);e.exports=function(e,t){return t=n(t,e),null==(e=o(e,t))||delete e[u(i(t))]}},function(e,t,r){var n=r(78),i=r(345);e.exports=function(e,t){return t.length<2?e:n(e,i(t,0,-1))}},function(e,t){e.exports=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}},function(e,t,r){var n=r(33),i=r(16);e.exports=function(e,t){var r=-1,o=i(e)?Array(e.length):[];return n(e,function(e,n,i){o[++r]=t(e,n,i)}),o}},function(e,t,r){"use strict";var n=r(86),i=r(348),o=r(354),u=r(355),a=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,o=i.toSubscriber(e,t,r);if(n?n.call(o,this.source):o.add(this.source||!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},e.prototype.forEach=function(e,t){var r=this;if(t||(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise?t=n.root.Rx.config.Promise:n.root.Promise&&(t=n.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,n){var i;i=r.subscribe(function(t){if(i)try{e(t)}catch(e){n(e),i.unsubscribe()}else e(t)},n,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[o.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return 0===e.length?this:u.pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;if(e||(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise?e=n.root.Rx.config.Promise:n.root.Promise&&(e=n.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}();t.Observable=a},function(e,t,r){"use strict";var n=r(131),i=r(87),o=r(134);t.toSubscriber=function(e,t,r){if(e){if(e instanceof n.Subscriber)return e;if(e[i.rxSubscriber])return e[i.rxSubscriber]()}return e||t||r?new n.Subscriber(e,t,r):new n.Subscriber(o.empty)}},function(e,t,r){"use strict";var n=r(350),i=r(351),o=r(132),u=r(352),a=r(133),s=r(353),c=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var r=this._parent,c=this._parents,f=this._unsubscribe,h=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var p=-1,d=c?c.length:0;r;)r.remove(this),r=++p<d&&c[p]||null;if(o.isFunction(f))u.tryCatch(f).call(this)===a.errorObject&&(t=!0,e=e||(a.errorObject.e instanceof s.UnsubscriptionError?l(a.errorObject.e.errors):[a.errorObject.e]));if(n.isArray(h))for(p=-1,d=h.length;++p<d;){var y=h[p];if(i.isObject(y))if(u.tryCatch(y.unsubscribe).call(y)===a.errorObject){t=!0,e=e||[];var v=a.errorObject.e;v instanceof s.UnsubscriptionError?e=e.concat(l(v.errors)):e.push(v)}}if(t)throw new s.UnsubscriptionError(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var r=t;switch(typeof t){case"function":r=new e(t);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.prototype._addParent=function(e){var t=this._parent,r=this._parents;t&&t!==e?r?-1===r.indexOf(e)&&r.push(e):this._parents=[e]:this._parent=e},e.EMPTY=((t=new e).closed=!0,t),e}();function l(e){return e.reduce(function(e,t){return e.concat(t instanceof s.UnsubscriptionError?t.errors:t)},[])}t.Subscription=c},function(e,t,r){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},function(e,t,r){"use strict";t.isObject=function(e){return null!=e&&"object"==typeof e}},function(e,t,r){"use strict";var n,i=r(133);function o(){try{return n.apply(this,arguments)}catch(e){return i.errorObject.e=e,i.errorObject}}t.tryCatch=function(e){return n=e,o}},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=function(e){function t(t){e.call(this),this.errors=t;var r=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError",this.stack=r.stack,this.message=r.message}return n(t,e),t}(Error);t.UnsubscriptionError=i},function(e,t,r){"use strict";var n=r(86);function i(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}t.getSymbolObservable=i,t.observable=i(n.root),t.$$observable=t.observable},function(e,t,r){"use strict";var n=r(356);function i(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:n.noop}t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return i(e)},t.pipeFromArray=i},function(e,t,r){"use strict";t.noop=function(){}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(358);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveCollectionManager=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.getLiveCollectionManager=function(e){c||(c=new s(e));return c};var i=r(9),o=r(1),u=r(7),a=r(56);var s=t.LiveCollectionManager=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._client=t||i.Client.sharedInstance()}return n(e,[{key:"subscribeCollection",value:function(e,t){var r=this;return(0,a.isValidChannelName)(e)?(0,a.isValidReceiver)(t)?this._makeSubscriptionRequest(e,"_subscribe").then(function(){var n=r._buildChannelName(e),i=r._buildPersonalChannelName(e),o=(0,a.getLiveService)();o.subscribeToChannel(n,t),o.subscribeToChannel(i,t)}):Promise.reject(new o.KinveyError("Invalid or missing receiver")):Promise.reject(new o.KinveyError("Invalid or missing collection name"))}},{key:"unsubscribeCollection",value:function(e){var t=this;return(0,a.isValidChannelName)(e)?this._makeSubscriptionRequest(e,"_unsubscribe").then(function(){var r=t._buildChannelName(e),n=t._buildPersonalChannelName(e),i=(0,a.getLiveService)();i.unsubscribeFromChannel(r),i.unsubscribeFromChannel(n)}):Promise.reject(new o.KinveyError("Invalid or missing collection name"))}},{key:"_buildChannelName",value:function(e){return this._client.appKey+".c-"+e}},{key:"_buildPersonalChannelName",value:function(e){return this._buildChannelName(e)+".u-"+this._client.getActiveUser()._id}},{key:"_makeSubscriptionRequest",value:function(e,t){return u.KinveyRequest.executeShort({method:u.RequestMethod.POST,pathname:"/appdata/"+this._client.appKey+"/"+e+"/"+t,body:{deviceId:this._client.deviceId}})}}]),e}(),c=void 0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(360)),i=a(r(389)),o=a(r(390)),u=r(391);r(3);function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.db=new o.default,e.networking=new i.default({del:u.del,get:u.get,post:u.post}),e.sdkFamily="NativeScript",function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),t}();t.default=s,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=U(r(29)),o=U(r(135)),u=U(r(363)),a=U(r(136)),s=U(r(366)),c=q(r(367)),l=q(r(368)),f=q(r(369)),h=q(r(370)),p=q(r(371)),d=q(r(372)),y=q(r(373)),v=q(r(374)),b=q(r(375)),g=q(r(376)),m=q(r(377)),_=q(r(378)),w=q(r(379)),O=q(r(380)),E=q(r(381)),k=q(r(382)),P=q(r(383)),j=q(r(384)),S=q(r(385)),A=q(r(386)),T=q(r(387)),x=q(r(137)),C=q(r(388)),M=U(r(5)),R=U(r(57)),I=(r(3),U(r(90)));function q(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function U(e){return e&&e.__esModule?e:{default:e}}var D=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.db,M=t.networking,R=this._config=new i.default({setup:t,db:n}),I=new o.default({config:R});M.init(R);var q={config:R,networking:M,crypto:I},U=s.default.bind(this,q,x),D=s.default.bind(this,q,g),K=s.default.bind(this,q,_),N=s.default.bind(this,q,O),L=s.default.bind(this,q,C),B=this._listenerManager=new a.default,F=new u.default({timeEndpoint:U,leaveEndpoint:D,heartbeatEndpoint:K,setStateEndpoint:N,subscribeEndpoint:L,crypto:q.crypto,config:q.config,listenerManager:B});this.addListener=B.addListener.bind(B),this.removeListener=B.removeListener.bind(B),this.removeAllListeners=B.removeAllListeners.bind(B),this.channelGroups={listGroups:s.default.bind(this,q,h),listChannels:s.default.bind(this,q,p),addChannels:s.default.bind(this,q,c),removeChannels:s.default.bind(this,q,l),deleteGroup:s.default.bind(this,q,f)},this.push={addChannels:s.default.bind(this,q,d),removeChannels:s.default.bind(this,q,y),deleteDevice:s.default.bind(this,q,b),listChannels:s.default.bind(this,q,v)},this.hereNow=s.default.bind(this,q,E),this.whereNow=s.default.bind(this,q,m),this.getState=s.default.bind(this,q,w),this.setState=F.adaptStateChange.bind(F),this.grant=s.default.bind(this,q,P),this.audit=s.default.bind(this,q,k),this.publish=s.default.bind(this,q,j),this.fire=function(e,t){return e.replicate=!1,e.storeInHistory=!1,r.publish(e,t)},this.history=s.default.bind(this,q,S),this.deleteMessages=s.default.bind(this,q,A),this.fetchMessages=s.default.bind(this,q,T),this.time=U,this.subscribe=F.adaptSubscribeChange.bind(F),this.presence=F.adaptPresenceChange.bind(F),this.unsubscribe=F.adaptUnsubscribeChange.bind(F),this.disconnect=F.disconnect.bind(F),this.reconnect=F.reconnect.bind(F),this.destroy=function(e){F.unsubscribeAll(e),F.disconnect()},this.stop=this.destroy,this.unsubscribeAll=F.unsubscribeAll.bind(F),this.getSubscribedChannels=F.getSubscribedChannels.bind(F),this.getSubscribedChannelGroups=F.getSubscribedChannelGroups.bind(F),this.encrypt=I.encrypt.bind(I),this.decrypt=I.decrypt.bind(I),this.getAuthKey=q.config.getAuthKey.bind(q.config),this.setAuthKey=q.config.setAuthKey.bind(q.config),this.setCipherKey=q.config.setCipherKey.bind(q.config),this.getUUID=q.config.getUUID.bind(q.config),this.setUUID=q.config.setUUID.bind(q.config),this.getFilterExpression=q.config.getFilterExpression.bind(q.config),this.setFilterExpression=q.config.setFilterExpression.bind(q.config),this.setHeartbeatInterval=q.config.setHeartbeatInterval.bind(q.config),M.hasModule("proxy")&&(this.setProxy=function(e){q.config.setProxy(e),r.reconnect()})}return n(e,[{key:"getVersion",value:function(){return this._config.getVersion()}},{key:"networkDownDetected",value:function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)}},{key:"networkUpDetected",value:function(){this._listenerManager.announceNetworkUp(),this.reconnect()}}],[{key:"generateUUID",value:function(){return I.default.createUUID()}}]),e}();D.OPERATIONS=M.default,D.CATEGORIES=R.default,t.default=D,e.exports=t.default},function(e,t,r){var n,i,o,u;u=function(e){var t={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,r="";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(r+="-"),r+=(12===e?4:16===e?3&t|8:t).toString(16);return r}function n(e,r){var n=t[r||"all"];return n&&n.test(e)||!1}r.isUUID=n,r.VERSION="0.1.0",e.uuid=r,e.isUUID=n},i=[t],void 0===(o="function"==typeof(n=u)?n.apply(t,i):n)||(e.exports=o)},function(e,t,r){"use strict";var n,i,o,u,a,s=s||function(e,t){var r={},n=r.lib={},i=function(){},o=n.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=n.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var i=0;i<e;i++)t[n+i>>>2]|=(r[i>>>2]>>>24-i%4*8&255)<<24-(n+i)%4*8;else if(65535<r.length)for(i=0;i<e;i+=4)t[n+i>>>2]=r[i>>>2];else t.push.apply(t,r);return this.sigBytes+=e,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r=[],n=0;n<t;n+=4)r.push(4294967296*e.random()|0);return new u.init(r,t)}}),a=r.enc={},s=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++){var i=t[n>>>2]>>>24-n%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new u.init(r,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++)r.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new u.init(r,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,a=i/(4*o);if(t=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,i=e.min(4*t,i),t){for(var s=0;s<t;s+=o)this._doProcessBlock(n,s);s=n.splice(0,t),r.sigBytes-=i}return new u.init(s,i)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=f.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new h.HMAC.init(e,r).finalize(t)}}});var h=r.algo={};return r}(Math);!function(e){for(var t=s,r=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,o=[],u=[],a=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var f;e:{f=c;for(var h=e.sqrt(f),p=2;p<=h;p++)if(!(f%p)){f=!1;break e}f=!0}f&&(8>l&&(o[l]=a(e.pow(c,.5))),u[l]=a(e.pow(c,1/3)),l++),c++}var d=[];i=i.SHA256=n.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],c=r[5],l=r[6],f=r[7],h=0;64>h;h++){if(16>h)d[h]=0|e[t+h];else{var p=d[h-15],y=d[h-2];d[h]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[h-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+d[h-16]}p=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&c^~s&l)+u[h]+d[h],y=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&o^i&o),f=l,l=c,c=s,s=a+p|0,a=o,o=i,i=n,n=p+y|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+c|0,r[6]=r[6]+l|0,r[7]=r[7]+f|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=n._createHelper(i),t.HmacSHA256=n._createHmacHelper(i)}(Math),i=(n=s).enc.Utf8,n.algo.HMAC=n.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),u=this._iKey=t.clone(),a=o.words,s=u.words,c=0;c<r;c++)a[c]^=1549556828,s[c]^=909522486;o.sigBytes=u.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),u=(o=s).lib.WordArray,o.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,u=0;4>u&&i+.75*u<r;u++)e.push(n.charAt(o>>>6*(3-u)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map;(n=r.charAt(64))&&-1!=(n=e.indexOf(n))&&(t=n);for(var n=[],i=0,o=0;o<t;o++)if(o%4){var a=r.indexOf(e.charAt(o-1))<<o%4*2,s=r.indexOf(e.charAt(o))>>>6-o%4*2;n[i>>>2]|=(a|s)<<24-i%4*8,i++}return u.create(n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){function t(e,t,r,n,i,o,u){return((e=e+(t&r|~t&n)+i+u)<<o|e>>>32-o)+t}function r(e,t,r,n,i,o,u){return((e=e+(t&n|r&~n)+i+u)<<o|e>>>32-o)+t}function n(e,t,r,n,i,o,u){return((e=e+(t^r^n)+i+u)<<o|e>>>32-o)+t}function i(e,t,r,n,i,o,u){return((e=e+(r^(t|~n))+i+u)<<o|e>>>32-o)+t}for(var o=s,u=(c=o.lib).WordArray,a=c.Hasher,c=o.algo,l=[],f=0;64>f;f++)l[f]=4294967296*e.abs(e.sin(f+1))|0;c=c.MD5=a.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,o){for(var u=0;16>u;u++){var a=e[f=o+u];e[f]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}u=this._hash.words;var s,c,f=e[o+0],h=(a=e[o+1],e[o+2]),p=e[o+3],d=e[o+4],y=e[o+5],v=e[o+6],b=e[o+7],g=e[o+8],m=e[o+9],_=e[o+10],w=e[o+11],O=e[o+12],E=e[o+13],k=e[o+14],P=e[o+15],j=u[0],S=i(S=i(S=i(S=i(S=n(S=n(S=n(S=n(S=r(S=r(S=r(S=r(S=t(S=t(S=t(S=t(S=u[1],c=t(c=u[2],s=t(s=u[3],j=t(j,S,c,s,f,7,l[0]),S,c,a,12,l[1]),j,S,h,17,l[2]),s,j,p,22,l[3]),c=t(c,s=t(s,j=t(j,S,c,s,d,7,l[4]),S,c,y,12,l[5]),j,S,v,17,l[6]),s,j,b,22,l[7]),c=t(c,s=t(s,j=t(j,S,c,s,g,7,l[8]),S,c,m,12,l[9]),j,S,_,17,l[10]),s,j,w,22,l[11]),c=t(c,s=t(s,j=t(j,S,c,s,O,7,l[12]),S,c,E,12,l[13]),j,S,k,17,l[14]),s,j,P,22,l[15]),c=r(c,s=r(s,j=r(j,S,c,s,a,5,l[16]),S,c,v,9,l[17]),j,S,w,14,l[18]),s,j,f,20,l[19]),c=r(c,s=r(s,j=r(j,S,c,s,y,5,l[20]),S,c,_,9,l[21]),j,S,P,14,l[22]),s,j,d,20,l[23]),c=r(c,s=r(s,j=r(j,S,c,s,m,5,l[24]),S,c,k,9,l[25]),j,S,p,14,l[26]),s,j,g,20,l[27]),c=r(c,s=r(s,j=r(j,S,c,s,E,5,l[28]),S,c,h,9,l[29]),j,S,b,14,l[30]),s,j,O,20,l[31]),c=n(c,s=n(s,j=n(j,S,c,s,y,4,l[32]),S,c,g,11,l[33]),j,S,w,16,l[34]),s,j,k,23,l[35]),c=n(c,s=n(s,j=n(j,S,c,s,a,4,l[36]),S,c,d,11,l[37]),j,S,b,16,l[38]),s,j,_,23,l[39]),c=n(c,s=n(s,j=n(j,S,c,s,E,4,l[40]),S,c,f,11,l[41]),j,S,p,16,l[42]),s,j,v,23,l[43]),c=n(c,s=n(s,j=n(j,S,c,s,m,4,l[44]),S,c,O,11,l[45]),j,S,P,16,l[46]),s,j,h,23,l[47]),c=i(c,s=i(s,j=i(j,S,c,s,f,6,l[48]),S,c,b,10,l[49]),j,S,k,15,l[50]),s,j,y,21,l[51]),c=i(c,s=i(s,j=i(j,S,c,s,O,6,l[52]),S,c,p,10,l[53]),j,S,_,15,l[54]),s,j,a,21,l[55]),c=i(c,s=i(s,j=i(j,S,c,s,g,6,l[56]),S,c,P,10,l[57]),j,S,v,15,l[58]),s,j,E,21,l[59]),c=i(c,s=i(s,j=i(j,S,c,s,d,6,l[60]),S,c,w,10,l[61]),j,S,h,15,l[62]),s,j,m,21,l[63]);u[0]=u[0]+j|0,u[1]=u[1]+S|0,u[2]=u[2]+c|0,u[3]=u[3]+s|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;r[i>>>5]|=128<<24-i%32;var o=e.floor(n/4294967296);for(r[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(r.length+1),this._process(),r=(t=this._hash).words,n=0;4>n;n++)i=r[n],r[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=a._createHelper(c),o.HmacMD5=a._createHmacHelper(c)}(Math),function(){var e,t=s,r=(e=t.lib).Base,n=e.WordArray,i=(e=t.algo).EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=(a=this.cfg).hasher.create(),i=n.create(),o=i.words,u=a.keySize,a=a.iterations;o.length<u;){s&&r.update(s);var s=r.update(e).finalize(t);r.reset();for(var c=1;c<a;c++)s=r.finalize(s),r.reset();i.concat(s)}return i.sigBytes=4*u,i}});t.EvpKDF=function(e,t,r){return i.create(r).compute(e,t)}}(),s.lib.Cipher||function(e){var t=(d=s).lib,r=t.Base,n=t.WordArray,i=t.BufferedBlockAlgorithm,o=d.enc.Base64,u=d.algo.EvpKDF,a=t.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,r,n){return("string"==typeof r?y:p).encrypt(e,t,r,n)},decrypt:function(t,r,n){return("string"==typeof r?y:p).decrypt(e,t,r,n)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=d.mode={},l=function(e,t,r){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var i=0;i<r;i++)e[t+i]^=n[i]},f=(t.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();f.Encryptor=f.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize;l.call(this,e,t,n),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}),f.Decryptor=f.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=e.slice(t,t+n);r.decryptBlock(e,t),l.call(this,e,t,n),this._prevBlock=i}}),c=c.CBC=f,f=(d.pad={}).Pkcs7={pad:function(e,t){for(var r,i=(r=(r=4*t)-e.sigBytes%r)<<24|r<<16|r<<8|r,o=[],u=0;u<r;u+=4)o.push(i);r=n.create(o,r),e.concat(r)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:f}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=t.createEncryptor;else r=t.createDecryptor,this._minBufferSize=1;this._mode=r.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var h=t.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),p=(c=(d.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?n.create([1398893684,1701076831]).concat(e).concat(t):t).toString(o)},parse:function(e){var t=(e=o.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var r=n.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return h.create({ciphertext:e,salt:r})}},t.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n);return t=i.finalize(t),i=i.cfg,h.create({ciphertext:t,key:r,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),d=(d.kdf={}).OpenSSL={execute:function(e,t,r,i){return i||(i=n.random(8)),e=u.create({keySize:t+r}).compute(e,i),r=n.create(e.words.slice(t),4*r),e.sigBytes=4*t,h.create({key:e,iv:r,salt:i})}},y=t.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:d}),encrypt:function(e,t,r,n){return r=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize),n.iv=r.iv,(e=p.encrypt.call(this,e,t,r.key,n)).mixIn(r),e},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),r=n.kdf.execute(r,e.keySize,e.ivSize,t.salt),n.iv=r.iv,p.decrypt.call(this,e,t,r.key,n)}})}(),function(){for(var e=s,t=e.lib.BlockCipher,r=e.algo,n=[],i=[],o=[],u=[],a=[],c=[],l=[],f=[],h=[],p=[],d=[],y=0;256>y;y++)d[y]=128>y?y<<1:y<<1^283;var v=0,b=0;for(y=0;256>y;y++){var g=(g=b^b<<1^b<<2^b<<3^b<<4)>>>8^255&g^99;n[v]=g,i[g]=v;var m=d[v],_=d[m],w=d[_],O=257*d[g]^16843008*g;o[v]=O<<24|O>>>8,u[v]=O<<16|O>>>16,a[v]=O<<8|O>>>24,c[v]=O,O=16843009*w^65537*_^257*m^16843008*v,l[g]=O<<24|O>>>8,f[g]=O<<16|O>>>16,h[g]=O<<8|O>>>24,p[g]=O,v?(v=m^d[d[d[w^m]]],b^=d[d[b]]):v=b=1}var E=[0,1,2,4,8,16,32,64,128,27,54];r=r.AES=t.extend({_doReset:function(){for(var e=(r=this._key).words,t=r.sigBytes/4,r=4*((this._nRounds=t+6)+1),i=this._keySchedule=[],o=0;o<r;o++)if(o<t)i[o]=e[o];else{var u=i[o-1];o%t?6<t&&4==o%t&&(u=n[u>>>24]<<24|n[u>>>16&255]<<16|n[u>>>8&255]<<8|n[255&u]):(u=n[(u=u<<8|u>>>24)>>>24]<<24|n[u>>>16&255]<<16|n[u>>>8&255]<<8|n[255&u],u^=E[o/t|0]<<24),i[o]=i[o-t]^u}for(e=this._invKeySchedule=[],t=0;t<r;t++)o=r-t,u=t%4?i[o]:i[o-4],e[t]=4>t||4>=o?u:l[n[u>>>24]]^f[n[u>>>16&255]]^h[n[u>>>8&255]]^p[n[255&u]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,u,a,c,n)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,l,f,h,p,i),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,o,u,a){for(var s=this._nRounds,c=e[t]^r[0],l=e[t+1]^r[1],f=e[t+2]^r[2],h=e[t+3]^r[3],p=4,d=1;d<s;d++){var y=n[c>>>24]^i[l>>>16&255]^o[f>>>8&255]^u[255&h]^r[p++],v=n[l>>>24]^i[f>>>16&255]^o[h>>>8&255]^u[255&c]^r[p++],b=n[f>>>24]^i[h>>>16&255]^o[c>>>8&255]^u[255&l]^r[p++];h=n[h>>>24]^i[c>>>16&255]^o[l>>>8&255]^u[255&f]^r[p++],c=y,l=v,f=b}y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[f>>>8&255]<<8|a[255&h])^r[p++],v=(a[l>>>24]<<24|a[f>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^r[p++],b=(a[f>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^r[p++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&f])^r[p++],e[t]=y,e[t+1]=v,e[t+2]=b,e[t+3]=h},keySize:8});e.AES=t._createHelper(r)}(),s.mode.ECB=((a=s.lib.BlockCipherMode.extend()).Encryptor=a.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),a.Decryptor=a.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),a),e.exports=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(s(r(135)),s(r(29)),s(r(136)),s(r(364))),o=s(r(365)),u=s(r(10)),a=(r(3),s(r(57)));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){var r=t.subscribeEndpoint,n=t.leaveEndpoint,u=t.heartbeatEndpoint,a=t.setStateEndpoint,s=t.timeEndpoint,c=t.config,l=t.crypto,f=t.listenerManager;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listenerManager=f,this._config=c,this._leaveEndpoint=n,this._heartbeatEndpoint=u,this._setStateEndpoint=a,this._subscribeEndpoint=r,this._crypto=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new i.default({timeEndpoint:s}),this._dedupingManager=new o.default({config:c})}return n(e,[{key:"adaptStateChange",value:function(e,t){var r=this,n=e.state,i=e.channels,o=void 0===i?[]:i,u=e.channelGroups,a=void 0===u?[]:u;return o.forEach(function(e){e in r._channels&&(r._channels[e].state=n)}),a.forEach(function(e){e in r._channelGroups&&(r._channelGroups[e].state=n)}),this._setStateEndpoint({state:n,channels:o,channelGroups:a},t)}},{key:"adaptPresenceChange",value:function(e){var t=this,r=e.connected,n=e.channels,i=void 0===n?[]:n,o=e.channelGroups,u=void 0===o?[]:o;r?(i.forEach(function(e){t._heartbeatChannels[e]={state:{}}}),u.forEach(function(e){t._heartbeatChannelGroups[e]={state:{}}})):(i.forEach(function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]}),u.forEach(function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]}),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:i,channelGroups:u},function(e){t._listenerManager.announceStatus(e)})),this.reconnect()}},{key:"adaptSubscribeChange",value:function(e){var t=this,r=e.timetoken,n=e.channels,i=void 0===n?[]:n,o=e.channelGroups,u=void 0===o?[]:o,a=e.withPresence,s=void 0!==a&&a;this._config.subscribeKey&&""!==this._config.subscribeKey?(r&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=r),"0"!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),i.forEach(function(e){t._channels[e]={state:{}},s&&(t._presenceChannels[e]={}),t._pendingChannelSubscriptions.push(e)}),u.forEach(function(e){t._channelGroups[e]={state:{}},s&&(t._presenceChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)}),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log("subscribe key missing; aborting subscribe")}},{key:"adaptUnsubscribeChange",value:function(e,t){var r=this,n=e.channels,i=void 0===n?[]:n,o=e.channelGroups,u=void 0===o?[]:o,a=[],s=[];i.forEach(function(e){e in r._channels&&(delete r._channels[e],a.push(e)),e in r._presenceChannels&&(delete r._presenceChannels[e],a.push(e))}),u.forEach(function(e){e in r._channelGroups&&(delete r._channelGroups[e],s.push(e)),e in r._presenceChannelGroups&&(delete r._channelGroups[e],s.push(e))}),0===a.length&&0===s.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:s},function(e){e.affectedChannels=a,e.affectedChannelGroups=s,e.currentTimetoken=r._currentTimetoken,e.lastTimetoken=r._lastTimetoken,r._listenerManager.announceStatus(e)}),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())}},{key:"unsubscribeAll",value:function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)}},{key:"getHeartbeatChannels",value:function(){return Object.keys(this._heartbeatChannels)}},{key:"getHeartbeatChannelGroups",value:function(){return Object.keys(this._heartbeatChannelGroups)}},{key:"getSubscribedChannels",value:function(){return Object.keys(this._channels)}},{key:"getSubscribedChannelGroups",value:function(){return Object.keys(this._channelGroups)}},{key:"reconnect",value:function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()}},{key:"disconnect",value:function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()}},{key:"_registerHeartbeatTimer",value:function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))}},{key:"_stopHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_performHeartbeatLoop",value:function(){var e=this,t=[];t=(t=t.concat(this.getHeartbeatChannels())).concat(this.getSubscribedChannels());var r=[];r=(r=r.concat(this.getHeartbeatChannelGroups())).concat(this.getSubscribedChannelGroups());var n={};if(0!==t.length||0!==r.length){this.getSubscribedChannels().forEach(function(t){var r=e._channels[t].state;Object.keys(r).length&&(n[t]=r)}),this.getSubscribedChannelGroups().forEach(function(t){var r=e._channelGroups[t].state;Object.keys(r).length&&(n[t]=r)});this._heartbeatEndpoint({channels:t,channelGroups:r,state:n},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}}},{key:"_startSubscribeLoop",value:function(){this._stopSubscribeLoop();var e=[],t=[];if(Object.keys(this._channels).forEach(function(t){return e.push(t)}),Object.keys(this._presenceChannels).forEach(function(t){return e.push(t+"-pnpres")}),Object.keys(this._channelGroups).forEach(function(e){return t.push(e)}),Object.keys(this._presenceChannelGroups).forEach(function(e){return t.push(e+"-pnpres")}),0!==e.length||0!==t.length){var r={channels:e,channelGroups:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(r,this._processSubscribeResponse.bind(this))}}},{key:"_processSubscribeResponse",value:function(e,t){var r=this;if(e.error)e.category===a.default.PNTimeoutCategory?this._startSubscribeLoop():e.category===a.default.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection(function(){r._config.autoNetworkDetection&&!r._isOnline&&(r._isOnline=!0,r._listenerManager.announceNetworkUp()),r.reconnect(),r._subscriptionStatusAnnounced=!0;var t={category:a.default.PNReconnectedCategory,operation:e.operation,lastTimetoken:r._lastTimetoken,currentTimetoken:r._currentTimetoken};r._listenerManager.announceStatus(t)}),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===a.default.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e);else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var n={};n.category=a.default.PNConnectedCategory,n.operation=e.operation,n.affectedChannels=this._pendingChannelSubscriptions,n.subscribedChannels=this.getSubscribedChannels(),n.affectedChannelGroups=this._pendingChannelGroupSubscriptions,n.lastTimetoken=this._lastTimetoken,n.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(n),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var i=t.messages||[],o=this._config,s=o.requestMessageCountThreshold,c=o.dedupeOnSubscribe;if(s&&i.length>=s){var l={};l.category=a.default.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}i.forEach(function(e){var t=e.channel,n=e.subscriptionMatch,i=e.publishMetaData;if(t===n&&(n=null),c){if(r._dedupingManager.isDuplicate(e))return;r._dedupingManager.addEntry(e)}if(u.default.endsWith(e.channel,"-pnpres")){var o={channel:null,subscription:null};o.actualChannel=null!=n?t:null,o.subscribedChannel=null!=n?n:t,t&&(o.channel=t.substring(0,t.lastIndexOf("-pnpres"))),n&&(o.subscription=n.substring(0,n.lastIndexOf("-pnpres"))),o.action=e.payload.action,o.state=e.payload.data,o.timetoken=i.publishTimetoken,o.occupancy=e.payload.occupancy,o.uuid=e.payload.uuid,o.timestamp=e.payload.timestamp,e.payload.join&&(o.join=e.payload.join),e.payload.leave&&(o.leave=e.payload.leave),e.payload.timeout&&(o.timeout=e.payload.timeout),r._listenerManager.announcePresence(o)}else{var a={channel:null,subscription:null};a.actualChannel=null!=n?t:null,a.subscribedChannel=null!=n?n:t,a.channel=t,a.subscription=n,a.timetoken=i.publishTimetoken,a.publisher=e.issuingClientId,e.userMetadata&&(a.userMetadata=e.userMetadata),r._config.cipherKey?a.message=r._crypto.decrypt(e.payload):a.message=e.payload,r._listenerManager.announceMessage(a)}}),this._region=t.metadata.region,this._startSubscribeLoop()}}},{key:"_stopSubscribeLoop",value:function(){this._subscribeCall&&("function"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)}}]),e}();t.default=c,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(137);(n=o)&&n.__esModule,r(3);var u=function(){function e(t){var r=t.timeEndpoint;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._timeEndpoint=r}return i(e,[{key:"onReconnection",value:function(e){this._reconnectionCallback=e}},{key:"startPolling",value:function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:"stopPolling",value:function(){clearInterval(this._timeTimer)}},{key:"_performTimeLoop",value:function(){var e=this;this._timeEndpoint(function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())})}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(29);(n=o)&&n.__esModule,r(3);var u=function(){function e(t){var r=t.config;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hashHistory=[],this._config=r}return i(e,[{key:"getKey",value:function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r+=1)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}(JSON.stringify(e.payload)).toString();return e.publishMetaData.publishTimetoken+"-"+t}},{key:"isDuplicate",value:function(e){return this.hashHistory.includes(this.getKey(e))}},{key:"addEntry",value:function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))}},{key:"clearHistory",value:function(){this.hashHistory=[]}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e.networking,u=e.config,c=null,l=null,f={};t.getOperation()===o.default.PNTimeOperation||t.getOperation()===o.default.PNChannelGroupsOperation?c=arguments.length<=2?void 0:arguments[2]:(f=arguments.length<=2?void 0:arguments[2],c=arguments.length<=3?void 0:arguments[3]),"undefined"==typeof Promise||c||(l=i.default.createPromise());var h=t.validateParams(e,f);if(h)return c?c(s(h)):l?(l.reject(new a("Validation failed, check status for details",s(h))),l.promise):void 0;var p=t.prepareParams(e,f),d=function(e,t,r){return e.usePost&&e.usePost(t,r)?e.postURL(t,r):e.getURL(t,r)}(t,e,f),y=void 0,v={url:d,operation:t.getOperation(),timeout:t.getRequestTimeout(e)};p.uuid=u.UUID,p.pnsdk=function(e){if(e.sdkName)return e.sdkName;var t="PubNub-JS-"+e.sdkFamily;e.partnerId&&(t+="-"+e.partnerId);return t+="/"+e.getVersion()}(u),u.useInstanceId&&(p.instanceid=u.instanceId),u.useRequestId&&(p.requestid=n.default.createUUID()),t.isAuthSupported()&&u.getAuthKey()&&(p.auth=u.getAuthKey()),u.secretKey&&function(e,t,r){var n=e.config,o=e.crypto;r.timestamp=Math.floor((new Date).getTime()/1e3);var u=n.subscribeKey+"\n"+n.publishKey+"\n"+t+"\n";u+=i.default.signPamFromParams(r);var a=o.HMACSHA256(u);a=(a=a.replace(/\+/g,"-")).replace(/\//g,"_"),r.signature=a}(e,d,p);var b=function(r,n){if(r.error)c?c(r):l&&l.reject(new a("PubNub call failed, check status for details",r));else{var i=t.handleResponse(e,n,f);c?c(r,i):l&&l.fulfill(i)}};if(t.usePost&&t.usePost(e,f)){var g=t.postPayload(e,f);y=r.POST(p,g,v,b)}else y=t.useDelete&&t.useDelete()?r.DELETE(p,v,b):r.GET(p,v,b);return t.getOperation()===o.default.PNSubscribeOperation?y:l?l.promise:void 0};var n=u(r(90)),i=(r(3),u(r(10))),o=(u(r(29)),u(r(5)));function u(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name=n.constructor.name,n.status=r,n.message=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();function s(e){return(t={message:e}).type="validationError",t.error=!0,t;var t}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNAddChannelsToGroupOperation},t.validateParams=function(e,t){var r=t.channels,n=t.channelGroup,i=e.config;if(!n)return"Missing Channel Group";if(!r||0===r.length)return"Missing Channels";if(!i.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(r)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.channels;return{add:(void 0===r?[]:r).join(",")}},t.handleResponse=function(){return{}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNRemoveChannelsFromGroupOperation},t.validateParams=function(e,t){var r=t.channels,n=t.channelGroup,i=e.config;if(!n)return"Missing Channel Group";if(!r||0===r.length)return"Missing Channels";if(!i.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(r)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.channels;return{remove:(void 0===r?[]:r).join(",")}},t.handleResponse=function(){return{}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNRemoveGroupOperation},t.validateParams=function(e,t){var r=t.channelGroup,n=e.config;if(!r)return"Missing Channel Group";if(!n.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(r)+"/remove"},t.isAuthSupported=function(){return!0},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(){return{}},t.handleResponse=function(){return{}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNChannelGroupsOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e){return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){return{groups:t.payload.groups}};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNChannelsForGroupOperation},t.validateParams=function(e,t){var r=t.channelGroup,n=e.config;if(!r)return"Missing Channel Group";if(!n.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+i.default.encodeString(r)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){return{channels:t.payload.channels}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var r=t.device,n=t.pushGateway,i=t.channels,o=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i||0===i.length)return"Missing Channels";if(!o.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+r},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.pushGateway,n=t.channels,i=void 0===n?[]:n;return{type:r,add:i.join(",")}},t.handleResponse=function(){return{}};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var r=t.device,n=t.pushGateway,i=t.channels,o=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i||0===i.length)return"Missing Channels";if(!o.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+r},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.pushGateway,n=t.channels,i=void 0===n?[]:n;return{type:r,remove:i.join(",")}},t.handleResponse=function(){return{}};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNPushNotificationEnabledChannelsOperation},t.validateParams=function(e,t){var r=t.device,n=t.pushGateway,i=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+r},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){return{type:t.pushGateway}},t.handleResponse=function(e,t){return{channels:t}};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNRemoveAllPushNotificationsOperation},t.validateParams=function(e,t){var r=t.device,n=t.pushGateway,i=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+r+"/remove"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){return{type:t.pushGateway}},t.handleResponse=function(){return{}};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNUnsubscribeOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=e.config,n=t.channels,o=void 0===n?[]:n,u=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+i.default.encodeString(u)+"/leave"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.channelGroups,n=void 0===r?[]:r,i={};n.length>0&&(i["channel-group"]=n.join(","));return i},t.handleResponse=function(){return{}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNWhereNowOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=e.config,n=t.uuid,i=void 0===n?r.UUID:n;return"/v2/presence/sub-key/"+r.subscribeKey+"/uuid/"+i},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(){return{}},t.handleResponse=function(e,t){if(!t.payload)return{channels:[]};return{channels:t.payload.channels}};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNHeartbeatOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=e.config,n=t.channels,o=void 0===n?[]:n,u=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+i.default.encodeString(u)+"/heartbeat"},t.isAuthSupported=function(){return!0},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.prepareParams=function(e,t){var r=t.channelGroups,n=void 0===r?[]:r,i=t.state,o=void 0===i?{}:i,u=e.config,a={};n.length>0&&(a["channel-group"]=n.join(","));return a.state=JSON.stringify(o),a.heartbeat=u.getPresenceTimeout(),a},t.handleResponse=function(){return{}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNGetStateOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=e.config,n=t.uuid,o=void 0===n?r.UUID:n,u=t.channels,a=void 0===u?[]:u,s=a.length>0?a.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+i.default.encodeString(s)+"/uuid/"+o},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.channelGroups,n=void 0===r?[]:r,i={};n.length>0&&(i["channel-group"]=n.join(","));return i},t.handleResponse=function(e,t,r){var n=r.channels,i=void 0===n?[]:n,o=r.channelGroups,u=void 0===o?[]:o,a={};1===i.length&&0===u.length?a[i[0]]=t.payload:a=t.payload;return{channels:a}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNSetStateOperation},t.validateParams=function(e,t){var r=e.config,n=t.state,i=t.channels,o=void 0===i?[]:i,u=t.channelGroups,a=void 0===u?[]:u;if(!n)return"Missing State";if(!r.subscribeKey)return"Missing Subscribe Key";if(0===o.length&&0===a.length)return"Please provide a list of channels and/or channel-groups"},t.getURL=function(e,t){var r=e.config,n=t.channels,o=void 0===n?[]:n,u=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+i.default.encodeString(u)+"/uuid/"+r.UUID+"/data"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.state,n=t.channelGroups,i=void 0===n?[]:n,o={};o.state=JSON.stringify(r),i.length>0&&(o["channel-group"]=i.join(","));return o},t.handleResponse=function(e,t){return{state:t.payload}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNHereNowOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=e.config,n=t.channels,o=void 0===n?[]:n,u=t.channelGroups,a=void 0===u?[]:u,s="/v2/presence/sub-key/"+r.subscribeKey;if(o.length>0||a.length>0){var c=o.length>0?o.join(","):",";s+="/channel/"+i.default.encodeString(c)}return s},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.channelGroups,n=void 0===r?[]:r,i=t.includeUUIDs,o=void 0===i||i,u=t.includeState,a=void 0!==u&&u,s={};o||(s.disable_uuids=1);a&&(s.state=1);n.length>0&&(s["channel-group"]=n.join(","));return s},t.handleResponse=function(e,t,r){var n=r.channels,i=void 0===n?[]:n,o=r.channelGroups,u=void 0===o?[]:o,a=r.includeUUIDs,s=void 0===a||a,c=r.includeState,l=void 0!==c&&c,f=void 0;f=i.length>1||u.length>0||0===u.length&&0===i.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach(function(r){var n=t.payload.channels[r],i=[];return e.channels[r]={occupants:i,name:r,occupancy:n.occupancy},s&&n.uuids.forEach(function(e){l?i.push({state:e.state,uuid:e.uuid}):i.push({state:null,uuid:e})}),e}),e}():function(){var e={},r=[];e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[i[0]]={occupants:r,name:i[0],occupancy:t.occupancy},s&&t.uuids&&t.uuids.forEach(function(e){l?r.push({state:e.state,uuid:e.uuid}):r.push({state:null,uuid:e})});return e}();return f};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNAccessManagerAudit},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e){return"/v2/auth/audit/sub-key/"+e.config.subscribeKey},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!1},t.prepareParams=function(e,t){var r=t.channel,n=t.channelGroup,i=t.authKeys,o=void 0===i?[]:i,u={};r&&(u.channel=r);n&&(u["channel-group"]=n);o.length>0&&(u.auth=o.join(","));return u},t.handleResponse=function(e,t){return t.payload};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return o.default.PNAccessManagerGrant},t.validateParams=function(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key";if(!t.publishKey)return"Missing Publish Key";if(!t.secretKey)return"Missing Secret Key"},t.getURL=function(e){return"/v2/auth/grant/sub-key/"+e.config.subscribeKey},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!1},t.prepareParams=function(e,t){var r=t.channels,n=void 0===r?[]:r,i=t.channelGroups,o=void 0===i?[]:i,u=t.ttl,a=t.read,s=void 0!==a&&a,c=t.write,l=void 0!==c&&c,f=t.manage,h=void 0!==f&&f,p=t.authKeys,d=void 0===p?[]:p,y={};y.r=s?"1":"0",y.w=l?"1":"0",y.m=h?"1":"0",n.length>0&&(y.channel=n.join(","));o.length>0&&(y["channel-group"]=o.join(","));d.length>0&&(y.auth=d.join(","));(u||0===u)&&(y.ttl=u);return y},t.handleResponse=function(){return{}};r(3);var n,i=r(5),o=(n=i)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getOperation=function(){return i.default.PNPublishOperation},t.validateParams=function(e,t){var r=e.config,n=t.message;if(!t.channel)return"Missing Channel";if(!n)return"Missing Message";if(!r.subscribeKey)return"Missing Subscribe Key"},t.usePost=function(e,t){var r=t.sendByPost;return void 0!==r&&r},t.getURL=function(e,t){var r=e.config,n=t.channel,i=t.message,u=a(e,i);return"/publish/"+r.publishKey+"/"+r.subscribeKey+"/0/"+o.default.encodeString(n)+"/0/"+o.default.encodeString(u)},t.postURL=function(e,t){var r=e.config,n=t.channel;return"/publish/"+r.publishKey+"/"+r.subscribeKey+"/0/"+o.default.encodeString(n)+"/0"},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.postPayload=function(e,t){var r=t.message;return a(e,r)},t.prepareParams=function(e,t){var r=t.meta,i=t.replicate,o=void 0===i||i,u=t.storeInHistory,a=t.ttl,s={};null!=u&&(s.store=u?"1":"0");a&&(s.ttl=a);!1===o&&(s.norep="true");r&&"object"===(void 0===r?"undefined":n(r))&&(s.meta=JSON.stringify(r));return s},t.handleResponse=function(e,t){return{timetoken:t[2]}};r(3);var i=u(r(5)),o=u(r(10));function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=e.crypto,n=e.config,i=JSON.stringify(t);return n.cipherKey&&(i=r.encrypt(i),i=JSON.stringify(i)),i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNHistoryOperation},t.validateParams=function(e,t){var r=t.channel,n=e.config;if(!r)return"Missing channel";if(!n.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.channel;return"/v2/history/sub-key/"+e.config.subscribeKey+"/channel/"+i.default.encodeString(r)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.start,n=t.end,i=t.reverse,o=t.count,u=void 0===o?100:o,a=t.stringifiedTimeToken,s=void 0!==a&&a,c={include_token:"true"};c.count=u,r&&(c.start=r);n&&(c.end=n);s&&(c.string_message_token="true");null!=i&&(c.reverse=i.toString());return c},t.handleResponse=function(e,t){var r={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return t[0].forEach(function(t){var n={timetoken:t.timetoken,entry:function(e,t){var r=e.config,n=e.crypto;if(!r.cipherKey)return t;try{return n.decrypt(t)}catch(e){return t}}(e,t.message)};r.messages.push(n)}),r};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNDeleteMessagesOperation},t.validateParams=function(e,t){var r=t.channel,n=e.config;if(!r)return"Missing channel";if(!n.subscribeKey)return"Missing Subscribe Key"},t.useDelete=function(){return!0},t.getURL=function(e,t){var r=t.channel,n=t.start,o=t.end,u=e.config,a="";n&&(a="?start="+n);o&&(a+=(""!==a?"&":"?")+"end="+o);return"/v3/history/sub-key/"+u.subscribeKey+"/channel/"+i.default.encodeString(r)+a},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.start,n=t.end,i={};r&&(i.start=r);n&&(i.end=n);return{}},t.handleResponse=function(e,t){return t.payload};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNFetchMessagesOperation},t.validateParams=function(e,t){var r=t.channels,n=e.config;if(!r||0===r.length)return"Missing channels";if(!n.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=t.channels,n=void 0===r?[]:r,o=e.config,u=n.length>0?n.join(","):",";return"/v3/history/sub-key/"+o.subscribeKey+"/channel/"+i.default.encodeString(u)},t.getRequestTimeout=function(e){return e.config.getTransactionTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=t.start,n=t.end,i=t.count,o={};i&&(o.max=i);r&&(o.start=r);n&&(o.end=n);return o},t.handleResponse=function(e,t){var r={channels:{}};return Object.keys(t.channels||{}).forEach(function(n){r.channels[n]=[],(t.channels[n]||[]).forEach(function(t){var i={};i.channel=n,i.subscription=null,i.timetoken=t.timetoken,i.message=function(e,t){var r=e.config,n=e.crypto;if(!r.cipherKey)return t;try{return n.decrypt(t)}catch(e){return t}}(e,t.message),r.channels[n].push(i)})}),r};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=function(){return n.default.PNSubscribeOperation},t.validateParams=function(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"},t.getURL=function(e,t){var r=e.config,n=t.channels,o=void 0===n?[]:n,u=o.length>0?o.join(","):",";return"/v2/subscribe/"+r.subscribeKey+"/"+i.default.encodeString(u)+"/0"},t.getRequestTimeout=function(e){return e.config.getSubscribeTimeout()},t.isAuthSupported=function(){return!0},t.prepareParams=function(e,t){var r=e.config,n=t.channelGroups,i=void 0===n?[]:n,o=t.timetoken,u=t.filterExpression,a=t.region,s={heartbeat:r.getPresenceTimeout()};i.length>0&&(s["channel-group"]=i.join(","));u&&u.length>0&&(s["filter-expr"]=u);o&&(s.tt=o);a&&(s.tr=a);return s},t.handleResponse=function(e,t){var r=[];t.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r},n={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};r.push(n)});var n={timetoken:t.t.t,region:t.t.r};return{messages:r,metadata:n}};r(3);var n=o(r(5)),i=o(r(10));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(o(r(29)),o(r(57)));r(3);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._modules={},Object.keys(t).forEach(function(e){r._modules[e]=t[e].bind(r)})}return n(e,[{key:"init",value:function(e){this._config=e,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(this._config.secure?"https://":"http://")+this._config.origin,this._coreParams={},this.shiftStandardOrigin()}},{key:"nextOrigin",value:function(){if(-1===this._providedFQDN.indexOf("pubsub."))return this._providedFQDN;var e;return this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),e=this._currentSubDomain.toString(),this._providedFQDN.replace("pubsub","ps"+e)}},{key:"hasModule",value:function(e){return e in this._modules}},{key:"shiftStandardOrigin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._standardOrigin=this.nextOrigin(e),this._standardOrigin}},{key:"getStandardOrigin",value:function(){return this._standardOrigin}},{key:"POST",value:function(e,t,r,n){return this._modules.post(e,t,r,n)}},{key:"GET",value:function(e,t,r){return this._modules.get(e,t,r)}},{key:"DELETE",value:function(e,t,r){return this._modules.del(e,t,r)}},{key:"_detectErrorCategory",value:function(e){if("ENOTFOUND"===e.code)return i.default.PNNetworkIssuesCategory;if("ECONNREFUSED"===e.code)return i.default.PNNetworkIssuesCategory;if("ECONNRESET"===e.code)return i.default.PNNetworkIssuesCategory;if("EAI_AGAIN"===e.code)return i.default.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty("status")&&void 0===e.status)return i.default.PNNetworkIssuesCategory;if(e.timeout)return i.default.PNTimeoutCategory;if(e.response){if(e.response.badRequest)return i.default.PNBadRequestCategory;if(e.response.forbidden)return i.default.PNAccessDeniedCategory}return i.default.PNUnknownCategory}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storage={}}return n(e,[{key:"get",value:function(e){return this.storage[e]}},{key:"set",value:function(e,t){this.storage[e]=t}}]),e}();t.default=i,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get=function(e,t,r){var n=this.getStandardOrigin()+t.url;return o.call(this,"GET",n,e,"",t,r)},t.post=function(e,t,r,n){var i=this.getStandardOrigin()+r.url;return o.call(this,"POST",i,e,t,r,n)},t.del=function(e,t,r){var n=this.getStandardOrigin()+t.url;return o.call(this,"DELETE",n,e,"",t,r)};var n=r(128),i=(r(3),r(392));function o(e,t,r,o,u,a){var s=this,c={};return c.operation=u.operation,(0,n.request)({method:e,url:(0,i.buildUrl)(t,r),content:o,timeout:u.timeout}).then(function(e){return c.error=!1,e.statusCode&&(c.statusCode=e.statusCode),e.content.toJSON()}).then(function(e){var n=e;s._config.logVerbosity&&function(e,t,r){var n=(new Date).getTime(),i=(new Date).toISOString(),o=(console&&console.log,console);o.log("<<<<<"),o.log("["+i+"]","\n",e,"\n",t),o.log("-----");var u=(new Date).getTime()-n,a=(new Date).toISOString();o.log(">>>>>>"),o.log("["+a+" / "+u+"]","\n",e,"\n",t,"\n",r),o.log("-----")}(t,r,n),a(c,n)}).catch(function(e){c.error=!0,c.errorData=e,c.category=s._detectErrorCategory(e),a(c,null)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,t,r){null!=r?Array.isArray(r)?r.forEach(function(r){i(e,t,r)}):"object"===(void 0===r?"undefined":n(r))?Object.keys(r).forEach(function(n){i(e,t+"["+n+"]",r[n])}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r)):null===r&&e.push(encodeURIComponent(""+encodeURIComponent(t)))}t.encodedKeyValuePair=i,t.buildUrl=function(e,t){var r=[];return Object.keys(t).forEach(function(e){i(r,e,t[e])}),e+"?"+r.join("&")}},function(e,t,r){e.exports=r(394)},function(e,t,r){var n=r(25),i=r(73),o=r(45),u=i(function(e,t){n(t,o(t),e)});e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(396);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(139);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(1),o=r(9),u=r(2),a=r(56),s=r(7),c=r(139);t.Stream=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this._client=o.Client.sharedInstance(),this._liveService=(0,a.getLiveService)(this._client),this._subscribeChannels={},this._publishChannels={}}return n(e,[{key:"getSubstreams",value:function(){return this._makeStreamRequest("_substreams",s.RequestMethod.GET)}},{key:"getACL",value:function(e){return(0,u.isNonemptyString)(e)?this._makeStreamRequest(e,s.RequestMethod.GET):Promise.reject(new i.KinveyError("Invalid or missing id"))}},{key:"setACL",value:function(e,t){return(0,u.isNonemptyString)(e)?c.StreamACL.isValidACLObject(t)?(t instanceof c.StreamACL||(t=new c.StreamACL(t)),this._makeStreamRequest(e,s.RequestMethod.PUT,t.toPlainObject())):Promise.reject(new i.KinveyError("Invalid or missing ACL object")):Promise.reject(new i.KinveyError("Invalid or missing id"))}},{key:"follow",value:function(e,t){return this._subscribe(e,t)}},{key:"unfollow",value:function(e){return this._unsubscribe(e)}},{key:"post",value:function(e){var t=this._client.getActiveUser()._id;return this._publish(t,e)}},{key:"listen",value:function(e){var t=this._client.getActiveUser()._id;return this._subscribe(t,e)}},{key:"stopListening",value:function(){var e=this._client.getActiveUser()._id;return this._unsubscribe(e)}},{key:"send",value:function(e,t){return this._publish(e,t)}},{key:"_unsubscribeFromSubstream",value:function(e){var t=e+"/unsubscribe";return this._makeStreamRequest(t,s.RequestMethod.POST,{deviceId:this._client.deviceId})}},{key:"_subscribe",value:function(e,t){var r=this;return this._requestSubscribeAccess(e).then(function(){var n=r._subscribeChannels[e];r._liveService.subscribeToChannel(n,t)})}},{key:"_unsubscribe",value:function(e){var t=this;return this._unsubscribeFromSubstream(e).then(function(){var r=t._subscribeChannels[e];t._liveService.unsubscribeFromChannel(r),delete t._subscribeChannels[e]})}},{key:"_publish",value:function(e,t){return this._publishChannels[e]?this._retriablePublish(e,t):this._publishWithAccessRequest(e,t)}},{key:"_publishWithAccessRequest",value:function(e,t){var r=this;return this._requestPublishAccess(e).then(function(){var n=r._publishChannels[e];return r._liveService.publishToChannel(n,t)})}},{key:"_retriablePublish",value:function(e,t){var r=this,n=this._publishChannels[e];return this._liveService.publishToChannel(n,t).catch(function(n){var i=Promise.reject(n);return n.statusCode===s.StatusCode.Forbidden&&(i=r._publishWithAccessRequest(e,t)),i})}},{key:"_requestPublishAccess",value:function(e){var t=this;return this._makeStreamRequest(e+"/publish",s.RequestMethod.POST).then(function(r){return r.substreamChannelName&&(t._publishChannels[e]=r.substreamChannelName),r})}},{key:"_requestSubscribeAccess",value:function(e){var t=this,r={deviceId:this._client.deviceId};return this._makeStreamRequest(e+"/subscribe",s.RequestMethod.POST,r).then(function(r){return t._subscribeChannels[e]=r.substreamChannelName,r})}},{key:"_makeStreamRequest",value:function(e,t,r){return s.KinveyRequest.executeShort({method:t,pathname:"/stream/"+this._client.appKey+"/"+this.name+"/"+e,body:r},this._client)}}],[{key:"StreamACL",get:function(){return c.StreamACL}}]),e}()},function(e,t,r){var n=r(398),i=r(399),o=r(22),u=r(4),a=r(114);e.exports=function(e,t,r){var s=u(e)?n:i;return r&&a(e,t,r)&&(t=void 0),s(e,o(t,3))}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}},function(e,t,r){var n=r(33);e.exports=function(e,t){var r=!0;return n(e,function(e,n,i){return r=!!t(e,n,i)}),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onConnectionStatusUpdates=function(e){o().onConnectionStatusUpdates(e)},t.offConnectionStatusUpdates=function(e){o().offConnectionStatusUpdates(e)},t.isInitialized=function(){return o().isInitialized()};var n=r(9),i=r(56);function o(){var e=n.Client.sharedInstance();return(0,i.getLiveService)(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataStore=t.DataStoreType=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=p(r(8)),o=p(r(11)),u=r(7),a=r(1),s=r(2),c=r(9),l=r(88),f=r(83),h=r(141);function p(e){return e&&e.__esModule?e:{default:e}}var d=t.DataStoreType={Cache:"Cache",Network:"Network",Sync:"Sync"};Object.freeze(d);var y=function(){function e(){throw function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),new a.KinveyError("Not allowed to construct a DataStore instance. Please use the collection() function to get an instance of a DataStore instance.")}return n(e,null,[{key:"collection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.Cache,r=arguments[2],n=void 0;if(!1===(0,s.isDefined)(e)||!1===(0,i.default)(e))throw new a.KinveyError("A collection is required and must be a string.");switch(t){case d.Network:n=new l.NetworkStore(e,r);break;case d.Sync:n=new h.SyncStore(e,r);break;case d.Cache:default:n=new f.CacheStore(e,r)}return n}},{key:"getInstance",value:function(e,t,r){return this.collection(e,t,r)}},{key:"clearCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.client||c.Client.sharedInstance(),r="/appdata/"+t.appKey;return new u.CacheRequest({method:u.RequestMethod.DELETE,url:o.default.format({protocol:t.apiProtocol,host:t.apiHost,pathname:r}),properties:e.properties,timeout:e.timeout}).execute().then(function(e){return e.data})}}]),e}();t.DataStore=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserStore=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=d(r(6)),o=d(r(4)),u=d(r(8)),a=d(r(11)),s=r(7),c=r(1),l=r(36),f=r(2),h=r(12),p=r(55);function d(e){return e&&e.__esModule?e:{default:e}}t.UserStore=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,p.NetworkStore),n(t,[{key:"lookup",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.KinveyObservable.create(function(n){return!(0,f.isDefined)(e)||e instanceof h.Query?new s.KinveyRequest({method:s.RequestMethod.POST,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/_lookup"}),properties:r.properties,body:(0,f.isDefined)(e)?e.toPlainObject().filter:null,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)}):n.error(new c.KinveyError("Invalid query. It must be an instance of the Query class."))})}},{key:"create",value:function(){return i.default.reject(new c.KinveyError("Please use `User.signup()` to create a user."))}},{key:"update",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?(0,o.default)(e)?i.default.reject(new c.KinveyError("Only one user can be updated at one time.",e)):e._id?function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(n):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,r):i.default.reject(new c.KinveyError("User must have an _id.")):i.default.reject(new c.KinveyError("No user was provided to be updated."))}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new s.KinveyRequest({method:s.RequestMethod.POST,authType:s.AuthType.App,url:a.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:"/rpc/"+this.client.appKey+"/check-username-exists"}),properties:t.properties,data:{username:e},timeout:t.timeout,client:this.client}).execute().then(function(e){return e.data}).then(function(){return!0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).usernameExists})}},{key:"removeById",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.KinveyObservable.create(function(n){return!1===(0,f.isDefined)(e)?n.error(new c.KinveyError("An id was not provided.","Please provide a valid id for a user that you would like to remove.")):!1===(0,u.default)(e)?n.error(new c.KinveyError("The id provided is not a string.","Please provide a valid id for a user that you would like to remove.")):new s.KinveyRequest({method:s.RequestMethod.DELETE,authType:s.AuthType.Default,url:a.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e,query:!0===r.hard?{hard:!0}:void 0}),properties:r.properties,timeout:r.timeout}).execute().then(function(e){return e.data}).then(function(e){return n.next(e)}).then(function(){return n.complete()}).catch(function(e){return n.error(e)})}).toPromise()}},{key:"pathname",get:function(){return"/user/"+this.client.appKey}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomEndpoint=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=l(r(6)),o=l(r(8)),u=l(r(11)),a=r(1),s=r(9),c=r(7);function l(e){return e&&e.__esModule?e:{default:e}}t.CustomEndpoint=function(){function e(){throw function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),new a.KinveyError("Not allowed to create an instance of the `CustomEndpoint` class.","Please use `CustomEndpoint.execute()` function.")}return n(e,null,[{key:"execute",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.client||s.Client.sharedInstance();return e?(0,o.default)(e)?new c.KinveyRequest({method:c.RequestMethod.POST,authType:c.AuthType.Default,url:u.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/custom/"+e}),properties:r.properties,body:t,timeout:r.timeout,client:n}).execute().then(function(e){return e.data}):i.default.reject(new a.KinveyError("The endpoint argument must be a string.")):i.default.reject(new a.KinveyError("An endpoint argument is required."))}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Files=t.FileStore=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=b(r(6)),o=b(r(84)),u=b(r(17)),a=b(r(19)),s=b(r(75)),c=b(r(11)),l=r(7),f=r(1),h=r(36),p=r(21),d=r(2),y=r(12),v=r(55);function b(e){return e&&e.__esModule?e:{default:e}}function g(e,t){var r=e?parseInt(e.split("-")[1],10)+1:0;return r>=t?t-1:r}var m=t.FileStore=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,v.NetworkStore),n(t,[{key:"find",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={tls:!0===(r=(0,u.default)({tls:!0},r)).tls};return(0,s.default)(r.ttl)&&(n.ttl_in_seconds=parseInt(r.ttl,10)),h.KinveyObservable.create(function(i){return!(0,d.isDefined)(e)||e instanceof y.Query?new l.KinveyRequest({method:l.RequestMethod.GET,authType:l.AuthType.Default,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname,query:n}),properties:r.properties,query:e,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return i.next(e)}).then(function(){return i.complete()}).catch(function(e){return i.error(e)}):i.error(new f.KinveyError("Invalid query. It must be an instance of the Query class."))}).toPromise().then(function(e){return!0===r.download?i.default.all((0,o.default)(e,function(e){return t.downloadByUrl(e._downloadURL,r)})):e})}},{key:"findById",value:function(e,t){return this.download(e,t)}},{key:"download",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={tls:!0===(r=(0,u.default)({tls:!0},r)).tls};return(0,s.default)(r.ttl)&&(n.ttl_in_seconds=parseInt(r.ttl,10)),h.KinveyObservable.create(function(i){return!1===(0,d.isDefined)(e)?(i.next(void 0),i.complete()):new l.KinveyRequest({method:l.RequestMethod.GET,authType:l.AuthType.Default,url:c.default.format({protocol:t.client.apiProtocol,host:t.client.apiHost,pathname:t.pathname+"/"+e,query:n}),properties:r.properties,timeout:r.timeout,client:t.client}).execute().then(function(e){return e.data}).then(function(e){return i.next(e)}).then(function(){return i.complete()}).catch(function(e){return i.error(e)})}).toPromise().then(function(e){return!0===r.stream?e:(r.mimeType=e.mimeType,t.downloadByUrl(e._downloadURL,r))})}},{key:"downloadByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new l.NetworkRequest({method:l.RequestMethod.GET,url:e,timeout:t.timeout}).execute().then(function(e){return e.data})}},{key:"stream",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.stream=!0,this.download(e,t)}},{key:"upload",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=this.transformMetadata(e,r);var o=null;return this.saveFileMetadata(n,r).then(function(e){return o=e.data,t.makeStatusCheckRequest(e.data._uploadURL,e.data._requiredHeaders,r,n.timeout)}).then(function(u){if(p.Log.debug("File upload status check response",u),!u.isSuccess())return i.default.reject(u.error);if(200===u.statusCode||201===u.statusCode)return u;if(308!==u.statusCode){var a=new f.KinveyError("Unexpected response for upload file status check request.",!1,u.statusCode,u.headers.get("X-Kinvey-Request-ID"));return i.default.reject(a)}var s={start:g(u.headers.get("range"),r.size),timeout:n.timeout,maxBackoff:n.maxBackoff,headers:o._requiredHeaders};return t.retriableUpload(o._uploadURL,e,r,s)}).then(function(){return delete o._expiresAt,delete o._requiredHeaders,delete o._uploadURL,o._data=e,o})}},{key:"transformMetadata",value:function(e,t){var r=(0,u.default)({filename:e._filename||e.name,public:!1,size:e.size||e.length,mimeType:e.mimeType||e.type||"application/octet-stream"},t);return r._filename=t.filename,delete r.filename,r._public=t.public,delete r.public,r}},{key:"saveFileMetadata",value:function(e,t){var r=(0,d.isDefined)(t._id);return new l.KinveyRequest({method:r?l.RequestMethod.PUT:l.RequestMethod.POST,authType:l.AuthType.Default,headers:{"X-Kinvey-Content-Type":t.mimeType},url:c.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:r?this.pathname+"/"+t._id:this.pathname}),properties:e.properties,timeout:e.timeout,body:t,client:this.client}).execute()}},{key:"makeStatusCheckRequest",value:function(e,t,r,n){var i=new l.Headers(t);return i.set("content-type",r.mimeType),i.set("content-range","bytes */"+r.size),new l.NetworkRequest({method:l.RequestMethod.PUT,url:e,timeout:n,headers:i}).execute()}},{key:"retriableUpload",value:function(e,t,r,n){var o=this;return n=(0,u.default)({count:0,start:0,maxBackoff:32e3},n),p.Log.debug("Start file upload"),p.Log.debug("File upload headers",n.headers),p.Log.debug("File upload upload url",c.default),p.Log.debug("File upload file",t),p.Log.debug("File upload metadata",r),p.Log.debug("File upload options",n),this.makeUploadRequest(e,t,r,n).then(function(e){if(p.Log.debug("File upload response",e),e.isClientError())return i.default.reject(e.error);if(!e.isSuccess()&&!e.isServerError()&&308!==e.statusCode){var t=new f.KinveyError("Unexpected response for upload file request.",!1,e.statusCode,e.headers.get("X-Kinvey-Request-ID"));return i.default.reject(t)}return e}).then(function(e){var t,o,u=0;return e.isServerError()?(p.Log.debug("File upload server error. Probably network congestion.",e.statusCode,e.data),(u=Math.pow(2,n.count)+(t=1,o=1001,Math.floor(Math.random()*(o-t))+t))>=n.maxBackoff?i.default.reject(e.error):(p.Log.debug("File upload will try again in "+u+" seconds."),new i.default(function(e){setTimeout(function(){n.count+=1,e(!0)},u)}))):308===e.statusCode?(p.Log.debug("File upload was incomplete (statusCode 308). Trying to upload the remainder of file."),n.start=g(e.headers.get("range"),r.size),new i.default(function(e){setTimeout(function(){n.count=0,e(!0)},u)})):new i.default(function(e){setTimeout(function(){e(!1)},u)})}).then(function(i){return i?o.retriableUpload(e,t,r,n):null})}},{key:"makeUploadRequest",value:function(e,t,r,n){var i=new l.Headers(n.headers);return i.set("content-type",r.mimeType),i.set("content-range","bytes "+n.start+"-"+(r.size-1)+"/"+r.size),new l.NetworkRequest({method:l.RequestMethod.PUT,url:e,headers:i,body:(0,a.default)(t.slice)?t.slice(n.start):t,timeout:n.timeout}).execute()}},{key:"create",value:function(e,t,r){return this.upload(e,t,r)}},{key:"update",value:function(e,t,r){return this.upload(e,t,r)}},{key:"remove",value:function(){throw new f.KinveyError("Please use removeById() to remove files one by one.")}},{key:"pathname",get:function(){return"/blob/"+this.client.appKey}}]),t}();t.Files=new m},function(e,t,r){"use strict";r(406)},function(e,t,r){"use strict";"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r},writable:!0,configurable:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(408));var n=r(411);t.Push=n.Push;var i=r(127);t.StorageProvider=i.StorageProvider},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(2),o=r(1),u=r(409);function a(e){if(void 0===e&&(e={}),!i.isDefined(e.appKey))throw new o.KinveyError("No App Key was provided. Unable to create a new Client without an App Key.");if(!i.isDefined(e.appSecret)&&!i.isDefined(e.masterSecret))throw new o.KinveyError("No App Secret or Master Secret was provided. Unable to create a new Client without an App Secret.");return u.Client.init(e)}t.init=a,t.initialize=function(e){var t=a(e);return n.Promise.resolve(t.getActiveUser())}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),i=r(1),o=r(2),u=r(21),a=new(r(410).SecureStorage),s=function(){function e(){}return e.prototype.get=function(e){if("string"!=typeof e)throw new i.KinveyError("The key argument must be a string.");try{return JSON.parse(a.get(e))}catch(e){return u.Log.debug("Unable to parse stored active user.",e),null}},e.prototype.set=function(e,t){if("string"!=typeof e)throw new i.KinveyError("The key argument must be a string.");return o.isDefined(t)?a.set(e,t):this.remove(e),t},e.prototype.remove=function(e){if("string"!=typeof e)throw new i.KinveyError("The key argument must be a string.");return a.remove(e),null},e}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.init=function(e){var t=n.Client.init(e);return t.activeUserStorage=new s,t},t}(n.Client);t.Client=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.defaultService="kinvey_nativescript_sdk"}return e.prototype.get=function(e){if("string"!=typeof e)throw new Error("The key argument must be a string.");var t=SAMKeychainQuery.new();t.service=this.defaultService,t.account=e;try{return t.fetch(),t.password}catch(e){return null}},e.prototype.set=function(e,t){if("string"!=typeof e)throw new Error("The key argument must be a string.");null!==t&&void 0!==t&&"object"==typeof t&&(t=JSON.stringify(t)),null!==t&&void 0!==t&&"string"!=typeof t&&(t=String(t));var r=kSecAttrAccessibleAlwaysThisDeviceOnly;SAMKeychain.setAccessibilityType(r);var n=SAMKeychainQuery.new();return n.service=this.defaultService,n.account=e,n.password=t,n.save()},e.prototype.remove=function(e){if("string"!=typeof e)throw new Error("The key argument must be a string.");var t=SAMKeychainQuery.new();t.service=this.defaultService,t.account=e;try{return t.deleteItem()}catch(e){return!1}},e}();t.SecureStorage=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(6),o=r(2),u=r(1),a=r(412);try{n=r(413)}catch(e){}var s=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._registerWithPushPlugin=function(e){var t=this;void 0===e&&(e={});var r=e.ios||{};return new i.Promise(function(e,i){if(!1===o.isDefined(n))return i(new u.KinveyError("NativeScript Push Plugin is not installed.","Please refer to http://devcenter.kinvey.com/nativescript/guides/push#ProjectSetUp for help with setting up your project."));r.notificationCallbackIOS=function(e){t.emit("notification",e)},n.register(r,function(t){o.isDefined(r.interactiveSettings)?n.registerUserNotificationSettings(function(){e(t)},function(r){e(t)}):e(t)},i)})},t.prototype._unregisterWithPushPlugin=function(e){return void 0===e&&(e={}),new i.Promise(function(t,r){if(!1===o.isDefined(n))return r(new u.KinveyError("NativeScript Push Plugin is not installed.","Please refer to http://devcenter.kinvey.com/nativescript/guides/push#ProjectSetUp for help with setting up your project."));n.unregister(t,r,e)})},t}(a.PushCommon));t.Push=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(54),o=r(129),u=r(9),a=r(1),s=r(2),c=r(82),l=r(7),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"client",{get:function(){return!1===s.isDefined(this._client)?u.Client.sharedInstance():this._client},set:function(e){if(s.isDefined(e)&&e instanceof u.Client==!1)throw new Error("client must be an instance of Client.");this._client=e},enumerable:!0,configurable:!0}),t.prototype.onNotification=function(e){return this.on("notification",e)},t.prototype.onceNotification=function(e){return this.once("notification",e)},t.prototype.register=function(e){var t=this;return void 0===e&&(e={}),this._registerWithPushPlugin(e).then(function(r){if(!1===s.isDefined(r))throw new a.KinveyError("Unable to retrieve the device token to register this device for push notifications.");return t._registerWithKinvey(r,e)}).then(function(r){return t._saveTokenToCache(r,e)})},t.prototype.unregister=function(e){var t=this;return void 0===e&&(e={}),this._unregisterWithPushPlugin(e).then(function(){return t._getTokenFromCache(e)}).then(function(r){if(!1===s.isDefined(r))throw new a.KinveyError("Unable to retrieve the device token to unregister this device for push notifications.");return t._unregisterWithKinvey(r,e)}).then(function(){return t._deleteTokenFromCache(e)})},t.prototype._registerWithPushPlugin=function(e){return void 0===e&&(e={}),n.Promise.reject(new a.KinveyError("Unable to register for push notifications."))},t.prototype._unregisterWithPushPlugin=function(e){return void 0===e&&(e={}),n.Promise.reject(new a.KinveyError("Unable to unregister for push notifications."))},t.prototype._registerWithKinvey=function(e,t){void 0===t&&(t={});var r=c.User.getActiveUser(this.client);return!1===s.isDefined(r)?n.Promise.reject(new a.KinveyError("Unable to register this device for push notifications.","You must login a user.")):new l.KinveyRequest({method:l.RequestMethod.POST,url:this.client.apiHostname+"/push/"+this.client.appKey+"/register-device",authType:r?l.AuthType.Session:l.AuthType.Master,data:{platform:o.device.os.toLowerCase(),framework:"nativescript",deviceId:e},timeout:t.timeout,client:this.client}).execute().then(function(){return e})},t.prototype._unregisterWithKinvey=function(e,t){void 0===t&&(t={});var r=c.User.getActiveUser(this.client);return!1===s.isDefined(r)?n.Promise.reject(new a.KinveyError("Unable to unregister this device for push notifications.","You must login a user.")):new l.KinveyRequest({method:l.RequestMethod.POST,url:this.client.apiHostname+"/push/"+this.client.appKey+"/unregister-device",authType:s.isDefined(r)?l.AuthType.Session:l.AuthType.Master,data:{platform:o.device.os.toLowerCase(),framework:"nativescript",deviceId:e},timeout:t.timeout,client:this.client}).execute().then(function(e){return e.data})},t.prototype._getTokenFromCache=function(e){void 0===e&&(e={});var t=c.User.getActiveUser(this.client);if(!1===s.isDefined(t))throw new a.KinveyError("Unable to retrieve device token.","You must login a user.");return new l.CacheRequest({method:l.RequestMethod.GET,url:this.client.apiHostname+"/appdata/"+this.client.appKey+"/__device/"+t._id,client:this.client}).execute().catch(function(e){if(e instanceof a.NotFoundError)return{};throw e}).then(function(e){return e.data}).then(function(e){return s.isDefined(e)?e.token:null})},t.prototype._saveTokenToCache=function(e,t){void 0===t&&(t={});var r=c.User.getActiveUser(this.client);if(!1===s.isDefined(r))throw new a.KinveyError("Unable to save device token.","You must login a user.");return new l.CacheRequest({method:l.RequestMethod.PUT,url:this.client.apiHostname+"/appdata/"+this.client.appKey+"/__device",data:{userId:r._id,token:e},client:this.client}).execute().then(function(){return e})},t.prototype._deleteTokenFromCache=function(e){void 0===e&&(e={});var t=c.User.getActiveUser(this.client);if(!1===s.isDefined(t))throw new a.KinveyError("Unable to delete device token.","You must login a user.");return new l.CacheRequest({method:l.RequestMethod.DELETE,url:this.client.apiHostname+"/appdata/"+this.client.appKey+"/__device/"+t._id,client:this.client}).execute().catch(function(e){if(e instanceof a.NotFoundError)return{};throw e}).then(function(){return null})},t}(i.EventEmitter);t.PushCommon=f},function(e,t){e.exports=require("nativescript-push-notifications")}]);
//# sourceMappingURL=kinvey-nativescript-sdk.ios.js.map